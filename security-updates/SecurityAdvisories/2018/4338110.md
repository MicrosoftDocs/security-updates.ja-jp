---
TOCTitle: 4338110
Title: マイクロソフト セキュリティ アドバイザリ 4338110
---

マイクロソフト セキュリティ アドバイザリ 4338110
===================================

パディングを使用した CBC モード対称復号化によるタイミングの脆弱性
-----------------------------------------------------------------------------

公開日: 2018 年 6 月 13 日

**バージョン:** 1.0

一般情報
-------------------

### 概要

マイクロソフトは、アプリケーションまたはサービス内での対称暗号化の Cipher-Block-Chaining (CBC) モードの使用に関するガイダンスの更新をお知らせします。マイクロソフトでは、現時点でわかっている暗号化の調査に基づき、非常に特殊な状況を除いて、暗号文の整合性を確保せずに検証可能なパディングを適用した場合、対称暗号化の Cipher-Block-Chaining (CBC) モードで暗号化されたデータを復号することはもはや安全ではなくなったと考えています。 
"パディング オラクル攻撃" と呼ばれる脆弱性のクラスは、10 年以上前から存在が知られていました。この攻撃により、対称ブロック アルゴリズム (AES や 3DES など) で暗号化されたデータは、データの 1 ブロックあたり 4,096 回以下の試行回数でで解読される可能性があります。これらの脆弱性は、多くの場合、ブロック暗号が末尾の検証可能なパディング データと共に使用されることを利用しています。攻撃者が暗号文を改ざんし、改ざんによって末尾のパディングの形式でエラーが発生したかどうかを確認できる場合、攻撃者はデータを復号化できることが判明しました。

**推奨する対応策**: マイクロソフトは、機密情報含むすべてのデータを必ず Transport Layer Security (TLS、Secure Sockets Layer (SSL) の後継) を介して送信することをお勧めします。最新の調査によると、通常、(AE 以外の暗号化モードの場合) 暗号文を認証する認証と暗号化の手順が独立して実行されるとき (暗号化してから署名) が、最も一般的な選択肢であると考えられています。ただし、あらゆる場合に適した 1 つの暗号化方法はないため、このような一般化は、プロの暗号化技術者からの指導的アドバイスほど適切ではありません。メッセージの形式を変更することができない、未認証の CBC 復号化を実行するアプリケーションは、緩和策を組み込むことをお勧めします。 

要約すると、パディングされた CBC ブロック暗号文を安全に使用するには、データの復号化を試みる前に一定時間の比較を使用して検証する HMAC (または別のデータ整合性チェック) と組み合わせる必要があります。すべての変更されたメッセージは、応答の生成に同じ時間がかかるので、攻撃は回避されます。この脆弱性の例を見つけられるように、マイクロソフトは、更新されたドキュメントで説明されているコード レビューの実行方法を示すガイダンスをリリースしました。パディングを使用した CBC モード対称復号化によるタイミングの脆弱性

アドバイザリの詳細
----------------

### 問題に関する参照情報

この問題に関する詳細情報は、次の参照情報をご確認ください。


<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">一般情報</td>
<td style="border:1px solid black;"><a href="http://aka.ms/sha1">パディングを使用した CBC モード対称復号化によるタイミングの脆弱性</a></td>
</tr>
</tbody>
</table>
  
### 推奨されるその他のアクション
  
-   **コンピューターを守る**   
    マイクロソフトは、お客様が引き続き、「コンピューターを守る」のガイダンスに従い、ファイアウォールを有効にし、すべてのソフトウェアの更新を適用し、ウイルス対策ソフトウェアをインストールすることを推奨しています。詳細については、[Microsoft セーフティとセキュリティ センター](http://www.microsoft.com/ja-jp/security/default.aspx)をご覧ください。
  
-   **マイクロソフトのソフトウェアを最新の状態に保つ**   
    マイクロソフトのソフトウェアを使用しているユーザーは、最新のマイクロソフトのセキュリティ更新プログラムを適用してください。ご使用のソフトウェアが最新のものかどうか明確でない場合は、[Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747) にアクセスし、コンピューターをスキャンして利用可能な更新プログラムがあるかどうかを調べ、提示される優先度の高い更新プログラムをインストールしてください。自動更新ツールが有効で、マイクロソフト製品用の更新プログラムが提供されるよう設定されている場合は、新しい更新プログラムがご利用可能になった時点で自動的に提供されます。しかし、更新プログラムが正しくインストールされているかどうかをご確認いただく必要があります。
  
関連情報  
-----------------

### Microsoft Active Protections Program (MAPP)
  
お客様のセキュリティ保護をより向上させるために、マイクロソフトは、月例のセキュリティ更新プログラムの公開に先立ち、脆弱性情報を主要なセキュリティ ソフトウェア プロバイダーに提供しています。セキュリティ ソフトウェア プロバイダーは、この脆弱性の情報を使用し、ウイルス対策、ネットワーク ベースの侵入検出システムまたはホスト ベースの侵入防止システムを介して、お客様に最新の保護環境を提供します。このような保護環境を提供するセキュリティ ソフトウェア ベンダーの情報については、[Microsoft Active Protections Program (MAPP) パートナー](http://go.microsoft.com/fwlink/?linkid=215201)に記載されている各社の Web サイトを参照してください。
  
### フィードバック
  
-   フィードバックをご提供いただく際は、マイクロソフトへの[ご意見・ご要望のフォーム](http://support.microsoft.com/ja-jp?scid=sw;en;1257&amp;showpage=1&amp;ws=technet&amp;sd=tech)へ入力をお願いします。
  
### サポート
  
-   セキュリティ関連、およびセキュリティ更新プログラムに関するご質問や、ご不明な点などありましたら、[マイクロソフト セキュリティ情報センター](http://go.microsoft.com/fwlink/?linkid=21131)までご連絡ください。詳細については、[Microsoft サポート](http://support.microsoft.com/)を参照してください。  
-   その他、製品に関するご質問は、マイクロソフト プロダクト サポートまでご連絡ください。詳細については、[インターナショナル サポート](http://go.microsoft.com/fwlink/?linkid=21155)を参照してください。  
-   [Microsoft セキュリティ TechCenter](http://go.microsoft.com/fwlink/?linkid=21132) では、マイクロソフト製品に関するセキュリティ情報を提供しています。
  
### 免責
  
この文書に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation およびその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。Microsoft Corporation、その関連会社およびこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含むすべての損害に対して、状況のいかんを問わず一切責任を負いません。結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。
  
### 更新履歴
  
-   V1.0 (2018 年 6 月 13 日): このアドバイザリを公開しました。  
  

