---
TOCTitle: 'MS00-005'
Title: 'マイクロソフト セキュリティ情報 MS00-005 - 重要'
ms:assetid: 'ms00-005'
ms:contentKeyID: 61228171
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-005(v=Security.10)'
---
マイクロソフト セキュリティ情報 MS00-005 - 重要
===============================================

「RTF のコントロール ワードが改ざんされた場合」の脆弱性に対する対策
-------------------------------------------------------------------

公開日: 2000年3月6日 | 最終更新日: 2001年2月20日

#### 概要 :

マイクロソフトは、Microsoft® Windows® 95、98、および Windows NT® 4.0 に含まれている Rich Text Format (RTF) リーダーにおけるセキュリティの脆弱性を排除する更新プログラムをリリースしました。 特定の条件で、この脆弱性により電子メールプログラムをクラッシュする危険性があるという問題です。

**影響を受けるソフトウェアのバージョン:**

-   Microsoft Windows 95
-   Microsoft Windows 98
-   Microsoft Windows 98 Second Edition
-   Microsoft Windows NT 4.0 Workstation
-   Microsoft Windows NT 4.0 Server
-   Microsoft Windows NT 4.0 Server、Enterprise Edition
-   Microsoft Windows NT 4.0 Server、Terminal Server Edition

**注:**
Windows 2000 にはこの脆弱性による影響はありません

### 詳細

問題
----


RTF ファイルは、ディレクティブ呼び出しによるコントロール ワードを使用するコントロール情報とテキストからなっており、コントロール ワードの解析を行うそのリーダーは全ての Windows バージョンで共通です。悪意の あるユーザーが改ざんされたコントロール ワードを含む RTF ファイルを送信した場合、RTF リーダーのコントロール ワード解析部分にはチェック済みでないバッファが含まれているため、アプリケーションがクラッシュしてしまうことがあります｡  

この問題により、サービスが不能になってしまうということはありますが、任意のコードが実行されてしまうということはありません｡最も深刻な事態は Outlook などのメール プログラムでプレビュー モードを有効にしているユーザーが改ざんされたコントロール ワードを含む RTF 形式のメールを受信してしまった場合です｡メール プログラムの設定がプレビュー モードになっているとメールの解析が自動的に行われてしまうので、次のメールを受信するかプレビュー モードを無効にしてメール プログラムが開始されないとプログラムはクラッシュし続けます｡

よく寄せられる質問
------------------


**マイクロソフト セキュリティ情報 MS00-005 はどのような内容の通知ですか?**

このマイクロソフト セキュリティ情報 MS00-005 は、Microsoft® Windows® 95、98 そして Windows NT® 4.0 のセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことを、お客様にお知らせするものです。この脆弱性のため、リッチ テキスト形式 （RTF） のデータを使用するアプリケーションがクラッシュしてしまうことがあります。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**この脆弱性はどれくらいの範囲に影響を与えますか?**

Microsoft プラットフォームの一部として出荷されている、RTF リーダーの[バッファ オーバーラン](https://www.microsoft.com/japan/security/glossary.mspx)により、[サービス拒否](https://www.microsoft.com/japan/security/glossary.mspx)されてしまうことがあります。  

この脆弱性を利用し、悪意のあるユーザーが特別に改ざんされた RTF ファイルを送信した場合、それを開いたユーザーのアプリケーションがクラッシュしてしまうことがあります。通常、この問題は、アプリケーションの再起動で対処できますが、ユーザーが電子メール アプリケーションで電子メールをプレビュー ウィンドウで参照するよう設定している場合、次の電子メールが届くか、プレビュー ウィンドウ オプションを無効にしてアプリケーションを立ち上げないと、アプリケーションがクラッシュしつづける場合があります。バッファ オーバーランが原因の他の問題同様、マイクロソフトではこの脆弱性により任意のコードが実行されてしまうことはないと考えます。

**RTF とは何ですか?**

RTF とは、テキストや画像などの属性を含む情報を記述するためのファイル形式で、テキストや画像を扱うワードプロセッサ ソフトや電子メール ソフトなど、たくさんのアプリケーションでサポートされています。  

RTF は、コントロール情報とフォーマットされていないテキストを含みます。コントロール情報は、テキストのフォント、色、行端揃えなどの情報を含み、テキストをどのようにフォーマットすべきか指示します。これらの設定は、例えばテキストを大文字にしたい場合は、\\caps が指定されるようにコントロール ワードが使用されます。

**RTF リーダーとは何ですか?**

RTF リーダーとは、RTF データを解釈するプログラムです。RTF リーダーは、どのマイクロソフト プラットフォームにも含まれます。マイクロソフト プラットフォームにあらかじめ RTF リーダーが含まれていることにより、アプリケーション独自のそれが必要ありません。

**この脆弱性の原因は何ですか?**

この脆弱性は、マイクロソフト製品に含まれ出荷されている RTF リーダーのバッファに問題があるために発生します。特別に改ざんされたコントロール ワードが送信されると、バッファ オーバーランを引き起こし、アプリケーションをクラッシュさせてしまうことができます。

**どうやって改ざんされたコントロール ワードが RTF に入るのですか?**

マイクロソフトでは、改ざんされたコントロール ワードは、悪意のあるユーザーによって、故意に挿入されなければならないと考えています。普段の処理において、またエラーによって、そのようなコントロール ワードが、RTF アプリケーションで生成されることはないと考えるからです。

**この脆弱性にはどのような危険がありますか?**

マイクロソフトでは、以下の 2 つのシナリオによって、お客様に影響がおよぶことがあると考えています。悪意のあるユーザーが、改ざんされたコントロール ワードを含む RTF ファイルを作成し、他のユーザーに渡し、そのユーザーが、デフォルトの RTF リーダーを使用するアプリケーションでそれを開いた場合、この脆弱性により、アプリケーションがクラッシュすることがあります。例えば、WordPad を使用し、そのようなファイルが開くと、WordPad はクラッシュします。そのとき、ユーザーは作業中の文書を失ってしまいますが、WordPad を再起動することで、作業をつづけられます。  

これよりも深刻なシナリオは、多くの電子メール アプリケーションに含まれるプレビュー ウィンドウ オプションが、ユーザーによって使用されていた場合です。悪意のあるユーザーが、電子メールをプレビュー ウィンドウで参照しているユーザーに、改ざんされたコントロール ワードを含む RTF 形式の電子メールを送ると、電子メールが表示されたとたんに、電子メール アプリケーションがクラッシュしてしまいます。改ざんされた電子メールを受信したユーザーは、アプリケーションを再起動できますが、メールがプレビュー ペインに表示されているかぎり、アプリケーションはクラッシュしつづけます。ここで重要なことは、プレビュー ウィンドウ オプションが有効になっていないユーザーの場合は、アプリケーションの起動後、電子メールを削除することで、通常の作業に戻れるということです。つまり、プレビュー ウィンドウ オプションが有効になっているユーザーのみ、影響が大きくなることがあるということです。

**Outlookプレビューとプレビュー ウィンドウ オプションの両方が Outlook で影響を受けますか?**

いいえ。プレビューとプレビュー ウィンドウのオプションは、違うものです。これは、プレビュー ウィンドウを使用しているユーザーのみに影響を与える脆弱性であり、プレビューには影響を与えません。  

プレビュー オプションとは、受信トレイの電子メールの最初の 3 行だけを表示させるオプションで、\[表示\] メニューから選択することができます。一方、プレビュー ウィンドウ オプションとは、電子メールの内容を表示するためプレビュー ペインが作成されるオプションです。  

プレビューの場合、フォーマット情報の処理は行われないので、改ざんされたコントロール ワードを含む RTF 電子メールが送信された場合でも、電子メールを実際に開かないかぎり問題は発生しません。しかし、プレビュー ウィンドウで電子メールを参照している場合、フォーマット情報の処理が行われますので、プレビュー ペインに電子メールが表示されたと同時に、Outlook がクラッシュします。

**Outlook のプレビュー ウィンドウが有効になっています。問題となっているメールを受け取ったら、どのように対処すればよいですか?**

この問題を回避するには、以下の 2 通りの方法があります。

-   他の人に、電子メールを送ってもらいます。Outlook では、最後に受信した電子メールしかプレビュー ペインに表示されません。したがって、また電子メールを受信すれば、悪意のある電子メールはプレビューされず、Outlook をクラッシュさせません。
-   Outlook をコマンド プロンプトから起動し、オプション、/safe と /nopreview を指定し、プレビュー ウィンドウ オプションを無効にします。方法の詳細については、マイクロソフトのサポート技術資料 [197180](https://support.microsoft.com/kb/197180) と [182112](https://support.microsoft.com/kb/182112) を参照してください。

Outlook を起動したら、その電子メールを削除します。その際、電子メールは開かないでください。  

バッファ オーバーラン攻撃によってセキュリティを侵害する他の多くの問題では、攻撃者が任意のコードを実行できる場合が多いです。しかし、弊社で確認している限り、このケースにおいて実行することは非常に困難です。なぜなら、悪意のあるユーザーは、任意のコードを実行するために小文字の英字と数字を組み合わせたマシン言語で、プログラムを書かなければならないからです。したがって、マイクロソフトでは、任意のコードは実行できないと考えています。

**この脆弱性は偶発的に発生しますか?**

いいえ、発生しません。この脆弱性を侵害するには、悪意のあるユーザーは、16 進数のエディタを使用し RTF ファイルのデータを改ざんする必要があるためです。

**リモートからこの脆弱性を侵害することはできますか?**

上述のとおり、悪意のあるユーザーは改ざんしたファイルを、電子メールで送信したり、フロッピーディスクや他のメディアに入れ、他のユーザーに渡すことができます。しかし、悪意のあるユーザーが、ネットワーク ベースの攻撃として、この脆弱性を侵害することはできません。

**だれが更新プログラムを適用する必要がありますか?**

マイクロソフトでは、Windows 95、98 および Windows NT 4.0 を使用しているすべてのお客様が、本更新プログラムを適用することを推奨します。

**Windows 2000 はこの脆弱性の影響を受けますか?**

いいえ、受けません。

**どこから更新プログラムを入手できますか?**

マイクロソフト セキュリティ情報 MS00-005 をご覧ください。

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する更新プログラムを開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 MS00-005 と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](https://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。
-   マイクロソフトはサポート技術情報 [249973](https://support.microsoft.com/kb/249973) を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](https://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカル サポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](https://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------


-   Windows 95:  
    <https://technet.microsoft.com/ja-jp/security/default.aspx>
-   Windows 98:  
    <https://technet.microsoft.com/ja-jp/security/default.aspx>
-   Windows NT 4.0 Workstation, Windows NT 4.0 Server、および Windows NT 4.0 Server, Enterprise Edition:
    この問題に対する更新プログラムは Windows NT 4.0 のセキュリティ ロールアップ パッケージ (SRP) に含まれています。
    個別の更新プログラムよりもセキュリティ ロールアップ パッケージを適用することをお勧めします。  
    NT 4.0 のセキュリティ ロールアップ パッケージは次のリンクから入手してください。

    [299444](https://support.microsoft.com/kb/299444) Post Windows NT 4.0 SP6a セキュリティ ロールアップ パッケージ (SRP)

    なお、個別の更新プログラムは次のリンクから入手することができます。

    -   PC/AT 互換機用 :  
        以下のダウンロード先で、ファイル名をクリックして、ファイルをダウンロードしてください。  
        [https://www.microsoft.com/download/details.aspx?FamilyId=22d42b3d-3006-42f7-a7fe-5d5e8334063f&displaylang=ja](https://www.microsoft.com/download/details.aspx?familyid=22d42b3d-3006-42f7-a7fe-5d5e8334063f&displaylang=ja)  
        PC/AT 互換機用ファイル名 : Q249973i.exe
    -   NEC PC-9800 シリーズ用 :  
        以下のダウンロード先で、ファイル名をクリックして、ファイルをダウンロードしてください。  
        [https://download.microsoft.com/download/winntsp/Patch/RTF/NT4/JA/Q249973n.exe](https://download.microsoft.com/download/winntsp/patch/rtf/nt4/ja/q249973n.exe)    
        NEC PC-9800 シリーズ用ファイル名 : Q249973n.exe
    -   Alpha 用 :   
        以下のダウンロード先で、ファイル名をクリックして、ファイルをダウンロードしてください。  
        [https://www.microsoft.com/download/details.aspx?FamilyId=d5c0929f-ebcc-4a5c-b81f-1a6f42db7aa6&displaylang=ja](https://www.microsoft.com/download/details.aspx?familyid=d5c0929f-ebcc-4a5c-b81f-1a6f42db7aa6&displaylang=ja)  
        Alpha 用ファイル名 : Q249973a.exe

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](https://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報:**

-   US マイクロソフトセキュリティ情報（MS00-005）  
    [https://www.microsoft.com/technet/security/bulletin/ms00-005.mspx](https://technet.microsoft.com/security/bulletin/ms00-005)
-   サポート技術情報 （KB） 文書番号 ： 249973    
    [デフォルトの RTF ファイル ビューアがプログラム処理を妨げる](https://support.microsoft.com/kb/249973)

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*