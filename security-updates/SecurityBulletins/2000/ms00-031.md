---
TOCTitle: 'MS00-031'
Title: 'マイクロソフト セキュリティ情報 MS00-031 - 緊急'
ms:assetid: 'ms00-031'
ms:contentKeyID: 61228197
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-031(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS00-031 - 緊急
===============================================

「区切り文字なしの .HTR リクエスト」 および 「.HTR 経由のファイル フラグメントの読み取り」 の脆弱性に対する対策
---------------------------------------------------------------------------------------------------------------

公開日: 2000年5月12日 | 最終更新日: 2001年2月9日

#### 概要

マイクロソフトは、Microsoft® Internet Information Server の 2 つのセキュリティ脆弱性を排除する更新プログラムをリリースしました。これらの脆弱性は、ぞれぞれ、影響を受ける Web サーバーの応答を遅くしたり、非常に限られた条件下で、一定の種類のファイルのソース コードを取得したりするために利用される恐れがあります。

**影響を受けるソフトウェアのバージョン :**

-   Internet Information Server 4.0
-   Internet Information Services 5.0

### 詳細

問題
----

 
この更新プログラムを使用すると、2 つのセキュリティ脆弱性が排除されますが、これら 2 つの関連性は、両者とも Web ベースのパスワード管理を .HTR スクリプト経由で提供する ISAPI 拡張機能に存在する脆弱性であるということだけです。

-   "区切り文字なしの .HTR リクエスト" 脆弱性は、サービス拒否の脆弱性です。
    悪意のあるユーザーが、指定するべき区切り文字が指定されていないパスワード変更要求を行うと、アプリケーションは無限の検索を行います。これにより、その他の .HTR 要求に対応することができなくなり、サーバーの応答が全体的に遅くなる恐れがあります。
-   ".HTR ファイル フラグメントの読み取り" 脆弱性では、一定の種類のファイルのフラグメントに対して .HTR 処理を適用させる不良な形式の要求を行うことにより、それらのファイル フラグメントが読み取られてしまう可能性があります。ただし、この脆弱性は、ごく限られた条件下でのみ利用できるものであり、ファイル内の最も価値の高いデータがユーザーに送信されるフラグメントに実際に含まれることは、ほとんどないと思われます。

これらの脆弱性はいずれも、サーバー上でのデータの追加、削除、変更を可能にするものではなく、不正使用されるサーバー上の管理者的制御を可能にするものでもありません。.HTR ファイルは Web ベースのパスワード管理を可能にするために使用されますが、これらの脆弱性により、パスワード処理上の問題が発生することはありません。また、最善のセキュリティ対策を行っていて、不要なスクリプト マッピングが削除されていれば、多くのお客様がいずれは .HTR スクリプト マッピングを削除することになるため、どちらの脆弱性の影響も受けないことになります。

よく寄せられる質問
------------------

 
**マイクロソフト セキュリティ情報 MS00-031 はどのような内容の通知ですか?**

マイクロソフト セキュリティ情報 MS00-031 は、Microsoft® Internet Information Server のセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことをお客様にお知らせするものです。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**どのようなことが起こる可能性がありますか?**

Internet Information Server の脆弱性が 2 つ確認されています。それにより、まず Web サーバーに 「区切り文字なしの .HTR リクエスト」 が送信されると、サーバーが[サービス拒否](https://www.microsoft.com/japan/security/glossary.mspx)の状態になってしまうことがあります。また、非常にまれな状況において Web サーバーで 「.HTR 経由のファイル フラグメントの読み取り」 が可能になってしまうことがあります。
なお、いずれの脆弱性が攻撃された場合でも、Web サーバー上のデータを変更できたり、追加できたり、削除できたり、Administrator 権限を取得できてしまうことはありません。推奨されるセキュリティ設定がおこなわれている場合、この脆弱性の影響を受ける機能は無効になっているはずです。無効に設定されているお客様の環境では、この脆弱性が攻撃されることはありません。

**2 つの脆弱性の間にはどのような関連がありますか?**

.HTR ファイルを処理する ISM.DLL という ISAPI エクステンションに脆弱性があるという関連があります。これが唯一の関連性です。

**ISAPI エクステンションとは何ですか?**

ISAPI (Internet Services Application Programming Interface) は、Web 開発者が書いたカスタムコードを新たな機能として Web サーバーに拡張するためのテクノロジです。コードが高度な場合は ISAPI エクステンションとして、低い場合は ISAPI フィルタとして作成されます。この資料で説明している問題で影響を受けるのは、ISAPI エクステンションです。

**スクリプト マッピングとは何ですか?**

開発した ISAPI エクステンションを使用するには、利用する ISAPI エクステンションを IIS に登録する必要があります。関連づけたい ISAPI エクステンションを特定のファイル拡張子にマッピングする設定を、スクリプト マッピングと呼びます。
例えば IIS では、Advanced Server Page (ASP) テクノロジは ISAPI エクステンションとして実装されており、.asp はデフォルトで ISAPI エクステンションとしてスクリプト マッピングされています。したがってユーザーが Web 開発者が作成した .asp ファイルをリクエストすると、IIS はスクリプト マッピングにより ASP ISAPI エクステンションを使用してファイルの処理をおこないます。

**.HTR ファイルとは何ですか?**

.HTR ファイルは、IIS Web サーバーを介し Windows NT パスワード サービスを提供するためのスクリプトです。.HTR スクリプトは、Windows NT ユーザーにはパスワードの変更機能を、また管理者にはさまざまなパスワード管理機能を提供します。この機能の詳細については、サポート技術情報から提供されている、[184619](https://support.microsoft.com/kb/184619) をご参照下さい。
なお、利用しないアプリケーションのスクリプト マッピングがある場合、セキュリティ上削除をすることが推奨されます。[IIS 4.0 セキュリティ チェックリスト](https://technet.microsoft.com/ja-jp/security/cc297183.aspx) にもあるように、Web サイトにパスワード管理機能を実装しない場合、.HTR ファイルのスクリプト マッピングも削除してしまうことが推奨されます。正確に削除されている場合、この通知で説明している脆弱性がサーバーに影響をおよぼすことはありません。

**2 つの脆弱性によりパスワードも危険にさらされますか?**

いいえ、これはパスワード管理機能がある Web の機能で発生する問題です。いずれの脆弱性によっても、パスワードが漏れてしまったり、その効力が弱まってしまうことはありません。

**「区切り文字なしの .HTR リクエスト」 とはどのような脆弱性ですか?**

サービスが拒否されてしまう脆弱性です。.HTR ファイルは、特定の方法で区切られているパラメータを受け付けます。しかし区切り文字を探す検索ルーチンに問題があるため、この脆弱性が発生してしまいます。悪意のあるユーザーが区切り文字のないリクエストを送信すると、その処理をおこなう ISAPI フィルタが永遠にそれを探しつづけてしまい、この脆弱性が出てしまいます。
悪意のあるユーザーが、含まれるべき区切り文字のないパスワードの変更リクエストを送ると、.HTR ファイルを処理する ISM.DLL という ISAPI エクステンションは、永遠にそれを探しつづけてしまいます。これによってサーバーはパスワードの変更リクエストを受け付けられなくなってしまいます。またCPU 使用率も消費されてしまうため、サーバーのレスポンスが全体的に遅くなってしまうことがあります。

**どうすれば影響を受けたサーバーを正常な状態に戻せますか?**

IIS サービスを終了し、再起動すれば元に戻ります。

**偶発的に発生しますか?**

可能性的にはほとんどないと考えます。パスワードの変更リクエストは、ISAPI フィルタを呼び出す方法ではなく、HTML フォームを直接送信する方法で、通常おこなわれます。IIS 4.0 と 5.0 でデフォルトで提供されているHTML フォームは、リクエストの送信前に区切り文字を探すようになっており、含まれない場合、送信をおこないません。

**「.HTR 経由のファイル フラグメントの読み取り」 とはどのような脆弱性ですか?**

さまざまな制限があるにも関わらず、悪意のあるユーザーがにせの .HTR リクエストを送信できると、特定種類のファイルが読めてしまう可能性がある脆弱性です。

**なぜ にせの .HTR リクエストからファイルが読めてしまうのですか?**

ここで問題となっている形式のにせのリクエストを送信できると、悪意のあるユーザーが標的とするサーバー上の特定ファイルが .HTR ファイルとして処理されてしまうからです。処理されてしまうと、内容の一部がユーザーに返されてしまいます。

**「内容の一部が返されてしまう」 とはどのような意味ですか?**

ISAPI フィルタがリクエスト ファイルを .HTR ファイルと判断すると、そのファイルのテキスト以外の部分が実質的に削除されてしまいます。つまり、.asp ファイルや他のサーバー上のファイルの重要な情報が削除されてしまうことがあります。
例えば、この脆弱性を利用し、以下のような内容のファイルを読もうとした場合、  
&lt;b&gt;Some HTML text&lt;/b&gt;  
&lt;%  
/\*Some &lt;file://Some/&gt; ASP/HTR code\*/  
var objConn = new ActiveXObject("Foo.bar");  
%&gt;  
&lt;I&gt;other html code&lt;/I&gt;  
other code.  
悪意のあるユーザーには、以下が返されてしまいます。  
&lt;b&gt;Some HTML text&lt;/b&gt;  
&lt;I&gt;other html code&lt;/I&gt;  
other code.  

**この脆弱性に他の制限はありますか?**

この脆弱性を侵害するには、サーバーのメモリ ロケーションの特定の場所が 0 になっていなければなりません。すなわち IIS が .HTR リクエストの処理の一部を終了後残りの処理を行う、暫定的なメモリ ロケーションが 0 になっていなければなりません。この脆弱性を攻撃するには、そこに配置されている文字列を null にして、IIS の残りの処理を無効にする必要があります。
2 とおりの方法で、悪意のあるユーザーがこれらの制限を乗り超えることができる場合があります。運まかせに繰り返しリクエストを送信する方法と、サーバーの再起動直後を待つ方法です。サーバーのメモリは、初期化処理のさいに 0 になります。しかし使用すればすぐに増えてしまうので、この脆弱性が存在しても攻撃を仕掛けることができる期間はかなり短いものとなります。

**更新プログラムは何を修正しますか?**

区切り文字の検索の終了をアルゴリズムがどこまで続けるかを制限することによって、1 つ目の脆弱性を修正しています。またファイル データの読み取りを可能にしてしまう不正なリクエストを ISM.DLL が拒否するよう、2 つ目の脆弱性を修正しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](https://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する更新プログラムを開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 MS00-031 と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](https://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。
-   マイクロソフトは、[260838](https://support.microsoft.com/kb/260838) と [260069](https://support.microsoft.com/kb/260069) を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](https://technet.microsoft.com/ja-jp/security/default.aspx) の Web サイトから入手してください。また <https://technet.microsoft.com/ja-jp/security/cc297183.aspx> に、IIS 4.0 サーバー用のチェックリストが掲載されています。

**テクニカル サポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](https://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------

 
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Internet Inforamation Server 4.0 :  
    この問題に対する更新プログラムは Windows NT 4.0 のセキュリティ ロールアップ パッケージ (SRP) に含まれています。
    個別の更新プログラムよりもセキュリティ ロールアップ パッケージを適用することをお勧めします。
    NT4.0 のセキュリティ ロールアップ パッケージは次のリンクから入手してください。

    [JP299444](https://support.microsoft.com/kb/299444) Post Windows NT 4.0 SP6a セキュリティ ロールアップ パッケージ (SRP)

**注 :**  
その後リリースされたセキュリティ情報 [MS01-004](https://technet.microsoft.com/security/bulletin/ms01-004) の中で、ここで説明されている脆弱性といくつかの他の脆弱性を排除する更新プログラムを提供しています。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](https://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報 :**

-   US マイクロソフトセキュリティ情報（MS00-031）  
    [https://www.microsoft.com/technet/security/bulletin/ms00-031.mspx](https://technet.microsoft.com/security/bulletin/ms00-031)
-   サポート技術情報 （KB） 文書番号 ： 184619  
    [\[IIS\] IIS 4.0 を使用した Windows NT アカウントのパスワード変更方法](https://support.microsoft.com/kb/184619)
-   サポート技術情報 （KB） 文書番号 ： 260069  
    [無効な HTR リクエストにより ASP のソース コードが返される](https://support.microsoft.com/kb/260069)
-   サポート技術情報 （KB） 文書番号 ： 260838  
    [IIS が HTR リクエストに応答しなくなる](https://support.microsoft.com/kb/260838)

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
