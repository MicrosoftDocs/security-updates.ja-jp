---
TOCTitle: 'MS00-042'
Title: 'マイクロソフト セキュリティ情報 MS00-042 - 緊急'
ms:assetid: 'ms00-042'
ms:contentKeyID: 61228208
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-042(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS00-042 - 緊急
===============================================

「アクティブ セットアップ ダウンロード」 脆弱性に対する対策
-----------------------------------------------------------

公開日: 2000年6月29日 | 最終更新日: 2001年1月11日

#### 概要 :

弊社では、Microsoft® Internet Explorer に付随の ActiveX コントロールにおけるセキュリティ脆弱性を排除するパッチをリリースしました。この脆弱性が利用されると、悪質な Web サイト オペレータのサイトを訪問したユーザーのコンピュータ上にあるファイルが上書きされる恐れがあります。 

**影響を受けるソフトウェアのバージョン :**

-   Microsoft Internet Explorer 4.x
-   Microsoft Internet Explorer 5.x

### 詳細

問題
----

 
アクティブ セットアップ コントロールを使用すると、ソフトウェア更新のためのインストール プロセスの一環として .cab ファイルをユーザーのコンピュータにダウンロードすることが可能です。しかし、このコントロールには欠陥が 2 つあります。1 つ目は、Microsoft の署名済みの .cab ファイルをすべて信頼できるものとして処理するために、ユーザーの許可なしにそれらのファイルをインストールさせてしまうことです。2 つ目は、呼び出し者がダウンロードの場所をユーザーのハード ドライブ上に指定できる方法が提供されていることです。この 2 つの欠陥を組み合わせると、悪質な Web サイト オペレータが Microsoft の署名済み .cab ファイルを利用してユーザーのマシン上にあるファイルを上書きすることが可能になります。
システム ファイルを上書きすることにより、悪質なユーザーがマシンを使用不能にしてしまう恐れがあります。

この脆弱性を利用することによって、ダウンロード済みのソフトウェアを実際にインストールすることはできないということに、注意が必要です。この脆弱性では、サービス アタックの拒否で、ファイルの上書きが可能になるだけです。Windows 2000 のシステム ファイル保護では、このようなアタックを利用してシステム ファイルを上書きすることはできなくなります。

よく寄せられる質問
------------------

 
**マイクロソフトセキュリティ情報 MS00-042 はどのような内容の通知ですか?**

このマイクロソフト セキュリティ情報 MS00-042 は、Microsoft® Internet Explorer に付随して出荷されている ActiveX コントロールのセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことを、お客様にお知らせするものです。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**この脆弱性はどれくらいの範囲に影響を与えますか?**

これは [サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。この脆弱性を利用して、悪意のある Web サイト運営者は Web サイトを訪問しているユーザーのマシン上のファイルを上書きすることができます。マシンの特定のシステム ファイルが上書きされると、Web サイト訪問者のマシンが使用できなくなります。

この脆弱性は操作をできなくするための手段として、ファイルを上書きするためだけに利用されます。悪意のある Web サイト運営者の選択による新しいコードを実行可能ファイルと交換するためには使用できません。ActiveX コントロールが動作できないセキュリティ ゾーンで悪意のある Web サイト運用者の Web サイトが動作している場合、この脆弱性は利用されません。

**この脆弱性の原因は何ですか?**

この脆弱性は ActiveX コントロールと Active Setup Control の 2 つの問題が原因となっています。

-   マイクロソフトによりデジタル署名されたファイルをダウンロードする時、コントロールはユーザーに確認を求めません。
-   コントロールは、ファイルをハード ドライブの呼び出し者が望むどの場所にでもインストールできるようにします。

**これはActiveX コントロールの技術の問題ですか?**

いいえ、違います。この脆弱性は ActiveX の技術自体とは何の関係もありません。特定の ActiveX コントロールの実装方法が原因となっています。

**Active Setup とは何ですか? また Active Setup Control とは何ですか?**

Active Setup とはソフトウェアの更新をインストールするプロセスを特にインターネットで非常に向上させる技術です。ほとんどのブラウザで、インターネットを介してソフトウェアの更新をダウンロードする必要がある場合、更新におそらく必要となる各ファイルを含む大きなパッケージをダウンロードしなければならないでしょう。これに対し、Internet Explorer の Active Setup はユーザーのマシンに小さいセットアップ パッケージをダウンロードできるようにします。このように必要なファイルだけを決定し、それをダウンロードします。更新に要する時間を大幅に削減できます。

ここで問題となっている ActiveX コントロールと Active Setup コントロールは Internet Explorer のコンポーネントで、この機能を有効にするために使用されます。

**マイクロソフトが署名した更新に関する問題は何ですか?**

一般的に、Active Setup コントロールはセットアップ パッケージをダウンロードする前に、それがデジタル署名されているかどうか、もしデジタル署名されているとしたら、誰によってであるかをチェックします。デジタル署名はパッケージ作成者と、パッケージが不正に変更されていないことの証明を提供します。
セットアップ パッケージがデジタル署名されていない場合、コントロールはユーザーに警告を発し、ダウンロードを続行するかどうかをたずねます。同様に、ユーザーが信頼していると指定していない者によりパッケージがデジタル署名されている場合、コントロールはインストールを続行するかどうかをたずねます。また、署名者からのコンテンツを常に信頼するかどうかもたずねます。しかし、マイクロソフトが署名したコンテンツはデフォルトで信頼されています。

**なぜマイクロソフトが署名したコンテンツはデフォルトで信頼されているのですか?**

設計上、マイクロソフトが署名したファイルはデフォルトで信頼されています。一見したところ、これは適切です。結局ユーザーはマイクロソフトのプロダクトをインストールすることを選択するので、既にマイクロソフトが提供するコンテンツを信頼するという決断をしているのです。

ここで問題となりますが、マイクロソフトが署名したファイル（結局、マイクロソフトが署名したファイルはマイクロソフトの Web サイトの様々なページで自由に利用可能であるため）を他の人がホストし、不適切に使用することを防ぐ手段がありません。

**「マイクロソフトが署名したファイルをホストし、不適切に使用する」とはどのような意味ですか?**

悪意のある Web サイトはマイクロソフトが署名した更新ファイルをマイクロソフトの Web サイトからダウンロードし、自身の Web サイトでホストすることができます。実際、更新ファイルはデフォルトで信頼されており、Web サイトを訪問しているユーザーのマシンにダウンロードすることができます。この脆弱性に関する制限を覚えておくことは重要でしょう。

-   この脆弱性は悪意のあるユーザーが更新ファイルの変更ができる手段は供給しません。もし、悪意のあるユーザーがこれを行った場合、デジタル署名の確認は異常終了します。
-   この脆弱性は悪意のあるユーザーがインストール処理を開始する手段を供給しません。つまり、更新ファイルをダウンロードできますが、インストールを実際開始させるには他の手段が必要となります。

**なにが問題となるのかわかりません。悪意のある Web サイトユーザーが変更されていないマイクロソフトプロダクトを Web サイト訪問者のマシンにダウンロードできるとしたら、なぜそれがセキュリティ上の脆弱性なのですか?**

ここで第 2 の問題が発生します。Active Setup Control により、ファイルがダウンロードされる場所に呼び出し者（この場合、悪意のある Web サイト運営者）がパスとファイル名を指定することができます。これにより、悪意のあるユーザーは Web サイト訪問者のマシン上にある任意のファイルに上書きができます。

**しかし、悪意のあるユーザーがインストール処理を開始できないのなら、任意の場所にファイルを置くことができるのはなぜ問題となるのですか?**

攻撃の目的は更新ファイルのインストール試行である必要はありません。単にユーザーのディスクにあるファイルの上書きである可能性もあります。例えば、悪意のある Web サイト運営者がディスクに存在する重要なファイルを上書きした場合、潜在的にマシンを操作不可能にすることもできます。Active Setup ファイルでファイルの上書きを行うことは付随的です。重要な点はファイルの上書きができるということです。

**Windows 2000 にある機能がこの脆弱性を防ぐ手助けをしているそうですが、本当ですか?**

はい、本当です。System File Protection (SFP) と呼ばれる Windows 2000 の機能はある程度、この脆弱性を防いでいます。SFP では、特定の重要な Windows 2000 ファイルがマークを付けられ、システムが起動するごとにチェックされています。ファイルが変更されている場合、元の状態に復元されます。悪意のある Web サイト運営者がこの脆弱性を利用して SPFで保護されたファイルに上書きをした場合、Windows 2000 は該当するファイルを復元するので、その攻撃は無効となります。

SFP はワード文書やテキスト ファイルなど、Web サイト訪問者が作成したファイルを悪意のある Web サイト運営者が上書きすることを防ぎません。しかし、これらのファイルを上書きするためには、悪意のある Web サイト運営者はこれらのファイルの正確なパスとファイル名を知っている必要があります。この脆弱性は悪意のある Web サイト運営者にユーザーのマシン上にあるファイルの在庫管理をする手段を供給しないため、攻撃を実行することは非常に困難です。

**セキュリティゾーン機能はこの脆弱性を防ぐ手助けをしますか?**

はい。Internet Explorer のセキュリティ ゾーン機能で、訪問する Web サイトを分類し、特定の分類範囲内のサイトが実行可能なことを指定できます。オプションの中で、ActiveX コンポーネントを使用するかどうかを選択できます。ActiveX コンポーネントがブラウザで動作可能である場合にのみ、悪意のある Web サイト運営者はこの脆弱性を利用できます。

マイクロソフトはお客様にセキュリティ ゾーン機能を日常的に使用することを推奨します。よく訪れ、信頼している Web サイトを信頼されたゾーンに入れることを推奨します。まだ分類していない全ての Web サイトはインターネット ゾーンにあります。ゾーンを設定して、これらのゾーン内で Web サイトに適切な権限を付与して下さい。

**だれが更新プログラムを適用する必要がありますか?**

マイクロソフトは該当する Internet Explorer のバージョンを使用している全てのお客様にこの更新プログラムの適用を推奨します。

**更新プログラムは何を変更するのですか?**

この更新プログラムは次の 2 つを修正します。

-   マイクロソフトが署名したコンテンツを他のソフトウェア発行元のコンテンツと全く同じように扱うようにActive Setup Control を変更します。
-   呼び出し者がファイルのダウンロード先を知ることができないようにします。その代わり、ファイルは常に標準の場所にダウンロードされ、セットアップ ファイルがユーザーにより開始されると、更新ファイルがインストールされる場所を指定するようにしました。

**セキュリティ情報の Patch Availability section で Internet Explorer 5.5 用の更新プログラムは後でリリースされる更新プログラムに含まれると説明されていましたが、それはなぜですか?**

お客様が適用する必要のある更新プログラムの数を最小限化するためです。Internet Explorer 5.5 を動作していて、既にマイクロソフト セキュリティ情報 [MS00-055](http://technet.microsoft.com/security/bulletin/ms00-055) で提供された更新プログラムを適用している場合、この脆弱性に対する保護はなされていますので他の対応策を講じる必要はありません。

**更新プログラムはどのように使用するのですか?**

サポート技術情報 JP265258 [http://support.microsoft.com/kb/JP265258](http://support.microsoft.com/kb/jp265258) には、お客様のサイトに更新プログラムを提供するための詳細な情報が記載されています。

**どこから更新プログラムを入手できますか?**

このセキュリティ情報の「更新プログラム」セクションからダウンロードしていただけます。

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する手順を開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 MS00-042 と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](http://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。
-   マイクロソフトは、[265258](http://support.microsoft.com/kb/265258) を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](http://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカルサポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](http://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------

 
この問題を解決するための日本語版更新プログラムは、以下のサイトからダウンロードできます。

-   <http://support.microsoft.com/kb/265258>

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報 :**

-   US マイクロソフトセキュリティ情報（MS00-042）  
    [http://www.microsoft.com/technet/security/bulletin/ms00-042.mspx](http://technet.microsoft.com/security/bulletin/ms00-042)
-   サポート技術情報 （KB） 文書番号 ： 265258  
    [Internet Explorer の "アクティブ セットアップ ダウンロード" に関する脆弱性を解決する更新プログラム](http://support.microsoft.com/kb/265258)

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
