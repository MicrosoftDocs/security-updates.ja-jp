---
TOCTitle: 'MS00-043'
Title: 'マイクロソフト セキュリティ情報 MS00-043 - 緊急'
ms:assetid: 'ms00-043'
ms:contentKeyID: 61228209
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-043(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS00-043 - 緊急
===============================================

「改ざんされた電子メール ヘッダ」 の脆弱性に対する対策
------------------------------------------------------

公開日: 2000年7月27日 | 最終更新日: 2001年3月7日

#### 概要 :

2000 年 7 月 18 日、マイクロソフトはこのセキュリティ情報をリリースし、お客様に問題をお知らせしました。そして、この脆弱性を排除するために 2 つの Service Pack のいずれかをインストールすることを推奨しました。2000 年 7 月 20 日、このセキュリティ情報を更新し、この脆弱性を排除する更新プログラムが入手可能であることをお知らせしました。

マイクロソフトは Microsoft® Outlook® と Outlook Express のセキュリティ上の脆弱性を排除する日本語版更新プログラムをリリースしました。この脆弱性は、特定の状況において、悪意のあるユーザーが自分が選択したコードを他のユーザーのコンピュータで実行することができます。

この更新プログラムは上記の脆弱性と、マイクロソフト セキュリティ情報 MS00-045 と MS00-046 で説明した脆弱性を排除します。これらのいずれかのセキュリティ情報で説明した対応策を既に行ったお客様は今回の対応策は必要ありません。

**影響を受けるソフトウェアのバージョン :**

-   Microsoft Outlook Express 4.x
-   Microsoft Outlook Express 5.x
-   Microsoft Outlook 98
-   Microsoft Outlook 2000

### 詳細

問題
----

 
Inetcomm.dll は Outlook と Outlook Express が共有しているコンポーネントです。このコンポーネントにはPOP3 または IMAP4 を介してメールをダウンロードする際に電子メール ヘッダーを解析する機能に問題のあるバッファが含まれています。このため、悪意のあるユーザーがバッファ オーバーランを引き起こす電子メールを送信すると、該当する電子メール クライアントによりサーバーからメールがダウンロードされる際に、以下の問題が発生することがあります。

-   電子メール ヘッダーの影響を及ぼす部分に、ランダムに大量のデータが含まれていると、 Outlook もしくはOutlook Express をクラッシュさせます。
-   電子メール ヘッダーに、入念に改ざんされたデータを含むことにより、悪意のあるユーザーにより、電子メール クライアント上で特定のコードを実行されます。

この問題は、Outlookもしくは Outlook Expressで、POP3 もしくは IMAP4 を使用するように設定されている場合に発生することがあります。Outlook で MAPI サービスだけを使用するように設定されている場合は、この脆弱性の影響を受けることはありません。しかし、マイクロソフトは Outlook で MAPI サービスだけを使用するよう設定されているお客様にも、更新プログラム セクションで説明しているいずれかの対策をとることを推奨します。その主な理由として、更新プログラムは、使用している電子メール プロトコルに関わらず、全ての Outlook ユーザーに影響を与える他の脆弱性に対する保護を行うからです。

Outlook Express 5.5 以降のバージョンに含まれている Inetcomm.dll では、この問題は発生しません。したがって、既に Outlook Express 5.5 をインストールされている場合は、修正モジュールを適用する必要はありません。Outlook Express 5.5 は、Internet Explorer 5.01 Service Pack 1 および、Internet Explorer 5.5 (Windows 2000 用は除く)および、Internet Explorer 5.5 Service Pack 1(Windows 2000 用は除く) に含まれています。Outlook Express 5.5 へのアップグレードを希望しないお客様は、下記の更新プログラムをインストールして下さい。

Inetcomm.dll は Outlookと Outlook Express の両方で使用されていますが、 Internet Explorer とOutlook Express の一部として出荷および、アップデートされています。このため Outlook を使用しているお客様は、この更新プログラムをインストールするか、マシンにインストールされている Internet Explorer と Outlook Express を適切なバージョンにアップグレードして下さい。

よく寄せられる質問
------------------

 
**マイクロソフトセキュリティ情報 MS00-043 はどのような内容の通知ですか?**

このマイクロソフト セキュリティ情報 MS00-043 は、Microsoft® Outlook® と Outlook Express のセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことを、お客様にお知らせするものです。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**この脆弱性はどれくらいの範囲に影響を与えますか?**

これは [バッファ オーバーラン](https://www.microsoft.com/japan/security/glossary.mspx) の脆弱性です。悪意のあるユーザーはこの脆弱性を利用して電子メールを送信し、メール サーバーからメールがダウンロードされる時に次の 2 つの影響を及ぼします。その 1 つの例として、Outlook や Outlook Express を異常終了させます。またさらに深刻な例として、悪意のあるユーザー自身の選択によるコードを受信者のマシンで実行します。そのようなコードは正当なユーザーがマシンで実行権限を持つ操作を行うことができます。例えば、ハード ドライブの再フォーマット、外部 Web サイトとの通信、そしてマシン上のデータの変更などです。  
この脆弱性には主に 2 つの制限があります。

-   この脆弱性は Internet Explorer の最近リリースされたバージョンにより排除されます。特に、全てのお客様のために Internet Explorer 5.01 Service Pack 1 のデフォルトの インストールがこの脆弱性を排除します。Windows 2000 ユーザー以外のお客様には、Internet Explorer 5.5 のデフォルトの インストールがこの脆弱性を排除します。
-   この脆弱性は特定のメール プロトコルだけに影響を及ぼします。特に、Outlook が Microsoft Exchange Server とともに使用されている場合、デフォルトで使用されているプロトコルには影響を及ぼしません。これにより、企業ネットワークが危険にさらされる可能性は低くなります。マイクロソフトは全てのお客様に修正処置を講じることを推奨します。

**この脆弱性の原因は何ですか?**

メール サーバーからメールをダウンロードするために特定の電子メール プロトコルが使用されている場合、モジュールは電子メール ヘッダ フィールドを解釈します。Outlook と Outlook Express の両方で使用されているコンポーネントはそのモジュールにチェックされていないバッファを含んでいます。これが脆弱性の原因となります。電子メールが該当するプロダクトを使用しているサーバーから検索される際、悪意のあるユーザーはこの脆弱性を利用して、電子メールを送信し、受信者のマシン上で任意のコードを実行することができます。

**チェックされていないバッファとは何ですか? またなぜそれがこの脆弱性が発生する原因なのですか?**

バッファとはプログラム内の格納場所です。プログラムが入力を読むと、それをプログラムのメモリに格納します。しかし、データをバッファに格納しようとする前に、実際にバッファに適合するかを確認する必要があります。さもないと、バッファ オーバーラン状態となります。

バッファ オーバーランが起きると、データはバッファの長さよりも長くなります。結果としてプログラムに新しいコードが導入可能となります。ここで問題となっている脆弱性では、バッファ オーバーランが原因となって Outlook や Outlook Express が動作している時に、新しいコードがそれらに導入されてしまいます。新しいコードはユーザーのマシンでの権限により制限されます。つまり、ユーザーがマシンで実行権限を持っている操作は、新しいコードでも実行可能となります。

**電子メールヘッダとは何ですか?**

メール サーバーとクライアントは着信メールと発信メールの処理方法に関する情報を必要とします。この情報はメール内のヘッダ フィールドに供給されています。電子メール ヘッダ フィールドに含まれている情報の種類として、送信者と受信者のアドレス、メールが送信された時間そしてメールを受信したメール サーバー名などがあります。

ここで問題となっている脆弱性では、POP3 や IMAP4 がメールをダウンロードするために使用されている場合、Outlook と Outlook Express は電子メール ヘッダ フィールドを処理のためにバッファに挿入する前に、電子メール ヘッダ フィールドの長さを正しくチェックしません。

**POP3 とは何ですか? また IMAP4 とは何ですか?**

POP (Post Office Protocol) と IMAP (Internet Mail Access Protocol) はメール サービスを提供する一般的に使用されているプロトコルです。（POP3 と IMAP4 の後ろに付いている番号はプロトコルのバージョンを示しています。） POP3 はインターネット メールに最も使用されています。インターネット サービス プロバイダ （ISP） を使用してメールを受信しているのであれば、多くの場合、そのメール クライアントは POP3 を介してサーバーと通信しています。IMAP4 もまたインターネット メールに使用されていますが、POP3 ほど使用されていません。しかし、大学などのネットワークでは普及しています。

**これは POP3 や IMAP4 プロトコルの問題ですか?**

いいえ、違います。Outlook と Outlook Express 用の POP3 や IMAP4 のサポートを提供するコンポーネントにどのようにプロトコルが実装されているかが問題となっています。

**Outlook と Outlook Express に利用可能な他のメールプロトコルはありますか?**

Outlook Express には POP3 と IMAP4 だけが利用可能です。しかし、Outlook はこの脆弱性による影響を受けていない MAPI (Messaging Application Programming Interface) も使用できます。これは少なくとも Outlook ユーザーに、この脆弱性による危険を著しく削減します。メール サーバーと通信を行うために MAPI だけを使用している Outlook ユーザーはこの脆弱性による影響は受けません。

**Outlook を使用していますが、MAPI を使用するように設定されているということはどのようにして分かるのですか?**

一般的に、Outlook を電子メール クライアントとして、Exchange Server をそのメール サーバーとして使用しているお客様は MAPI を使用するように設定しています。しかし、MAPI だけを使用しているかどうかを確認することが重要です。確認方法は以下の通りです。

-   最初に、Outlook が MAPI を使用するように設定されているかを確認します。このためには Outlook を開き、ヘルプ メニューから 「バージョン情報」を選択します。ダイアログ ボックスの 2 行目が 「企業/ワークグループ」 になっていれば、MAPI を使用しています。
-   次に、Outlook が POP3 や IMAP4 を使用していないことを確認します。Outlook のツール メニューで 「サービス」 を選択します。「インターネット メール」がサービスの中にリストされていなければ、MAPI だけを動作していますのでこの脆弱性による影響は受けません。

**Outlook を使用していて、MAPI だけを使用するように設定されている場合、何か対処策を講じる必要がありますか?**

それでも、この脆弱性に対する対策を講じる必要があります。最も重要な理由として、マイクロソフト セキュリティ情報の Patch Availability section で説明されている修正手順はここで問題になっている特定の脆弱性だけでなく、他の脆弱性も排除するためです。その他の脆弱性はマイクロソフト セキュリティ情報 [MS00-045](https://technet.microsoft.com/security/bulletin/ms00-045) と [MS00-046](https://technet.microsoft.com/security/bulletin/ms00-046) で説明しています。特に、MS00-046 で説明している脆弱性は使用しているプロトコルに関係なく全ての Outlook ユーザーに影響を及ぼします。

さらに、MAPI だけを使用している場合でも、この脆弱性の影響を受ける可能性がある例外的なシナリオもあります。これらのシナリオはかなり複雑で上記に述べたような利用をされる可能性は低いです。しかし、例外も存在しますので、全てのユーザーに修正処置を講じることを推奨します。

**悪意のあるユーザーはどのようにこの脆弱性を利用するのですか?**

悪意のあるユーザーは別のユーザー宛に電子メールを作成する必要があります。16進エディタを使用し該当する電子メール ヘッダを変更した後、それを他のユーザーに送信します。受信者が該当するメール クライアントを使用していて、そのメール クライアントが POP3 か IMAP4 を使用してメール サーバーと通信している場合、電子メール中のデータはサーバーからダウンロードされる時にバッファをオーバーランさせます。

オーバーランの影響は悪意のあるユーザーが電子メール ヘッダに挿入したデータによります。無作為なデータが挿入された場合、その影響としてメール クライアントが異常終了します。しかし、綿密に選択されたデータの場合、悪意のあるユーザーの選択による機能をメール クライアントに実行させるために使用されます。

**メールを開くとこの脆弱性による影響を受けるのですか?**

いいえ。この脆弱性はメールがサーバーから検索される時に利用されます。つまり、受信箱にメールが表示される前からです。

**この脆弱性が原因でメールクライアントが異常終了した場合、どうすればよいのですか?**

Outlook または Outlook Express を再起動して下さい。しかし、問題となっているメールはまだサーバーにあります。次回サーバーからメールを検索する時に、またメール クライアントが異常終了します。この状況を解決するためには、メール サーバー管理者にそのメールを削除するようにお願いしてください。

**この脆弱性はメールサーバーに損害を与えますか?**

いいえ、与えません。この脆弱性は完全に問題となっているメール クライアントが原因ですので、サーバーには何の影響も及ぼしません。

**この問題の影響を受けるかどうかはどのように分かるのですか?**

下記事項に 1 つでも当てはまるものがあれば、この脆弱性の**影響を受けません。**

-   システムに Internet Explorer 5.01 Service Pack 1 をデフォルトでインストールしている。
-   システムに Internet Explorer 5.5 をデフォルトでインストールしていて、さらにそのシステムは Windows 2000 ではない。
-   マイクロソフト セキュリティ情報 [MS00-045](https://technet.microsoft.com/security/bulletin/ms00-045) と [MS00-046](https://technet.microsoft.com/security/bulletin/ms00-046) で説明した更新プログラムのいずれかをインストールしている。

上記事項にあてはまるものが**ない**場合、更新プログラムをインストールする必要があります。

**Internet Explorer 5.01 SP1 や Internet Explorer 5.5 をデフォルトでインストールしていることの意味は何ですか?**

ここで問題になっているコンポーネント （inetcomm.dll） は、Outlook Express が Internet Explorer インストールの 1 部としてインストールされている場合にだけインストールされます。これがデフォルトの状態です。最小限のインストールを選択した場合、またはカスタム インストールを選択し、Outlook Express をアップグレードするオプションを選択しなかった場合、この脆弱性の影響を受けます。

**なぜ Internet Explorer 5.5 は Windows 2000 ユーザーに関わる脆弱性を排除しないのですか?**

Internet Explorer 5.5 が Windows 2000 の 1 部としてインストールされている場合、Outlook Express 5.5 は同梱されていません。しかし、Internet Explorer 5.5 をインストールしている Windows 2000 ユーザーにはこの脆弱性を排除するために次の 3 つのオプションがあります。

-   このセキュリティ情報で説明されている更新プログラムをインストールして下さい。
-   Internet Explorer 5.5 をアンインストールして下さい。（コントロール パネルのアプリケーションの追加と削除を使用して下さい。）そして、Internet Explorer 5.01 SP1 をインストールして下さい。
-   入手可能になりましたら、Windows 2000 Service Pack 1 をインストールして下さい。Windows 2000 Service Pack 1 は Outlook Express 5.5 を含んでいます。

**このセキュリティ情報にある全ての修正処置は Outlook Express に効果があるようですが、Outlook 用の更新プログラムは見当たりません。これはなぜですか?**

この脆弱性を含むコンポーネントである Inetcomm.dll は Outlook と Outlook Express に使用されていますが、Outlook Express の 1 部として出荷されています。このため、全てのユーザーに対する解決法は同じです。Outlook Express に対する更新プログラムを適用するか、Outlook Express の新しいバージョンをインストールして下さい。この解決方が適用されると、Inetcomm.dll の修正バージョンがインストールされ、Outlook と Outlook Express のどちらにも利用可能となります。[Office Update](https://office.microsoft.com/assistance/2000/olmalformedheader.aspx)Web サイトに Outlook ユーザーの行うべきことに関する情報が掲載されています。

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する更新プログラムを開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 MS00-043 と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](https://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。
-   マイクロソフトはサポート技術情報 [267884](https://support.microsoft.com/kb/267884) を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](https://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカルサポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](https://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------

 
この問題を解決するには、次のいずれかの方法を実行してください。

-   Internet Explorer 5.01 Service Pack 1、Internet Explorer 5.5、またはInternet Explorer 5.5 Service Pack 1 をインストールします。
-   Microsoft Windows 2000 以外のマシンを使用している場合には、次のいずれかの場所から Internet Explorer 5.01 Service Pack 1 もしくは Internet Explorer 5.5 Service Pack 1 をインストールします。
    <https://www.microsoft.com/japan/ie/> 
    <https://update.microsoft.com/microsoftupdate/>

    **注 :**  
    ここで問題となっている脆弱性を排除するとともに、この更新プログラムはマイクロソフト セキュリティ情報 MS00-045 と MS00-046 で説明されている脆弱性も排除します。これらのセキュリティ情報で説明されている対応策を既に行ったお客様は、今回の対応策は必要ありません。

    更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
    [マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](https://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報 :**

-   US マイクロソフトセキュリティ情報（MS00-043）  
    [https://www.microsoft.com/technet/security/bulletin/ms00-043.mspx](https://technet.microsoft.com/security/bulletin/ms00-043)
-   サポート技術情報 （KB） 文書番号 ： 267884  
    [InternetExplorer 5.01 SP1 で修正される電子メールの脆弱性の問題](https://support.microsoft.com/kb/267884)

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
