---
TOCTitle: 'MS00-070'
Title: 'マイクロソフト セキュリティ情報 MS00-070 - 緊急'
ms:assetid: 'ms00-070'
ms:contentKeyID: 61228236
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-070(v=Security.10)'
---
 
マイクロソフト セキュリティ情報 MS00-070 - 緊急
===============================================

「LPC 呼び出しおよび LPC ポート」 の複数にわたる脆弱性に対する対策
------------------------------------------------------------------

公開日: 2000年10月6日 | 最終更新日: 2002年1月7日

#### 概要 :

Microsoft は、Microsoft® Windows NT® 4.0 および Windows® 2000 用の日本語版更新プログラムをリリースしました。この脆弱性は、サービス拒否攻撃から、 場合によっては特権の昇格を可能とするような、広範囲にわたる影響を及ぼす可能性があります。

**影響を受けるソフトウェアのバージョン :**

-   Microsoft Windows NT 4.0 Workstation
-   Microsoft Windows NT 4.0 Server
-   Microsoft Windows NT 4.0 Server, Enterprise Edition
-   Microsoft Windows NT 4.0 Server, Terminal Server Edition
-   Microsoft Windows 2000 Professional
-   Microsoft Windows 2000 Server
-   Microsoft Windows 2000 Advanced Server
-   Microsoft Windows 2000 Datacenter Server

### 詳細

問題
----

 
Windows NT 4.0 および Windows 2000 の Local Procedure Call (LPC) 呼び出し、および LPC ポートの実装において、いくつかの脆弱性が確認されています。  
無効な LPC 要求に関する脆弱性は、Windows NT 4.0 においてのみ確認されています。無効な LPC 要求が発生すると、影響を受けたシステムをダウンさせてしまう可能性があります。

LPC によるメモリ消費に関する脆弱性は、Windows NT 4.0 および Windows 2000 において確認されています。不正な LPC 要求によって、カーネル メモリーが完全に消費されるまで 待ち状態のLPC メッセージを増加させる可能性があります。  

予測可能な LPC メッセージの識別子に関する脆弱性は、Windows NT 4.0 および Windows 2000 のどちらにも影響を及ぼします。LPC メッセージの識別子を知っているプロセスすべてが LPC メッセージにアクセスすることができます。これは識別子が判別可能であるということでもあります。単純なケースとして、悪意のあるユーザーがほかのプロセスのLPC ポートにアクセスし、サービスを拒否させるようなデータを送り込む可能性もあります。より深刻なケースとしては、特定の条件下で、ある権限を有しているプロセスに対して偽 の要求を送信することで追加のローカル権限を取得することが可能となってしまう場合があります。

よく寄せられる質問
------------------

 
**マイクロソフトセキュリティ情報 MS00-070 はどのような内容の通知ですか?**

マイクロソフト セキュリティ情報 MS00-070 は、Microsoft® Windows NT® 4.0 および WindowsR 2000 のセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことを、お客様にお知らせするものです。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**この脆弱性はどれくらいの範囲に影響を与えますか?**

ここで述べられている脆弱性は、2 つの大きなグループに分けることができます。

-   あるものは、[サービス拒否](https://www.microsoft.com/japan/security/glossary.mspx)攻撃を可能にして攻撃されたシステムを異常終了させます。
-   また、あるものは、悪意のあるユーザーに、ほかのユーザーを装うことやシステム処理を用いることで、マシンに対して許可されていない特権を取得させてしまいます。後者の場合には、悪意のあるユーザーに[特権の昇格](https://www.microsoft.com/japan/security/glossary.mspx)が行われ、マシ管理者特権を取得される可能性があります。

これらの脆弱性は、悪意のあるユーザーが[対話的なログオン](https://www.microsoft.com/japan/security/glossary.mspx)ができるマシンに対してのみ利用できます。その結果、この脆弱性による危険があるのは、主としてワークステーションおよびターミナル サーバーのようなマシンです。セキュリティ重視のサーバーは、通常のセキュリティの予防措置がとられている場合、普通のユーザーが対話的にログオンするのを許可しません。

**この脆弱性の原因は何ですか?**

Windows NT 4.0 および Windows 2000 の LPC、LPC ポートの実装に関する 2 つの脆弱性に起因します。

-   Windows NT 4.0 の実装では、想定された動作をしないプロセスの場合正しく処理しないことがあります。プロセスが、無効な命令および無効なパラメータにより LPC 要求を行った場合には、システムが異常終了することがあります。
-   Windows NT 4.0 および Windows 2000 において LPC ポートの識別子が推測可能なので、あるプロセスが、他のプロセスに属している LPC ポートにアクセスすることが可能になります。

**この脆弱性の原因は何ですか ?**

Windows NT 4.0 および Windows 2000 の LPC、LPC ポートの実装に関する 2 つの脆弱性に起因します。

-   Windows NT 4.0 の実装では、想定された動作をしないプロセスの場合正しく処理しないことがあります。プロセスが、無効な命令および無効なパラメータにより LPC 要求を行った場合には、システムが異常終了することがあります。
-   Windows NT 4.0 および Windows 2000 において LPC ポートの識別子が推測可能なので、あるプロセスが、他のプロセスに属している LPC ポートにアクセスすることが可能になります。

**LPC とは何ですか?**

ローカル プロシージャ コール (LPC) はWindows NT 4.0 および Windows 2000 が提供する、スレッドやプロセスが互いに通信できるメッセージ受け渡しサービスです。クライアント プロセスがサーバー プロセスにいつでもサービスを要求でき、2 つのプロセスが互いに通信できる方法が必要です。つまり、クライアント プロセスはサーバーに要求をし、サーバーはクライアントに応答をし、両者が双方の状態を確認できる方法が必要なのです。クライアントおよびサーバーのプロセスが異なるマシンで起動しているときは、リモート プロシージャ コール (RPC) が用いられます。同一マシン上で両方のプロセスが起動しているときは、LPC が用いられます。  

LPC の長所は処理が速いことです。両方のプロセスが同一マシン上にあるので、通信が高速になり効率が良くなります。例えば、LPC のもとでは、2 つのプロセスが共通のメモリ セグメントを通じて通信することが可能です。メッセージを互いに受け渡しするより、片方のプロセスがメッセージを共有セグメントに置き、もう一方にシグナルを送り、共有セグメントからメッセージを読むようにするのです。

**LPC ポートとは何ですか?**

どの LPC にも、LPC ポートと呼ばれる通信チャネルの集合体があります。どのポートも 1 種類の通信を伝達します。例えば、LPC には常に、プロセス内のスレッドがその要求を調整するのに使うポートと同様に、各クライアントがサーバーにメッセージを送信したり、サーバーが各クライアントにメッセージを送信するためのポートがあります。

**LPC と LPC ポートの実装の何が問題になっているのですか?**

上記の “なにが原因で起こりますか？” に述べられているように、LPC、LPC ポートの実装に関した全体的な問題が2つあります。この問題は、後述される 4つの特定の脆弱性を引き起こします。

-   “無効な LPC 要求”
-   “LPC メモリの枯渇”
-   “推測可能な LPC メッセージ識別子”
-   既存の ” 偽装 LPC ポート リクエスト”[MS00-003](https://technet.microsoft.com/security/bulletin/ms00-003) の変形

**"無効な LPC 要求" とは何ですか?**

Windows NT 4.0 のLPCの実装では、規則に反した呼び出しや想定しないパラメータが設定してある場合正しく処理しません。悪意のあるユーザーがこのような呼び出しをするプロセスを作成した場合には、システムが異常終了することがあります。

**Windows 2000 はこの脆弱性の影響を受けますか?**

いいえ、Windows NT 4.0 しか影響を受けません。

**この脆弱性の影響を受けるのはどのマシンですか?**

この脆弱性には LPC 構造が関与しているので、悪意のあるユーザーが対話的にログオンできるマシンのみ攻撃することができます。この脆弱性を利用してリモート マシンを攻撃することはできません。

**悪意のあるユーザーはなぜ、自分が使用しているマシンをクラッシュさせたいのですか?**

ほとんどの場合、悪意のあるユーザーにとって自分自身のマシンをクラッシュさせるのは意に反することです。例えば、ワークステーション上で悪意あるユーザーがこの脆弱性を利用すると、その被害は全て自ら引き起こしたものであり影響があるのは自分だけです。  

しかし、悪意のあるユーザーが数人のユーザーで共有しているマシンに対話的にログオンできた場合には、 ほかのユーザーに対するサービス拒否攻撃で、マシンを異常終了させることができます。ターミナル サーバーはここでは特に危険ですが、それは通常、普通のユーザーがターミナル サーバーに対話的にログオンできるからです。ドメイン コントローラ、プリンター/ ファイル サーバー、ERP サーバー、データベース サーバーなどほかのサーバーは、推奨されるセキュリティ (権限のないユーザーが対話的にログオンするのを極力妨げる) に従っている場合、このような攻撃対象にならないでしょう。

**どうすれば、攻撃を受けたマシンは元の状態に戻りますか?**

再起動することにより、元の状態に戻ります。

**更新プログラムは何を変更するのですか?**

Windows NT 4.0 の LPC の実装が、ここで問題になっている要求の拒否をするようにします。要求は無効なので、これが適切な応答です。

**“LPC メモリの枯渇” とは何ですか?**

Windows NT 4.0 および Windows 2000 の LPC の実装では、メッセージ記憶域を LPC ゾーンと呼ばれるプールから割り当てます。メッセージが LPC ゾーンの容量を越えるたびに、追加メモリがカーネルから LPC ゾーンに渡されます。仕様では、このメモリは、必要がなくなったときにカーネル メモリに返されます。しかし、特定の不正なLPC 要求を送信すると、このメモリがカーネルに返されなくなります。この結果、悪意のあるユーザーは、カーネル メモリの一部あるいは全てを渡してしまうことで、システムのパフォーマンスを低下あるいは停止させることができます。

**この脆弱性の影響を受けるのはどのマシンですか?**

ターミナル サーバーは特に危険ですが、その理由は、上記の ”無効な LPC 要求” に関して述べられていることと同様です。悪意のあるユーザーが自分自身のワークステーションでサービス拒否攻撃をしかけてもほとんど何もよいことはなく、推奨されるセキュリティに従っている場合、セキュリティ重視のサーバーには対話的にログオンできません。

**どうすれば、攻撃を受けたマシンは元の状態に戻りますか?**

管理者がそのマシンを再起動すれば、元の状態に戻ります。

**更新プログラムは何を変更するのですか?**

LPC ゾーンに渡された全てのカーネル メモリが、要求したプロセスの必要がなくなると、必ずすぐに返却されるようにします。

**“推測可能な LPC メッセージ識別子” とは何ですか?**

Windows NT 4.0 および Windows 2000 の LPC ポートの実装では、LPC メッセージ毎に設定されている識別子を知っているプロセスはすべて、LPC メッセージを利用できます。この脆弱性は識別子が推測可能なことに起因しています。これにより、あるプロセスが、ほかのプロセスに属している LPC 通信に干渉することができます。

**どのようなことが起呼び出し可能性がありますか?**

悪意のあるユーザーはこの脆弱性を利用して 3 種類の攻撃をしかけることができます。

-   サービス拒否。最も単純な場合には、不正プロセスがクライアントあるいはサーバーを装いランダムなデータを送信し、クライアントあるいはサーバーを異常終了させます。
-   盗聴。クライアントとサーバーがメッセージ受け渡し構造としてメモリセグメントを共有していた場合には、不正プロセスはそこに記憶されているデータを参照することができます。
-   特権の昇格。悪意のあるユーザーが、権限を与えられたスレッドに接続している、現存する LPC 通信を含むシステムプロセスを認識できた場合、クライアントをだまして本来なら不可能な要求をすることができます。悪意のあるユーザーがとれる特定の行為は、起動しているプロセスとそのプロセスによりできることにより異なります。

**この脆弱性の影響を最も受けるのはどのマシンですか?**

ターミナルサーバーが、この脆弱性を利用したサービス拒否の影響を特に受けます。その理由は、上記の ”無効な LPC 要求” “LPC メモリの枯渇” の脆弱性に関して述べられていることと同様です。また、ターミナル サーバーで盗聴攻撃がしかけられた場合には、最もその被害が大きくなりそうです。というのは、これにより悪意のあるユーザーは、ほかのユーザーのプロセスを盗聴できるからです。

この脆弱性が特権の昇格攻撃に利用された場合には、ターミナル サーバーとワークステーションが共に主な攻撃対象になります。しかし、通常のセキュリティ管理の行われている環境では、サーバーは、普通のユーザーがログオンするのを許可しないため、この脆弱性がサービス拒否攻撃、盗聴攻撃、特権の昇格攻撃に利用されても、それによる危険はありません。悪意のあるユーザーが対話的にログオンできない場合には、この脆弱性を利用することができないからです。

**悪意のあるユーザーはこの攻撃によりどんな権限を取得できますか?**

それは、マシン上で起動している特定のプロセスと、そのプロセスが与える権限の種類により異なります。この脆弱性を利用して任意のプロセスを起動させることはできないので、悪意のあるユーザーは、既に起動しているプロセスで破壊できるものを探す必要があります。

最悪の場合でも、この脆弱性によりできることはローカル マシン上での権限を高めることだけです。つまり、悪意のあるユーザーがワークステーション上でこの脆弱性を利用した場合には、ワークステーションの権限を取得できますが、直接ドメインでの権限を高めることはできません。

**更新プログラムは何を変更するのですか?**

要求が、メッセージの所有者からのものでない場合、LPC メッセージがその要求を拒否するようにします。

**” 偽装 LPC ポートリクエスト” の変形とは何ですか?**

もともとマイクロソフト セキュリティ情報 [MS00-003](https://technet.microsoft.com/security/bulletin/ms00-003) で述べられている "偽装 LPC ポート リクエスト" の脆弱性を利用すると、悪意のあるユーザーは、クライアントとサーバー両方のプロセスを作成して LPC の要求を操作し、それを高められたセキュリティ コンテキスト、システム自身の中で実行させることができます。
新種の脆弱性は、MS00-003 で提供されている更新プログラムを適用した後でも、この脆弱性を利用可能にするものです。しかし、新しい脆弱性を利用するためには、その環境において幾つかの重要な制限があります。

**制限とは何ですか?**

2 つの制限があります。

-   新しい脆弱性を利用しても、悪意のあるユーザーは任意のセキュリティ コンテキストで自分のプロセスを実行することはできません。悪意のあるユーザーが LPC ポートの識別子を推測できる場合に限り、新しいプロセスがマシン上で既に起動しているプロセスの １ つを装うことはできます。
-   この脆弱性は、標的のプロセスが特定のLPC 呼び出しをするのと同じ時間に、悪意のあるユーザーが偽装要求をすることができる場合にのみ利用されます。

**この脆弱性の影響を受けるのはどのマシンですか?**

主な攻撃対象となるのは、ターミナル サーバーやワークステーションです。通常のセキュリティ管理の行われている環境では、サーバーは、普通のユーザーがログオンするのを許可しないため、この脆弱性による危険はありません。上記に述べられているように、悪意のあるユーザーが対話的にログオンできない場合には、この脆弱性を利用することはできません。

**悪意のあるユーザーはこの攻撃によりどんな権限を取得できますか?**

マシン上で起動する特定のプロセスにより異なります。この脆弱性を用いて任意のプロセスを起動させることはできません。この脆弱性を用いてできることは、どんな場合でも、ローカルマシンでの権限を高めることのみです。つまり、悪意のあるユーザーがワークステーション上でこの脆弱性を利用した場合、ワークステーション上の権限は取得できますが、直接ドメインでの権限を高めることはできません。

**更新プログラムは何を変更するのですか?**

あるプロセスが、権限を必要とするプロセスになりすます機能を制限します。

**どこから更新プログラムを入手できますか?**

マイクロソフト セキュリティ情報 MS00-070 をご覧ください。

**更新プログラムはどのように使用するのですか?**

サポート技術情報 [266433](https://support.microsoft.com/kb/266433) には、お客様のサイトに更新プログラムを提供するための詳細な情報が記載されています。

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する更新プログラムを開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 MS00-070 と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](https://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。
-   マイクロソフトはサポート技術情報 [266433](https://support.microsoft.com/kb/266433) を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](https://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカルサポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](https://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------

 
この問題に対する日本語版更新プログラムは、以下のサイトからダウンロードできます。

-   Microsoft Windows NT 4.0 Workstation、Server、および Server, Enterprise Edition:  
    この問題に対する更新プログラムは Windows NT 4.0 のセキュリティ ロールアップ パッケージ (SRP) に含まれています。  
    個別の更新プログラムよりもセキュリティ ロールアップ パッケージを適用することをお勧めします。
    NT4.0 のセキュリティ ロールアップ パッケージは次のリンクから入手してください。

    [299444](https://support.microsoft.com/kb/299444) Post Windows NT 4.0 SP6a セキュリティ ロールアップ パッケージ (SRP)

    なお、個別の更新プログラムは次のリンクから入手することができます。

    -   PC/AT 互換機用  
        [https://www.microsoft.com/download/details.aspx?displaylang=ja&FamilyID=F0521C62-34ED-4A35-8EE8-27FA09C37B94](https://www.microsoft.com/download/details.aspx?displaylang=ja&familyid=f0521c62-34ed-4a35-8ee8-27fa09c37b94)  
        ダウンロード先のリストから Japanese Language Version を選択してください。

    **注 :**  
    他のセキュリティ更新プログラムは[マイクロソフト ダウンロードセンター](https://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)で入手可能です。

    更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
    [マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](https://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報 :**

-   US マイクロソフトセキュリティ情報（MS00-070）  
    [https://www.microsoft.com/technet/security/bulletin/ms00-070.mspx](https://technet.microsoft.com/security/bulletin/ms00-070)
-   サポート技術情報 （KB） 文書番号 ： 266433  
    [「LPC ポートのシステム コール」の複数の脆弱性に対する対策](https://support.microsoft.com/kb/266433)

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
