---
TOCTitle: 'MS00-080'
Title: 'マイクロソフト セキュリティ情報 MS00-080 - 緊急'
ms:assetid: 'ms00-080'
ms:contentKeyID: 61228246
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-080(v=Security.10)'
---
 
マイクロソフト セキュリティ情報 MS00-080 - 緊急
===============================================

「セッション ID クッキーのマーキング」 の脆弱性に対する対策
-----------------------------------------------------------

公開日: 2000年11月1日 | 最終更新日: 2001年1月24日

#### 概要 :

2000 年 10 月 23 日 Microsoft は、Microsoft® Internet Information Server の脆弱性を排除する日本語版更新プログラムをリリースしました。この脆弱性を利用することにより、悪意のあるユーザーは、特定の制限された状況で、他のユーザーのセキュリティで保護された Web セッションを "ハイジャック" することができます。

2000 年 11 月 20 日 Microsoft は、Alpha プラットホーム上で IIS 4.0 を使用するお客様と IIS 5.0 をお使いのお客様へのセキュリティ情報を更新します。新しい更新プログラムは元の更新プログラムの脆弱性も修正します。x86 用の IIS 4.0 更新プログラムには影響ありませんので、この場合のお客様は対応策を講じる必要はありません。

**影響を受けるソフトウェアのバージョン :**

-   Microsoft Internet Information Server 4.0
-   Microsoft Internet Information Services 5.0

### 詳細

問題
----

 
IIS は、Web セッションの現在のセッション ID を追跡するために、セッション ID クッキーの使用をサポートしています。しかし、IIS の ASP は、RFC 2109 で定義されている、セキュリティで保護されたセッション ID クッキーの生成をサポートしていません。結果として、同じ Web サイト上にセキュリティで保護されたページと保護されていないページが設置されている場合、同じセッション ID が使用されてしまいます。ユーザーが、セキュリティで保護された Web ページでセッションを開始した場合、セッション ID クッキーが生成され、SSL によって暗号化された状態でユーザーに送信されます。しかし、その後ユーザーが同じサイト上にあるセキュリティで保護されていないページを訪れた場合、同じセッション ID クッキーがプレーンテキストで交換されます。悪意のあるユーザーが通信チャンネルにおいて完全なコントロールを取得している場合、プレーンテキストのセッション ID クッキーを読み取り、それを使ってセキュリティで保護されたページのユーザーのセッションに接続することができます。このとき悪意のあるユーザーは、セキュリティで保護されたページで、セッション ID クッキーを読み取っ たユーザーと同じ操作を実行することができます。    
この脆弱性を利用するには、非常に厳しい条件を満たす必要があります。まず悪意のあるユーザーは、ほかのユーザーの Web サイトとの通信に関して完全なコントロールを取得していなければなりません。さらに、悪意のあるユーザーは、セキュリティで保護されたページに最初に接続することはできません。接続が可能となるのは、正当なユーザーが接続した後だけです。この更新プログラムは、.ASP ページにおけるセキュリティで保護されたセッション ID クッキーのサポートを追加することにより、この脆弱性を排除します (IIS のほかのテクノロジで使用されるクッキーはすべてセキュリティで保護されており、この脆弱性の問題は発生しません)。

元の更新プログラム Alpha 用 IIS 4.0 とIIS 5.0 が正しくインストールできませんでした。  
x86 用の IIS 4.0 更新プログラムは正しくインストールされます。

よく寄せられる質問
------------------

 
**マイクロソフトセキュリティ情報 MS00-080 はどのような内容の通知ですか?**

マイクロソフト セキュリティ情報 MS00-080 は、Microsoft® Internet Information Server のセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことを、お客様にお知らせするものです。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**この脆弱性はどれくらいの範囲に影響を与えますか?**

非常に制限された環境において、別のユーザーのセキュリティで保護された Web セッションを "ハイジャック" するという悪意ある行為を可能にします。つまり、悪意あるユーザーが別のユーザーの、セキュリティで保護された Web ページにかかわる現在のセッションに接続し、そのユーザーに代わって命令を出したり個人情報を参照することなどを可能にするというものです。

この脆弱性を利用するには、非常に厳しい条件を満たす必要があります。悪意あるユーザーは、ユーザーと Web サイト間の通信を完全にコントロールできる必要があり、データの読み取りおよび通信中に自身のデータ挿入が可能な必要があります。さらに、悪意あるユーザーは、別のユーザーとしてセッションを開始することはできません。– 正当なユーザーがセッションを開始したら、それをハイジャックできるだけです。この脆弱性は、ある一つの技術を用いて作成された Web ページにのみ影響を与えます。

**この脆弱性の原因は何ですか?**

SSL で保護された ASP ページは、そのセッション ID クッキーをセキュリティで保護されたクッキーとして印をつけることができません。その結果、ある特定の状況において、悪意あるユーザーが別のユーザーのセッション ID を取得し、SSL で保護されたセッションに接続することが可能になります。

**クッキーとは何ですか?**

クッキーは特定のユーザーと特定の Web サイトに関する情報を含む小さなデータファイルです。クッキーの種類には以下の主な 2 種類があります:

-   永続的なクッキー。これは、次々とサイトを訪れるうちに蓄積され、通常は Web サイトに関するユーザーの嗜好の経歴情報を提供し、これにより提供する情報のカスタマイズを可能にします。例えば、Jane が Web サイトの A を頻繁に訪れていつもそこのスポーツ用品の支払いをしていた場合、その情報は彼女のコンピュータのクッキーに記録されます。彼女が将来そのサイトを再び訪れたら、クッキーを読み込み、香料やハーブの新しい品揃えではなく、最新のスポーツ用品を表示するでしょう。
-   セッション クッキー。これは、現在訪れている Web サイトに関する情報しか含まず、通常状態情報を提供します。–ビジターがそのサイトで何をしているのかを Web サイトに知らせるデータです。サイトが状態情報を必要な理由は、何十万人もの人が既知の Web サイトにばらばらに、つまり任意の順番、時間に訪れるためです。Jane が買い物のページから会計のページに移ったときに、会計のページは、彼女の現在のオーダーを調べるために、移った人が Jane であることを何らかの方法で知る必要があります。

この脆弱性は、IIS の特定の Web ページ – ASP ページ – が特定のセッション クッキー — セッション ID として知られる情報を含むもの –をどのように処理するかに関係します。

**ASP ページとは何ですか?**

ASP または Active Server Pages は、構築された Web サイトを非常に強力で動的なものにする IIS によって技術的にサポートされています。 Web の構築者は、静的な HTML ページのコーディングをするのではなく、ASP のもとで Web サーバー上で作動し、動的に生成されてユーザーに送信される HTML ページを作成します。これにより、特定のユーザーや特定の条件のためにいつでも Web ページをカスタマイズできます。

**セッション ID クッキーとは何ですか?**

Web サイトが必要とする状態情報の中には、Jane がサイトのあるページから次のページへ移ったときに彼女を確認する方法があります。その方法は、Jane が最初にそのサイトの一つのページを訪れたときにセッション ID を割り当て、セッション最中はその値を彼女の確認に用いるというものです。毎回 Web サイトで新しいセッションを開始するたびに、彼女に新しいセッション ID が発行されます。

**ASP ページのセッション ID クッキー処理で何が問題になっていますか?**

ASP ページはセッション ID クッキーに保護されているという印をつけることができません。クッキーの取り扱いを協議する業界標準仕様書の [RFC 2109](https://www.ietf.org/rfc/rfc2109.txt) では、セキュリティで保護された Web ページのクッキーに “保護されている” という印を付けることは可能だとしています。その場合には、ブラウザはそのサイトのセキュリティで保護されたページのみ送信します。

**これは、IIS で処理される全てのクッキーに関する問題ですか?**

いいえ、特殊な場合で、ASP ページがセッション ID クッキーに印を付ける方法にのみ影響を与えます。 IIS の他の全ての技術は、セキュリティで保護されたクッキーを全面的にサポートし、ASP はセッション ID クッキー という特殊な場合を除いてセキュリティで保護されたクッキーをサポートします。

**この脆弱性にはどのような危険がありますか?**

悪意あるユーザーが別のユーザーの Web セッションをかなりコントロールできる場合にのみ、セキュリティで保護された Web ページを”ハイジャック”することが可能です。仮に、Bob が Jane の Web 上の行動を監視することができたとします。つまり、Bob が Jane のネットワーク接続に物理的にアクセスし、Jane の Web セッションを”探り当てた”とします。ここで、Jane がお気に入りの Web サイト上のセキュリティで保護されたページ (つまり、SSL により保護されたページ) を訪れます。Bob は Jane とサイト間を行き来するデータを全て見ることができますが、Bob が所有していない鍵で暗号化されているので、彼はこのデータを読むことができません。サイトが Jane に送信したデータの中には、セッション ID クッキーも含まれています。

次に Jane が同じサイトの保護されていないページを訪れたとします。前回と同様、Bob は Jane と Web ページの間で交換されるデータを見ることができます。けれども、今回は Bob はそのデータを読むことができます。データがクリア テキストだからです。セッション ID クッキーは保護されているとして印をつけられないので、ネットワーク上をクリア テキストとして送信されます。そこで Bob はセッション ID クッキーを読むことができ、Jane になりすましてセキュリティで保護された Web ページに接続することが可能です。この時点で、Bob は Jane がそのページ上で操作できることを全て実行できます。

**結局 Bob は、データを読むのに必要な鍵をまだもってませんが、セキュリティで保護された Web ページに接続可能だと何ができますか?**

Bob のブラウザが Jane のセッション ID を使用してセキュリティで保護されたページに接続した場合、そのページは Bob のブラウザと新しい SSL 鍵の交渉をし、そのセッションを保護します。これにもかかわらず、Jane が事前に送信したページは以前読めないことに注意してください。 – そのページは異なる鍵で暗号化されており、Bob はその鍵を持っていません。しかし、新しい鍵の交渉をする資格は、セキュリティで保護されたページと以後やりとりをする機会を Bob に与えます。つまり、Bob がいったん Jane としてそのページと通信する手段を得たら、彼女のクレジットカード情報を参照したり、オーダーを変更することができます。

**この脆弱性を利用するのに必要な Web セッションの管理権限を得るのは、どの程度難しいですか?**

非常に困難ですが、不可能ではありません。悪意あるユーザーがお客様のネットワーク通信に物理的にアクセス可能か、またはネットワーク形態が悪意あるユーザーにとって極めて有利である必要があります。つまり、悪意あるユーザーが他のユーザーの回線を盗聴できるか、他のユーザーのデータが通過する位置にいる必要があります。

**Jane がそのサイトのセキュリティで保護されたページを訪れなかった場合はどうなりますか? その時に悪意あるユーザーはこの脆弱性を利用することができますか?**

この脆弱性により悪意あるユーザーができることは、存在するセッションをハイジャックすることであり、セキュリティで保護されたページにかかわるセッションを始めることではありません。Bob は Jane になりすましてセキュリティで保護されたセッションを始めることはできません。なぜなら、彼はセキュリティで保護されたページが要求する認証– デジタル証明書、パスワード、PIN など– を提供できないからです。(この問題を違う角度から捉えると、Bob にセキュリティで保護されたページが要求する認証の情報があれば、この脆弱性を利用する必要はありません。ただ単にそのサイトに Jane としてログオンすれば良いのです。)

この脆弱性を使って、Bob が Jane にセキュリティで保護されたサイトを訪ね認証するよう促すことはできません。Bob は Jane がセキュリティで保護されたページを訪ねるように社会工学を用いるか、Jane が偶然特別なサイトを訪れるまで彼女の通信を監視する必要があります。

**Jane がサイト内のセキュリティで保護されたページにのみ訪れて、保護されていないページは訪れなかったと仮定すると、悪意あるユーザーはこの場合脆弱性を利用できますか?**

Jane がセッション中セキュリティで保護されたページにのみ訪れ、Bob が Jane のセッション ID を取り出すために、Jane を保護されていないページに行かせることができなかったとします。それでも、もしセッション中に一度でも保護されていないページを訪れたら–それが違うサイトであったとしても– Bob が Jane のリクエストを変更することは可能です。現在のシナリオでは、Bob は Jane のネットワーク通信を完全にコントロールすることができるからです。この条件のもとでは、意図するサイトの保護されていないページにJaneが行くように、Bob は Jane のリクエストを変更することや、彼女の代わりに別のリクエストを送信することもできます。このことによりセッション ID を変更するようにできるため、Bob がセッションを読解し使用することが可能になります。

**この脆弱性により使用しているコンピュータ内のクッキーは危険にさらされますか?**

いいえ、この脆弱性が影響を与えるのは特別な 1 種類のクッキーで、ASP ページで作成されたものにのみだということを覚えておいてください。他のクッキーは全て保護されていると印をつけられ、適切に処理されます。

**ASP を使用する全てのセキュリティで保護された Web サイトが危険にさらされているのですか?**

いいえ、Web サイトはセキュリティで保護されたページと保護されていないページのセッションに異なる ID を使用することを推奨されています。この手引きに従っているサイトは 2 つの異なるセッション ID – 1 つはセキュリティで保護された Web ページ用ともう 1 つは保護されていない Web ページ用– を持つので、この脆弱性による危険はありません。保護されていないページのセッション ID クッキーはクリア テキストとして送信されるので解読可能ですが、保護されていないページの”ハイジャック”にしか用いることができず、これはいつでも可能なことです。

たとえサイトが、セキュリティで保護されたページと保護されていないページに共通のセッション ID を使用したとしても、セキュリティで保護されたページが新しい鍵の交渉をする前に必ずユーザーによる認証を要求する場合には、この脆弱性による危険は何もありません。認証が要求される場合には、Bob は Jane のパスワードを知らないため、Jane のセッション ID を使用してセッションを確立できないからです。

**どのような場合に更新プログラムを適用する必要がありますか?**

ASP ページからのセッション ID クッキーに、セキュリティで保護されたという印をつける必要のある全てのWeb サーバーにこの更新プログラムをインストールする必要があります。

**更新プログラムは何を修正しますか?**

更新プログラムがインストールされ機能すると、セキュリティで保護されたクッキーをサポートするようになります。サポート技術情報 [274149](https://support.microsoft.com/kb/274149) には、これにより生じたクッキーの扱われ方とセッション ID の使用方の変更に関する特別な詳細が記載されています。

**どこから更新プログラムを入手できますか?**

マイクロソフト セキュリティ情報 MS00-080 をご覧ください。

**更新プログラムはどのように使用するのですか?**

サポート技術情報 [274149](https://support.microsoft.com/kb/274149) には、お客様のサイトに更新プログラムを提供するための詳細な情報が記載されています。

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する更新プログラムを開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 MS00-080 と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](https://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。
-   マイクロソフトはサポート技術情報 [274149](https://support.microsoft.com/kb/274149) を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](https://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカルサポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](https://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------

 
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Internet Information Server 4.0:  
    この問題に対する更新プログラムは Windows NT 4.0 のセキュリティ ロールアップ パッケージ (SRP) に含まれています。  
    個別の更新プログラムよりもセキュリティ ロールアップ パッケージを適用することをお勧めします。  
    NT4.0 のセキュリティ ロールアップ パッケージは次のリンクから入手してください。

    [299444](https://support.microsoft.com/kb/299444) Post Windows NT 4.0 SP6a セキュリティ ロールアップ パッケージ (SRP)

    なお、個別の更新プログラムは次のリンクから入手することができます。

    -   PC/AT 互換機用  
        <https://www.microsoft.com/ntserver/nts/downloads/critical/q274149/default.asp>  
        ダウンロード先のリストから Japanese Language Version を選択してください。  
    -   Alpha 用  
        <https://support.microsoft.com/directory>

-   Internet Information Services 5.0:  
    この問題に対する修正は [MS01-026](https://technet.microsoft.com/security/bulletin/ms01-026) の修正モジュールに含まれています(NEC PC98 シリーズを除く)。MS01-026 には、それまでの IIS 関連の修正がすべて含まれていますので、MS01-026 のご利用をお勧めします。

    また、Windows 2000 をご使用の場合、この問題に対する修正は Windows 2000 Service Pack 2 以降に含まれております。最新の Windows 2000 Service Pack については次のリンクから入手してください。  
    [https://www.microsoft.com/download/details.aspx?FamilyID=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&DisplayLang=ja](https://www.microsoft.com/download/details.aspx?familyid=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&displaylang=ja)

    個別のモジュールは次のリンクより入手することができます。  
    [https://www.microsoft.com/Windows2000/downloads/critical/q274149/default.asp](https://www.microsoft.com/windows2000/downloads/critical/q274149/default.asp)
    -   PC/AT 互換機用  
        ダウンロード先のリストから Japanese Language Version を選択してください。
    -   PC-9800シリーズ 用  
        ダウンロード先のリストから Japanese NEC Language Version を選択してください。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](https://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報 :**

-   US マイクロソフトセキュリティ情報（MS00-080）  
    [https://www.microsoft.com/technet/security/bulletin/ms00-080.mspx](https://technet.microsoft.com/security/bulletin/ms00-080)
-   サポート技術情報 （KB） 文書番号 ： 274149  
    [\[IIS\] IIS では Cookie を Secure としてマークできない](https://support.microsoft.com/kb/274149)

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
