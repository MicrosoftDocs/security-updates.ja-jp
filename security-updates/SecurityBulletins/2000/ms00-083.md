---
TOCTitle: 'MS00-083'
Title: 'マイクロソフト セキュリティ情報 MS00-083 - 緊急'
ms:assetid: 'ms00-083'
ms:contentKeyID: 61228249
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-083(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS00-083 - 緊急
===============================================

「Netmon のプロトコル解析」 の脆弱性に対する対策
------------------------------------------------

公開日: 2000年11月7日 | 最終更新日: 2002年5月1日

#### 概要 :

Microsoft は、Microsoft® Windows NT® と Windows® 2000 のサーバー製品、および Systems Management Server の脆弱性を排除する更新プログラムをリリースしました。この脆弱性を利用することにより、悪意のあるユーザーは、脆弱性を持つサーバーのコントロールを取得することができます。

**影響を受けるソフトウェアのバージョン** **:**

-   Microsoft Windows NT 4.0 Server
-   Microsoft Windows NT 4.0 Server, Terminal Server Edition
-   Microsoft Windows NT 4.0 Server, Enterprise Edition
-   Microsoft Windows 2000 Server
-   Microsoft Windows 2000 Advanced Server
-   Microsoft Systems Management Server 1.2
-   Microsoft Systems Management Server 2.0

**注** **:**
Netmon は Windows NT 4.0 Workstation または Windows 2000 Professional に同梱されていません。これらの製品に SMS がインストールされている場合にのみこの脆弱性の影響を受けます。

### 詳細

問題
----

Microsoft では、2 つのバージョンのネットワーク モニタ (Netmon) を出荷しています。1 つ目は、Windows NT® 4.0 と Windows 2000 のサーバー製品に同梱される通常版で、2 つ目は、Systems Management Server (SMS) 1.2 と 2.0 に同梱される完全版です。両方のバージョンにプロトコル パーサーが含まれており、これを使って管理者は、以前キャプチャしたネットワーク データの解釈や解析を行うことができます。しかし、一部のパーサーには、チェックされないバッファが含まれます。悪意のあるユーザーが、ネットワーク トラフィックを監視しているサーバーに対して、特殊な無効フレームを送信すると、管理者が脆弱性の問題のあるパーサーを使用してそのフレームを解析した場合、Netmon が停止するか、あるいは悪意のあるユーザーが選択したコードが、標的とするコンピュータで実行されます。  
Netmon の実行には管理者権限が必要ですが、ドメインの管理者ではなく、ローカル コンピュータの管理者だけが実行する必要があります。ローカル コンピュータの管理者が Netmon を実行している場合、この脆弱性を利用して、ローカル コンピュータの完全なコントロールが取得されることはあっても、ド メインのコントロールが取得されることはありません。Netmon は、ワークステーション製品には同梱されません。したがって、ワークステーションがこの脆弱性による攻撃を受けるのは、ワークステーションに SMS がインストールされている場合だけです。

よく寄せられる質問
------------------

**マイクロソフトセキュリティ情報** **MS00-083** **はどのような内容の通知ですか?**

マイクロソフト セキュリティ情報 MS00-083 は、Microsoft® Windows NT® 4.0、Windows® 2000 server 製品、および Microsoft Systems Management Server のセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことを、お客様にお知らせするものです。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**この脆弱性はどれくらいの範囲に影響を与えますか?**

管理者がネットワークの監視に使用するツールに影響を及ぼす[バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)をされる可能性があります。悪意のあるユーザーが、管理者が監視しているネットワークに特定の不正なデータを送信すると、次の 2 つの結果のうち、どちらかが生じることがあります。大したことがない場合には、ツールがデータを処理しようとした時に、その不正なデータのために処理が失敗することになります。もっと深刻な被害を受けた場合には、管理者のマシンで、悪意のあるユーザーの任意のコードが実行されることになります。

ネットワークを監視するツールは、実行するのに管理者権限を必要とするので、この脆弱性のためにコードがマシン上で実行された場合には、ローカルマシンに対する完全なコントロールを取得されたことになります。しかし、推奨されることを厳守していれば、ドメインの管理者がこの脆弱性を利用されることは回避可能です。このツールはサーバー製品にのみ同梱されて出荷されています。

**この脆弱性の原因は何ですか?**

Network Monitor で提供されるプロトコル パーサーの中には問題のあるバッファを含むものがあります。管理者が監視しているネットワークに特定の不正なデータを送付した場合、バッファ オーバーランを引き起こす可能性があり、それにより Network Monitor が異常終了するか、管理者によりセキュリティで保護されたコンテキストの中のマシン上で、送信者の任意のコードが実行されます。

**Network Monitor** **とは何ですか?**

Network Monitor は Netmon としても知られていますが、ネットワーク トラフィックを監視するために用いられる管理者用ツールです。管理者はこのツールを使用して、ネットワークを行き交うデータのパケットを記録、分析することができるのです。Netmon は、通信の故障探求やネットワークの監視に役に立つツールです。このツールの使用には管理者権限が必要になります。  
Netmon には 2 つのバージョンがあり、両方共この脆弱性の影響を受けます。非公式に Netmon Lite と呼ばれる通常版は、Windows NT 4.0、Windows 2000 server 製品に同梱されています。ここで Netmon の完全版と呼ぶ Advanced バージョンは、Systems Management Server 1.2 と 2.0の管理ツールとして同梱されています。

両方のバージョンで、データをキャプチャ、分析することができますが、両者には重要な違いがあります。Netmon Lite は、管理者のマシンに直接送信されてきたデータのみ、管理者が記録、分析できます。それとは反対に、Netmon の完全版では、ローカル ネットワークを行き交う全てのデータを管理者が記録、分析できます。そのデータがどのマシン宛てに送信されているかは関係ありません。(ネットワークのインターフェースを "無作為検出モード" に設定した場合です。) また、完全版では、別のマシンにリモート エージェントをインストールすることで、そのマシンがどのネットワークに存在するかに関係なく、管理者はそのマシン宛てのデータを記録、分析できます。

**プロトコルパーサーとは何ですか?**

プロトコル パーサーは、Netmon のプラグイン モジュールの 1 つで、特定のプロトコルの、データのパケットやフレームを解釈します。データのフレームを受信して、それを解釈しようとした場合、その 1 つの方法は、フレームの最初の部分を読み、用いられているプロトコルを判断し、そのプロトコルからフレーム上の各フィールドのサイズや意味を表している個所を調べることです。この情報をいったん入手したらフレームを解釈できますが、この作業は明らかに自動化すべきものです。Netmon のプロトコル パーサーはこの作業をするために作られました。

Netmon は、特定のプロトコルのフレームを解釈できるパーサーの集まりです。Netmon はバージョンにより異なりますが、100 以上もの異なるプロトコルのためのパーサーを提供します。パーサーの大部分はこの脆弱性により影響を受けませんが、中には影響を受けるパーサーもあります。

**パーサーの何が問題なのですか?**

パーサーの中には、解釈する前に、フレームのデータの正当性を正しく立証しないものがあります。悪意のあるユーザーが特殊な不正なフレームを、ネットワーク トラフィックを監視しているマシンに送信し、管理者がそれをこの脆弱性の問題のあるパーサーを使用して処理した場合、2 つの結果のうち一方が起きることがあります。フレームの不正な個所にランダムなデータを含んでいた場合には、Netmon は異常終了することがあります。しかし、注意深く選択されたデータを含んでいた場合には、悪意のあるユーザーの任意のコードが管理者のマシン上で実行されることになります。

**悪意のあるユーザーは、Netmon** **が起動しているマシンに直接不正なフレームを送信しなければならないのですか、それともネットワークにそのフレームをただ流せばよいのですか?**

管理者が Netmon Lite を起動していた場合には、悪意のあるユーザーはそのマシンに直接データを送信する必要があります。しかし、管理者が完全版の Netmon を起動していた場合には、悪意のあるユーザーは同一ネットワーク内宛てか、リモート エージェントがインストールされているマシン宛てに不正なフレームを送信しさえすればよいのです。

**悪意のあるユーザーは、管理者がネットワークを監視し始めた途端にこの脆弱性を利用できるのですか?**

いいえ、この脆弱性が Netmon 自体ではなく、パーサーに関係していることを認識することが重要です。パーサーは "キャプチャした" データを、つまり、後で解析するためにキャプチャされたデータを解釈するのにしか用いることはできません。 パーサーは、現時点でのデータを解釈するためには使用できません。その結果、管理者が Netmon をデータのキャプチャや分析以外の作業で使用した場合には、この脆弱性による危険は全くありません。

**この脆弱性が利用されて** **Netmon** **が異常終了した場合、通常の作業に復帰するために何をする必要がありますか?**

管理者はただ Netmon を再起動させればよいだけです。マシンを再起動する必要はありません。

**この脆弱性が利用されて管理者のマシン上で悪意のあるユーザーのコードが実行された場合、何ができますか?**

Netmon を起動するには管理者権限が必要なので、コードがこの権限を得ることは確かです。コードはこのようにして少なくとも、ローカル管理者権限を得て、ローカルマシンを完全にコントロールするでしょう。

Netmon を起動しているのがドメイン管理者である場合、コードはドメイン全体の完全なコントロール権を取得することになります。しかし、ドメイン管理機能以外の目的でドメイン管理者アカウントを使用しないようにセキュリティで推奨されているので、これに従っていれば、管理者はドメインではなくローカルの管理者コンテキストで Netmon を使用することになります。

**悪意のあるユーザーには、管理者が** **Netmon** **を使用しているのがいつか知ることはできますか?**

管理者が Netmon の完全版を使用している場合、ネットワーク インターフェースが無作為検出モードになっている時マルチキャストパケットが送信されるので、悪意のあるユーザーはいつ使用しているか知ることができます。悪意のあるユーザーはただマルチキャスト パケットを監視するアプリケーションを書き、どのマシンがそれを発信しているのか記録すればよいのです。

悪意のあるユーザーにとって、Netmon Lite が起動しているかを見極める方がもっと難しいことです。ネットワーク インターフェースが無作為検出モードに設定されないので、マルチキャスト パケットを送信しないからです。Netmon Lite が自身の起動を知らせる方法が1つあります。– 別のマシンが Netmon Lite を起動していた場合、同じネットワーク上の他のマシンでも Netmon Lite が起動しているかどうかを確認するクエリーを送信できるのです。これにより、Netmon Lite が起動していた場合、悪意のあるユーザーがそのことを知ることになります。しかし、これは悪意のあるユーザーが同一ネットワーク上の server の管理者として管理する権限を既に所有していた場合に限ります。

**この脆弱性をリモートで利用することはできますか?**

正しく構成されたファイア ウォール – 外部のユーザーが、内部の特定のネットワークアドレスにパケットを送信するのを妨げる – はインターネット ユーザーがこの脆弱性を利用するのを防ぎます。

**この脆弱性は偶発的に発生しますか?**

いいえ、ここで問題にしている特殊な不正なデータはフレームを無効にするものです。そのようなフレームが偶然生成されるとは、極めて想像しがたいことです。

**どのような場合に更新プログラムを適用する必要がありますか?**

マイクロソフトは以下のマシンに更新プログラムをインストールすることを推奨します。

-   Netmon Lite が同梱されている製品である、全ての Windows NT 4.0 と Windows 2000 server 製品。Netmon Lite は workstation には同梱されていません。
-   Netmon の完全版がインストールされている全てのマシン

**この脆弱性の問題のある** **server** **製品上で** **Netmon** **の完全版を起動させています。SMS** **とオペレーティングシステム両方の更新プログラムをインストールする必要がありますか?**

いいえ、Netmon の完全版を起動させているのなら、SMS の更新プログラムのみインストールする必要があります。Netmon の完全版を起動していない場合は、現在使用しているオペレーティングシステムのバージョンの更新プログラムを適用する必要があります。

**更新プログラムは何を変更するのですか?**

更新プログラムは、ここで問題になっている問題のあるバッファを持たない新しいパーサーを提供します。

**どこから更新プログラムを入手できますか?**

マイクロソフト セキュリティ情報 MS00-083 をご覧ください。

**更新プログラムはどのように使用するのですか?**

サポート技術情報 [274835](http://support.microsoft.com/kb/274835) には、お客様のサイトに更新プログラムを提供するための詳細な情報が記載されています。

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する更新プログラムを開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 MS00-083 と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](http://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。
-   マイクロソフトはサポート技術情報 [274835](http://support.microsoft.com/kb/274835) を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](http://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカルサポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](http://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------

この問題を解決するための日本語版更新プログラムは、以下のサイトからダウンロードできます。

SMS を使用しているお客様は、プラットフォームに関係なく、SMS の更新プログラムを適用してください。SMS を使用していなくても、該当するサーバーを使用している場合は、オペレーティング システムの更新プログラムを適用してください。

-   Windows 2000:  
    この問題に対する修正は Windows 2000 Service Pack 2 以降に含まれております。最新の Windows 2000 Service Pack については次のリンクから入手してください。
    [http://www.microsoft.com/downloads/details.aspx?FamilyID=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&DisplayLang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&displaylang=ja)  
    個別のモジュールについては次のリンクから入手することができます。
    -   PC/AT 互換機用  
        [http://download.microsoft.com/download/win2000platform/Patch/Q274835/
        NT5/JA/Q274835\_W2K\_sp2\_x86\_JA.EXE](http://download.microsoft.com/download/win2000platform/patch/q274835/nt5/ja/q274835_w2k_sp2_x86_ja.exe)
    -   NEC PC-9800 シリーズ用  
        [http://download.microsoft.com/download/win2000platform/PatchNEC/
        Q274835/NT5/JA/Q274835\_W2K\_sp2\_NEC98\_JA.EXE](http://download.microsoft.com/download/win2000platform/patchnec/q274835/nt5/ja/q274835_w2k_sp2_nec98_ja.exe)
-   Windows NT 4.0 Server または Windows NT 4.0 Server, Enterprise Edition:
    この問題に対する更新プログラムは Windows NT 4.0 のセキュリティ ロールアップ パッケージ (SRP) に含まれています。
    個別の更新プログラムよりもセキュリティ ロールアップ パッケージを適用することをお勧めします。
    NT 4.0 のセキュリティ ロールアップ パッケージは次のリンクから入手してください。

    [299444](http://support.microsoft.com/kb/299444) Post Windows NT 4.0 SP6a セキュリティ ロールアップ パッケージ (SRP)

    なお、個別の更新プログラムは次のリンクから入手することができます。

    **注** **:**  
    SMS 2.0 Service Pack 2 以上の環境にインストールしてください。  
    [http://download.microsoft.com/download/sms20/Patch/
    SMS\_2.0/NT45/JA/Q273476c.EXE](http://download.microsoft.com/download/sms20/patch/sms_2.0/nt45/ja/q273476c.exe)

-   Microsoft Systems Management Server 1.2:  
    [http://download.microsoft.com/download/sms12/Patch/
    SMS\_1.2/NT45/JA/Q273476c.EXE](http://download.microsoft.com/download/sms12/patch/sms_1.2/nt45/ja/q273476c.exe)

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS00-083）  
    [http://www.microsoft.com/technet/security/bulletin/ms00-083.mspx](http://technet.microsoft.com/security/bulletin/ms00-083)  
-   サポート技術情報 （KB） 文書番号 ： 274835  
    [ネットワーク モニタのバッファ オーバーフローによる脆弱性](http://support.microsoft.com/kb/274835)

**更新履歴** **:**

-   2000/11/07: このセキュリティ情報を公開しました。
-   2002/5/1: 更新履歴を追加し、以後の更新履歴が確認できるようにしました。また、このセキュリティ情報を更新し、Windows NT 4.0 Server, Terminal Server Edition セキュリティ ロールアップ パッケージ (SRP) が利用可能になったことをお知らせしました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*