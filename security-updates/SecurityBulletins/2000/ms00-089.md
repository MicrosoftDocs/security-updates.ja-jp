---
TOCTitle: 'MS00-089'
Title: 'マイクロソフト セキュリティ情報 MS00-089 - 重要'
ms:assetid: 'ms00-089'
ms:contentKeyID: 61228255
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-089(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS00-089 - 重要
===============================================

「ドメイン アカウント ロックアウト」 の脆弱性に対する対策
---------------------------------------------------------

公開日: 2000年11月22日 | 最終更新日: 2001年2月22日

#### 概要 :

マイクロソフトは Microsoft® Windows 2000 のセキュリティの脆弱性を排除する更新プログラムをリリースしました。この脆弱性により、ドメイン管理者がアカウント ロックアウト ポリシーを設定しても、悪意のあるユーザーがアカウント パスワードを何度も推測しようと試みる可能性があります。

**影響を受けるソフトウェアのバージョン** **:**

-   Microsoft Windows 2000 Professional Service Pack 1
-   Microsoft Windows 2000 Server Service Pack 1
-   Microsoft Windows 2000 Advanced Server Service Pack 1

**注** **:**
Windows 2000 Gold はこの脆弱性による影響は受けません。

### 詳細

問題
----

NTLM 認証が Windows 2000 で動作する際に、ドメイン管理者がドメイン アカウント ロックアウト ポリシーを設定しても、それがローカルの Windows 2000 マシン上でバイパスされてしまうという問題があります。悪意のあるユーザーがドメイン アカウント ロックアウト ポリシーを回避してしまうと、ブルート フォース パスワード推測攻撃の危険性がさらに高くなります。

Windows 2000 以外のドメインのメンバーである Windows 2000 マシンだけがこの脆弱性による影響を受けます。さらに、あらかじめ目的のマシンにログインし、そのマシン上で既にキャッシュされた認証情報を獲得しているドメイン ユーザー アカウントだけがこの脆弱性による影響を受けます。ドメイン アカウント ロックアウト ポリシーが適切に設定してある場合にブルート フォース パスワード推測攻撃が行われると、ドメイン コントローラで ドメイン ユーザー アカウントがロックアウトされます。しかし、攻撃者が正しいパスワードを見つけることができると、キャッシュされた認証情報を使用してローカルの Windows 2000 マシンにログオンが可能となり、アカウント ロックアウト ポリシーは侵害されてしまいます。しかし、攻撃者がローカル マシンにログオンできても、ドメインに認証を行ったり、ドメインの他のマシンにあるリソースへのアクセスは取得できません。

よく寄せられる質問
------------------

**マイクロソフト セキュリティ情報** **MS00-089** **はどのような内容の通知ですか?**

このマイクロソフト セキュリティ情報 MS00-089 は、Microsoft® Windows 2000のセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことを、お客様にお知らせするものです。この脆弱性により、悪意のあるユーザーがドメイン アカウント ロックアウト ポリシーをバイパスし、ローカル マシンでブルート フォース パスワード推測攻撃を行う可能性があります。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**この脆弱性はどれくらいの範囲に影響を与えますか?**

この脆弱性により、ドメイン管理者がアカウント ロックアウト ポリシーを設定しても、悪意のあるユーザーが Windows 2000 マシンにブルート フォース パスワード推測攻撃を行う可能性があります。目的のマシンにユーザーが既にログインし、そのユーザーのログイン資格情報がマシンにキャッシュされたアカウントだけが攻撃の対象となります。  
いくつかの要因がこの脆弱性の可能性を制限します。

-   この脆弱性は Windows 2000 以外のドメインのメンバーである Windows 2000 マシンだけに影響を与えます。スタンドアローンの Windows 2000 マシンと Windows 2000 ドメインのメンバーである Windows 2000 マシンは影響を受けません。
-   ブルート フォース パスワード推測攻撃は、既にマシンにログインしているドメイン アカウントで、そのマシンがユーザーの資格情報をキャッシュしているものに限り行われます。
-   悪意のあるユーザーが、ユーザーのパスワードを推測できる場合、攻撃の際にそのパスワードを使用してマシンにログインする可能性があります。ドメイン アカウント ロックアウト ポリシーは悪意のあるユーザーがドメイン コントローラに認証を行なったり、推測したパスワードを使用してドメインの他のマシンに認証を行うことを防ぎます。

**この脆弱性の原因は何ですか?**

この脆弱性は Windows 2000 の NTLM 認証の実装の問題により起こります。　NTLM 認証のためのユーザーの資格情報がローカル マシンにキャッシュされると、Windows 2000 はそのユーザーのアカウントにログインを行う処理中にドメインのアカウント ロックアウト ポリシーを尊重しそこねます。

**アカウント ロックアウト ポリシーとは何ですか?**

アカウント ロックアウト ポリシーはユーザーが間違ったパスワードを使用して、管理者が指定した回数以上ログインしようとした場合、管理者がそのアカウントを無効にするよう指定ができるものです。

**なぜドメイン管理者はアカウント ロックアウトについてドメイン ポリシーを設定する必要があるのですか?**

管理者はアカウント ロックアウトに関するドメイン ポリシーを設定し、ブルート フォース パスワード推測攻撃によるアカウント　パスワードの推測が成功してしまう可能性を削減する必要があるからです。

**ブルート フォース パスワード推測攻撃とは何ですか?**

ブルート フォース パスワード推測攻撃は文字、語句または他の一般的に使用されている文字列の多種多様な組み合わせで、特定のアカウントに関連したパスワードを見つけようとするユーザーやプログラムによる試行です。

**NTLM** **とは何ですか?**

NTLM とは、Windows NT 4.0 とそれより前のバージョンがドメイン コントローラにユーザーの識別を認証させるために使用する認証プロトコルです。Windows 2000 は Windows 2000 クライアント、サーバー、ドメイン コントローラ、Windows NT の初期バージョンを動作するシステムの互換性を提供する NTLM 認証をサポートします。

**キャッシュされた資格情報とは何ですか?**

ドメインのメンバーである Windows 2000 システムにログオンが成功すると、オペレーティング システムはユーザーのハッシュされたバージョンのパスワードを記憶し、そのユーザーが、システムがドメイン コントローラにアクセスできない場合でも、ログオンできるようにします。このハッシュされたバージョンのパスワードと、ユーザーの許可についての関連した情報はユーザーのキャッシュされた資格情報と呼ばれます。

**NTLM** **ではなく** **Kerberos** **によって認証が行われる** **Windows 2000** **ドメインを使用していますが、この脆弱性による危険性はありますか?**

いいえ、ありません。NTLM 認証を使用する Windows 2000 マシンだけが影響を受けます。Windows 2000 マシンが Windows 2000 ドメインに認証を行うと、Kerberos 認証を使用しますので、この脆弱性による影響は受けません。

**あるマシンに** **1** **度もログインしたことがない場合、それでも悪意のあるユーザーはそのマシンをねらって、パスワードを推測しようとしますか?**

いいえ、しません。この脆弱性はローカル マシンに既にキャッシュされた資格情報を持つドメイン ユーザーのアカウントだけに影響を与えます。つまり、ユーザーが既にローカル マシンにログオンしていると、そのユーザー アカウントはこの脆弱性による影響を受ける危険性があります。

**この脆弱性を利用して悪意のあるユーザーがパスワードを推測できた場合、そのパスワードを使用してドメインにある他のマシンにもログオンできますか?**

いいえ、できません。キャッシュされた資格情報で、悪意のあるユーザーはアカウント ロックアウト ポリシーを侵害して目的のマシンにログオンすることができます。しかし、ログイン試行は依然としてドメイン コントローラに報告されますので、アカウント ロックアウト ポリシーはドメイン レベルで有効となっています。このため、悪意のあるユーザーがユーザー名を使用し、パスワードを推測してドメインの他のマシンにログオンしようとしても、それは許可されません。

**攻撃が成功した場合、攻撃者はどのような権限を得るのでしょうか?**

攻撃者がキャッシュされた資格情報を使用してログオンできたとしても、ドメイン アカウントは依然としてロックアウトされ、攻撃者はドメインに認証を行うことができません。したがって、攻撃者はローカル マシンで、そのドメイン アカウントが持つアクセスのみを取得します。ドメイン アカウントがローカル マシンで管理者権限を持っている場合、攻撃者はそのマシンのローカル管理者コントロールを取得します。

**この脆弱性はリモートでも利用されますか?**

この脆弱性をリモートで利用するためには、攻撃者は Windows 2000 以外のドメインのメンバーである Windows 2000 マシンへのネットワーク アクセスを取得し、マシンにログインしたユーザー名を識別し、パスワード推測攻撃ができなければなりません。最善策が講じられ、NetBIOS ポートが組織のファイアウォールでブロックされている場合、この攻撃は組織のネットワーク内のみから発生が可能となります。しかし、攻撃は組織のネットワーク内で行われます。

**誰かがブルート フォース パスワード推測攻撃をドメインで行おうとしていることはどのようにして分かるのですか?**

監査ログイン イベント エラーのための監査ポリシーが有効な場合、すべての失敗したアカウント ログイン 試行はイベント ログに記録されます。

**ローカル アカウントはこの脆弱性による影響を受けますか?**

いいえ、受けません。ドメイン アカウントだけが影響を受けます。ローカル アカウントのためのアカウント ロックアウト ポリシーはこの脆弱性による影響を受けませんので、依然として有効です。

**管理者アカウントはロックアウトされていませんが、これに対し、どのように攻撃者がブルート フォース アカウント パスワード攻撃を行うことを防ぐことができますか?**

まず、管理者は管理者アカウントの名前を変えて、その名前が明白でないようにすることが可能です。しかし、攻撃者がその管理者アカウント名を見つけてしまうと、ブルート フォース アカウント パスワード推測攻撃を行う可能性があります。管理者アカウントには長くて複雑なパスワードを使用するのが得策です。さらに、この場合、失敗したログイン試行のロギングを有効にすることは特に重要です。

**だれが更新プログラムを適用する必要がありますか?**

マイクロソフトはNT 4.0 ドメインのメンバーである Windows 2000 マシンを持つ全てのユーザーにこの更新プログラムのインストールを考慮することを推奨します。

**更新プログラムは何を修正しますか?**

この更新プログラムは Windows 2000 の NTLM 認証における実装問題を排除することでこの脆弱性を排除します。

**どこから更新プログラムを入手できますか?**

マイクロソフト セキュリティ情報 MS00-089 をご覧ください。

**更新プログラムはどのように使用するのですか?**

マイクロソフト サポート技術情報 [274372](https://support.microsoft.com/kb/274372) には、お客様のサイトに更新プログラムを提供するための詳細な情報が記載されています。

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する更新プログラムを開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 MS00-089 と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](https://technet.microsoft.com/ja-jp/security/dd252948.aspx)を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](https://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカル サポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](https://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------

この問題に対する修正は Windows 2000 Service Pack 2 以降に含まれております。最新の Windows 2000 Service Pack については次のリンクから入手してください。  

<https://www.microsoft.com/japan/windows2000/downloads/>  
個別の修正モジュールは次のリンクから入手することができます。

-   PC/AT 互換機用  
    [https://www.microsoft.com/download/details.aspx?FamilyId=45C7A628-CE0E-49D5-B7A7-3A71B2FF4C97&displaylang=ja](https://www.microsoft.com/download/details.aspx?familyid=45c7a628-ce0e-49d5-b7a7-3a71b2ff4c97&displaylang=ja)  
-   NEC PC-9800 シリーズ用  
    [https://download.microsoft.com/download/win2000platform/PatchNEC/q274372/NT5/JA/Q274372\_W2K\_sp2\_NEC98\_JA.EXE](https://download.microsoft.com/download/win2000platform/patchnec/q274372/nt5/ja/q274372_w2k_sp2_nec98_ja.exe)

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](https://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS00-089）  
    [https://www.microsoft.com/technet/security/bulletin/ms00-089.mspx](https://technet.microsoft.com/security/bulletin/ms00-089)
-   サポート技術情報 （KB） 文書番号 ： 274372  
    [「ドメイン アカウント ロックアウト」の脆弱性の更新プログラム](https://support.microsoft.com/kb/274372)

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*