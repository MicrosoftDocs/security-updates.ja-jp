---
TOCTitle: 'MS01-022'
Title: 'マイクロソフト セキュリティ情報 MS01-022 - 緊急'
ms:assetid: 'ms01-022'
ms:contentKeyID: 61228369
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms01-022(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS01-022 - 緊急
===============================================

WebDAV Service Provider によりスクリプトがユーザーとしてリクエストを行う
------------------------------------------------------------------------

公開日: 2001年4月19日 | 最終更新日: 2001年7月4日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**  
Microsoft のオペレーティング システムを使用しているユーザー

**脆弱性の影響** **:**    
Web ベースのスクリプトがユーザーに代わって WebDAV リクエストを行う

**推奨する対応策** **:**  
FAQ よく寄せられる質問を参考にして、使用中のバージョンが該当するかどうかを確認して下さい。該当するバージョンを使用しているお客様はこの更新プログラムを適用して下さい。

**影響を受けるソフトウェア** **:**

-   Microsoft Windows® 95
-   Microsoft Windows 98
-   Microsoft Windows 98 Second Edition
-   Microsoft Windows Me
-   Microsoft Windows NT® 4.0
-   Microsoft Windows 2000

### 詳細

問題
----

**技術的な説明** **:**  
Microsoft Data Access Component Internet Publishing Provider はインターネット経由での WebDAV リソースへのアクセスを提供します。仕様上、ユーザーによるリクエストと、ユーザーのブラウザで実行されているスクリプトによるリクエストは区別されます。しかし、実装上の問題のため、全てのリクエストがユーザーのセキュリティ コンテキストで処理されます。このため、ユーザーがスクリプトを含む Web ページを参照したり、HTML 形式の電子メールを開くと、そのスクリプトがユーザーとして Web ベースのリソースにアクセスします。

この脆弱性を利用して攻撃者が実行できる操作は、ユーザーに利用可能な Web ベースのリソースやそのリソースに対するユーザーの権限によります。しかし、少なくとも攻撃者はユーザーのイントラネットを参照することができます。また Web ベースの電子メールにアクセスできる可能性もあります。

**問題を緩和する要素** **:**

-   攻撃者が攻撃を行うためには、サーバー名、フォルダの構成、他のユーザーやネットワークに関する情報など、充分な内部情報が必要となります。したがって、この脆弱性は内部からの攻撃の一部として利用される可能性が最も高くなります。
-   WebDAV リクエストの認証方法のため、この脆弱性はスタンドアロン マシンに対して利用することはできません。
-   スクリプトが開かれたセキュリティ ゾーンでアクティブ スクリプトが無効にされている場合、この脆弱性を利用することはできません。

**脆弱性識別番号** **:**  
[CAN-2001-0238](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0238)

**テストしたバージョン** **:**  
マイクロソフトは 8.103.2519.0 またはそれより前の全てのバージョンの Microsoft Data Access Component Internet Publishing Provider のテストを行い、この脆弱性による影響を評価しました。

よく寄せられる質問
------------------

**どのようなことが起こる可能性がありますか?**

この脆弱性のため、攻撃者は別のユーザーのイントラネットにある情報にアクセスすることができます。特に、攻撃者が別のユーザーに特定の Web ページを訪問したり、特定の HTML 形式の電子メールを開くように誘導した場合、攻撃者はそのユーザーが読み取り、変更そして追加を行うことのできるデータに対し、同様な権限を取得することができます。  

この脆弱性を利用することは困難です。この脆弱性を利用するためには、攻撃者はそのユーザーやネットワークに関する十分な内部情報を知っている必要があるからです。ほとんどの場合、この脆弱性は内部からのみ利用される可能性があります。

**何が原因で起こりますか?**

この脆弱性は Web ベースのリソースへのリモート アクセスを可能にするために使用されるコンポーネントがドメインの制限を適切に行わないために起こります。Web サイトの HTML コード、または HTML 形式の電子メールがブラウザ内で動作すると、ユーザーのセキュリティ コンテキストを使用してリクエストが行われる可能性があります。

**ここで問題となっているコンポーネントとは何ですか?**

このコンポーネントの名前は Microsoft Data Access Component Internet Publishing Provider です。このコンポーネントは WebDAV （Web Distributed Authoring and Versioning） をサポートする役割を果たします。

**WebDAV　とは何ですか?**

WebDAV は、インターネット ベースの共有ファイル システムを使用して、複数のユーザーが文書を共同作業することを可能にするインターネット標準です。これは文書に競合する変更が行われた場合の、ファイルへのアクセス権、オフラインでの編集、ファイルの整合性、競合の解消などの問題を解決します。WebDAV は共有ファイルを保存する中心となる位置として、インターネットやイントラネットを使用することで、企業のインフラストラクチャを拡張します。

**Provider** **はどの製品に同梱されていますか?**

Provider は WebDAV をサポートし、WebDAV はマイクロソフト製品が提供している多くの Web ベースのコラボレーション機能の基礎となる技術であるため、Provider は様々なマイクロソフト製品によりインストールされます。これは Windows Me および Windows 2000 の一部として提供され、他のマイクロソフト製品と同様に、Office の最近のバージョンによってもインストールされます。下記に使用中のマシンに該当するバージョンがインストールされているかどうかを確認する方法について説明します。

**Provider** **の何が問題になっていますか?**

Provider は WebDAV リクエストのソースを認識する必要があります。そして、それに応じて実行可能な操作を制限します。特に、スクリプトにより行われたリクエストと、ユーザーにより行われたリクエストを別の方法で処理しなければなりません。

**スクリプトを介して行われたリクエストはなぜ別の方法で処理されなければならないのですか?**

スクリプトは、Web サイトや HTML 形式の電子メールなど、外部のソースからのものであっても、ローカル マシンで実行されます。例えば、ユーザーが Javascript を含む Web ページを訪問した場合、スクリプトがそのユーザーのマシンにダウンロードされ、ローカルで実行されます。しかし、明らかに、このようなスクリプトはユーザーの代わりとなって任意の操作を行うべきではありません。

一般的に、ブラウザはそのソースごとに、スクリプトが適切な操作だけを行うようにします。仕様上、スクリプトは WebDAV リクエストを行うことができます。しかし、もちろんスクリプトが実行できる操作は厳しく制限されています。この脆弱性は Provider がこれらの操作を適切に制限せず、外部のソースからのスクリプトを、ユーザーがリクエストしたスクリプトとして実行するために起こります。

**この脆弱性を利用して攻撃者は何ができますか?**

攻撃者がユーザーにスクリプトを含む Web ページや HTML 形式の電子メールを開くように誘導した場合、攻撃者はそのユーザーとして WebDAV リクエストを行うことができます。これにより、攻撃者は WebDAV を介してそのユーザーに可能な任意の操作を行うことができます。

**ユーザーは** **WebDAV** **を介して、どのような操作を行うことができますか?**

利用可能な Web ベースのリソース数やユーザーの権限により、システムごとに異なります。しかし、少なくとも、この脆弱性により、スクリプトがユーザーとしてイントラネット サイトにアクセスすることができます。また Web ベースのメールにアクセスすることもできます。

**この脆弱性は容易に利用できるのですか？**

攻撃者が、自分の Web ページ、または HTML 形式の電子メールからのスクリプトをユーザーが実行するように誘導できたと仮定しても、この脆弱性を利用するのは依然として困難です。攻撃者は、攻撃するリソースがあるサーバーの名前とフォルダの構成を正確に知る必要があります。また攻撃者は、リクエストを正確に作成するために、ユーザーに関する情報が必要になります。この脆弱性を利用するためには、攻撃者はサイトに関する情報が多く必要なので、攻撃者は例えば不満を持った従業員などの内部者である可能性が高いといえます。

**この脆弱性を利用する方法に何か別の制約はありますか?**

はい、あります。WebDAV リクエストの認証方法のため、この脆弱性は、ワークグループまたはドメイン メンバのマシンに対してのみ利用することができ、スタンドアロン マシンに対して利用することはできません。

**この更新プログラムは何を修正しますか?**

この更新プログラムは、 Provider が、スクリプトを介しての WebDAV リクエストを制限できるように修正し、この脆弱性を排除します。具体的には、Provider ができるのは、特定の Web サイトとフォルダが作成されたサイト内のフォルダの代わりにスクリプトがリクエストを処理することのみです。

**更新プログラムが必要であるかはどのようにして分かるのですか?**

最も簡単なチェック方法は Provider のバージョン番号を確認する方法です。以下の手順でバージョン番号を確認してください。

1.  \[スタート\] メニューから、\[検索\]、次に \[ファイルやフォルダ\] を選択します。
2.  \[検索をする文字の名前\] フィールドに msdaipp.dll と入力し、\[検索開始\] ボタンをクリックします。
3.  msdaipp.dll がマシン上に存在しない場合、使用しているマシンがこの脆弱性の影響を受けておらず、更新プログラムは必要ありません。
4.  msdaipp.dll がマシン上に存在する場合、検索ウィンドウのファイル上で右クリックをし、\[プロパティ\]、次に \[バージョン\] を選択します。下記の表で、この脆弱性があるバージョンを使用しているか確認して下さい。

| バージョン番号       | ステータス     |
|----------------------|----------------|
| 8.102.1403.0         | 影響を受ける   |
| 8.103.2402.0         | 影響を受ける   |
| 8.103.2519.0         | 影響を受ける   |
| 他の全てのバージョン | 影響を受けない |

**Provider** **は多くのマイクロソフト製品に同梱されているとのことですが、更新プログラムを適用し、その後** **Provider** **の脆弱性の影響を受けるバージョンをインストールする製品をインストールした場合、その後更新プログラムを再度インストールする必要がありますか?**

いいえ、必要ありません。マイクロソフト製品では、バージョン番号を考慮しており、新しいバージョンの上に古いバージョンが上書きされることはありません。この更新プログラムをインストールした場合、どんな製品をインストールしたとしても脆弱性のあるバージョンに戻ることはありません。

更新プログラム
--------------

-   影響を受けるすべての製品 :  
    [https://www.microsoft.com/download/details.aspx?FamilyId=046E5A26-54D8-4AAB-B3B1-0050C267C2B2&displaylang=en](https://www.microsoft.com/download/details.aspx?familyid=046e5a26-54d8-4aab-b3b1-0050c267c2b2&displaylang=en)

#### 更新プログラムに関する追加情報  

**更新プログラムのインストール確認方法** **:**  
この更新プログラムがマシンにインストールされたことを確認するためには、msdaipp.dll　のバージョン番号が、よく寄せられる質問の 「更新プログラムが必要であるかはどのように分かるのですか?」の項目に記載されている 3 つの該当するバージョン番号のうち、いずれでもないことを確認して下さい。

**警告** **:**  
なし

**ローカライズ** **:**  
この更新プログラムは該当するプラットフォームの全ての言語バージョンに使用することができます。

**他のセキュリティ更新プログラムの入手先** **:**  
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](https://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](https://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](https://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報  

**詳細情報** **:**  

-   US マイクロソフトセキュリティ情報（MS01-022）  
    [https://www.microsoft.com/technet/security/bulletin/ms01-022.mspx](https://technet.microsoft.com/security/bulletin/ms01-022)
-   サポート技術情報 （KB） 文書番号 ： 296441  
    [WebDAV でユーザー コンテキストでスクリプトが実行されてしまう](https://support.microsoft.com/kb/296441)

**更新履歴** **:**

-   2001/4/19: このセキュリティ情報ページを公開しました。  
-   2001/7/4: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*