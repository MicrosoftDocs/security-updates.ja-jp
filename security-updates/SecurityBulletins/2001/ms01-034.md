---
TOCTitle: 'MS01-034'
Title: 'マイクロソフト セキュリティ情報 MS01-034 - 緊急'
ms:assetid: 'ms01-034'
ms:contentKeyID: 61228393
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms01-034(v=Security.10)'
---


マイクロソフト セキュリティ情報 MS01-034 - 緊急
===============================================

不正な Word 文書が自動的にマクロを実行する
------------------------------------------

公開日: 2001年6月25日 | 最終更新日: 2001年7月11日

#### 概要 :

**このセキュリティ情報の対象となるユーザー:**  
Microsoft® Word を使用しているお客様

**脆弱性の影響 :**  
警告なしでマクロが実行される

**推奨する対応策:**  
影響を受ける Word のバージョンを使用しているお客様はこの更新プログラムを適用して下さい。

**影響を受けるソフトウェア:**  

-   Microsoft Word 2002
-   Microsoft Word 2000
-   Microsoft Word 97
-   Microsoft Word 98 (日本語版)
-   Microsoft Word 2001 for Mac
-   Microsoft Word 98 Macintosh Edition

### 詳細

問題
----


**技術的な説明:**  
Word は、他の Office ファミリー製品と同様に、マクロを実行する際にユーザーの承諾が必要なセキュリティ メカニズムを提供しています。仕様上、文書が開かれる際には、Word は常にその文書にマクロが含まれていないかスキャンします。マクロが発見された場合、マクロはユーザーのセキュリティ設定に従って処理されます。Word 2000 および 2002 の既定では、信頼される発行元によって署名されたマクロのみが有効になり、そうでないものは全て無効になります。Word 97 では、文書にマクロが含まれている場合、マクロを有効にするかをユーザーに確認する画面が表示されます。

セキュリティ スキャナが、組み込まれたマクロを実行できるようにしながら、マクロを認識できないように Word 文書を変更できる可能性があるために脆弱性が発生します。この脆弱性を利用すると、攻撃者はこのような文書が開かれた際に、自動的にマクロが実行されるようにすることができます。このようなマクロによって、ユーザーが実行可能なあらゆる操作を実行される可能性があります。ユーザーの Word のセキュリティ設定を無効にし、その後開いた Word 文書でマクロのチェックが行われなくなる可能性もあります。

お客様の多くは、既にこの脆弱性から保護されています。具体的には、マイクロソフトセキュリティ情報 [MS01-028](https://technet.microsoft.com/security/bulletin/ms01-028) で提供されている Word 2000、Word 97、Word 98 (日本語版)、Word 2001 for Mac、Word 98 Macintosh Edition のための更新プログラムが、MS01-028 で説明している脆弱性とここで説明している脆弱性の両方を排除します。MS01-028 で提供されている更新プログラムを適用されたお客様は、特にほかの対策を講じる必要はありません。Word 2002 には MS01-028 で説明されている脆弱性による影響はありません。したがって Word 2002 をご使用のお客様は、下の更新プログラムを適用してください。

**問題を緩和する要素:**  

-   Word 2002 以外の影響を受ける製品をご使用で、マイクロソフトセキュリティ情報 [MS01-028](https://technet.microsoft.com/security/bulletin/ms01-028) で提供された更新プログラムを適用されたお客様は、この脆弱性からは既に保護されています。
-   この脆弱性は Word のみに影響を及ぼします。他の Office 製品には影響はありません。
-   Outlook 電子メール セキュリティ アップデート （Word 2002 に含まれる） をご利用のお客様は、Word 文書に含まれるすべてのワーム ウイルスから保護されます。

**脆弱性識別番号:**  
[CAN-2001-0501](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0501)

**テストしたバージョン:**  
マイクロソフトは Word 2002、Word 2000、Word 97、Word 98 （日本語版）、Word 98 Macintosh Edition、Word 2001 for Mac のテストを行い、この脆弱性による影響を評価しました。それより前のバージョンに関してはサポートしておらず、この脆弱性による影響は不明です。

よく寄せられる質問
------------------


**どのようなことが起こる可能性がありますか?**

攻撃者はこの脆弱性を利用して、Word で開くとユーザーの許可無しでマクロを実行してしまう文書を作成することができます。マクロはユーザーが実行可能なあらゆる操作を実行することができ、攻撃者はこの脆弱性を利用して、結果的にデータの変更、Web サイトとの通信、ハード ディスクの再フォーマット、Word のセキュリティ設定の変更などができるようになる可能性があります。

この脆弱性は Word のみに影響を及ぼします。ほかの Office ファミリー製品にはこの脆弱性による影響はありません。

**この脆弱性の原因は何ですか?**

この脆弱性は、Word の通常のマクロのセキュリティ スキャンをすり抜けることができるような Word 文書を作成することが可能なために発生します。

**マクロとは何ですか?**

一般的には、マクロとは、オペレーティング システムまたはアプリケーション内でよく実行されるタスクを自動化する小さなプログラムのことを指します。例えば、Office ファミリー製品はすべてマクロを使用することができます。マクロを使用することによって、例えばある会社内で、Word、Excel ほかのプログラム内で実行できる生産性の高いツールとして使用できるマクロを開発することができます。

しかしマクロは、ほかのコンピュータ プログラムと同様に、不正に使用される可能性があります。特に、Office 製品は広く普及しているため、多量のウイルスがマクロとして書きこまれ、Office 文書内に埋め込まれてしまいます。この脅威に対抗するために、Office では、セキュリティ モデルが開発されており、ユーザーが必要な場合にのみマクロが実行されるように設計されています。しかし、この場合不正な文書を開く際に発生する、セキュリティ モデルの弱点があります。

**Wordがマクロをスキャンする方法の何が問題になっていますか?**

Word は仕様上、組み込まれたマクロが認識できなくなるような Word 文書の変更は、マクロが実行できないため、マクロが破損してしまいます。しかしある特定の場合において、これが当てはまらないためにこの脆弱性が発生します。つまり、Word 文書に組み込まれているマクロが Word のセキュリティ機構によってマクロと認識されないように Word 文書を改ざんすることができます。しかし、マクロを実行する Word の一部はマクロを認識し、実行します。

Word 上で、直接このような文書を作成することはできません。攻撃者は必要な不正を引き起こすために、正規の Word 文書に低レベルの編集を行う必要があります。

**このことにより攻撃者は何をする可能性がありますか?**

攻撃者はこの脆弱性を利用して、通常の Word セキュリティ モデルをすり抜ける可能性があります。具体的には、攻撃者がマクロを含む不正な文書を作成し、その Word ファイルを開くようにほかのユーザーを誘導できた場合、ユーザーの許可を得ないで、そのファイル内のマクロが実行される可能性があります。

**そのマクロによってどんな操作を実行できますか?**

そのマクロによってユーザーがマシン上で実行できるすべての操作が可能になります。ファイルの追加、変更、削除、Web サイトとの通信、ハード ディスクの再フォーマットなどが実行できるようになります。

マクロによってユーザーのセキュリティ設定も変更される可能性があることに注意してください。マクロの保護を無効にすることもできます。その結果、ユーザーがこの脆弱性による攻撃を受けた場合、ユーザーのセキュリティ設定が下げられたり、通常ならば Word によって止められるはずのマクロが実行されてしまう可能性があります。

**攻撃者はどのようにしてその文書をほかのユーザーに渡しますか?**

攻撃者には様々な方法があります。攻撃者はマクロを組み込んだ文書を Web サイトにホストしたり、シェアに十分なアクセス権を持つ場合には、そこに保存します。同様に、攻撃者はある特定のユーザーを標的にして、電子メールを利用してそのような文書を送信したり、フロッピー ディスクを使ってそのユーザーに渡したりする可能性があります。

**この脆弱性はWord以外のOffice製品に影響を及ぼしますか?**

いいえ。ほかの Office アプリケーションでもマクロを使用しますが、この脆弱性による影響を受けるのは Word のみです。

**マイクロソフト セキュリティ情報MS01-028で提供された更新プログラムもこの脆弱性を排除するそうですが、本当ですか?**

はい、その通りです。MS01-034 で提供された更新プログラムは、今回 Word 2002 以外の全ての該当する製品用に提供された更新プログラムと同じものです。(Word 2002 は MS01-028 で説明されている脆弱性による影響を受けないため、MS01-028 では Word 2002 用の更新プログラムは提供されていません。) このため、MS01-028 で提供された更新プログラムを適用した場合、このセキュリティ情報で説明されている脆弱性に対して、システムを保護するための対応策を講じる必要はありません。

**更新プログラムは何を修正しますか?**

この更新プログラムは、上記で説明したような不正な変更が行われた文書が開かれる際に、正常にマクロのチェックが行われるように修正し、この脆弱性を排除します。

**Word 98(日本語版)とは何ですか?**

Word 98 (日本語版) は日本語版のみがリリースされている Word のバージョンです。ほかの言語のバージョンでは、Word 97 のあとはすぐに Word 2000 があり、Word 98 は存在しません。しかし、日本語の特別なケースとして、Word 97 と Word 2000 の間にリリースされたバージョンが Word 98 (日本語版) です。

更新プログラム
--------------


この問題に対する日本語版更新プログラムは、以下のサイトからダウンロードできます。

-   Microsoft Word 2002:
    <https://office.microsoft.com/japan/downloads/2002/wrd1001.aspx>
-   Microsoft Word 2000:
    <https://office.microsoft.com/japan/downloads/2000/wd2kmsec.aspx>
-   Microsoft Word 97:
    [https://office.microsoft.com/japan/downloads/9798/Wd97mcrs.aspx](https://office.microsoft.com/japan/downloads/9798/wd97mcrs.aspx)
-   Microsoft Word 98 (日本語版):
    [https://office.microsoft.com/japan/downloads/9798/Wd98mcrs.aspx](https://office.microsoft.com/japan/downloads/9798/wd98mcrs.aspx)
-   Microsoft Word 2001 for Mac:
    <https://www.microsoft.com/japan/mac/security/>
-   Microsoft Word 98 Macintosh Edition:
    <https://www.microsoft.com/japan/mac/security/>

#### 更新プログラムに関する追加情報

**対象プラットフォーム:**  

-   Word 2002 の更新プログラムは Word 2002 を実行しているシステムにインストールすることができます。
-   Word 2000 の更新プログラムは Word 2000 Service Release 1 または Service Pack 2 を実行しているシステムにインストールすることができます。
-   Word 97 の更新プログラムは Word 97 または Word 97 のいずれかの Service Release を実行しているシステムにインストールすることができます。
-   Word 98 (日本語版) の更新プログラムは Word 98 (日本語版) または Word 98 (日本語版) のいずれかの Service Release を実行しているシステムにインストールすることができます。
-   Word 2001 for Mac の更新プログラムは Microsoft Office 2001 SR1 アップデータを実行しているシステムにインストールすることができます。
-   Word 98 Macintosh Edition の更新プログラムは Microsoft Office 98 アップデータ 2 を実行しているシステムにインストールすることができます。

**今後リリースされるサービス パックに含まれる更新プログラム:**  
この問題に対する更新プログラムは Word 2002 Service Pack 1 に含まれています。その他の該当の製品のサービスパックまたはサービスリリースの予定はありません。

**再起動の必要性:**  
なし

**更新プログラムに含まれる過去の修正:**  
ここで提供されている更新プログラムは、マイクロソフトセキュリティ情報 [MS01-028](https://technet.microsoft.com/security/bulletin/ms01-028) で提供されている更新プログラムとまったく同一なものです。唯一の例外は、Word 2002 の場合で、Word 2002 は MS01-028 の脆弱性による影響は受けません。そのため MS01-028 では、Word 2002 の更新プログラムは提供されていません。

**更新プログラムのインストール確認方法:**  

-   Word 2002:
    Winword.exe のバージョンが 10.2930.2625 であることを確認してください。
-   Word 2000:
    Winword.exe のバージョンが 9.00.00.5302 であることを確認してください。
-   Word 98 (日本語版):
    Winword.exe のバージョンが 8.0.0.8923 であることを確認してください。
-   Word 97:
    \[ヘルプ\] メニューの Word 97 のバージョン情報で （QFE 6309） を確認して下さい。
-   Word 2001 for Mac:
    ［ヘルプ］ メニューから Microsoft Word の \[バージョン情報］ を選択し、バージョン情報が 「Word 9.0.2 (3411)」 以降であることを確認して下さい。
-   Word 98 Macintosh Edition:
    ［ヘルプ］ メニューから Microsoft Word の \[バージョン情報］ を選択し、バージョン情報が 「Word 8.0 (8823)」 以降であることを確認して下さい。

**警告:**  
なし

**他のセキュリティ更新プログラムの入手先:**  
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](https://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   Windows ユーザーの方におかれましては、コンシューマー プラットフォーム用の更新プログラムを [Microsoft Update](https://update.microsoft.com/microsoftupdate/) Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](https://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報:**  

-   US マイクロソフトセキュリティ情報（MS01-034）
    [https://www.microsoft.com/technet/security/bulletin/ms01-034.mspx](https://technet.microsoft.com/security/bulletin/ms01-034)
-   サポート技術情報 （KB） 文書番号 ： 302294
    [\[WD2002\] 不正な Word 文書が自動的にマクロを実行する](https://support.microsoft.com/kb/302294)

**更新履歴:**  

-   2001/6/25: このセキュリティ情報ページを公開しました。
-   2001/7/2: セキュリティ情報を更新し、ここで提供している更新プログラムが MS01-028 で提供した更新プログラムと Word 2002 の場合を除き、同一であることを明確にしました。
-   2001/7/11: この問題に対する、Microsoft Word 97 および Microsoft Word 98 (日本語版) の日本語版更新プログラムを公開しました。また、この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
