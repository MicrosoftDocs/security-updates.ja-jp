---
TOCTitle: 'MS02-004'
Title: 'マイクロソフト セキュリティ情報 MS02-004 - 警告'
ms:assetid: 'ms02-004'
ms:contentKeyID: 61228429
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-004(v=Security.10)'
---


マイクロソフト セキュリティ情報 MS02-004 - 警告
===============================================

Telnet Server に含まれる未チェックのバッファにより、任意のコードが実行される
----------------------------------------------------------------------------

公開日: 2002年2月8日 | 最終更新日: 2002年2月25日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**  
Microsoft® Windows® 2000 または Microsoft® Interix 2.2 を使用しているシステム管理者

**脆弱性の影響** **:**  
サービス拒否、攻撃者の選択したコードが実行される可能性がある

**最大深刻度** **:**  
中

**推奨する対応策** **:**  
システム管理者は該当する Telnet Service を提供するすべてのシステムに更新プログラムを適用してください。

**影響を受けるソフトウェア** **:**

-   Microsoft Windows 2000 の Telnet Service
-   Microsoft Interix 2.2 の Telnet Daemon (この製品は、英語版のみで日本語版はありません)

### 詳細

問題
----


**技術的な説明** **:**  
Telnet プロトコルはリモート シェル機能を提供しています。マイクロソフトはいくつかの製品に Telnet Server を提供し、 Telnet プロトコルを実装しています。これらの製品に Windows 2000 および Interix 2.2 がありますが、これらの製品の実装には、Telnet プロトコル オプションのプロセスを処理するコードに未チェックのバッファが含まれています。  
この脆弱性を利用して、攻撃者はバッファのオーバーフロー攻撃を行うことができます。攻撃が成功すると、Telnet Server が異常終了する可能性があります。また、攻撃者が選択したコードがシステムで実行される可能性もあります。そのようなコードは Telnet サービスのセキュリティ コンテキストを使用して実行されます。しかしそのコンテキストは製品により異なります。Windows 2000 では Telnet Service は常に System として実行されます。Interix の実装では、管理者によってインストール プロセスの一部として実行されるセキュリティ コンテキストが選択されます。  

**問題を緩和する要素** **:**

-   Windows 2000 の Telnet Service は既定でインストールされますが、既定では実行されません。したがって、管理者がサービスを起動していた場合のみ、Windows 2000 システムは、この脆弱性の影響を受けます。
-   リモートでこの脆弱性を利用するためには、攻撃者は Telnet Server に接続できる必要があります。セキュリティ上の対策として、管理されていないネットワークでは Telnet へのアクセスを許可しないことを推奨します。
-   Interix 2.2 がインストールされる場合、Interix 2.2 の Telnet Daemon は既定ではインストールされません。管理者がこの機能のインストールおよび設定を選択する必要があります。
-   Interix の Telnet Daemon は既定ではセキュリティ コンテキストを指定しません。管理者が Telnet Daemon を設定または実行する時に、セキュリティ コンテキストを指定する必要があります。セキュリティ上の対策として、Telnet Daemon は最も特権の少ないコンテキスト、つまり、必要最小限の権限を持つセキュリティ コンテキストで実行することを推奨します。

**深刻度** **:**

|                                                      | インターネット サーバー | イントラネット サーバー | クライアント システム |
|------------------------------------------------------|-------------------------|-------------------------|-----------------------|
| **Microsoft Windows 2000** **の** **Telnet Service** | 中                      | 中                      | 中                    |
| **Microsoft Interix 2.2** **の** **Telnet Daemon**   | 低                      | 低                      | 低                    |

上記の[評価](http://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形態およびこの脆弱性がシステムに及ぼす影響に基づいています。Windows 2000 Telnet Service の場合、サービスは既定では実行されないため、既定のインストールはこの脆弱性の影響を受けません。Interix Telnet Daemon の場合、これは既定でインストールされず、管理者による特定のセキュリティ設定が必要となります。最小限の特権管理のセキュリティ対策を講じることにより、脆弱性が影響を及ぼす範囲を制限します。

**脆弱性識別番号** **:**  
[CAN-2002-0020](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0020)

**テストしたバージョン** **:**  
マイクロソフトは Windows XP、Windows 2000、Services for UNIX 2.0 および Interix 2.2 のテストを行い、これらの脆弱性による影響を評価しました。Windows NT 4.0 にはTelnet server が同梱されていないため、テストは行われませんでした。それより前のバージョンに関してはサポートの対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------


**どのようなことが起こる可能性がありますか?**

これはマイクロソフトの 2 つの製品に影響を及ぼす [バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。すなわち、Windows 2000 の Telnet Service および Microsoft Interix 2.2 の Telnet Daemon (telnetd) です。攻撃者は特に不正なリクエストを Telnet サーバーに送信し、次のいずれかの結果をもたらす可能性があります。単純なケースでは、Telnet サーバーが異常終了します。より複雑なケースでは、この脆弱性により、攻撃者はシステム上で任意のコードを実行することができます。  
最善策として、Telnet を十分に信頼するネットワーク上でのみ使用することが強く推奨されます。Telnet はインターネットで使用するべきではなく、また、外部からのTelnet 接続はファイアウォールでブロックされるべきです。Windows 2000 および Interix は両者とも既定の条件下ではこの脆弱性の影響を受けません。  

**何が原因で起こりますか?**

この脆弱性は Telnet プロトコル オプションを処理するコードの一部に未チェックのバッファが含まれるために発生します。悪意のあるユーザーは、ある特定の不正なパケットを提出することによりバッファをオーバーランさせる可能性があります。

**Telnet** **とは何ですか?**

[Telnet](http://www.ietf.org/rfc/rfc0854.txt) （英語情報） はユーザーが Telnet サーバー上でリモート ターミナル セッションを確立することができる業界標準のプロトコルです。これはターミナル セッションのため、コマンドライン インターフェースのみが利用されます。Telnet は主にコマンド プロンプトから単純なリモート管理に使用されます。  
いくつかのマイクロソフト製品にはこの Telnet プロトコルの実装が含まれています。しかし、ここで問題になっている脆弱性はこれらの実装の中の Microsoft Interix および Windows 2000 の 2 種類のみに影響を及ぼします。  

**Microsoft Interix** **とは何ですか?**

[Microsoft Interix](http://www.microsoft.com/windows2000/interix/) （英語情報） は、ユーザーが Windows システム上で UNIX アプリケーションの実行が可能になる製品です。この機能により、Windows 2000 の標準 POSIX サブシステムを超える 拡張されたUNIX 環境サブシステムが提供され、UNIX アプリケーション、デーモンおよびスクリプトのサポートが拡張されます。この機能により、ユーザーは、Windows NT および Windows 2000 上で UNIX アプリケーション、デーモン、スクリプトを実行できるようになります。  

**デーモンとは何ですか?**

UNIX では、Telnet のようなネットワーク サービスをデーモンと呼びます。サービスの実際のプログラムに、"-d" で終る名前を付け、それがデーモンであることを示すことがあります。  
Interix の Telnet サーバーは、 Win-32 プログラムではなく実際には UNIX のプログラムで、厳密にはデーモンと呼ばれます。この場合、問題のプログラムは、/bin/telnetd および /usr/sbin/in.telnetd. といったものです。  

**この脆弱性を利用して攻撃者は何ができますか?**

攻撃者は大量のデータでバッファをオーバーランさせることを試みる可能性があります。攻撃者が攻撃するのに十分な量のランダム データを送信した場合、攻撃者は Telnet サーバーを異常終了させることができます。攻撃者が、綿密に作成したデータを送信した場合、Telnet サーバーのプロセス スペースで攻撃者の任意のコードを実行することができる可能性があります。

**攻撃者が悪意のあるコードのロードに成功した場合、どのセキュリティコンテキストで実行されますか?**

コードは Telnet サービスと同じコンテキストで実行されます。そのコンテキストは製品によって異なります。  
Windows 2000 Telnet Service では、コードは SYSTEM コンテキスト内で実行されます。これにより、攻撃者はオペレーティング システムと同じ権限でコマンドを実行することができます。これはこのコードにより、ハード ドライブの再フォーマット、SYSTEM 特権でリモート コマンド シェルの作成、プログラムのインストール、システムのシャット ダウンを含むすべての操作を実行できることを意味します。  
Interix の Telnet Daemon では、コードが実行されるコンテキストは telnetd の設定時の管理者の選択によって異なります。管理者は telnetd を開始する際、または telnetd を自動で起動するように設定する際に telnetd が実行されていたコンテキストを指定します。したがって、この脆弱性の利用が成功し、ロードされたすべてのコードは、管理者が、telnetd の実行を決定したコンテキストで実行されます。Telnetd が SYSTEM コンテキストで実行されるように設定された場合、悪意のあるコードはそのコンテキストで実行され、オペレーティング システムの一部として動作することができます。または、管理者が telnetd を特別に制限したアカウントのコンテキストで実行するように設定した場合、悪意のあるコードはそのコンテキストの範囲内でのみ実行される可能性があります。  

**攻撃者はこの脆弱性を利用してどのように攻撃を仕掛ける可能性がありますか?**

攻撃者はこの Telnet Service へ不正なパケットを送信することによってこの脆弱性を利用した攻撃を試みる恐れがあります。Telnet Service に接続できるユーザーはだれでもこの脆弱性を利用する可能性があります。

**攻撃者はインターネット上でこの脆弱性を利用することができますか?**

Telnet サーバーがインターネット上でアクセスできる場合、攻撃者はこの脆弱性を利用してサーバーに攻撃を仕掛けることができます。しかし、ほとんどの企業では適切な対策としてファイアウォールで Telnet アクセスをブロックしています。また、ほとんどの企業では、適切な対策として DMZ の Telnet を禁止しています。これらのステップにより、インターネットでこの脆弱性の危険性を排除することができます。

**更新プログラムは何を修正しますか?**

この更新プログラムは、データ入力のチェックを適切に行うようにし、この脆弱性を排除します。

**だれがこの更新プログラムを適用する必要がありますか?**

Windows 2000 Telnet Service を実行しているすべてのユーザーまたは Interix で Telnet Daemon (telnetd) を実行しているすべてのユーザーがこの更新プログラムを適用する必要があります。

**Services for UNIX 2.0** **で** **Telnet Server** **を使用しています。この更新プログラムを適用する必要がありますか?**

いいえ、Services for UNIX 2.0 の Telnet Server にはこの問題はありません。

**Telnet Service for Windows 2000** **をインストールしていますが、実行はしていません。更新プログラムを適用する必要がありますか?**

Telnet をインストールしているがサービスを使用していない場合、最善策として、サービスをまず削除することを推奨します。サービスを削除しない場合、更新プログラムを適用することをお勧めします。

**Windows 2000 Professional** **を実行しています。この脆弱性の影響を受けますか?**

Windows 2000 Professional は既定で Telnet Service for Windows 2000 がインストールされますが、実行されません。Windows 2000 Professional を実行しているお客様は、サービスが有効にされた場合に保護されるようにこの更新プログラムを適用してください。

更新プログラム
--------------


この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft Windows 2000 の Telnet Service
    この問題に対する修正は Windows 2000 Service Pack 3 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

    <http://www.microsoft.com/japan/windows2000/downloads/>
    -   なお、この問題に対する個別更新プログラムは次のサイトからダウンロードできます。

        -   PC/AT 互換機用 :
            <http://download.microsoft.com/download/win2000platform/patch/q307298/nt5/ja/q307298_w2k_sp3_x86_ja.exe>
        -   NEC PC-9800シリーズ用 :
            <http://download.microsoft.com/download/win2000platform/patchnec/q307298/nt5/ja/q307298_w2k_sp3_nec98_ja.exe>
    -   さらに、この問題に対する修正は [Windows 2000 Security Rollup Package 1](http://support.microsoft.com/kb/311401) に含まれています。
-   Microsoft Interix 2.2:
    この製品は、英語版のみで日本語版はありません。英語版更新プログラムは次のサイトで入手できます。

    [http://www.microsoft.com/downloads/details.aspx?FamilyID=06fa6186-d0b6-4918-af11-3aed00127dc6&DisplayLang=en](http://www.microsoft.com/downloads/details.aspx?familyid=06fa6186-d0b6-4918-af11-3aed00127dc6&displaylang=en)

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**

-   Windows 2000:
    この更新プログラムは Windows 2000 Service Pack 1 または Windows 2000 Service Pack 2 を実行しているシステムにインストールすることができます。
-   Interix 2.2:
    この更新プログラムは Microsoft Interix 2.2 を実行しているシステムにインストールすることができます。

**この修正を含む予定のサービスパック** **:**

-   Windows 2000 の Telnet Service の問題に対する更新プログラムは Windows 2000 Service Pack 3 に含まれています。

**再起動の必要性** **:**  
なし

**更新プログラムに含まれる過去の修正** **:**  
[MS01-039](http://technet.microsoft.com/security/bulletin/ms01-039)

**更新プログラムが正しくインストールされたか確認する方法** **:**

-   Interix 2.2 :
    in.telnetd バイナリのバージョンが 2.2.428.1 であることを確認して下さい。
-   Windows 2000 の Telnet Service :
    Tlntsvr.exe のバージョンが 5.0.33668.1 であることを確認して下さい。

**警告** **:**  
なし

**他のセキュリティ更新プログラムの入手先** **:**  
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-004）
    [http://www.microsoft.com/technet/security/bulletin/ms02-004.mspx](http://technet.microsoft.com/security/bulletin/ms02-004)
-   サポート技術情報 （KB） 文書番号 ： 307298
    [MS02-004: サービス拒否攻撃に対する Telnet サーバーの脆弱性](http://support.microsoft.com/kb/307298)

**更新履歴** **:**

-   2002/2/8: このセキュリティ情報ページを公開しました。
-   2002/2/25: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
