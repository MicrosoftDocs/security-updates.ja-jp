---
TOCTitle: 'MS02-025'
Title: 'マイクロソフト セキュリティ情報 MS02-025 - 緊急'
ms:assetid: 'ms02-025'
ms:contentKeyID: 61228450
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-025(v=Security.10)'
---


マイクロソフト セキュリティ情報 MS02-025 - 緊急
===============================================

不正なメール属性により Exchange 2000 が CPU リソースを使い果たす (320436)
-------------------------------------------------------------------------

公開日: 2002年5月30日 | 最終更新日: 2002年6月12日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**  
Exchange 2000 を使用しているシステム管理者

**脆弱性の影響** **:**  
サービス拒否

**最大深刻度** **:**  
高

**推奨する対応策** **:**  
システム管理者は Exchange 2000 を実行しているサーバーに更新プログラムを適用してください。

**影響を受けるソフトウェア** **:**

-   Microsoft Exchange 2000

### 詳細

問題
----


**技術的な説明** **:**  
異種システムでのメール送受信をサポートするために、Exchange メッセージでは RFC の 821 および 822 によって指定される SMTP メール メッセージの属性が使用されます。Exchange 2000 が、受信したメール上で、ある不正な RFC メッセージ属性を処理する方法に問題があります。このような不正なメッセージ属性を含むメッセージを受信すると、この問題が原因となり、メッセージを処理する際に利用可能な CPU リソースがストア サービスによってすべて消費されてしまいます。  
攻撃者が、この問題を悪用してサービス拒否の攻撃を仕掛ける可能性があるためにセキュリティ上の脆弱性が発生します。攻撃者は、Exchange サーバーに直接接続し、未処理の、自ら作成した不正な属性のメール メッセージを送信することによって、攻撃を仕掛ける可能性があります。ストア サービスがそのメッセージを受信し、処理すると CPU リソースが急激にすべて消費される可能性があります。攻撃の影響は、Exchange ストア サービスがメッセージを処理する時間続きます。サービスまたはサーバーを再起動しても、このサービス拒否の攻撃の状況を改善することはできません。  

**問題を緩和する要素** **:**

-   この脆弱性による攻撃の影響は、一時的なものです。サーバーでのメッセージの処理が完了すると、通常の操作が回復します。しかし、メッセージの処理が一度始まると、再起動をしても処理を停止させることはできません。
-   この脆弱性が悪用されても、サーバー上のデータが改ざんされたり、サーバーの管理機能が取得されるようにはなりません。
-   攻撃者が攻撃を成功させるためには、自ら作成したメッセージを標的となるシステムに送信できることが必要条件となります。これはほとんどの場合、シミュレートされたサーバーベースの接続を介して行われる可能性があります。Outlook または Outlook Express などの電子メール クライアントを使用して不正なメッセージを作成することはできません。

**深刻度** **:**

|                   | インターネット サーバー | イントラネット サーバー | クライアント システム |
|-------------------|-------------------------|-------------------------|-----------------------|
| **Exchange 2000** | 高                      | 高                      | なし                  |

上記の[評価](https://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。この脆弱性は、認証されていないユーザーによってリモートで利用される可能性があります。また、問題の特質により、サーバーのダウンタイムが長くなる可能性があります。しかし、攻撃者が攻撃を成功させるためには、標的となるシステムに直接接続し、不正なメッセージを送信することが必要条件となります。

**脆弱性識別番号** **:**  
[CAN-2002-0368](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0368)

**テストしたバージョン** **:**  
マイクロソフトは Exchange 5.5 および Exchange 2000 のテストを行い、これらの脆弱性による影響を評価しました。それより前のバージョンに関しては[サポート](https://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------


**どのようなことが起こる可能性がありますか?**

これはサービス拒否の脆弱性です。攻撃者が直接 Exchange 2000 Server に接続を行い、自ら作成した、未処理の電子メール メッセージを直接渡すことができる場合、この脆弱性が悪用され、システムを無応答にされる可能性があります。  
この脆弱性が悪用されても、攻撃者にシステムでの特権を取得されることありません。また、システムのユーザーの電子メールの読み取り、送信、削除が行われることはありません。メッセージが処理されると、システムは通常の状態に戻ります。  

**何が原因で起こりますか?**

この脆弱性は Exchange 2000 が、特定の不正なメッセージ属性を含むメール メッセージを処理する方法に問題が存在するために起こります。不正なメッセージを直ちに拒否する代わりに、Exchange 2000 ストア サービスはそのメッセージの処理を試行します。メッセージ処理の試行中、Exchange 2000 ストア サービスはすべての利用可能な CPU リソースを利用し、この間、サーバーでのそのほかのサービスが機能できないようにします。

**Exchange 2000** **ストアサービスとは何ですか?**

ストアとは Exchange 2000 のコア サービスの 1 つです。ストアは Exchange 2000 のメールボックスおよびパブリック フォルダに含まれる情報に記憶域を提供します。

また、メールボックスやパブリック フォルダ間でのメッセージを配信するためのメッセージ処理機能も提供します。

**メール属性とは何ですか?**

電子メール メッセージはいつくかの標準要素で構成されています。例えば、各メッセージには 「to」 に 「受信者」、「subject」 に件名、またはタイトル、そしてメッセージ本文があります。これらの要素は一般的に属性と呼ばれています。  
Exchange のメール メッセージは、Exchange 以外のシステムへ送信されることもあるため、Exchange は標準化されたメール属性を使用して、これらの要素を表します。これらの標準化された属性を使用することにより、Exchange 以外のシステムが正しく Exchange メッセージを認識し、処理することができます。例えば、標準化された 「to」 属性を使用し、Exchange および Exchange 以外のシステムはメッセージの受信者を認識し、その情報を適切に処理することができます。

[RFC 822](https://www.faqs.org/rfcs/rfc822.html) (英語情報) で、これらの標準化されたメール属性について説明しています。  

**メール属性が** **Exchange 2000** **で処理される方法の何が問題になっていますか?**

Exchange 2000 が特定の方法で不正な形式にされた属性を含むメール メッセージを受け取ると、直ちにそのメッセージを拒否するのではなく、処理を試行します。ストア サービスがメッセージの処理を試行する時、システムの CPU リソースを 100% 利用します。この間、ストアがメッセージを正常に処理するまで、そのほかの処理をシステムで行うことができないため、サービス拒否の状態が発生します。  

**この脆弱性を悪用して攻撃者は何ができますか?**

攻撃者はこの脆弱性を悪用して、故意に Exchange サーバーが、メール サービスやそのほかのサービスを提供できないようにする可能性があります。

**攻撃者はこの脆弱性をどのように悪用する可能性がありますか?**

攻撃者はサーバーへ直接接続を確立し、自ら作成した、不正な属性を含む未処理のメール メッセージを渡すことにより、この脆弱性を悪用する可能性があります。

**「攻撃者がサーバーへ直接接続を確立する」とのことですが、それはどのような意味ですか?**

メールが転送されると、送信を行っているサーバーが直接、受信を行うサーバーに接続します。これらのサーバーが接続すると、メールは送信者から受信者へと直接渡されます。この脆弱性を悪用するには、攻撃者は、標的となるサーバーへ、これと類似した直接接続を行う必要があります。直接接続されると、攻撃者によって不正なメッセージが渡される可能性があります。

**「この脆弱性を悪用するために、攻撃者は自ら作成した、未処理のメッセージを使用する必要がある」とのことですが、これはどのような意味ですか?**

「subject」 など、ユーザーが指定することができるメッセージ属性のほかに、サーバーにより制御されている属性があります。問題はサーバーが制御している、ある属性を処理する方法に影響を及ぼします。このため、攻撃者は標準のメール クライアント (Outlook または Outlook Express) を使用して、悪質なメッセージを作成することはできません。その代わり、攻撃者は未処理のメール メッセージを作成して、そのメッセージをサーバーへ直接接続し、渡すことができなければなりません。

**攻撃はどのくらいの間続くのですか?**

根本的な問題の特質のため、攻撃の影響はシステムがメッセージを完全に、そして正常に処理するまで続きます。攻撃が続く実際の時間の長さはサーバーへ渡されたメッセージにより異なります。

**通常の処理を再開させるために、ストアサービスを再起動することはできますか?**

いいえ、できません。この特定のケースでは、いったんストア サービスがメッセージを受け入れ、処理を開始すると、システムがメッセージを正常に処理するまで、通常のサービスは再開しません。  
これは、メッセージを処理するストア機能には、そのほかのストア操作に対し、順番に関する優先権があるためです。この理由により、再起動後、ストアは直ちにメッセージの処理を開始します。メッセージの処理は CPU リソースの 100% 使用を指示するため、そのメッセージを消去するために通常使用されるそのほかのストア機能を呼び出すことはできません。結果として、不正なメッセージの処理が開始されると、その処理を中止することはできません。ストアは通常通り、不正なメッセージを処理しなければなりません。  

**メールサービスを再開させるために、サーバーを再起動することはできますか?**

いいえ、できません。この場合、再起動することには、サービスを停止し、再起動する場合と同じ影響があります。つまり、ストアは再起動されると、直ちに不正なメッセージの処理を再開します。

**この脆弱性が悪用されるメッセージは偶発的に作成されることはありますか?**

いいえ、ありません。この問題の特質として、この脆弱性が悪用されるメッセージは悪意を持って、特別に作成されるものです。

**攻撃者はこの脆弱性を悪用して、システムの特権を取得することはできますか?** **また、ユーザーのメールを読み取ることはできますか?**

いいえ、できません。この脆弱性が悪用されても、攻撃者は、サーバーの CPU リソースを 100% 占有することのみができます。サーバーでの特権の取得やデータの改ざんはできません。

**この脆弱性は** **Exchange Server 5.5** **に影響を及ぼしますか?**

いいえ。Exchange 5.5 はこの脆弱性の影響を受けません。

**更新プログラムは何を修正しますか?**

この更新プログラムは Exchange 2000 ストアが不正な属性を含むメッセージを直ちに拒否するようにして、この脆弱性を排除します。

更新プログラム
--------------


この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft Exchange 2000 :
    [https://download.microsoft.com/download/exchangeentserver/Patch/06.00.91.5770/NT5/JA/Q320436jpni386.EXE](https://download.microsoft.com/download/exchangeentserver/patch/06.00.91.5770/nt5/ja/q320436jpni386.exe)

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**  
この更新プログラムはMicrosoft Exchange 2000 Service Pack 2 を実行しているシステムにインストールすることができます。

**この修正を含む予定のサービスパック** **:**  
この問題に対する更新プログラムは Exchange 2000 Service Pack 3 に含まれています。

**再起動の必要性** **:**  
なし

**更新プログラムに含まれる過去の修正** **:**  
なし

**更新プログラムが正しくインストールされたか確認する方法** **:**

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。

    HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Updates\\Exchange Server 2000\\SP3\\Q320436
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。

    HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Updates\\Exchange Server 2000\\SP3\\Q320436\\Filelist

**警告** **:**  
なし

**他のセキュリティ更新プログラムの入手先** **:**  
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](https://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](https://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](https://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-025）
    [https://www.microsoft.com/technet/security/bulletin/ms02-025.mspx](https://technet.microsoft.com/security/bulletin/ms02-025)
-   サポート技術情報 （KB） 文書番号 ： 320436
    [MS02-025: 無効なメール属性により Exchange 2000 が CPU リソースを使い果たす (Q320436)](https://support.microsoft.com/kb/320436)

**更新履歴** **:**

-   2002/5/30: このセキュリティ情報ページを公開しました。
-   2002/6/12: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
