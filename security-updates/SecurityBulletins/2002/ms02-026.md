---
TOCTitle: 'MS02-026'
Title: 'マイクロソフト セキュリティ情報 MS02-026 - 警告'
ms:assetid: 'ms02-026'
ms:contentKeyID: 61228451
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-026(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS02-026 - 警告
===============================================

ASP.NET ワーカー プロセスに未チェックのバッファが含まれる (322289)
------------------------------------------------------------------

公開日: 2002年6月7日 | 最終更新日: 2002年6月8日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
ASP.NET アプリケーションを実行している Web サーバーを運用しているお客様

**脆弱性の影響** **:**
サービス拒否、および攻撃者が選択したコードが実行される可能性があります。

**最大深刻度** **:**
中

**推奨する対応策** **:**
StateServer モードを使用しているお客様は更新プログラムを適用して下さい。StateServer モードを使用していないお客様は新たに対応策を講じる必要はありません。

**影響を受けるソフトウェア** **:**

-   Microsoft .NET Framework バージョン 1.0 (そのコンポーネントの 1 つが ASP.NET です。)

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
ASP.NET は開発者が Web ベース アプリケーションを作成する手助けをする技術です。Web ベースのアプリケーション (ASP.NET を使用して作成されているものも含む) は HTTP に依存して接続を提供します。プロトコルとしての HTTP の 1 つの特徴は、ステートレスであるということです。つまり、サイトに対するユーザーからのページの各リクエストは独立したリクエストとみなされます。これを補正するために、ASP.NET は様々なモードを介し、セッション状態管理を提供します。

これらのモードの中に、StateServer モードがあります。このモードは、別の実行中のプロセスに、セッション状態の情報を保存します。そのプロセスを同じマシン、または ASP.NET アプリケーションとは異なるマシンで実行することができます。StateServer モードで Cookie のプロセスを処理するルーチンの 1 つに未チェックのバッファが含まれます。攻撃者がバッファのオーバーラン攻撃を行うことにより、セキュリティ上の脆弱性を悪用することができる可能性があります。攻撃が成功すると、ASP.NET アプリケーションが再起動される可能性があります。このため、Web ベース アプリケーションを使用中のユーザーは、実行中のセッションが再起動され、そのセッション情報が失われるという影響を受ける場合があります。

StateServer モードは ASP.NET のセッション状態管理の既定のモードではありません。StateServer モードを使用する ASP.NET アプリケーションで、Cookie を使用しないものはこの脆弱性の影響を受けません。

**問題を緩和する要素** **:**

-   StateServer モードは ASP.NET のセッション状態管理の既定のモードではありません。このモードを使用するためには、ASP.NET アプリケーションを特別に構成する必要があります。
-   アプリケーションが StateServer モードを使用するように構成されている場合でも、Cookie を使用する場合にのみ、この脆弱性の影響を受けます。

**深刻度** **:**

|             | インターネット サーバー | イントラネット サーバー | クライアント システム |
|-------------|-------------------------|-------------------------|-----------------------|
| **ASP.NET** | 中                      | 中                      | なし                  |

上記の[評価](https://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形態およびこの脆弱性がシステムに及ぼす影響に基づいています。この脆弱性は Cookie に関連して StateServer モードが使用されている場合のみに悪用されます。StateServer モードはセッション状態管理の既定のセッション状態モードではありません。

**脆弱性識別番号** **:**
[CAN-2002-0369](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0369)

**テストしたバージョン** **:**
マイクロソフトは NET Framework 1.0 のテストを行い、これらの脆弱性による影響を評価しました。NET Framework の以前のバージョンはありません。

よく寄せられる質問
------------------

<span></span>
**どのようなことが起こる可能性がありますか?**

これはバッファ オーバーランの脆弱性です。攻撃者がこの脆弱性を悪用することに成功した場合、Web サーバー上で実行されているアプリケーションを再起動させることができる可能性があります。さらに、マイクロソフトはその現象を再現していませんが、攻撃者がこの脆弱性を悪用して、Web サーバー上でコードを実行することができる可能性があります。そのコードは、ASP.NET ワーカー プロセスのセキュリティ コンテキストで実行される可能性があり、その際、既定で特権を持たないアカウントが使用されます。

この脆弱性は StateServer モードを使用して、セッション状態の情報を管理する ASP.NET アプリケーションのみに影響を及ぼします。これは、既定のモードではありません。また、StateServer モードとさらにCookie も使用しているアプリケーションのみがこの脆弱性による影響を受けます。StateServer モードを使用し、Cookie を使用していないアプリケーションにはこの脆弱性による影響は及びません。

**何が原因で起こりますか?**

Cookie データを ASPState サービスで処理する機能が、そのサービスに渡される Cookie の長さを適切に確認しないために脆弱性が発生します。

**ASP.NET** **とは何ですか?**

[ASP.NET](https://www.asp.net/) （英語情報） は、開発者が Web アプリケーションおよび XML Web サービスを構築できるようになる[.NET Framework](https://www.microsoft.com/japan/msdn/netframework/) の中の技術を集積したものです。

静的な HTML およびスクリプトの組み合わせを使用する、これまでの Web ページとは異なり、ASP.NET は、コンパイルされた、イベントドリブンのページを使用します。これにより、ASP.NET の開発者は Web ベースのアプリケーションを、今までの Visual Basic や Visual C++ などの言語で作成されたアプリケーションと同様の豊かな機能で構築することができます。しかし、デスクトップ アプリケーションとは異なり、このようなコンパイルされたページは、HTML および XML などのマークアップ言語を使用してクライアント デスクトップまたはブラウザに送信される情報を生成します。これにより、開発者は、幅広い機能を持つアプリケーションを作成し、さらにユーザー インターフェースを多くのオペレーティング システムを実行するデバイスおよびシステムに表示させることができます。

ASP.NET は、Web ベースのアプリケーション環境であるため、Web サーバーが基本的な HTTP の機能を提供していることが必要となります。このため、ASP.NET は Windows 2000 上の Internet Information Services 5.0 および Windows XP Professional 上の Internet Information Services 5.1 の上で実行されます。この場合の問題は、 ASP.NET が HTTP の機能のひとつ、セッション状態を処理する機能に関係しています。

**セッション状態とは何ですか?**

ASP.NET アプリケーションは、Web ベースのアプリケーションです。そのため、従来の Web アプリケーションと同じ基本概念で構築されます。これらの概念の中で最も重要なものに、セッション状態があります。

仕様上、HTTP （ハイパーテキスト転送プロトコル） は、ステートレスのプロトコルです。これは、ネットワーク レイヤーからの観点からすると、Web サーバーと Web ブラウザの間の相互作用は、分離しており、関連性がないと言うことを意味します。たとえば、靴のオンライン ショップで、自分のサイズの靴のリストを表示する Web ページを見るとします。次にある靴をクリックしてその詳細ページを表示させるとします。Web サーバーの観点では、これらの 2 つの相互作用は、互いにまったく関連性がありません。それらは 2 つのまったく独立したやりとりです。Web サーバーはこれらのリクエストが同じユーザー セッションの一部であるということを認識することはできません。

ユーザーは Web ページというよりも Web サイトにアクセスをするため、この制限を打開するために Cookie が導入されました。Cookie は、Web サーバーが 1 人のユーザーからのそれぞれのページ リクエストをより重要な全体のセッションへ関連付ける方法を提供し、[セッション状態](https://msdn2.microsoft.com/en-us/library/ms952602) (英語情報) の概念を導入しています。

**Cookie** **とは何ですか?**

Cookie は、ユーザーのローカル システムに保存されているデータ ファイルです。Cookie は、構造、内容の面では形式は自由で、Web サイトが Cookie に保存する情報を選択することができます。しかし、その情報は常にクリア テキストで渡されるため、機密を含む個人情報は決して Cookie に保存するべきではありません。

**Cookie** **はセッション状態をどのように有効にしますか?**

HTTP は、ステートレスのプロトコルです。つまり、Web サーバーが複数のページ リクエストとシングル セッションを関連付けることができません。Cookie により、Web サイトはクライアントにデータを保存することができるようになるため、この制限を打開することができるようになります。Web サイトは、Cookie を使用して、サイト上の複数のリクエストを関連付けて 1 つの全体のセッションを作成するために使用される情報を保存することができます。具体的には、1 つのページは、別のページによって読み取ることができる情報をCookie に記述します。これにより、セッションが有効になります。

たとえば、靴を 1 足買うことにすることにした場合、その店のサイトは、Cookie の中に選んだ靴の情報のメモを作成します。次に、支払いのページに行くと、その Cookie を読み取り、購入したアイテムを確認することができます。そして、複数のページで選択したアイテムを示す 1つのページを生成します。

**セッション状態は、サーバー上でどのように処理されますか?**

最初にセッション状態を有効にするのは、ローカル コンピュータ上に保存された Cookie ですが、状態管理は最終的にはクライアントではなく Web サーバーによって呼び出されます。Web サーバーは、状態情報をどのように処理するかを認識している必要があります。また、アプリケーションによって、状態情報を使用する要件が異なります。これは結局、サーバー上でこの情報が処理される方法が異なるということを意味します。

このため、ASP.NET では、セッション状態を管理する方法がいくつか導入され、アプリケーションによるそれぞれの要件に対応できるようにしています。

たとえば、1 台のサーバーにホストされているオンラインの靴ショップのアプリケーションは、サーバー ファームにホストされているアプリケーションとは異なる管理セッションの要件があります。

**ASP.NET** **はセッション状態をどのように管理しますか?**

ASP.NET は、セッション情報を管理するために Cookie に完全に依存するだけでなく、セッション状態情報をいくつか、またはすべてをサーバー上で管理できるようにするオプションを提供します。これにより、Web サーバーとクライアント間をやり取りする情報の量を減少させ、パフォーマンスを向上させます。

ASP.NET では、以下の 3 つの方法で、セッション状態情報をサーバー上で管理することができます。

-   インプロセス モード
-   アウトプロセス モード （StateServer モード）
-   SQL Server モード

インプロセス モードでは、セッション状態メモリが ASP.NET アプリケーション内で管理されます。これは、スピードの面でメリットがあります。その理由は、アプリケーションがセッション情報を即座に利用できるためです。インプロセス モードのデメリットは、情報が 1 台のマシンに含まれるため Web ファームで使用することができない点です。これは ASP.NET アプリケーションの既定のセッション状態です。

StateServer モードでは、別の実行中プログラムの ASPState サービスにセッション状態情報が保存されます。これは同じシステム、または ASP.NET アプリケーションとは異なるシステム上で実行することができます。このモードのメリットは、Web ファームでの使用もサポートするという点です。

SQL Server モードは、Web ファームでの使用をサポートするという点で StateServer モードに類似しています。このモードの場合、セッション状態情報はデータベース サーバーに保存され、アプリケーション ファームのメンバは誰でもアクセスすることができます。SQL Server の拡張性により、Web ファームでの使用ではセッション状態情報を管理するためのオプションとしてより好まれます。

**StateServer** **モードが** **Cookie** **を処理する方法の何が問題になっていますか?**

Cookie が ASP.NET に渡される際に、Cookie を処理する StateServer モード機能の中のある機能に未チェックのバッファが含まれます。

**それはどうして起こるのですか?** **未チェックのバッファは** **.NET Framework** **にはあり得ないと思いました。**

StateServer 自体は .NET Framework を使用して作成されていますが、StateServer によって呼び出され、.NET Framework を使用して作成されていないヘルパー機能がいくつか存在します。従来のコードを使用して記述されたこのようなヘルパー機能の 1 つにこの脆弱性の原因となる問題が存在します。

しかし、StateServer はすべての機能を .NET Framework へ移行するように計画されています。その作業は現在行われています。これは構造的な変更で、セキュリティ更新プログラムで安全に行うことができる種類の変更ではないため、この作業の結果は、大規模な製品出荷時に最初に提供されます。

**では、.NET Frameworkで管理するコードにはこの脆弱性の影響はまったく及ばないのですか?**

その通りです。この脆弱性は .NET Framework で管理されるコードにはまったく関連性がありません。

**この脆弱性により、攻撃者は何ができますか?**

攻撃者はこの脆弱性を悪用し、バッファ オーバーラン攻撃を仕掛ける可能性があります。攻撃が成功した場合、ASP.NET アプリケーションを再起動することができる恐れがあります。

さらに、マイクロソフトのテストではコードの実行は再現していませんが、攻撃者がこの脆弱性を悪用し、コードを実行する可能性が残っていると考えられます。しかし、ASP.NET ワーカー プロセスは、既定で特権を持たないセキュリティ コンテキストで実行されます。したがって、攻撃者の任意のコードをこの脆弱性を悪用して入力できた場合、攻撃者のコードがシステムで非常に限られた権限で実行される可能性があります。

**攻撃者はどのようにしてこの脆弱性を利用する可能性がありますか?**

攻撃者はこの脆弱性を悪用し、不正な Cookie を作成し、それを ASP.NET アプリケーションに送信する可能性があります。Cookie が ASP.NET アプリケーションで処理され、バッファ オーバーランが発生すると、ASP.NET アプリケーションが再起動する可能性があります。

**Cookie** **と** **StateServer** **を併せて使用しているアプリケーションのみがこの脆弱性の影響を受ける可能性があるとのことでしたが、詳しく言うとどのようなことですか?**

この脆弱性を発生させる問題は、StateServer モードでの Cookie の処理に関する機能にあります。StateServer モードを使用し、Cookie を使用しない ASP.NET アプリケーションはこの脆弱性の影響は受けません。

**更新プログラムは何を修正しますか?**

この更新プログラムは、StateServer モードで処理される Cookie を適切にチェックするようにし、この脆弱性を排除します。

**StateServer** **モードを使用していますが、Cookie** **は使用していません。更新プログラムを適用する必要がありますか?**

はい、更新プログラムが必要です。StateServer モードを使用する場合、Cookie を使用しない場合でも、いつでも Cookie を使用する場合のためにこの更新プログラムを適用し、この脆弱性に対処することが必要です。しかし、同時に StateServer モードではなく SQL Server モードを使用することも検討してください。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft .NET Framework バージョン 1.0
    この問題に対する修正は .NET Framework Service Pack 2 以降に含まれています。.NET Framework 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

    <https://www.microsoft.com/japan/msdn/netframework/downloads/>
    なお、個別の更新プログラムは以下の Web サイトから入手できます。

    [https://download.microsoft.com/download/NETFrameworkRedistributable/
    Patch/1/NT45XP/JA/NDP10\_QFEM\_Q322298\_Ja.exe](https://download.microsoft.com/download/netframeworkredistributable/patch/1/nt45xp/ja/ndp10_qfem_q322298_ja.exe)

    **注意** **:**
    ファイル名の Q 以降の数字が、本セキュリティ情報のタイトルにあるサポート技術情報の文章番号 Q322289 と異なりますので、ご注意ください。

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**
この更新プログラムは .NET Framework バージョン 1.0 [Service Pack 1](https://www.microsoft.com/japan/msdn/netframework/downloads/sp1/) を実行しているシステムにインストールすることができます。

**この更新プログラムを含む予定のサービスパック** **:**
この問題に対する更新プログラムは .NET Framework Service Pack 2 に含まれています。

**再起動の必要性** **:**
あり

**更新プログラムに含まれる過去の修正** **:**
なし

**更新プログラムが正しくインストールされたか確認する方法** **:**

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\.NETFramework\\1.0\\NDP10SP338\\M322298

**警告** **:**
[Visual Studio .net](https://www.microsoft.com/japan/msdn/vstudio/) を実行した状態で MS02-026 の更新プログラムを適用した場合に、システムが不安定になる可能性があります。 MS02-026 の更新プログラムを適用時に関連するファイルが使用されていると、正常に新しいファイルに置き換えることが出来ない可能性があるために発生します。この現象は、ファイルが使用されている状態で、更新プログラムがサイレントモードで適用された場合または、更新プログラムを対話モードで適用した場合に、アプリケーションを閉じるダイアログが表示されますが、このダイアログを無視した場合に発生します。MS02-026 の更新プログラムを適用する場合は、Visual Studio .net を一度終了してからの適用をお願いします。詳細な情報については、 [324292](https://support.microsoft.com/kb/324292) を参照してください。

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](https://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](https://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](https://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-026）
    [https://www.microsoft.com/technet/security/bulletin/ms02-026.mspx](https://technet.microsoft.com/security/bulletin/ms02-026)
-   サポート技術情報 （KB） 文書番号 ： 322298
    [\[MS02-026\] ASP.NET ワーカー プロセス (日本語) に未チェックのバッファが含まれる](https://support.microsoft.com/kb/322298)

**更新履歴** **:**

-   2002/6/7: このセキュリティ情報ページを公開しました。
-   2002/6/8: 「警告」の欄で更新プログラム適用時の問題について説明しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
