---
TOCTitle: 'MS02-032'
Title: 'マイクロソフト セキュリティ情報 MS02-032 - 緊急'
ms:assetid: 'ms02-032'
ms:contentKeyID: 61228457
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-032(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS02-032 - 緊急
===============================================

2002 年 6 月 26 日 Windows Media Player 用の累積的な修正プログラム (320920)
---------------------------------------------------------------------------

公開日: 2002年6月27日 | 最終更新日: 2002年7月26日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Windows Media™ Player 6.4、7.1 または Windows Media Player for Windows XP を使用しているお客様

**脆弱性の影響** **:**
3 つの新しい脆弱性。2002 年 6 月 26 日 (米国日付) に最初に報告されました。最も深刻な脆弱性により、攻撃者の選択したコードが実行される可能性があります。

**最大深刻度** **:**
高

**推奨する対応策** **:**
影響を受ける製品を実行しているお客様は、直ちに更新プログラムを適用して下さい。現在 Windows Media Player 7.0 を実行しているお客様は、まず Windows Media Player 7.1 にアップグレードし、次にこの更新プログラムを直ちに適用して下さい。

**影響を受けるソフトウェア** **:**

-   Microsoft Windows Media Player 6.4
-   Microsoft Windows Media Player 7.1
-   Microsoft Windows Media Player for Windows XP

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
2002 年 6 月 26 日 (米国日付)、マイクロソフトはこのセキュリティ情報の最初のバージョンをリリースし、累積的な更新プログラムとして提供された更新プログラムであると説明しました。その後、マイクロソフトは更新プログラムにファイルが不足していたことを発見しました。次に説明する新しい脆弱性に対する更新プログラムとして、不足していたファイルによる影響はありませんが、提供した更新プログラムは累積的ではなかったということになります。具体的には、最初の更新プログラムはマイクロソフト セキュリティ情報 [MS01-056](http://technet.microsoft.com/security/bulletin/ms01-056) で説明したすべての修正を含んでいませんでした。マイクロソフトはこの更新プログラムを再パッケージし、不足していたファイルを含め、確実な累積的な更新プログラムとして再リリースしました。

マイクロソフト セキュリティ情報 [MS01-056](http://technet.microsoft.com/security/bulletin/ms01-056) で提供した更新プログラムと、このセキュリティ情報の最初のバージョンで提供した更新プログラムを適用した場合、Windows Media Player に存在するすべての既知の脆弱性に対し、充分に保護されています。このため、新たに対応策を講じる必要はありません。上記の更新プログラムを適用していない場合、マイクロソフトは下記で提供されている新しいバージョンの更新プログラムを適用することを推奨します。

この更新プログラムは、Windows Media Player 6.4、7.1 および Windows Media Player for Windows XP 用に、過去にリリースされたすべての機能を含みます。さらに、次の新しく確認された 3 つの脆弱性を排除します。それぞれの深刻度の評価は 「高」、「中」、そして 「低」 です。

-   情報の漏えいの脆弱性。この脆弱性により、攻撃者にユーザーのシステムでコードを実行する手段を取得される可能性があります。深刻度の評価は 「高」 です。
-   特権の昇格の脆弱性。この脆弱性により、攻撃者が Windows 2000 マシンに物理的にローカルでログオンし、プログラムを実行できる場合、オペレーティング システムと同じ権限を取得される可能性があります。
-   スクリプトの実行に関連する脆弱性。ユーザーが不正なメディア ファイルを再生し、その後不正な Web ページを表示した場合、この脆弱性により、攻撃者の選択したスクリプトが、ユーザー自身が選択したように実行される可能性があります。この脆弱性はタイミングに関する特定の要件を必要とするため、脆弱性が悪用される可能性は極めて低いです。深刻度の評価は 「低」 です。

この累積的な更新プログラムもまた、Windows Media Player に関連するファイル拡張子に関する構成の変更を導入します。最後に、MS02-023 で提供された Internet Explorer 用の累積的な更新プログラムの適用や Windows Media Player for versions 7.x またはそれ以降のスクリプト機能を無効にするだけでなく、さらにそのほかの対応策を望まれるユーザーや組織のために、新しい追加のセキュリティ構成機能を導入します。

**問題を緩和する要素** **:**
Windows Media Player によるキャッシュのパスの公開 :

-   MS02-023 で提供された更新プログラムを適用しているお客様は、「制限付きサイト ゾーン」 で電子メールが読み取られる時に、HTML 形式の電子メールを使用して、この問題が自動的に悪用されることから、保護されています。Outlook 98 および Outlook 2000 Outlook (電子メール セキュリティ アップデートをインストールしているもの)、Outlook 2002 そして Outlook Express 6.0 はすべて、電子メールを既定で 「制限付きサイト ゾーン」 で読み取ります。
-   この脆弱性はローカル マシンから開かれたメディア ファイルには影響を及ぼしません。このため、ファイルをダウンロードし、ローカルで保存するお客様はこの脆弱性の影響を受けません。

Windows メディア デバイス マネージャ サービスによる特権の昇格 :

-   この問題は Windows Media Player 7.1 のみに影響を及ぼし、Windows Media Player for Windows XP および Windows Media Player 6.4 には影響を及ぼしません。
-   この脆弱性は Windows 2000 で実行されている Windows Media Player 7.1 にのみ影響を及ぼし、Windows 98 や Windows ME システムなどのユーザー セキュリティ モデルのないシステムには影響を及ぼしません。
-   この問題はコンソール セッションにのみ影響を及ぼします。ターミナル セッションを介しログオンするユーザーに、この脆弱性を悪用されることはありません。
-   攻撃者はシステム上でプログラムを読み込み、実行できなければなりません。攻撃者がプログラムを読み込み、実行を阻止することで、この脆弱性が悪用されることはありません。

メディア再生スクリプトの呼び出し :

-   この脆弱性を悪用した攻撃による被害の発生には、次の一連の操作が正確に次の順序で行われることが必要条件となり、そうでない場合、攻撃は失敗します。具体的な操作の順序は以下の通りです。

    -   ユーザーが攻撃者からの不正なメディア ファイルを再生する必要があります。

    -   そのファイルの再生後、ユーザーはそのほかのファイルを再生せずに、Windows Media Player をシャット ダウンする必要があります。

    -   次にユーザーは攻撃者が作成した Web ページを表示する必要があります。

**深刻度** **:**
Windows Media Player によるキャッシュのパスの公開 :

|                                         | インターネット サーバー | イントラネット サーバー | クライアント システム |
|-----------------------------------------|-------------------------|-------------------------|-----------------------|
| **Windows Media Player 6.4**            | 低                      | 低                      | 高                    |
| **Windows Media Player 7.1**            | 低                      | 低                      | 高                    |
| **Windows Media Player for Windows XP** | 低                      | 低                      | 高                    |

Windows Media Device Manager サービスによる特権の昇格 :

 
<table style="border:1px solid black;">
<thead>
<tr class="header">
<th style="border:1px solid black;" ></th>
<th style="border:1px solid black;" >インターネット サーバー</th>
<th style="border:1px solid black;" >イントラネット サーバー</th>
<th style="border:1px solid black;" >クライアント システム</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;"><strong>Windows Media Player 6.4</strong></td>
<td style="border:1px solid black;">なし</td>
<td style="border:1px solid black;">なし</td>
<td style="border:1px solid black;">なし</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Windows 2000</strong> <strong>で実行されている</strong><br />
<strong>Windows Media Player 7.1</strong></td>
<td style="border:1px solid black;">低</td>
<td style="border:1px solid black;">低</td>
<td style="border:1px solid black;">高</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><strong>そのほかのプラットフォームで実行されている</strong><br />
<strong>Windows Media Player 7.1</strong></td>
<td style="border:1px solid black;">なし</td>
<td style="border:1px solid black;">なし</td>
<td style="border:1px solid black;">なし</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Windows Media Player for Windows XP</strong></td>
<td style="border:1px solid black;">なし</td>
<td style="border:1px solid black;">なし</td>
<td style="border:1px solid black;">なし</td>
</tr>
</tbody>
</table>
  
メディア再生スクリプトの呼び出し :
  
|                                         | インターネット サーバー | イントラネット サーバー | クライアント システム |  
|-----------------------------------------|-------------------------|-------------------------|-----------------------|  
| **Windows Media Player 6.4**            | なし                    | なし                    | なし                  |  
| **Windows Media Player 7.1**            | 低                      | 低                      | 低                    |  
| **Windows Media Player for Windows XP** | なし                    | なし                    | なし                  |
  
この更新プログラムに含まれるすべての問題の総合的な深刻度 (過去の更新プログラムに含まれる修正も含む)
  
|                                         | インターネット サーバー | イントラネット サーバー | クライアント システム |  
|-----------------------------------------|-------------------------|-------------------------|-----------------------|  
| **Windows Media Player 6.4**            | 高                      | 高                      | 高                    |  
| **Windows Media Player 7.1**            | 高                      | 高                      | 高                    |  
| **Windows Media Player for Windows XP** | 低                      | 低                      | 高                    |
  
上記の[評価](http://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。「ライセンス処理のキャッシュの公開」 の脆弱性は、ユーザーとして、システムでコードを実行するために悪用される可能性があります。「Windows Media Device Manager サービスによる特権の昇格」 では、コンソールでログオンできることが必要条件となります。ターミナル セッションはこの脆弱性の影響を受けません。さらに、攻撃者はプログラムを読み込み、実行することができなければなりません。「メディア再生スクリプトの呼び出し」 の脆弱性では、タイミングに関し、特定の必要条件があるため、自動化された攻撃を行うことは困難です。

  
**脆弱性識別番号** **:**
  
-   Windows Media Player によるキャッシュのパスの公開 : [CAN-2002-0372](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0372)  
-   Windows Media Device Manager サービスによる特権の昇格 : [CAN-2002-0373](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0373)  
-   メディア再生スクリプトの呼び出し : [CAN-2002-0615](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0615)
  
**テストしたバージョン** **:**  
マイクロソフトは Windows Media Player 6.4、7.1 および Windows Media Player for Windows XPのテストを行い、これらの脆弱性による影響を評価しました。7.0 を含む以前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。Windows Media Player 7.0 を使用しているお客様は、この更新プログラムをインストールする前に、Windows Media Player 7.1 をインストールして下さい。

  
よく寄せられる質問  
------------------
  
<span></span>
**なぜこのセキュリティ情報を更新したのですか?**
  
2002 年 6 月 26 日 (米国日付)、マイクロソフトはこのセキュリティ情報の最初のバージョンをリリースし、累積的な更新プログラムとして提供された更新プログラムであると説明しました。その後、マイクロソフトは更新プログラムにファイルが不足していたことを発見しました。次に説明する新しい脆弱性に対する更新プログラムとして、不足していたファイルによる影響はありませんが、提供した更新プログラムは累積的ではなかったということになります。具体的には、最初の更新プログラムはマイクロソフト セキュリティ情報 [MS01-056](http://technet.microsoft.com/security/bulletin/ms01-056) で説明したすべての修正を含んでいませんでした。マイクロソフトはこの更新プログラムを再パッケージし、不足していたファイルを含め、確実な累積的な更新プログラムとして再リリースしました。

  
**この更新プログラムの新しいバージョンを適用する必要はありますか?**
  
マイクロソフト セキュリティ情報 [MS01-056](http://technet.microsoft.com/security/bulletin/ms01-056) で提供した更新プログラムと、このセキュリティ情報の最初のバージョンで提供した更新プログラムを適用した場合、Windows Media Player に存在するすべての既知の脆弱性に対し、充分に保護されています。このため、新たに対応策を講じる必要はありません。上記の更新プログラムを適用していない場合、マイクロソフトは下記で提供されている新しいバージョンの更新プログラムを適用することを推奨します。

  
**セキュリティ情報** **MS01-056** **で提供された更新プログラムを適用したかどうか分かりません。何をしたらよいですか?**
  
セキュリティ情報 MS01-056 で提供された更新プログラムを適用したかどうか分からない場合、最も安全な対応策として、下記で提供されている更新プログラムの新しいバージョンを適用して下さい。

  
**更新プログラムの最初のバージョンをインストールすることにより、システムはセキュリティ情報** **MS01-056** **で説明されている問題の影響を受けるようになりましたか?**
  
いいえ、受けるようにはなりませんでした。すでに MS01-056 で説明されている脆弱性に対してシステムが保護されていた場合、最初のバージョンの更新プログラムをインストールしても、この保護は変わりませんでした。

  
**このセキュリティ情報の最初のバ－ジョンで提供された更新プログラムはすべての新しい脆弱性を排除しましたか?**
  
はい。最初の更新プログラムはこのセキュリティ情報で説明されているすべての新しい脆弱性に対し、充分に効果的でした。

  
**この更新プログラムでどのような脆弱性が排除されますか?**
  
この更新プログラムは、Windows Media Player 6.4、7.1 および Windows Media Player for Windows XP 用に過去にリリースされたすべての修正を含んでいます。 さらに、この更新プログラムは新たに確認された 3 つの脆弱性を排除します。脆弱性の深刻度はそれぞれ、「高」、「中」 そして 「低」 と評価します。

  
-   情報漏えいの脆弱性。この脆弱性は Windows Media Player が安全なメディア ファイルのライセンス プロセスを処理する方法に関連しています。これにより、攻撃者はユーザーのシステムでコードを実行する可能性があります。この問題の深刻度は 「高」 です。  
-   情報漏えいの脆弱性。これにより、攻撃者が Windows 2000 マシンに物理的にローカルでログオンし、プログラムを実行できる場合、オペレーティング システムと同じ権限を取得する可能性があります。つまり、攻撃者はデータやセキュリティ設定の追加、変更、削除を行う可能性があります。この問題の深刻度は 「中」 です。  
-   ローカル スクリプト実行の脆弱性。これにより、ユーザーが選択したかのように、攻撃者のスクリプトが実行される可能性があります。この特定の脆弱性には問題を緩和する重要な要素があるため、深刻度は 「低」 です。

  
最後に、この更新プログラムは構成の変更および新しい追加のセキュリティの構成機能を導入します。

  
**Windows Media Player** **によるキャッシュのパスの公開** **: (CVE-CAN-2002-0372)**  
**1** **番目の脆弱性でどのようなことが起こる可能性がありますか?**
  
これは情報漏えいの脆弱性です。これにより、攻撃者がユーザーのシステムでコードを実行する可能性があります。コードはデータの追加、変更、削除、Web サイトとの通信、システムの構成の変更など、システムでユーザーに可能な任意の操作を行うことができます。  

攻撃者のコードはユーザーと同じ権限で実行されます。ユーザーのシステム変更操作に関する制限は攻撃者のコードにも適用されます。例えば、ユーザーがハード ドライブのファイルを削除できない場合、攻撃者のコードもまた、これを行うことはできません。一方、ユーザーが管理者アカウントなどの高い権限を持つアカウントを使用している場合、攻撃者のコードも同じ高い権限で実行されます。

  
**何が原因で起こりますか?**
  
メディア ファイルが Internet Explorer のキャッシュに保存される時、Windows Media Player が安全なメディア ファイルについて、特定の種類のライセンスを処理する方法に問題が存在するため、この脆弱性が起こります。具体的には、安全な Windows Media ファイルが開かれると、Windows Media Player は間違って情報をサーバーに渡し、そのサーバーは、ライセンシング情報のサイトについてのリクエストを処理する時に、Internet Explorer のキャッシュの場所を公開します。

  
**Internet Explorer** **のキャッシュとは何ですか?**
  
Internet Explorer のキャッシュとは Internet Explorer により制御されるシステム フォルダで、Web ページまたは HTML 形式の電子メールがユーザーのローカル システムにファイルを作成し、一時的な記憶域として使用されます。Web ページまたは HTML 形式の電子メールがキャッシュ情報を利用する必要がある場合、その情報を保存するために Internet Explorer に渡します。次に Internet Explorer はその情報を保存し、必要に応じて Web ページまたは HTML 形式の電子メールのために取得します。

たとえば、ファイルが Web サイトからダウンロードされ、提供される場合、実際、これらのファイルはまずキャッシュにダウンロードされ、この時点でユーザーに 「ファイルのダウンロード」 ダイアログ ボックスが表示されます。ユーザーがダウンロードをキャンセルすることを選択した場合、そのファイルはキャッシュから削除され、ダウンロードが停止します。ユーザーが直接ファイルを開くことを選択した場合、そのファイルはキャッシュに残り、そこから開かれます。ユーザーがそのほかの場所にファイルを保存することを選択した場合、そのファイルはキャッシュから、ユーザーが指定した場所へ移動されます。

Internet Explorer のセキュリティ モデルでは、キャッシュ内の情報は Web ページや HTML 形式の電子メールに代わって、Internet Explorer によってのみアクセスされなければなりません。仕様上、Web ページや HTML 形式の電子メールはキャッシュ内のコンテンツに直接アクセスできるべきではありません。

  
**Internet Explorer** **はキャッシュ内の情報をどのようにセキュリティで保護するのですか?**
  
キャッシュ内の情報が直接的なアクセスから保護される方法の 1 つは、ファイル システム上のキャッシュの場所を不明瞭にすることです。不明瞭にする機能を使用し、動的な名前を持つフォルダを作成することにより、キャッシュは予測できない場所に保存されます。このため、Internet Explorer のみがキャッシュに保存されているすべてのものの完全な場所を知っています。このような方法により、Web ページや HTML 形式の電子メールには情報が保存されているファイル システムの場所が分からないため、キャッシュ内の情報にアクセスできません。

  
**Windows Media Player** **の何が問題になっていますか?** **また、Windows Media Player** **がキャッシュ情報を処理する方法の何が問題になっていますか?**
  
特定の状況で Windows Media Player が安全なメディア ファイルへのライセンス リクエストを処理する方法に問題が存在します。Windows Media Player がメディア ファイルへのライセンスをリクエストし、そのメディア ファイルが Internet Explorer のキャッシュにある場合、Windows Media Player は Internet Explorer がキャッシュのために使用する判別されにくくされた名前を、その特定のメディア ファイルのライセンス サーバーとして指定されたサーバーに間違って返します。

  
**Windows Media Player** **の問題は安全なメディア ファイルのすべての種類に影響を及ぼしますか?**
  
いいえ。この問題は Windows Media Player が、Windows Media Rights Manager バージョン 1.0 を使用する安全なメディア ファイルの特定の種類を処理する場合にのみ発生します。Windows Media Player は Windows Media Rights Manager バージョン 7.0 以降のバージョンでは同じ方法で処理しません。このため、脆弱性は起こりません。

  
**この脆弱性により、攻撃者は何ができる可能性がありますか?**
  
この脆弱性により、攻撃者はローカル ファイル システム上の Internet Explorer のキャッシュの場所を知ることができる可能性があります。攻撃者が実行可能なプログラムをキャッシュに保存し、場所に関する情報を取得することができると、その情報を利用してキャッシュ内のコンテンツに直接アクセスし、Internet Explorer のキャッシュ セキュリティ メカニズムを無視することができる可能性があります。また、攻撃者はこれを悪用し、キャッシュに保存されている実行可能ファイルを直接呼び出し、実行する可能性があります。

  
**攻撃者はどのようにしてこの脆弱性を悪用するのですか?**
  
攻撃者はユーザーに Internet Explorer のキャッシュから、不正な Windows Media ファイルを開かせることにより、この脆弱性を悪用する可能性があります。攻撃者がこれを行う方法は次の 2 通りのいずれかです。攻撃者が管理する Web サイトでダウンロード用のファイルをホストするか、またはファイルを HTML 形式の電子メールの一部として送信します。

両方のケースで、メディア ファイルが再生されると、Internet Explorer のキャッシュの場所に関する情報が攻撃者の Web サイトに返されます。この時点で、攻撃者はキャッシュに存在する実行可能ファイルを呼び出します。

  
**攻撃者はどのようにして** **Web** **サイトを介し、この脆弱性を悪用するのですか?**
  
攻撃者は自分が管理する Web サイトにメディア ファイルを配置し、ユーザーにその Web サイトを訪問するよう誘導することにより、この脆弱性を悪用する可能性があります。メディア ファイルをホストしているページがブラウザに読み込まれ、メディア ファイルが Internet Explorer のキャッシュから開かれると、この脆弱性が悪用されます。

  
**攻撃者はどのようにして** **HTML** **形式の電子メールを介し、この脆弱性を悪用するのですか?**
  
攻撃者は HTML 形式の電子メールを介し、メディア ファイルを添付ファイルとして送信することにより、この脆弱性を悪用する可能性があります。メディア ファイルが Internet Explorer のキャッシュから開かれると、この脆弱性が悪用されます。

  
**添付されたメディア ファイルは自動的に再生されるのですか?** **それともユーザーがメディア ファイルを開く必要があるのですか?**
  
メディア ファイルが自動的に再生されるかどうかは、ユーザーの特定の構成によります。

HTML 形式の電子メールを 「制限付きサイト ゾーン」 で読み取っているお客様が、[MS02-023](http://technet.microsoft.com/security/bulletin/ms02-023) で提供された累積的な更新プログラム (この更新プログラムは 「制限付きサイト ゾーン」 でフレームを無効にします。) を適用していれば、メディア ファイルは自動的に再生されません。このケースでは、ユーザーは添付ファイルをダブルクリックすることにより、メディア ファイルは再生されます。Outlook 98 および 2000 ([Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx) をインストール済みのもの)、Outlook 2002 そして Outlook Express 6 はすべて、既定で電子メールを 「制限付きサイト ゾーン」 で読み取ります。

しかし、[MS02-023](http://technet.microsoft.com/security/bulletin/ms02-023) で提供された累積的な更新プログラムを適用していない場合、HTML 形式の電子メールはメディア ファイルを自動的に再生しようとします。このケースでは、メッセージが開かれる、またはメッセージがプレビュー ウィンドウを介し、メッセージがレンダリングされると、脆弱性が悪用される可能性があります。

  
**ユーザーが攻撃者のファイルをローカルで保存している場合、この脆弱性は起こりますか?**
  
いいえ。この問題の特性により、攻撃者のファイルが Internet Explorer のキャッシュ内にある場合のみ、この脆弱性は起こります。つまり、ユーザーがメディア ファイルをダウンロードし、ローカルで保存している場合、そのファイルを実行するまで、この脆弱性は起こりません。

  
**更新プログラムは何を修正しますか?**
  
この更新プログラムは、メディア ファイルが再生される時に、Windows Media Player が Internet Explorer 内のキャッシュの場所に関する情報を返さないようにすることにより、この脆弱性を排除します。

  
**Windows Media Device Manager** **サービスによる特権の昇格** **: (CAN-2002-0373)**  
**2** **番目の脆弱性でどのようなことが起こる可能性がありますか?**
  
これは特権の昇格の脆弱性です。悪意のあるユーザーがコンソールで対話的にログオンし、システム上でプログラムを実行できる場合、この脆弱性を悪用してオペレーティング システム自体と同じシステム上での権限を取得してしまう可能性があります。これにより、攻撃者にシステム上のファイルの追加、変更または削除を行われる可能性があります。さらに、攻撃者にセキュリティ設定の変更やシステムへのアカウントの追加を行われる可能性があります。

この特定の脆弱性は Windows 2000 システム上の Windows Media Player 7.1 のみに影響を及ぼします。すべてのプラットフォーム上の Windows Media Player 6.4、Windows Media Player for Windows XP、および Windows 98、ME 上の Windows Media player 7.1 はこの問題の影響を受けません。この脆弱性はユーザー ログオンがコンソールでシステムにログオンする場合のみ、悪用される可能性があります。ターミナル セッションはこの脆弱性の影響を受けません。さらに、ユーザーは悪質なプログラムをシステムに導入することが必要条件となります。このため、SQL や Exchange のようなサーバーよりも、クライアント システムの方がこの脆弱性の影響を受ける可能性があります。この理由は SQL や Exchange サーバーのようなシステムは通常、対話的にログオンは管理者のみに制限されているためです。最後に、クライアント システムで、システムにコードを導入し、実行するユーザーの権限に関する制限 (グループ ポリシー、ソフトウェア制限ポリシー、物理的なセキュリティなど) は、問題を緩和する重要な要素となります。

  
**何が原因で起こりますか?**
  
Windows Media Device Manager サービスがローカル記憶装置へアクセスするためのリクエストを処理する方法に問題が存在するため、この脆弱性が起こります。このサービスは、ローカル記憶装置へのリクエストを有効にするためのリクエストを正しく識別しません。

  
**どのバージョンの** **Windows Media** **がこの特定の脆弱性による影響を受けますか?**
  
この脆弱性は Windows Media Player 7.1 のみに影響を及ぼします。Windows Media Player 6.4 および Windows Media Player for Windows XP は、この特定の脆弱性による影響は受けません。

  
**どのプラットフォームがこの脆弱性による影響を受けますか?**
  
Windows Media Player 7.1 がインストールされている Windows 2000 のみがこの脆弱性の影響を受けます。そのほかのプラットフォームはこの脆弱性の影響を受けません。

  
**Windows Media Device Manager** **とは何ですか?**
  
様々なメディア プレイヤーやメディア記憶装置との通信を容易にするために、Windows Media Player は [WMDM](http://msdn2.microsoft.com/en-us/library/aa473513) (Windows Media Device Manager) (英語情報) を導入しました。WMDM は、PC からポータブル オーディオ プレイヤーやそのほかのメディア記憶装置へのメディア ファイルの転送について、メディア プレイヤー サポートを可能にします。Windows Media Player で、WMDM は 「デバイスへコピー」 機能のサポートを提供します。

  
**WMDM** **サービスとは何ですか?**
  
WMDM サービスとは、WMDM のコンポーネントの 1 つで、Windows 2000 でのみ使用されています。これはユーザーが PC にあるメディア デバイス ハードウェアにアクセス権を持たない場合、WMDM の代わりに、ポータブル メディア デバイスに関する情報を取得します。特権を持たないユーザーはハードウェアに直接アクセスすることを許可されていないため、WMDM サービスにより、メディア プレイヤーは最小限の権限の割り当ての規則に従いながらも、ポータブル メディア ハードウェアと対話する手段が提供されます。WMDM がハードウェア デバイスに関して必要な条件を取得すると、その情報を使用してポータブル メディア デバイスと対話します。

  
**WMDM** **サービスはどのように機能しますか?**
  
Windows Media Playerはハードウェア デバイス間でメディアをコピーする必要がある場合、WMDM フレームワークを使用するために接続し、そのリクエストを実行します。たとえば、目的となるハードウェアがポータブル メディア デバイスの場合、WMDM は WMDM サービスを呼び出し、WMDM サービスがポータブル メディア デバイスに関する情報を取得することをリクエストします。WMDM が WMDM サービスから必要な情報を取得すると、デバイス間のメディア ファイルを、どのような方法でも操作することができます。

たとえば、ユーザーがポータブル メディア デバイスにコピーしたいメディア ファイルを、ローカル PC に保存しているとします。ユーザーは Windows Media Player を起動し、コピーするファイルとコピー先のデバイス (この場合、ポータブル メディア デバイス) を選択します。これが Windows 2000 で行われると、WMDM は、ポータブル メディア デバイスに関する情報を取得するための WMDM サービスのリクエストを作成します。WMDM サービスは WMDM が必要としている情報を返し、WMDM は PC とポータブル メディア プレイヤー間でファイルを操作することができます。

  
**WMDM** **サービスの何が問題になっていますか?**
  
Windows 2000 の WMDM サービスが、ハードウェア デバイスに接続する時、これを LocalSystem コンテキストで行います。この理由は、このレベルのアクセスは直接ハードウェア デバイスにアクセスすることが必要とされているためです。

この問題は、WMDM サービスは無効なデバイスへ接続するためのリクエストを受け取ると、そのリクエストを正しく拒否せずに、処理を行ってしまうために発生します。そのデバイスが特定の種類で、リクエストが正常に処理されてしまう場合、この操作の結果、攻撃者は LocalSystem コンテキスト内のローカル リソースへのアクセスを取得します。そのローカル リソースは攻撃者の指示に従い、ローカル プログラムを実行してしまいます。

  
**この脆弱性により、攻撃者は何ができる可能性がありますか?**
  
この脆弱性により、攻撃者はシステムでオペレーティング システム自体と同じ権限を取得できる可能性があります。これにより、攻撃者にマシンを完全に制御される可能性があります。このため、攻撃者にハード ドライブの再フォーマット、セキュリティ設定の緩和、管理者の追加など、システムで任意の操作を行われる可能性があります。

  
**攻撃者はどのようにしてこの脆弱性を悪用するのですか?**
  
攻撃者は WMDM サービスを呼び出し、特定の名前に付けられた無効なリソースへの接続を要求するプログラムを書くことにより、この脆弱性を悪用する可能性があります。攻撃者はコンソール セッションを介し、プログラムを導入、実行する必要があります。WMDM サービスがコマンドを実行すると、呼び出しを行うプログラムに LocalSystem コンテキスト内のローカル リソースへのアクセスが与えられます。このため、呼び出しを行うプログラムはそのリソースを使用し、システム上のそのほかのプログラムを起動する可能性があります。これらのプログラムは同じセキュリティ コンテキスト、つまり LocalSystem コンテキストで実行されます。

  
**この脆弱性を悪用するためには、コンソール アクセスが必要条件となるとのことですが、これはどのような意味ですか?**
  
コンソール ログオンとは、実際にコンピュータに接続されているキーボード、マウス、モニターを使用して行われるログオンです。そのシステムのハードウェア リソースを使用して、直接物理的なコンピュータにログ オンすること、と説明すると分かりやすいでしょう。

これとは対照的に、Windows 2000 はリモートのターミナル ログオンもサポートします。これはターミナル サービス クライアントに接続する物理的なそのほかのマシンのリソースを使用して、ネットワークを介して行われるログオンです。

この特定の脆弱性はコンソール セッションでのみ起こります。つまり、この脆弱性が悪用されるには、攻撃者は有効なログオン資格情報に加え、マシンへの直接的で物理的なアクセスを所有していることが必要条件となります。

  
**更新プログラムは何を修正しますか?**
  
この更新プログラムはローカル記憶装置へ接続するための無効なリクエストを識別する処理部分を修正し、これらのリクエストを拒否することにより、この脆弱性を排除します。

  
**メディア再生スクリプトの呼び出し** **: (CAN-2002-0615)**  
**3** **番目の脆弱性でどのようなことが起こる可能性がありますか?**
  
これはローカル スクリプト実行の脆弱性です。この脆弱性により、攻撃者が HTML スクリプトをユーザーのシステム上で実行されるかのように、処理させる可能性があります。スクリプトはファイルの追加、変更、削除、セキュリティ設定の変更など、ユーザーに可能な任意の操作を行う可能性があります。

この脆弱性は問題を緩和する重要な要素を持っています。この脆弱性を悪用した攻撃による被害の発生には、次の一連の操作が正確な順序で行われることが必要条件となり、そうでない場合、攻撃は失敗します。具体的な操作の順序は以下の通りです。

  
-   ユーザーが攻撃者からの不正なメディア ファイルを再生する必要があります。  
-   そのファイルの再生後、ユーザーはそのほかのファイルを再生せずに、Windows Media Player をシャット ダウンする必要があります。  
-   次にユーザーは攻撃者が作成した Web ページを表示する必要があります。

  
この順序通りに操作が行われない場合、この脆弱性を悪用した攻撃は失敗します。

  
**何が原因で起こりますか?**
  
Windows Media Player のアクティブな再生リストがローカル システムに保存される方法に問題が存在するため、この脆弱性が起こります。具体的には、再生リストは決まった既知の場所に保存されます。

  
**Windows Media** **のアクティブな再生リストとは何ですか?**
  
特定のメディア ファイルのコンテンツに関する情報を提供するために、Windows Media Player は再生リストの使用をサポートします。再生リストは通常、拡張子 .asx を持ち、メディア ファイルに関する情報を XML 形式で保存します。再生リストが保存する情報の例として、作品のタイトル、アーティスト名、ダウンロード元などがあります。

Windows Media Player がメディア ファイルを再生する時、メディア ファイルの関連した再生リストを読み込み、Active Playlist として、メモリに一時的なコピーを作成します。新しいメディア ファイルが再生される時、新しいファイルの再生リストが Active Playlist として読み込まれ、以前の Active Playlist は削除されます。Windows Media Player が終了される時に行われる最も望ましくない操作の 1 つは、現在のアクティブな再生リストをローカル ディスクに書き込むことです。これが行われると、次回 Windows Media Player が実行される時に、その再生リストが再読み込まれる場合があります。

  
**Windows Media** **が** **Active Playlist** **の情報を保存する方法の何が問題になっていますか?**
  
Windows Media Player が終了すると、Active Playlist の情報がローカル ファイル システム上の既知の、決まった場所に保存されます。

  
**そのほかのいくつかのファイルもローカル ファイル システムの既知の場所にありますが、なぜ、この特定のファイルにセキュリティ上の脆弱性が存在するのですか?**
  
アクティブな再生リスト ファイルは既知の場所にあるそのほかのファイルとは異なります。相違点として、このファイルは XML ベースであるため、HTML スクリプトを有効な入力として受け取り、その情報をローカル ディスクに書き込むことができることです。

つまり、攻撃者はアクティブな再生リストの基本的な機能を使用して、HTML スクリプトをローカル システムに書き込むことができます。

この情報が既知の場所に書き込まれるという事実を考え合わせると、攻撃者にローカル マシンにスクリプトを書き込まれ、次にそれをローカル マシンから呼び出す手段をあたえる可能性があります。

  
**この脆弱性により、攻撃者は何ができる可能性がありますか?**
  
この脆弱性により、攻撃者がHTML スクリプトをローカル ディスクから呼び出すことができるため、攻撃者により ローカル コンピュータ ゾーンでスクリプトが実行される可能性があります。ローカル コンピュータ ゾーンでスクリプトを管理する制限は、スクリプトを通常管理しているゾーン (通常、これはインターネット ゾーンです) よりも厳重ではありません。ローカル コンピュータ ゾーンはスクリプトが直接ユーザーにより実行されることを意図しているため、ローカル コンピュータ ゾーンで実行されるスクリプトはユーザーに直接可能な操作と類似した操作を行うことができます。たとえば、ローカル コンピュータ ゾーン内のスクリプトは、ユーザーに操作可能な同じファイルの追加、変更、削除を行うことができます。

一方、ユーザーがローカル システムへの変更を行う権限に関する制限もまた、攻撃者のスクリプトを制限します。つまり、ユーザーがローカル ファイル システムに関する許可のため、ファイルの変更ができない場合、攻撃者のスクリプトも同様に変更を行うことができません。

  
**攻撃者はどのようにしてこの脆弱性を悪用するのですか?**
  
この脆弱性を悪用するためには、攻撃者はまず、標的となるユーザーに不正なメディア ファイルを再生させることが必要条件となります。次に、攻撃者は標的となるユーザーにアクティブな再生リストを呼び出す不正な Web ページを表示させなければなりません。

Windows Media Player がアクティブな再生リストを処理する方法のため、攻撃者がこの攻撃による被害を発生させるためには、ユーザーがメディア ファイルを再生し、**次に** Windows Media プログラムを閉じた**後**、Web ページを表示させなければなりません。この要件を満たさない場合、攻撃は失敗します。

これは、Windows Media Player がシャット ダウンされる時のみ、情報がアクティブな再生リストに書き込まれるためです。

  
**攻撃者は** **HTML** **形式の電子メールを使用する攻撃を行うことができますか?**
  
はい、できます。攻撃者は電子メールを介し、この脆弱性を悪用した攻撃を行うことができます。しかし、上記で説明したタイミングに関する要件のため、攻撃が自動化されることは、不可能ではありませんが、可能性は極めて低いです。

  
**「制限付きサイト ゾーン」 で電子メールを読み取るクライアントを使用していますが、HTML** **形式の電子メールを介し、この脆弱性を悪用した攻撃から保護されていますか?**
  
この特定の脆弱性のケースでは、「制限付きサイト ゾーン」 で電子メールを読み取ることは、HTML 形式の電子メールを介し、この脆弱性を悪用した攻撃から保護することにはなりません。これは、基本的に HTML 機能は 「制限付きサイト ゾーン」 で許可されているため、脆弱性が起こる充分な状況があります。

  
**電子メールによりこの脆弱性が悪用されることを緩和する要素はありますか?**
  
はい、あります。[Outlook 2002 Service Pack 1](http://office.microsoft.com/japan/downloads/2002/oxpsp1.aspx) の [「テキスト形式で表示」](http://support.microsoft.com/kb/307594) する機能は電子メールにより、この脆弱性が悪用されることから保護します。この理由は、この機能はすべての HTML の機能を無効にするためです。

  
**攻撃者は悪質な** **Web** **サイトから攻撃を行うことができますか?**
  
はい、できます。攻撃者に悪質なメディア ファイルを自分が管理する Web サイトに配置されることにより、この脆弱性を悪用される可能性があります。

しかし、上記で説明したこの脆弱性の特質により、タイミングに関する要件が必要となるため、自動化された攻撃が行われることは不可能ではありませんが、可能性は極めて低いです。

  
**更新プログラムは何を修正しますか?**
  
この更新プログラムはハード ディスクの既知の場所にアクティブな再生リストを書き込まないようにし、アクティブな再生リスト内の情報がエンコードされていることを確認し、HTML スクリプトが情報を呼び出さないようにすることにより、この脆弱性を排除します。

  
**Windows Media Player** **の構成の変更構成の変更で何が起きますか?**
  
この変更は、.wms ([Windows Media スキン](http://www.microsoft.com/japan/windows/windowsmedia/software/v7/p7skins.aspx)に関連するファイル拡張子) を Windows Media Player から削除します。更新プログラムを適用すると、.wms ファイルがクリックされる、または受け取られる時、このファイルは自動的に Windows Media Player を開かなくなります。

  
**それでは、Windows Media** **スキンの機能を削除するということですか?**
  
いいえ、違います。Windows Media スキンの機能は削除されていません。マイクロソフトはスキンの処理方法に変更を行い、Windows Media Player を自動的に開かないようにします。ユーザーは引き続き .wms ファイルをダウンロードし、開き、適用することができます。

  
**なぜこの変更を行うのですか?** **これは** **Windows Media** **スキンに脆弱性が存在したという意味ですか?**
  
いいえ、違います。Windows Media スキンの動作には何の脆弱性も、問題もありません。Windows Media スキンの使用を管理するセキュリティ メカニズムは引き続き安全です。

現在進行中のセキュリティ レビューの一部として、.wms ファイルと Windows Media Player との関連付けを検討しました。その結果、Windows Media Playerの操作にはこの関連付けは必要ないという結論に達しました。このため、「最小限の権限の割り当て」 の対応策に従い、この関連付けを削除しました。

  
**新しい構成オプション**  
**追加のセキュリティ構成の機能で何が起きますか?**
  
この構成の機能により、ユーザーは Windows Media ファイルに含まれる HTML スクリプトの処理を無効にすることができます。

この更新プログラムは Windows Media ファイル内のスクリプトの処理には何の変更も行いません。これらのスクリプトは引き続き正常に機能します。しかし、この更新プログラムは新しい機能を追加します。この機能はユーザーがそのスクリプトの実行を有効にするかどうかを選択することができ、ユーザーはメディア ファイル内に含まれるすべての HTML スクリプトの処理を無効にすることができます。

  
**なぜこの変更を行うのですか?** **これはメディア ファイルに含まれるスクリプトに問題が存在するという意味ですか?**
  
いいえ、違います。Windows Media Player のスクリプト処理機能には何の脆弱性も問題も存在しません。引き続きこの機能を使用しても安全です。

お客様のフィードバックに基づき、マイクロソフトは、この機能を無効にできることに関する要望があることを知りました。このフィードバックにより、マイクロソフトは新しい追加の構成機能を作成し、お客様がこの機能を無効にすることができるようにしました。

  
**この新しい機能に関する詳しい情報はどこで入手できますか?**
  
この新しい機能に関するさらに詳しい情報およびその実装方法については、マイクロソフト サポート技術情報 [320944](http://support.microsoft.com/kb/320944) をご覧下さい。

  
更新プログラム  
--------------
  
<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

なお、Windows Media Player for Windows XP および Windows Media Player 7.1の更新プログラムには、Windows Media Player 6.4 の更新プログラムが含まれています。

Windows Media Player 6.4 の更新プログラムを適用するためには、バージョン 6.4 の Windows Media Player があらかじめインストールされている必要があります。Windows Media Player 6.4 をインストールするお客様は、次のマイクロソフト Web サイトからダウンロードできます。

<http://www.microsoft.com/japan/windows/windowsmedia/download/>

Windows Media Player 7.0 をお使いのお客様は、Windows Media Player 7.1 にアップグレードしてください。アップグレードするには、Windows Media Player を起動し、メニューの \[ヘルプ\] から \[プレーヤーのアップグレードの確認\] をクリックし、ウィザードに従ってアップグレードを行ってください。また、Windows Media Player 7.1 は 次のマイクロソフト Web サイトからダウンロードできます。

<http://www.microsoft.com/japan/windows/windowsmedia/download/>
  
-   Windows 2000 をお使いのお客様におかれましては、この問題に対する修正は Windows 2000 Service Pack 4 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

    <http://www.microsoft.com/japan/windows2000/downloads/>
-   個別の更新プログラムは以下の Web サイトから入手できます。

    -   Microsoft Windows Media Player 6.4:  
        [http://download.microsoft.com/download/winmediaplayer/Update/320920/W98NT42KMe/JA/wm320920\_64.exe](http://download.microsoft.com/download/winmediaplayer/update/320920/w98nt42kme/ja/wm320920_64.exe)  
    -   Microsoft Windows Media Player 7.1:  
        [http://download.microsoft.com/download/winmediaplayer/Update/320920/W982KMe/JA/wm320920\_71.exe](http://download.microsoft.com/download/winmediaplayer/update/320920/w982kme/ja/wm320920_71.exe)  
-   Microsoft Windows Media Player for Windows XP:  
    この問題に対する修正は Windows XP Service Pack 1 以降に含まれています。Windows XP 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

    <http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/>

    なお、個別の更新プログラムは以下の Web サイトから入手できます。  

    [http://download.microsoft.com/download/winmediaplayer/Update/320920/WXP/JA/wm320920\_8.exe](http://download.microsoft.com/download/winmediaplayer/update/320920/wxp/ja/wm320920_8.exe)
  
#### 更新プログラムに関する追加情報
  
**対象プラットフォーム** **:**  
この更新プログラムは Windows Media Player 6.4 または 7.1 を実行しているすべてのオペレーティング システムにインストールすることができます。

再起動の必要性 : インストール後、コンピュータの再起動が必要な場合があります。

Windows Media Player for Windows XP 用の更新プログラムは Windows XP にインストールすることができます。

  
**この修正を含む予定のサービス パック** **:**
  
-   この問題に対する修正は Windows 2000 [Service Pack 4](http://www.microsoft.com/downloads/details.aspx?familyid=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&displaylang=ja) に含まれています。  
-   この問題に対する更新プログラムは Windows XP [Service Pack 1](http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/) に含まれています。

  
**再起動の必要性** **:**  
この更新プログラムの適用時に Windows Media Player を実行している場合のみ、Windows Media Player の再起動が必要となります。コンピュータの再起動は必要ありません。

  
**更新プログラムに含まれる過去の修正** **:**  
[MS01-056](http://technet.microsoft.com/security/bulletin/ms01-056)
  
**更新プログラムが正しくインストールされたか確認する方法** **:**
  
-   この更新プログラムがインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。

    HKLM\\SOFTWARE\\Microsoft\\Updates\\Windows Media Player\\wm320920.1  
-   各ファイルを確認するためには、サポート技術情報 [320920](http://support.microsoft.com/kb/320920) のファイル欄を参照して下さい。

  
**警告** **:**  
なし
  
**他のセキュリティ更新プログラムの入手先** **:**  
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

  
-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード検索によって容易に見つけることができます。  
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

  
更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)
  
### その他の情報
  
**詳細情報** **:**
  
-   US マイクロソフトセキュリティ情報（MS02-032）  

    [http://www.microsoft.com/technet/security/bulletin/ms02-032.mspx](http://technet.microsoft.com/security/bulletin/ms02-032)  
-   サポート技術情報 （KB） 文書番号 ： 320920  
    [\[WMP\] \[MS02-032\] Windows Media Player の更新プログラム](http://support.microsoft.com/kb/320920)
  
**更新履歴** **:**
  
-   2002/6/27: このセキュリティ情報ページを公開しました。  
-   2002/7/18: この問題に対する日本語版 KB を公開しました。  
-   2002/7/26: このセキュリティ情報ページを改訂し、MS01-056 で提供された更新プログラムに不足していたファイルがあったことをお知らせしました。また、「すべての問題の総合的な深刻度」 を示す表を修正しました。

  
本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

  
*Built at 2014-04-18T01:50:00Z-07:00*
