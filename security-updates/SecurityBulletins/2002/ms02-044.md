---
TOCTitle: 'MS02-044'
Title: 'マイクロソフト セキュリティ情報 MS02-044 - 緊急'
ms:assetid: 'ms02-044'
ms:contentKeyID: 61228469
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-044(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS02-044 - 緊急
===============================================

Office Web Components に安全でない機能が含まれる (328130)
---------------------------------------------------------

公開日: 2002年8月22日 | 最終更新日: 2002年9月10日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Office Web Components を使用しているすべてのお客様。Office Web Components はスタンドアロン ダウンロードとして利用可能です。また、下記の一覧にあげられている Microsoft® 製品の一部として含まれています。

**脆弱性の影響** **:**
3 つの脆弱性が存在します。最も深刻な脆弱性で、攻撃者はユーザーのシステムでコマンドを実行する可能性があります。

**最大深刻度** **:**
高

**推奨する対応策** **:**
これらの製品を使用しているお客様は直ちに適切な更新プログラムをインストールして下さい。

**影響を受けるソフトウェア** **:**

-   Microsoft Office Web Components 2000
-   Microsoft Office Web Components 2002
-   Microsoft Access 2000
-   Microsoft Access 2002

**影響を受けるソフトウェアを含む製品** **:**

-   Microsoft BackOffice® Server 2000
-   Microsoft BizTalk® Server 2000
-   Microsoft BizTalk Server 2002
-   Microsoft Commerce Server 2000
-   Microsoft Commerce Server 2002
-   Microsoft Internet Security and Acceleration Server 2000
-   Microsoft Money 2002
-   Microsoft Money 2003
-   Microsoft Office 2000
-   Microsoft Office XP
-   Microsoft Project 2002
-   Microsoft Project Server 2002
-   Microsoft Small Business Server 2000

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
Office Web Components (OWC) はいくつかの ActiveX コントロールを含み、このコントロールにより、ユーザーが Microsoft Office アプリケーションを完全インストールしなくても、Web ブラウザで Microsoft Office の制限された機能がユーザーに提供されます。これにより、ユーザーは、すべてのアプリケーションのインストールができない場合でも、Microsoft Office アプリケーションの機能を活用することができます。

このコントロールには 3 つの脆弱性が存在します。これらのいずれも Web サイトまたは HTML 形式の電子メールを介して悪用される可能性があります。これらの脆弱性はコントロールが公開する次のスプレッドシート関数およびメソッドと、各機能に存在するエラーが原因となって発生します。

-   Host() : 仕様上、この機能は呼び出し元に、ユーザーのシステム上のアプリケーションのオブジェクト モデルへのアクセスを提供します。Host() 機能を使用することにより、たとえば攻撃者はユーザーのシステム上で Office アプリケーションを開き、コマンドを呼び出し、ユーザーとしてオペレーティング システム コマンドを実行する可能性があります。
-   LoadText() : このメソッドにより、Web ページがテキストをブラウザ ウィンドウに読み込むことができます。このメソッドはテキストのソースがウィンドウと同じドメイン内に存在することをチェックしますが、理論的には、その Web ページ自体がホストするテキストのみを読み込むように制限する必要があります。しかし、Web ページのドメイン内にあるテキストのソースを指定し、そのテキストのサーバー側のリダイレクトをユーザーのシステム上のファイルに設定することにより、この制限を無視することができます。これにより、攻撃者にユーザーのシステム上の任意のファイルを読み取る手段を取得される可能性があります。
-   Copy()/Paste() : これらのメソッドにより、テキストのコピーおよび貼り付けができます。このメソッドが Internet Explorer のセキュリティ設定の ［スクリプトによる貼り付け処理の許可］ を ［無効にする］ を無視するためにセキュリティ上の脆弱性が発生します。このため、この設定が選択されていても、Web ページはコピー バッファへのアクセスを続行し、ユーザーがそのほかのアプリケーションからコピー、または切り取ったテキストが読み取られる可能性があります。

この更新プログラムはこのコントロールに “kill bit” を設定しません。この理由は よく寄せられる質問 で説明されています。

**問題を緩和する要素** **:**

**全般** **:**

-   Web ベースの攻撃の場合、攻撃者はユーザーを強制的に攻撃者の Web ページを訪問させる必要があります。Web サイトへの訪問について注意を払っているユーザーは、この危険性を最小限にできる可能性があります。
-   HTML 形式の電子メール ベースの攻撃のケースでは、電子メールを 「制限付きサイト ゾーン」 で読み取るお客様はこの脆弱性が悪用されることから保護されています。Outlook 2002 および Outlook Express 6.0、そして [Outlook 電子メール セキュリティ アップデート](https://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)を適用した Outlook 2000 および Outlook 98 を使用しているお客様は既定で保護されています。また、Outlook Express 5.0 を使用し、電子メールを 「制限付きサイト ゾーン」 で読み取るお客様も、既定で保護されています。
-   HTML 形式の電子メール ベースの攻撃について、Outlook 2002 を使用し、Service Pack 1 またはそれ以降で利用可能な [「テキスト形式で表示」](https://support.microsoft.com/kb/307594) オプションを有効にしているお客様もまた保護されています。

**Host()** **の脆弱性** **:**

|                                | インターネット サーバー | イントラネット サーバー | クライアント システム |
|--------------------------------|-------------------------|-------------------------|-----------------------|
| **Office Web Components 2000** | 中                      | 中                      | 高                    |
| **Office Web Components 2002** | 中                      | 中                      | 高                    |

**LoadText()** **の脆弱性** **:**

|                                | インターネット サーバー | イントラネット サーバー | クライアント システム |
|--------------------------------|-------------------------|-------------------------|-----------------------|
| **Office Web Components 2000** | 低                      | 低                      | 高                    |
| **Office Web Components 2002** | 低                      | 低                      | 高                    |

**Copy()/Paste()** **の脆弱性** **:**

|                                | インターネット サーバー | イントラネット サーバー | クライアント システム |
|--------------------------------|-------------------------|-------------------------|-----------------------|
| **Office Web Components 2000** | 低                      | 低                      | 低                    |
| **Office Web Components 2002** | 低                      | 低                      | 低                    |

**深刻度** **:**

**更新プログラムにより排除されるすべての脆弱性の総合的な深刻度** **:**

|                                | インターネット サーバー | イントラネット サーバー | クライアント システム |
|--------------------------------|-------------------------|-------------------------|-----------------------|
| **Office Web Components 2000** | 中                      | 中                      | 高                    |
| **Office Web Components 2002** | 中                      | 中                      | 高                    |

上記の[評価](https://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。OWC はサーバー製品と関連してインストールされますが、最善策として、この脆弱性がサーバーで悪用される場合の必要条件となる信頼されない Web サイトの訪問および HTML 形式の電子メールの読み取りを行わないことを推奨します。

**脆弱性識別番号** **:**

-   Host() の脆弱性 : [CAN-2002-0727](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0727)
-   LoadText() の脆弱性 : [CAN-2002-0860](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0860)
-   Copy/Paste() の脆弱性 : [CAN-2002-0861](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0861)

**テストしたバージョン** **:**
マイクロソフトは次の製品の Office 2000 Web Components および Office XP Web Components のテストを行い、これらの脆弱性による影響を評価しました。それより前のバージョンの OWC は存在しません。さらに、マイクロソフトは 「影響を受けるソフトウェアを含む製品」 欄にあげられているサポートされているすべてのバージョンを調査し、この脆弱性の影響を受けるソフトウェアが含まれているかどうかを確認しました。それより前のバージョンに関しては[サポート](https://support.microsoft.com/lifecycle/)の対象となっていないため、これらの脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**この更新プログラムは何を修正しますか?**

この更新プログラムはOffice Web Components に存在する 3 つの公開された脆弱性を排除します。

-   攻撃者がユーザーのローカル システムでプログラムを実行する可能性がある脆弱性。
-   攻撃者がローカル システムでファイルのコンテンツを読み取る可能性がある脆弱性。
-   攻撃者がローカル クリップボードのコンテンツを読み取る可能性がある脆弱性。

さらに、この更新プログラムは Office Web Components の機能に関する社内でのコード レビューに基づき、これらの機能を変更しました。この更新プログラムは、製品全体のセキュリティを向上させ、そのほかの潜在的な脆弱性を排除します。

**この更新プログラムに関連する警告はありますか?**

はい、あります。これらの脆弱性は [ActiveX コントロール](https://www.microsoft.com/com/default.mspx) (英語情報) に関連しますが、この更新プログラムは “Kill Bit” を設定しません。

**ActiveX** **コントロールとは何ですか?**

ActiveX コントロールとは、小さな、単一の目的を持つプログラムで、プログラムや Web ページにより呼び出されます。ActiveX により、プログラマは 1 度ソフトウェアを書き、その機能を必要とするそのほかのプログラムに利用することができます。

**“Kill Bit”** **とは何ですか?**

Kill Bit とは ActiveX コントロールがシステムに存在する場合でも、コントロールが Internet Explorer を介し呼び出されることを防ぐメソッドです。(Kill Bit に関する詳細はマイクロソフト サポート技術情報 [240797](https://support.microsoft.com/kb/240797) をご覧ください。) 通常、セキュリティ上の脆弱性に ActiveX コントロールが関連する場合、更新プログラムは新しいコントロールを提供し、Kill Bit を影響を受けるコントロールに設定します。しかし、今回の場合、Kill Bit の設定を行うことができません。

**今回の場合、なぜ** **Kill Bit** **を設定することが不可能なのですか?**

これらの脆弱性に関連する ActiveX コントロールは Office アプリケーションにより作成される Web ページがデータにアクセスするために使用されます。サードパーティのアプリケーションを含む多くのアプリケーションは、データへのアクセスにハードコードされたリファレンスを含みます。この更新プログラムが Kill Bit を設定すると (新しい修正されたバージョンであっても)、Web ページはまったく機能しなくなります。このため、更新プログラムは脆弱性を排除するためにコントロールを更新しますが、新しいコントロールの提供および古いコントロールへの Kill Bit の設定は行いません。

**このアプローチに関する危険は何ですか?**

ここで問題となっている ActiveX コントロールはマイクロソフトによりデジタル署名されており、その署名は依然として有効であるため、特定の状況で、攻撃者がこの脆弱性の影響を受けるバージョンの古いコントロールを更新プログラムが適用されているシステムに再導入し、そのシステムを再度脆弱性の影響を受けるようにする可能性があります。ユーザーが悪質な人物により運営されている Web サイトを訪問するか、または悪質な人物からの HTML 形式の電子メールを開く場合、このような状態が発生することがあります。

**攻撃者はなぜ密かに古いバージョンのコントロールを再導入できるのですか?** **これに関する警告メッセージはないのですか?**

デジタル署名 (例 : 正しくない署名または有効期限の切れた証明書) に関連する、または署名者が信頼されない場合に関するエラーが発生する時には常に警告メッセージが生成されます。しかし、この場合では、古いバージョンのコントロールのデジタル署名は依然として有効であり、署名者は、ほとんどのケースで信頼される発行元であるマイクロソフトです。このため、古いコントロールが再導入されても、ほとんどの場合、ユーザーに警告メッセージは表示されません。

**誰かが古いバージョンのコントロールを再導入しようとする場合、それはどのくらい困難ですか?**

ここで問題になっている ActiveX コントロールが大きいため、攻撃者が古いコントロールを再導入することは困難です。Office Web Components のサイズは 7 MB を超えています。攻撃者がこの脆弱性の影響を受ける古いコントロールをダウンロードしようとしても、たとえば、ディスクが大量に使用され続けるなど、明白な徴候があります。そしてダウンロードの操作が完了するまでに時間を要します。ユーザーがダイヤルアップ接続またはそのほかの低速ネットワーク セッションで操作を行っている場合、後者は特に当てはまります。

**なぜコントロールを署名するために使用された証明書を失効しないのですか?**

コントロールを署名するために使用された証明書は依然として有効です。問題は証明書ではなく、コントロールに存在します。さらに、多くのコントロールが同じ証明書を使用して署名されているため、この証明書を失効すると、すべてのコントロールを無効にすることになります。

**どのようにしてコントロールが密かにシステムに再導入されることを防ぐことができますか?**

最も容易な方法は、マイクロソフトを含め、信頼される発行元を持たないようにして下さい。これを行うことにより、Web ページまたは HTML 形式の電子メールのいずれかにより ActiveX コントロールをダウンロードしようとすると、警告メッセージが生成されるようになります。次に信頼された発行元の一覧を空にする方法を示します。

1.  Internet Explorer の \[ツール\] で \[インターネット オプション\] をクリックします。
2.  \[コンテンツ\] タブを選択します。ページの \[証明書\] セクションで \[発行元\] をクリックします。
3.  \[証明書\] ダイアログで、\[信頼された発行元\] タブをクリックします。
4.  一覧の各証明書について、証明書をクリックし、\[削除\] を選択します。エントリを削除したいことを確認して下さい。
5.  一覧からすべてのエントリを削除したら、\[閉じる\] を選択し、\[証明書\] ダイアログを閉じます。次に \[OK\] をクリックし、\[インターネット オプション\] ダイアログを閉じます。

**\[信頼された発行元\]** **の一覧を空にした後、「Web** **サイトまたは** **HTML** **形式の電子メールがコントロールのダウンロードを必要としている」という内容の警告が表示された場合、これを続行すべきかどうかをどのように決定できますか?**

1 番の尺度は、Web サイトまたは HTML 形式の電子メールの送信者を信頼しているかどうかです。信頼していない場合、ダウンロードをキャンセルして下さい。

**マイクロソフトは** **Kill Bit** **をこのコントロールに設定する予定はありますか?**

はい、あります。マイクロソフトは新しい技術を開発中であり、これにより、ユーザーがこれらのコントロールへの参照を含む Web ページを再作成しなくても、Kill Bit をこの脆弱性の影響を受けるバージョンのコントロールに設定することにより、回避することが可能となります。この新しい技術が利用可能となった時、マイクロソフトはこの修正されたバージョンを使用するように考えています。

**Office Web Components (OWC)** **とは何ですか?**

[OWC](https://office.microsoft.com/downloads/2002/owc10.aspx) (英語情報。日本語情報は近日中に利用可能予定) とは一連の ActiveX コンポーネントであり、ユーザーが Office の完全なバージョンをインストールしなくても、制限された Office 機能を Web ブラウザを持つユーザーに提供します。

OWC の日本語版は、[こちら](https://download.microsoft.com/download/officexpprof/utility/owc10/w98nt42kmexp/ja/owc10.exe)からダウンロードできます。

ユーザーはこの制限された Office 機能をブラウザで使用し、データの操作や分析ができます。たとえば、Web ページでユーザーにスプレッドシート データを表示するために OWC を使用することができます。これにより、ユーザーは Excel をインストールせずに、その重要な機能のいくつかを使用することができます。

**OWC** **はどのように配布されていますか?**

OWC は次の 2 つの方法で配布されています。スタンドアロン ダウンロードまたはそのほかのマイクロソフト製品に含まれています。

-   マイクロソフト Web サイトから別個の独立した[ダウンロード](https://office.microsoft.com/downloads/2002/owc10.aspx) (英語情報) として利用可能です。ユーザーはマイクロソフト Web サイトを訪問し、OWC のダウンロード、インストールを行うことができます。
-   OWC がそのほかのアプリケーションに含まれる場合、OWC はそのほかのアプリケーションのインストール 処理に含まれます。OWC はユーザーがインストールするかどうかを選択できる別個の機能としてインストール オプションで呼び出されることもあります。そのほかの場合では、OWC アプリケーションを構成するファイルはより広範なインストール処理に含まれ、明示的に識別されない場合があります。

**OWC** **がそのほかのアプリケーションに含まれている場合、どのように** **OWC** **がインストールされているかどうかが分かるのですか?**

この脆弱性に関する調査の一部として、マイクロソフトは現在サポートされているアプリケーションの調査を行い、OWC を同梱しているアプリケーションを確認しました。サポートされているアプリケーションで、この脆弱性が存在する OWC のバージョンを同梱しているものは以下の通りです。

-   Microsoft BackOffice Server 2000
-   Microsoft BizTalk Server 2000
-   Microsoft BizTalk Server 2002
-   Microsoft Commerce Server 2000
-   Microsoft Commerce Server 2002
-   Microsoft Internet Security and Acceleration Server 2000
-   Microsoft Money 2002
-   Microsoft Money 2003
-   Microsoft Office 2000
-   Microsoft Office XP
-   Microsoft Project 2002
-   Microsoft Project Server 2002
-   Microsoft Small Business Server 2000

現在サポートされているそのほかのアプリケーションで OWC を同梱しているものはありません。

**更新プログラムは何を修正しますか?**

この更新プログラムは信頼されていないサイトがアクセスする際、安全でないこれらのメソッドおよび機能を排除することにより、この脆弱性を解決します。

**Host()** **の脆弱性** **(CAN-2002-0727) :**
**1** **番目の脆弱性でどのようなことが起こる可能性がありますか?**

この脆弱性により、攻撃者はそのほかのユーザーのシステムで任意のコマンドを実行する可能性があります。これを攻撃者が行うことにより、プログラムの読み込み、実行、システム上のデータの変更、ハード ドライブの再フォーマット、セキュリティ設定の変更など、ユーザーに可能な任意の操作が行われる可能性があります。

ユーザーのアカウントに関する制限はすべて攻撃者の操作も同様に制限します。たとえば、グループ ポリシーにより、ユーザーがシステムのセキュリティ設定の変更ができない場合、攻撃者は同様に制限されます。

**何が原因で起こりますか?**

この脆弱性は OWC のスプレッドシート コンポーネントが Host() 機能を公開するために起こります。

**Host()** **機能とは何ですか?**

Host() 機能は、この機能を呼び出すスクリプトやプログラムに、そのほかのアプリケーションのオブジェクト モデルへのアクセスを提供するようにデザインされています。アプリケーションのオブジェクト モデルが呼び出し元に利用可能になると、呼び出し元は、アプリケーションにより利用可能となるプログラム可能なオプションのすべてにアクセスできます。たとえば、スクリプトは Host() 機能を使用して Excel のオブジェクト モデルへのアクセスを取得します。そして、そのアクセスを使用し、Excel により利用可能となるプログラム可能なメソッドや機能を呼び出すことができます。

**Host()** **機能の何が問題になっていますか?**

OWC は 「スクリプトを実行しても安全」 であるとマークされていますが、この機能の機能性は信頼されないサイトによる使用には不適切です。このため、OWC は 「スクリプトを実行しても安全」 であるとマークされているコンポーネントを介し、公開されるべきではありません。

**この脆弱性により、攻撃者は何ができますか?**

攻撃者によりこの機能を悪用され、HTML スクリプト内の Host() 機能を呼び出し、ユーザーが選択したかのようにユーザーのシステムでコマンドを実行される可能性があります。また、攻撃者によりユーザーがアクセスしたデータの追加、変更、削除が行われる可能性があります。さらに、攻撃者によりユーザーが変更する権限を持つブラウザのセキュリティ設定などの設定が変更される可能性があります。

**攻撃者はどのようにこの脆弱性を悪用するのですか?**

この脆弱性が悪用されるには、攻撃者がホスト メソッドを呼び出す Web ページを作成し、それを Web サイトでホストされる、または別のユーザーに HTML 形式の電子メールとして送信されることにより行われます。いずれの場合でも、HTML 形式のページがレンダリングされると、ブラウザまたはメール クライアントで攻撃者のスクリプトが実行され、この脆弱性が悪用されます。

**Web** **ベースの攻撃による危険を緩和する要素はありますか?**

はい、あります。ユーザーが攻撃者の Web サイトへの訪問を選択することが、攻撃が行われる必要条件となりますが、攻撃者はこの脆弱性を悪用しても、ユーザーを強制的に、そして自動的に攻撃者の Web サイトを訪問させることはできません。このため、ユーザーが Web サイトのブラウジングに注意を払っている場合、ユーザー自身を保護することができます。具体的には、ユーザーが不明な信頼されない Web サイト訪問を避ける場合、またはこれらの Web サイトを 「制限付きサイト ゾーン」 (このサイトは ActiveX コントロールを無効にします) に含める場合、ユーザーは Web サイト上でこの脆弱性が悪用される可能性を緩和または排除できる場合があります。

**HTML** **形式の電子メールによる攻撃を緩和する要素はありますか?**

はい、あります。ActiveX コントロールを無効にするメール クライアントは HTML 形式の電子メール ベースの攻撃の可能性を排除できます。マイクロソフト製品に対し、これを行うための 2 つの方法があります。

-   お客様は電子メールを 「制限付きサイト ゾーン」 で読み取るメール クライアントを使用することができます。既定で Outlook Express 6.0 および Outlook 2002 は HTML 形式の電子メールを 「制限付きサイト ゾーン」 で開きます。さらに、Outlook 98 および 2000 は、[Outlook電子メール セキュリティ アップデート](https://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)がインストールされている場合、HTML 形式の電子メールを 「制限付きサイト ゾーン」 で開きます。Outlook Express 5.0 は HTML 形式の電子メールを 「制限付きサイト ゾーン」 で読み取るように構成することができます。
-   お客様は HTML 形式の電子メールを普通のテキストとして読み取るメール クライアントを使用することができます。[Outlook 2002 Service Pack 1](https://office.microsoft.com/japan/downloads/2002/oxpsp1.aspx) で導入された [「テキスト形式で表示」](https://support.microsoft.com/kb/307594) 機能を有効にしているお客様はこの脆弱性が悪用されることに対し、保護されます。

**LoadText()** **の脆弱性** **(CAN-2002-0860) :**
**2** **番目の脆弱性で何が起こる可能性がありますか?**

これは情報の漏えいの脆弱性です。この脆弱性により、悪質な Web サイトの管理者により Web サイトを訪問するユーザーのコンピュータ上のファイルが表示されてしまう可能性があります。

この脆弱性を緩和する多くの要素があります。

-   この脆弱性はファイルを読み取るためのみに悪用される可能性があります。この脆弱性を悪用してもファイルの作成、変更、削除、実行はできません。
-   攻撃者がユーザーのコンピュータ上のファイルの場所と名前を知っていることが必要条件となります。

**何が原因で起こりますか?**

LoadText() メソッドを公開する OWC のスプレッドシート コンポーネントに存在する問題のため、この脆弱性が起こります。

**LoadText()** **メソッドとは何ですか?**

[LoadText()](https://msdn2.microsoft.com/en-us/library/aa165560) (英語情報) メソッドとはプログラミング メソッドで、テキスト ファイルをワークシートに読み込み、解析するよう、スプレッドシートに指示します。

**LoadText()** **メソッドの何が問題になっていますか?**

仕様上、LoadText() メソッドはテキスト ファイルがスプレッドシートに読み込まれるようにデザインされています。この機能にそのファイルの場所を渡すことにより、これらのテキスト ファイルをネットワーク先のファイルとして指定できます。たとえば、LoadText() メソッドはネットワーク サーバーの共有ディレクトリ上のテキスト ファイルの検索を行うように指示することができます。このメソッドが OWC に実装されている場合、データはスプレッドシートをホストする Web ページに読み込まれます。

現在のデザインでは、Web ページがリモート ファイル共有ではなくユーザー自身のシステムに存在するファイルを指定することができます。これが行われると、ファイルは読み取られ、データは Web ページに読み込まれます。

ブラウザのドメイン制限の性質のため、このデータが Web ページに読み込まれると、ホストしている Web サイトはデータの操作を行うことができます。たとえば、ホストしている Web サイトにデータを送り返す操作などです。

**これにより攻撃者は何ができますか?**

これにより攻撃者は LoadText() メソッドを使用し、標的となるマシン上のファイルを読み取る HTML 形式の Web ページを作成できます。

**攻撃者はどのようにこの脆弱性を悪用しようとするのですか?**

攻撃者がこの脆弱性を悪用する可能性については Host() 機能の脆弱性と同一です。攻撃者はWeb サイトまたは HTML 形式の電子メールを介し、この脆弱性を悪用しようとします。ユーザーは Host() 機能の脆弱性について説明されている同じステップにより、ユーザー自身を保護することができます。

**Copy()/Paste()** **の脆弱性** **(CAN-2002-0861) :**
**3** **番目の脆弱性で何が起こる可能性がありますか?**

これは情報の漏えいの脆弱性です。具体的には、この脆弱性により、Web サイトがプログラムにより、ユーザーのクリップボードのコンテンツを読み取る (ユーザーがWeb サイトによりこれが行われないように設定している場合でも) 可能性があります。

このオプションの既定の設定ではクリップボードへのプログラムによるアクセスが許可されます。したがって、この脆弱性による危険はこの機能の既定の設定で最も深刻となります。しかし、この機能の既定の設定により、情報のプライバシを制御するセキュリティ設定が無視されるため、脆弱性が発生します。

**何が原因で起こりますか?**

OWC のスプレッドシート コンポーネントの Copy() および Paste() メソッドが Internet Explorer の \[スクリプトによる貼り付け処理の許可\] を \[有効にする\] 設定を無視するため、この脆弱性が起こります。

**Copy()** **および** **Paste()** **メソッドとは何ですか?**

[Copy()](https://msdn2.microsoft.com/en-us/library/aa165425) (英語情報) および [Paste()](https://msdn2.microsoft.com/en-us/library/aa141394) (英語情報) メソッドとは Windows の ［コピー］ および ［貼り付け］ の動作とプログラム的に同等です。ユーザーが ［コピー］ または ［貼り付け］ を選択した場合と同じように、これらのコマンドはデータの送信や Windows クリップボードからのデータの削除を行います。

**これにより攻撃者は何ができますか?**

これにより攻撃者は、ユーザーがクリップボードへのプログラムによる アクセスを明示的に無効にしている場合でも、ユーザーの Windows クリップボードに対し、スクリプトを介しコピーや貼り付け操作ができます。攻撃者は HTML スクリプトを介し、ユーザーのブリップボードを操作しようとする可能性があります。

**これにより攻撃者はどのようなデータへのアクセスを取得しますか?**

これにより攻撃者はユーザーが行ったコピーおよび貼り付け操作からの Windows クリップボードにすでに存在するすべてのデータへのアクセスを取得します。Windows クリップボードの性質とその使用方法のため、データは予測不可能で、ほとんどの場合、攻撃者の興味の対象となりません。

**この脆弱性により攻撃者は取得するデータを指定することができますか?**

いいえ、できません。データは攻撃が行われる前に Windows クリップボードに存在していることが必要条件となります。この脆弱性を悪用しても、攻撃者は Windows クリップボードに保存されるデータを指定することはできません。

**［スクリプトによる貼り付け処理の許可］の設定に関する詳細はどこで入手できますか?**

マイクロソフト サポート技術情報 [224993](https://support.microsoft.com/kb/224993) でこの機能について説明しています。

**攻撃者はどのようにこの脆弱性を悪用しようとするのですか?**

攻撃者がこの脆弱性を悪用する可能性については Host() 機能の脆弱性と同一です。攻撃者はWeb サイトまたは HTML 形式の電子メールを介し、この脆弱性を悪用しようとします。ユーザーは Host() 機能の脆弱性について説明されている同じステップにより、ユーザー自身を保護することができます。

**改善策** **:**
**どのようにしてこれらの脆弱性を排除できますか?**

これらの脆弱性についての修正は現在以下で利用可能です。

-   Office XP SP2
-   Office XP Service Pack 2
-   Microsoft Project 2002 用の更新プログラム
-   Microsoft Project Server 2002 用の更新プログラム
-   そのほかのすべての製品用の更新プログラム (全般的な更新プログラム)
-   Office Web Components ダウンロードの更新されたバージョン

**どのようにしてこれらの脆弱性を排除すればよいのですか?**

これらの脆弱性を解決する推奨される方法として、使用している製品に基づき、下記を確認して下さい。

-   **Microsoft Office XP :** Microsoft Office XP を使用しているお客様は、可能であれば Office XP Service Pack 2 を適用して下さい。SP2 の適用ができない場合、全般的な更新プログラムが適用できます。しかし、SP2 が、この脆弱性を解決する、より望ましい方法です。この理由は SP2 にはこの特定の問題以外のそのほかの修正も含まれているためです。マイクロソフトは常にこの理由のため、更新プログラムよりも Service Pack を[推奨](https://www.microsoft.com/japan/technet/archive/community/columns/security/essays/srvpatch.mspx)します。
-   **Microsoft Project 2002 :** Microsoft Project 2002 を使用しているユーザーは Microsoft Project 2002 用の更新プログラムを適用する必要があります。Microsoft Project を使用している場合、これが、これらの問題を解決できる唯一の方法です。Microsoft Project 2002 を使用しているユーザーは全般的な更新プログラムを使用することはできません。
-   **Microsoft Project Server 2002 :** Microsoft Project Server 2002 を使用しているお客様は Microsoft Project Server 2002 用の更新プログラムを適用する必要があります。これが、これらの問題を解決できる唯一の方法です。Microsoft Project Server 2002 を使用しているユーザーは全般的な更新プログラムを使用することはできません。詳細はQ328044 をご覧ください。
-   **そのほかのすべての製品** **:** そのほかのすべての製品を使用しているお客様は次のいずれかの方法でこれらの脆弱性を解決することができます。

    -   全般的な更新プログラムをインストールする
    -   更新された Office Web Components ダウンロードをインストールする

ほとんどの場合、全般的な更新プログラムの適用が、より望ましいソリューションです。しかし、どちらのオプションも充分にこれらの脆弱性を解決します。Office XP を使用しているお客様は更新された Office Web Components ダウンロードの更新プログラムを適用することができます。しかし、SP2 の適用を検討することを推奨します。Microsoft Project 2002 を使用しているお客様は Microsoft Project 2002 用の更新プログラムを使用する必要があり、全般的な更新プログラムおよび更新された Office Web Components ダウンロードのいずれも使用することはできません。

**混乱してきましたが、Microsoft Project 2002** **を使用している場合、何をする必要がありますか?**

Microsoft Project 2002 を実行している場合、Microsoft Project 2002 用の更新プログラムを適用して下さい。

**Microsoft Project 2002** **とそのほかの影響を受けるアプリケーションの** **1** **つを実行している場合はどうすればよいのですか?**

Microsoft Project 2002 で問題を解決する唯一の方法は Microsoft Project 2002 用の更新プログラムの適用です。しかし、この更新プログラムは Microsoft Project 2002 のみを修正します。影響を受けるそのほかの製品がシステムに存在している場合、これらに関する問題を別途解決する必要があります。

たとえば、Office XP と Microsoft Project 2002 を使用している場合、Microsoft Project 2002 を修正するために Microsoft Project 2002 用の更新プログラムを適用して下さい。次に、Office XP Service Pack 2 または全般的な更新プログラムを適用して、Office XP の問題を解決して下さい。

つまり、Microsoft Project 2002 を使用している場合、Microsoft Project 2002 用の更新プログラムを適用する必要があります。Microsoft Project と、影響を受けるそのほかの製品がシステムに存在する場合、別途、解決を行う必要があります。

**Microsoft Project Server 2002** **を実行していますが、何をする必要がありますか?**

Microsoft Project Server 2002 を実行している場合、Microsoft Project Server 2002 用の更新プログラムを適用して下さい。

**Microsoft Project Server 2002** **用の更新プログラムは** **Microsoft Project 2002** **用のものと同じですか?**

いいえ、違います。Microsoft Project Server 2002 用の更新プログラムは Microsoft Project 2002 用のものとは異なります。Microsoft Project Server 用の更新プログラムはサーバー側の更新プログラムであり、Microsoft Project Server のみに適用されなければなりません。Microsoft Project 2002 用の更新プログラムはクライアント側の更新プログラムであり、Microsoft Project 2002 を実行しているすべてのシステムに適用する必要があります。

**Office XP** **を実行していますが、何をする必要がありますか?**

Office XP を実行している場合、可能であれば Office XP Service Pack 2 を適用して下さい。Office XP SP2 はこれらの問題を解決するとともに、そのほかの多くの重要なセキュリティや安定性に関する修正を含んでいます。

Office XP SP2 の適用が可能でない場合、全般的な更新プログラムまたは更新された Office Web Components ダウンロードを適用して下さい。

**Web** **サイトから** **OWC** **をインストールしましたが、何をする必要がありますか?**

Web サイトから OWC をインストールした場合、OWC が現在インストールされているシステムに全般的な更新プログラムを使用して下さい。

**Microsoft Project 2002** **や** **Office XP** **を実行していません。また** **Web** **サイトから** **OWC** **をインストールしていません。この場合、何をする必要がありますか?**

一覧にあげられているそのほかの製品を使用しているお客様はこれらの脆弱性を解決するために、全般的な更新プログラムを適用して下さい。

**Access 2000/2002** **を実行していますが、何をする必要がありますか?**

Access 2000/2002 をインストールすると、OWC が自動的にインストールされます。 全般的な更新プログラムを使用して下さい。

**更新プログラムを適用したところ、"アップデート対象のファイルがインストールされていません。"** **というメッセージが表示され、エラーが発生してしまいました。**

このエラーは、OWC を構成しているファイル msowc.dll がコンピュータ内に存在しない場合に発生します。このエラーが発生するほとんどのお客様は Office 2000 Personal をお使いであると考えられます。

Office 2000 Personal には OWC は含まれていません。完全インストールを行われた場合でもインストールされません。そのため本脆弱性は Office 2000 Personal をお使いのお客様のほとんどの方には影響を与えませんので、更新プログラムのインストールも行う必要がありません。

しかし、脆弱性が残された古いバージョンの OWC を、別途、弊社の Web サイトから入手して使用しているお客様は、本脆弱性の対策を行っていただく必要があります。

OWC がお使いのコンピュータにインストールされている事を確認する方法は、下の FAQ の項目をご覧ください。

**私のコンピュータに** **OWC** **がインストールされているかどうかを確認する方法は？**

OWC を使用しているかどうかを調べるためには、以下の手順でコンピュータに msowc.dll ファイルが存在するかを確認します。

1.  \[スタート\] ボタンをクリックし、\[検索\] - \[ファイルやフォルダ\] をクリックします。
2.  \[名前\] ボックスに MSOWC.DLL と入力し、\[探す場所\] ボックスで OS がインストールされているドライブ (既定では C ドライブ) を指定して、\[検索開始\] ボタンを押します。
3.  検索結果として MSOWC.DLL ファイルが表示された場合には、コンピュータに OWC がインストールされています。

この調査の結果、OWC がインストールされている事が確認できましたら、本更新プログラムを適用してください。

**これらのコントロールにさらにkillbit** **を設定したいのですが、できますか?**

はい、これらのコントロールにkillbit を手動で設定することができます。しかし、コントロールに killbit を手動で設定することにより、OW C を使用するアプリケーションが正常な動作をしなくなったり、全く動作しなくなったりする可能性があることにご注意ください。

どうしても OWC に killbit を設定する必要がある場合、[240797](https://support.microsoft.com/kb/240797) に記載されている手順に従い、以下の CLSID を入力してください。

OWC 2000:

-   CLSID: {0002E530-0000-0000-C000-000000000046}  
    ProgID: OWC.DataSourceControl.9
-   CLSID: {0002E510-0000-0000-C000-000000000046}  
    ProgID: OWC.Spreadsheet.9
-   CLSID: {0002E500-0000-0000-C000-000000000046}  
    ProgID: OWC.Chart.9
-   CLSID: {0002E520-0000-0000-C000-000000000046}  
    ProgID: OWC.PivotTable.9
-   CLSID: {0002E531-0000-0000-C000-000000000046}  
    ProgID: OWC.RecordNavigationControl.9

OWC 2002:

-   CLSID: {0002E553-0000-0000-C000-000000000046}  
    ProgID: OWC10.DataSourceControl.10
-   CLSID: {0002E551-0000-0000-C000-000000000046}  
    ProgID: OWC10.Spreadsheet.10
-   CLSID: {0002E556-0000-0000-C000-000000000046}  
    ProgID: OWC10.ChartSpace.10
-   CLSID: {0002E552-0000-0000-C000-000000000046}  
    ProgID: OWC10.PivotTable.10
-   CLSID: {0002E554-0000-0000-C000-000000000046}  
    ProgID: OWC10.RecordNavigationControl.10

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   マイクロソフトは、[Office 製品のアップデート](https://office.microsoft.com/japan/productupdates/) サイトを使用して、Office XP SP2 をインストールされることを推奨します。
-   全般的な更新プログラム :

    [https://download.microsoft.com/download/OfficeXPProf/Update/
    Owcupd/W98NT42KMeXP/JA/owcupd.exe](https://download.microsoft.com/download/officexpprof/update/owcupd/w98nt42kmexp/ja/owcupd.exe)
    **注意 :** Office 2000 Personal を使用しているコンピュータに更新プログラムをインストールすると、"アップデート対象のファイルがインストールされていません。" というメッセージが表示される場合があります。このメッセージに関しての詳細はよく寄せられる質問をご確認ください。
-   Microsoft Project 2002:
    <https://office.microsoft.com/downloads/2002/prj1001.aspx>
-   Microsoft Project Server 2002:

    [https://download.microsoft.com/download/msftproject2002/Update/
    ps1001/W98NT42KMeXP/JA/ps1001jp.exe](https://download.microsoft.com/download/msftproject2002/update/ps1001/w98nt42kmexp/ja/ps1001jp.exe)
-   Office Web Components Download:

    [https://download.microsoft.com/download/OfficeXPProf/Update/
    Owcupd/W98NT42KMeXP/JA/owcupd.exe](https://download.microsoft.com/download/officexpprof/update/owcupd/w98nt42kmexp/ja/owcupd.exe)

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**

**全般的な更新プログラム** **:**

-   Microsoft BackOffice Server 2000 またはそれ以降
-   Microsoft BizTalk Server 2000 またはそれ以降
-   Microsoft BizTalk Server 2002 またはそれ以降
-   Microsoft Commerce Server 2000 またはそれ以降
-   Microsoft Commerce Server 2002 またはそれ以降
-   Microsoft Internet Security and Acceleration Server 2000 またはそれ以降
-   Microsoft Money 2002 またはそれ以降
-   Microsoft Money 2003 またはそれ以降
-   Microsoft Office 2000 またはそれ以降
-   Microsoft Office XP またはそれ以降
-   Microsoft Project Server 2002 またはそれ以降
-   Microsoft Small Business Server 2000 またはそれ以降

**Microsoft Project 2002** **用の更新プログラム** **:**

-   Microsoft Project 2002 またはそれ以降

**Microsoft Project Server 2002** **用の更新プログラム** **:**

-   Microsoft Project Server 2002 またはそれ以降

**この修正を含む予定のサービスパック** **:**
この問題に対する更新プログラムは Office XP [Service Pack 2](https://office.microsoft.com/japan/downloads/2002/oxpsp2.aspx) に含まれています。

**再起動の必要性** **:**
なし。更新プログラムの適用時に、すべての Office アプリケーションを閉じている場合、再起動の必要はありません。

**更新プログラムのアンインストール** **:**
不可

**更新プログラムに含まれる過去の修正** **:**
なし

**更新プログラムが正しくインストールされたか確認する方法** **:**

-   全般的な更新プログラム : [322382](https://support.microsoft.com/kb/322382) で説明されているファイルのバージョンを確認して下さい。
-   Microsoft Project 2002 用の更新プログラム : [328043](https://support.microsoft.com/kb/328043) で説明されているファイルのバージョンを確認して下さい。
-   Microsoft Project Server 2002 用の更新プログラム : [328044](https://support.microsoft.com/kb/328044) で説明されているファイルのバージョンを確認して下さい。

**警告** **:**
なし

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](https://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](https://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](https://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-044）  
    [https://www.microsoft.com/technet/security/bulletin/ms02-044.mspx](https://technet.microsoft.com/security/bulletin/ms02-044)
-   サポート技術情報 （KB） 文書番号 ： 322382  
    [\[OFFXP\] Office Web コンポーネント セキュリティ アップデート : 2002 年 8 月 20 日](https://support.microsoft.com/kb/322382)
-   サポート技術情報 （KB） 文書番号 ： 328043  
    [\[PRJ2002\] Microsoft Project 2002 アップデート : 2002 年 8 月 20 日](https://support.microsoft.com/kb/328043)
-   サポート技術情報 （KB） 文書番号 ： 328044  
    [\[PSVR2002\] Microsoft Project Server 2002 アップデート : 2002 年 8 月 20 日](https://support.microsoft.com/kb/328044)
-   サポート技術情報 （KB） 文書番号 ： 328130  
    [\[MS02-044\] Office Web コンポーネントに安全でない機能が含まれている](https://support.microsoft.com/kb/328130)

**更新履歴** **:**

-   2002/08/22: このセキュリティ情報ページを公開しました。
-   2002/08/23: Office 2000 Personal 環境でのインストールに関する注意文を追記しました。
-   2002/8/27: このセキュリティ情報ページを更新し、LoadText() メソッドを使用して読み取ることができるファイルの種類に関しての誤りを訂正しました。
-   2002/8/27: 「よく寄せられる質問」 を更新し、このコントロールに手動で "killbits" を設定する方法に関する情報を追加しました。
-   2002/8/29: この問題に対する日本語版 KB JP322382、JP328043 および JP328044 を公開しました。
-   2002/9/10: この問題に対する日本語版 KB JP328130 を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
