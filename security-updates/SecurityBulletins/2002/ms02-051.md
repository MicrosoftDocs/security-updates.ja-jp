---
TOCTitle: 'MS02-051'
Title: 'マイクロソフト セキュリティ情報 MS02-051 - 警告'
ms:assetid: 'ms02-051'
ms:contentKeyID: 61228476
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-051(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS02-051 - 警告
===============================================

RDP プロトコルの暗号の問題により、情報が漏えいされる (324380)
-------------------------------------------------------------

公開日: 2002年9月19日 | 最終更新日: 2002年9月27日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Windows® 2000 を使用してターミナル サーバーを実行しているシステム管理者、リモート デスクトップを有効にしている Windows XP ユーザー

**脆弱性の影響** **:**
2 つの脆弱性。情報の漏えいおよびサービス拒否

**最大深刻度** **:**
中

**推奨する対応策** **:**
Windows 2000 ターミナル サーバーの管理者およびリモート デスクトップを有効にしている Windows XP ユーザーは更新プログラムを適用して下さい。

**影響を受けるソフトウェア** **:**

-   Microsoft Windows 2000
-   Microsoft Windows XP

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
Remote Data Protocol (RDP) は、Windows システムがクライアントへリモート ターミナル セッションを提供できる手段を提供します。このプロトコルはターミナル セッションのキーボード、マウスおよびビデオに関する情報をリモート クライアントへ送信します。また、このプロトコルは Windows NT 4.0 および Windows 2000 のターミナル サービス、そして Windows XP のリモート デスクトップにより使用されます。様々な RDP 実装に 2 つのセキュリティ上の脆弱性が確認され、この更新プログラムはこれらの脆弱性を排除します。

1 番目の脆弱性は、セッションの暗号化が RDP の特定のバージョンで実装されている方法に関連します。すべての RDP の実装により、RDP セッションのデータは暗号化されます。しかし、Windows 2000 および Windows XP のバージョンでは、プレーンテキスト セッション データのチェックサムが暗号化されずに送信されます。攻撃者が RDP セッションを盗聴し、記録できる場合、チェックサムに対し、暗号文解読の攻撃を行い、セッションのトラフィックを復号する可能性があります。

2 番目の脆弱性は Windows XP の RDP の実装が特定の方法で不正な形式にされているデータ パケットを処理する方法に関連します。このようなパケットを受信すると、リモート デスクトップ サービスは異常終了し、これにより、オペレーティング システムが異常終了する可能性があります。この種類のパケットを、影響を受けるシステムに配信するために、攻撃者は影響を受けるシステムに認証を行う必要はありません。

**問題を緩和する要素** **:**
RDP プロトコルの暗号の問題

-   この脆弱性は、攻撃者が RDP セッションをキャプチャできないかぎり、悪用されることはありません。RDP セッションのキャプチャを行うためには、ほとんどの場合、ネットワーク メディアに物理的なアクセスを持っている必要があります。
-   暗号化鍵はセッションごとにネゴシエートされるため、攻撃が成功しても、攻撃者は、複数のセッションではなく、単一のセッションのみを解読できるのみにとどまります。このため、攻撃者は標的とする各セッションに対し、暗号文解読の攻撃を個別に行う必要があります。

リモート デスクトップのサービス拒否 :

-   Windows XP のリモート デスクトップ サービスは既定で有効ではありません。
-   リモート デスクトップ サービスが有効であったとしても、攻撃が行われるのは、攻撃者が影響を受けるシステムのリモート デスクトップ ポートにパケットを配信できる場合のみです。ファイアウォールでポート 3389 をブロックしているお客様はこの脆弱性が悪用されることから保護される可能性があります。(既定で、インターネット接続ファイアウォールはポート 3389 をブロックします。)

**深刻度** **:**

|                                        | インターネット サーバー | イントラネット サーバー | クライアント システム |
|----------------------------------------|-------------------------|-------------------------|-----------------------|
| **RDP** **プロトコルの暗号の問題**     | 中                      | 中                      | 中                    |
| **リモートデスクトップのサービス拒否** | なし                    | なし                    | 中                    |

上記の[評価](http://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。「RDP プロトコルの暗号の問題」 の脆弱性を悪用されるのは、攻撃者がネットワーク メディアへのアクセスを持っている場合のみです。「リモート デスクトップのサービス拒否」 の脆弱性は、リモート デスクトップ共有が有効にされている Windows XP システムのみに影響を及ぼします。

**脆弱性識別番号** **:**

-   RDP プロトコルの暗号の問題 : [CAN-2002-0863](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0863)
-   リモート デスクトップのサービス拒否 : [CAN-2002-0864](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0864)

**テストしたバージョン** **:**
マイクロソフトは Windows NT 4.0 Terminal Services Edition、Windows 2000 および Windows XP のテストを行い、これらの脆弱性による影響を評価しました。それ以前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**この更新プログラムはどのような脆弱性を排除しますか?**

この更新プログラムは RDP プロトコルの実装に影響を及ぼす 2 つの脆弱性を排除します。

-   1 番目は Windows 2000 および Windows XP に影響を及ぼす暗号の問題に関連します。
-   2 番目は Windows XP の実装のみに影響を及ぼすサービス拒否の脆弱性に関連します。

**RDP** **プロトコルとは何ですか?**

[Remote Desktop Protocol](http://www.microsoft.com/windows/products/windowsxp/) (英語情報) とはクライアントとサーバー間のリモート Windows ターミナル セッションをサポートするプロトコルです。これは通常、ネットワークで、ローカル コンソール セッション (キーボード操作、ビデオ、マウス データなど) に関連するすべての情報を転送します。これにより、ユーザーはリモート システムとの完全な対話的なログオン セッションができるようになります。マイクロソフト サポート技術情報 [186607](http://support.microsoft.com/kb/186607) でこのプロトコルに関する技術的な詳細が説明されています。

**どのマイクロソフト製品に** **RDP** **が実装されていますか?**

一般的に、RDP はリモート デスクトップ セッションを可能にする Windows の機能の基礎となるプロトコルです。これが実装されている製品の例は次の通りです。

-   Windows NT 4.0, Terminal Server Edition は RDP 4.0 を実装しています。
-   Windows 2000 のターミナル サービスは RDP 5.0 を実装しています。
-   [リモート デスクトップ共有](http://www.microsoft.com/windows/products/windowsxp/) (英語情報) は RDP 5.1 を実装しています。

**RDP** **セッションは既定で** **Windows** **で有効にされていますか?**

RDP セッションは既定で Windows NT 4.0, Terminal Server Edition で有効ですが、Windows のほかのバージョンでは有効ではありません。(しかし、これらのいずれの脆弱性も Windows NT 4.0, Terminal Server Edition では発生しません。)

**RDP** **プロトコルの暗号の問題** **(CAN-2002-0863) : 1** **番目の脆弱性でどのようなことが起こる可能性がありますか?**

この脆弱性により、攻撃者に暗号化されたRDP セッションのコンテンツを読み取り、そのデータを改ざんされる可能性があります。これはユーザー名、パスワード、ユーザーがアプリケーションに入力するデータ、または、アプリケーションによりユーザーに表示されるデータなどを含みます。

この脆弱性は、攻撃者が RDP セッションを盗聴し、記録できない限り悪用されることはありません。ほとんどの場合、これを行うためには、攻撃者はネットワーク メディア自体に物理的アクセスを持っていることが必要となります。また、攻撃者は記録されたデータに暗号文解読の攻撃を行う技術力を持っていることが必要となります。(しかし、攻撃は容易で単純なものです。) Windows 2000 および Windows XP の RDP 実装のみがこの脆弱性の影響を受けます。

**何が原因で起こりますか?**

セッション データが RDP 5.0 (Windows 2000 に同梱されているバージョン) や RDP 5.1 (Windows XP に同梱されているバージョン) で暗号化されても、セッション データのチェックサムが暗号化されないために、この脆弱性が起こります。

**RDP** **の暗号化とは何ですか?**

RDP パケットはインターネットやエクストラネットのように管理されていない、または信頼されないネットワークで送信される場合があるため、[RDP](http://msdn2.microsoft.com/en-us/library/aa383015) (英語情報) は RC4 暗号化アルゴリズムを使用してリモート セッションを暗号化します。Windows XP 以前のバージョンでは、サーバー管理者は使用するキー サイズを選択することができます。Windows XP では、すべてのセッションが 128 ビット キーを使用して保護されます。

しかし、この脆弱性は RDPにより使用される暗号化アルゴリズム、またそのキーのサイズのいずれにも関係がありません。チェックサム データの処理に関連する実装エラーのために、この脆弱性が起こります。

**チェックサムデータとは何ですか?**

チェックサムは、転送中に発生するエラーを検出、および修正する方法として、頻繁にネットワーク アプリケーションで使用されます。あるコンピュータがデータ パケットを送る前に、データで数値演算操作を行い、次にデータ自体とともに操作の結果を送ります。別のコンピュータがそのデータとチェックサムを受信すると、受信したデータに同じ数値演算操作を実行し、受信したデータとその結果が一致することを確認します。一致する場合、これはデータが転送中に破損しなかったことを示します。

**暗号化された** **RDP** **セッションでチェックサムが処理される方法の何が問題になっていますか?**

セッション データ自体のように、チェックサムは暗号化される必要があります。しかし、Windows 2000 および Windows XP の RDP の実装では、チェックサムは暗号化されません。セッション データは暗号化されますが、それが暗号化される前にチェックサムが計算されます。そしてそのチェックサムはプレーンテキストで送られます。

**これがなぜセキュリティ上の脆弱性となるのですか?** **チェックサムは単にセッションデータに関する情報であり、結局は、チェックサムはセッションデータと異なるのではないですか?**

その通りです。しかし、攻撃者がセッション データをチェックサムから復号できる可能性のある、容易で単純な暗号文解読のテクニックがあります。暗号化を壊した後、攻撃者はユーザーの RDP セッション全体を見ることができる可能性があります。ユーザーがキーボードで入力した情報から、ユーザーのマウスの操作まで、画面に表示されるあらゆる情報が読み取られる可能性があります。

**攻撃者はどのようにこの脆弱性を悪用する可能性がありますか?**

この脆弱性が悪用されるには、攻撃者はまずユーザーの暗号化されたネットワーク トラフィックを (最も高い可能性としてはネットワーク パケット トレーサを使用することにより) キャプチャする手段を持っている必要があります。ほとんどの場合、攻撃者はセッション データを伝送するネットワーク ケーブルへの物理的なアクセスを持っている必要があるため、これは重要なポイントです。

データをキャプチャした後、セッション データの暗号を 「クラック」 するために、攻撃者はそれを暗号文解読の攻撃の対象とする必要があります。これを行うためには、RDP データの形式および暗号文解読のテクニックに関する技術的な知識が必要となりますが、これらは攻撃者にとって困難な障害とはなりません。

**攻撃者があるセッションを解読した場合、その後のセッションを解読することはさらに容易になりますか?**

いいえ。一意のセッション キーは各 RDP セッションの開始時にネゴシエートされるため、セッションの侵害を試行するごとに、攻撃者は攻撃に必要な手順を最初から行わなければなりません。

**この脆弱性は** **Windows NT 4.0** **に影響を及ぼしますか?**

いいえ。Windows 2000 および Windows XP の RDP 実装のみがこの脆弱性の影響を受けます。

**更新プログラムは何を修正しますか?**

この更新プログラムはセッション データだけでなく、チェックサムも暗号化することによりこの脆弱性を排除します。

**リモートデスクトップのサービス拒否** **(CAN-2002-0864) : 2** **番目の脆弱性でどのようなことが起こる可能性がありますか?**

これは[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者はこの脆弱性を悪用し、リモート セッションをホストしているシステムを異常終了させ、保存されていないデータを損失させる可能性があります。

この脆弱性は Windows XP のみに影響を及ぼしますが、影響を受ける機能は既定では有効になっていません。この機能が有効とされている場合でも、この脆弱性は、攻撃者が影響を受けるシステムにデータを配信できないかぎり悪用されることはありません。このため、通常のファイアウォールによる対応策を講じているユーザーは、インターネット ベースの攻撃による危険にはさらされません。

**何が原因で起こりますか?**

RDP 5.1 (Windows XP に実装されているバージョン) が特定の無効なデータ パケットを処理する方法に問題が存在するため、この脆弱性は起こります。無効なデータ パケットを正常に処理せず、RDP とオペレーティング システム自体は、その処理時に異常終了する可能性があります。

**Windows XP** **の** **RDP** **の実装がこの脆弱性に関連する無効なデータを処理する方法の何が問題になっていますか?**

仕様上、RDP は着信データ パケットを処理する前に、常にその有効性をチェックする必要があります。しかし、Windows XP の RDP の実装は着信パケットに存在する特定の種類の問題をチェックしません。このため、処理されると、後にオペレーティング システム自体のエラーの原因となる一連のエラーを発生するパケットを作成できる可能性があります。

**この脆弱性により、攻撃者は何ができますか?**

攻撃者はリモート デスクトップ セッションを有効にするように構成されている Windows XP システムを異常終了させる可能性があります。通常のサービスを復元させるためには、オーペレ-タはマシンを再起動する必要があります。

**誰がこの脆弱性を悪用する可能性がありますか?**

この脆弱性に関連する特定のパケットを、影響を受ける Windows XP システムに配信することができるユーザーにより、この脆弱性が悪用される可能性があります。

**Windows XP** **の既定のインストールはこの脆弱性の影響を受けますか?**

いいえ。リモート デスクトップ サービスは既定で実行されません。

**リモートデスクトップが有効にされているかどうか分かりません。これはどのように確認できますか?**

\[スタート\] を選択し、\[コントロール パネル\] で \[システム\] を選択します。\[システムのプロパティ\] ダイアログで、\[リモート\] タブを選択し、\[リモート デスクトップ\] セクションのチェックボックスを確認して下さい。チェックボックスにチェックが入っている場合、リモート デスクトップは有効となっています。チェックが入っていない場合、リモート デスクトップは無効となっています。

**この脆弱性が悪用されるのは、攻撃者がリモートデスクトップセッションを確立できる場合ですか?**

いいえ。攻撃者は標的となるポートに攻撃に必要なパケットのセットを送ることのみが必要となります。

**この脆弱性はインターネットから悪用される可能性がありますか?**

攻撃者が RDP が実行されているポート (ポート 3389) へパケットを配信できるかどうかによります。標準の最善策が講じられている場合、このポートはファイアウォールでブロックされます。(たとえば、このポートは既定で[インターネット接続ファイアウォール](http://www.microsoft.com/windows/products/windowsxp/) (英語情報) でブロックされます。)

**この脆弱性はユーザーの不注意により発生する可能性はありますか?**

いいえ。サーバーを異常終了させる原因となる特定の一連のパケットは通常のリモート デスクトップ セッションの一部として生成されません。

**更新プログラムは何を修正しますか?**

この更新プログラムはリモート デスクトップ サービスが不正なパケットを正常に処理するようにして、この脆弱性を排除します。

更新プログラム
--------------

<span></span>
Windows 2000 用のこの問題に対する更新プログラムは [MS04-011](http://technet.microsoft.com/security/bulletin/ms04-011) で提供されている更新プログラムに含まれています。[MS04-011](http://technet.microsoft.com/security/bulletin/ms04-011) の問題も解決することができる [MS04-011](http://technet.microsoft.com/security/bulletin/ms04-011) の更新プログラムをご利用ください。

この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

- Windows 2000
    この問題に対する修正は Windows 2000 Service Pack 4 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

    <http://www.microsoft.com/japan/windows2000/downloads/>

    なお、個別の更新プログラムは以下の Web サイトから入手できます。

 - PC/AT 互換機用
        [http://www.microsoft.com/downloads/details.aspx?FamilyId=C9A38D45-5145-4844-B62E-C69D32AC929B&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=c9a38d45-5145-4844-b62e-c69d32ac929b&displaylang=ja)
 - NEC PC-9800 シリーズ用
        [http://download.microsoft.com/download/win2000platform/PatchNEC/Q324380/NT5/JA/Q324380\_W2K\_SP4\_nec98\_JA.exe](http://download.microsoft.com/download/win2000platform/patchnec/q324380/nt5/ja/q324380_w2k_sp4_nec98_ja.exe)
- Windows XP
    この問題に対する修正は Windows XP Service Pack 1 以降に含まれています。Windows XP 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

    <http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/>

    なお、個別の更新プログラムは以下の Web サイトから入手できます。


    [http://www.microsoft.com/downloads/details.aspx?FamilyId=84fc577d-f2d5-47b8-ab98-77ba7501b00b&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=84fc577d-f2d5-47b8-ab98-77ba7501b00b&displaylang=ja)
- Windows XP 64 bit Edition
    この問題に対する修正は Windows XP Service Pack 1 以降に含まれています。Windows XP 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

    <http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/>

    なお、個別の更新プログラムは以下の Web サイトから入手できます。


    [http://www.microsoft.com/downloads/details.aspx?FamilyId=84fc577d-f2d5-47b8-ab98-77ba7501b00b&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=84fc577d-f2d5-47b8-ab98-77ba7501b00b&displaylang=ja)

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**

-   Windows 2000 用の更新プログラムは、Windows 2000 Service Pack 2 または Service Pack 3 を実行しているシステムにインストールすることができます。
-   Windows XP用の更新プログラムは、Windows XP を実行しているシステムにインストールすることができます。

**この修正を含む予定のサービスパック** **:**

-   この問題に対する更新プログラムは Windows 2000 [Service Pack 4](http://www.microsoft.com/downloads/details.aspx?familyid=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&displaylang=ja) に含まれています。
-   この問題に対する更新プログラムは Windows XP [Service Pack 1](http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/) に含まれています。

**再起動の必要性** **:**
あり

**更新プログラムのアンインストール** **:**
可

**更新プログラムに含まれる過去の修正** **:**
なし

**更新プログラムが正しくインストールされたか確認する方法** **:**
Windows 2000 :

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP4\\Q324380
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP4\\Q324380\\Filelist

Windows XP :

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP1\\Q324380
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP1\\Q324380\\Filelist

**警告** **:**
なし

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-051）

    [http://www.microsoft.com/technet/security/bulletin/ms02-051.mspx](http://technet.microsoft.com/security/bulletin/ms02-051)
-   サポート技術情報 （KB） 文書番号 ： 324380
    [\[MS02-051\] RDP プロトコルの暗号化の問題により、情報が漏えいされる](http://support.microsoft.com/kb/324380)

**更新履歴** **:**

-   2002/9/19: このセキュリティ情報ページを公開しました。
-   2002/9/27: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
