---
TOCTitle: 'MS02-056'
Title: 'マイクロソフト セキュリティ情報 MS02-056 - 緊急'
ms:assetid: 'ms02-056'
ms:contentKeyID: 61228481
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-056(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS02-056 - 緊急
===============================================

SQL Server 用の累積的な修正プログラム (316333)
----------------------------------------------

公開日: 2002年10月3日 | 最終更新日: 2003年2月3日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® SQL Server™ 7.0 および SQL Server 2000、Microsoft Data Engine (MSDE) 1.0 および SQL Server 2000 Desktop Engine (MSDE 2000) を使用しているシステム管理者

**脆弱性の影響** **:**
3 つの脆弱性があります。最も深刻な脆弱性については、攻撃者は影響を受けるサーバーで制御を取得する可能性があります。

**最大深刻度** **:**
高

**推奨する対応策** **:**
システム管理者は影響を受けるシステムに更新プログラムを適用して下さい。

**注** **:**
このセキュリティ情報で提供された累積的な更新プログラムは "SQL Slammer" ワーム ウイルスに対し、SQL Server 2000 および MSDE 2000 を保護する効果があります。しかし、この累積的な更新プログラムは [MS02-061](http://technet.microsoft.com/security/bulletin/ms02-061) でリリースされた更新プログラムに含まれています。MS02-061 の更新プログラムにはこれらの製品に存在するそのほかの脆弱性に対する修正も含まれています。マイクロソフトは SQL 2000 および MSDE 2000 を使用しているお客様に [MS02-061](http://technet.microsoft.com/security/bulletin/ms02-061) でリリースされた更新プログラムを適用することを推奨します。

**影響を受けるソフトウェア** **:**

-   Microsoft SQL Server 7.0 のすべてのエディション
-   Microsoft Data Engine (MSDE) 1.0
-   Microsoft SQL Server 2000 のすべてのエディション
-   SQL Server 2000 Desktop Engine (MSDE 2000)

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
この累積的なセキュリティ更新プログラムは、マイクロソフト サポート技術情報 [317748](http://support.microsoft.com/kb/317748) で提供された更新プログラム (これは SQL Server 2000 および MSDE 2000 の安定動作に必要となります) を含みません。[317748](http://support.microsoft.com/kb/317748) の更新プログラムを適用する前に、SQL Server 2000 または MSDE 2000 インストールにこの累積的な更新プログラムを適用した場合、この累積的な更新プログラムのファイルを上書きしないために、ファイルの上書きの確認メッセージが表示された場合、\[いいえ\] を選択して下さい。

これは累積的な更新プログラムで、SQL Server 7.0、SQL Server 2000 および Microsoft Data Engine (MSDE) 1.0、SQL Server 2000 Desktop Engine (MSDE 2000) 用に以前リリースされたすべての更新プログラムを含みます。さらに、新たに確認された 3 つの脆弱性を排除しています。

-   ユーザー認証に関連する SQL Server 2000 (および MSDE 2000) のコードのセクションに含まれるバッファオーバーランの脆弱性。影響を受けるサーバーに不正なログイン リクエストが送られることにより、攻撃者がサーバーを異常終了させる可能性があります。また、サーバーのメモリを上書きすることにより SQL Server サービスのセキュリティ コンテキストで、サーバー上でコードを実行できる可能性があります。この脆弱性は、ユーザーが、正常にサーバーに認証されない場合や、直接コマンドが実行できない場合においても、悪用される可能性があります。
-   SQL Server 7.0 および 2000 の Database Console Commands (DBCC) の 1 つで起こるバッファオーバーランの脆弱性。最も深刻な場合、この脆弱性により、攻撃者のコードが、SQL Server サービスのコンテキストで実行される可能性があります。これにより、サーバーのすべてのデータベースを完全に制御することができます。
-   SQL Server 7.0 および 2000 のスケジュールされたジョブに関連する脆弱性。ジョブ ステップが出力ファイルを作成するようリクエストすると、SQL Server エージェントはジョブの所有者の権限ではなく、SQL Server エージェント自体の権限で出力ファイルの作成を行います。これにより、権限を持たないユーザーがそのほかのユーザーのスタートアップ フォルダに有効なオペレーティング システム コマンドを含むファイルを作成するジョブを送信する、または単にシステムの操作を中断させるためにシステム ファイルを上書きする可能性があります。

また、この累積的な更新プログラムは SQL Server の動作を変更し、管理者以外のユーザーが SQL OLEDB 以外のデータ ソースにアドホック クエリを行うことを防ぎます。現状、セキュリティ上の脆弱性は存在しませんが、修正された動作ではサーバーにインストールされている可能性のある正しくコードされていないデータ プロバイダが悪用されることをさらに困難にします。

**問題を緩和する要素** **:**
SQL Server 2000 の認証機能に含まれる未チェックのバッファ :

-   この脆弱性は SQL Server 2000 および MSDE 2000 に影響を及ぼします。SQL Server 7.0 および MSDE 1.0 はこの脆弱性の影響を受けません。
-   SQL Server ポート (ポート 1433) がファイアウォールでブロックされている場合、この脆弱性がインターネットから悪用される可能性はありません。
-   この脆弱性により、攻撃者は SQL Server サービス アカウントのレベルに権限を昇格することができます。既定で、このサービスはシステムの権限ではなく、ドメイン ユーザーの権限で実行されます。しかしながら、 MSDE 2000 につきましては、既定でこのサービスはシステムの権限で動作します。

Database Console Command に含まれる未チェックのバッファ :

-   この脆弱性により、攻撃者は SQL Server サービス アカウントのレベルに権限を昇格することができます。既定で、このサービスはシステムの権限ではなく、ドメイン ユーザーの権限で実行されます。
-   この脆弱性が悪用されるには、攻撃者が影響を受ける SQL Server に認証を行う必要があります、またはサーバーに直接クエリを実行できることが必要条件になります。
-   この脆弱性が悪用されるには、攻撃者が影響を受ける SQL Server に認証を行う必要があります。

スケジュールされたジョブの出力ファイル処理の問題 :

-   この脆弱性が悪用されるには、攻撃者が影響を受ける SQL Server に認証を行う必要があります。

**深刻度** **:**
SQL Server 2000 の認証機能に含まれる未チェックのバッファ :

|                                            | インターネット サーバー | イントラネット サーバー | クライアント システム |
|--------------------------------------------|-------------------------|-------------------------|-----------------------|
| **SQL Server 7.0 (MSDE 1.0** **を含む)**   | なし                    | なし                    | なし                  |
| **SQL Server 2000 (MSDE 2000** **を含む)** | 高                      | 高                      | なし                  |

Database Console Command に含まれる未チェックのバッファ :

|                                            | インターネット サーバー | イントラネット サーバー | クライアント システム |
|--------------------------------------------|-------------------------|-------------------------|-----------------------|
| **SQL Server 7.0 (MSDE 1.0** **を含む)**   | 高                      | 高                      | なし                  |
| **SQL Server 2000 (MSDE 2000** **を含む)** | 高                      | 高                      | なし                  |

スケジュールされたジョブを処理する出力ファイルの問題 :

|                                            | インターネット サーバー | イントラネット サーバー | クライアント システム |
|--------------------------------------------|-------------------------|-------------------------|-----------------------|
| **SQL Server 7.0 (MSDE 1.0** **を含む)**   | 高                      | 高                      | なし                  |
| **SQL Server 2000 (MSDE 2000** **を含む)** | 高                      | 高                      | なし                  |

この累積的な更新プログラムにより排除されるすべての脆弱性の総合的な深刻度 : (以前にリリースされた更新プログラムで解決された問題も含む。)

|                                            | インターネット サーバー | イントラネット サーバー | クライアント システム |
|--------------------------------------------|-------------------------|-------------------------|-----------------------|
| **SQL Server 7.0 (MSDE 1.0** **を含む)**   | 高                      | 高                      | なし                  |
| **SQL Server 2000 (MSDE 2000** **を含む)** | 高                      | 高                      | なし                  |

上記の[評価](http://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。

**脆弱性識別番号** **:**

-   SQL Server 2000 の認証機能に含まれる未チェックのバッファ : [CAN-2002-1123](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1123)
-   Database Console Command に含まれる未チェックのバッファ : [CAN-2002-1137](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1137)
-   スケジュールされたジョブの出力ファイル処理の問題 : [CAN-2002-1138](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1138)

**テストしたバージョン** **:**
マイクロソフトは SQL Server 2000 および SQL Server 7.0 (および MSDE のこれらに関連するバージョン) のテストを行い、これらの脆弱性による影響を評価しました。それ以前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**この累積的な更新プログラムを**[**317748**](http://support.microsoft.com/kb/317748)**で説明された更新プログラムと関連してインストールする場合の正しい順序を教えて下さい。**

この累積的なセキュリティ更新プログラムは、サポート技術情報 [317748](http://support.microsoft.com/kb/317748) で提供された更新プログラム (これは SQL Server 2000 および MSDE 2000 の安定動作に必要となります) を含みません。インストールの正しい順序は、まず [317748](http://support.microsoft.com/kb/317748) の更新プログラムを適用し、次にこの累積的なセキュリティ更新プログラムを適用します。サポート技術情報 [317748](http://support.microsoft.com/kb/317748) の更新プログラムを適用する前に、SQL Server 2000 または MSDE 2000 のインストールにこの累積的な更新プログラムを適用した場合、この累積的な更新プログラムのファイルを上書きしないために、ファイルの上書きの確認メッセージが表示された場合、\[いいえ\] を選択して下さい。

**この累積的な更新プログラムがインストールされているかどうかはどのように確認するのですか?**

この累積的な更新プログラムを適用したインスタンスの \\MSSQL\\BINN フォルダ内の ssnetlib.dll のバージョンが 2000.80.679.0 であることを確認して下さい。

\\MSSSQL\\BINN フォルダ内の ssnetlib.dll のバージョンが 2000.80.636.0 以前である場合、この累積的な更新プログラムを再適用する必要があります。しかし、マイクロソフトは [MS02-061](http://technet.microsoft.com/security/bulletin/ms02-061) で説明されているように、最新のセキュリティ更新プログラムを適用することを推奨します。この理由は、最新の更新プログラムにはこれらの製品に存在するそのほかのセキュリティ上の脆弱性に対する修正が含まれているためです。

**この更新プログラムはどのような脆弱性を排除しますか?**

これは累積的な更新プログラムで、適用することにより、以前に解決されたすべての脆弱性だけでなく、新たに確認された次の 3 つの脆弱性も排除します。

-   攻撃者が SQL Server 2000 データベースで制御を取得する可能性がある脆弱性。
-   マイクロソフト セキュリティ情報 [MS02-038](http://technet.microsoft.com/security/bulletin/ms02-038) で説明した脆弱性の変種。これにより、すでに認証されたユーザーが SQL Server で追加の権限を取得する可能性があります。
-   攻撃者が、他のユーザーのスタートアップ フォルダに有効なオペレーティング システム コマンドを含むファイルを作成して、そのユーザーがシステムにログオンした時に、そのプログラムを実行できる、または SQL Server エージェント サービスがアクセスできるファイルを上書きする可能性がある脆弱性。

**この更新プログラムは累積的な更新プログラムですか?**

この累積的な更新プログラムは以前リリースされた SQL Server 7.0 および SQL Server 2000 データベース エンジンに関連するすべてのセキュリティ更新プログラムを含みます。しかし、この更新プログラムを適用するだけでは、SQL Server に対して充分なセキュリティを確保することにはなりません。

-   マイクロソフト セキュリティ情報 [MS02-035](http://technet.microsoft.com/security/bulletin/ms02-035) で説明した SQL Server 2000 の修正は、更新プログラムのインストールではなく、ツールの実行を必要とします。このツールは一度実行すれば適用されるため、以前ツールを実行したお客様は追加の対応策を行う必要はありません。しかし、この累積的な更新プログラムのインストールだけでは、ツールは自動的に実行されません。
-   この累積的な更新プログラムには SQL Server の Microsoft Data Access Component (MDAC) または Online Analytic Processing (OLAP) 技術に関連するセキュリティ上の脆弱性に対する更新プログラムは含まれません。これらの問題 (マイクロソフト セキュリティ情報の 「警告」 欄に記載されています。) に対する更新プログラムは別途適用する必要があります。

**マイクロソフトセキュリティ情報の「影響を受けるソフトウェア」の欄によると、Microsoft Desktop Engine (MSDE)** **もまたこれらの脆弱性の影響を受けるとのことですが、MSDE** **とは何ですか?**

[Microsoft Desktop Engine](http://msdn2.microsoft.com/en-us/library/ms811092) (MSDE) (英語情報) とは SQL Server の技術に基づいて構築されたデータベース エンジンです。これは Microsoft Visual Studio や Microsoft Office Developer Edition など、いくつかのマイクロソフト製品に同梱されています。MSDE と SQL Server のバージョンは直接関連しています。MSDE 1.0 は SQL Server 7.0 に基づき、MSDE 2000 は SQL Server 2000 に基づいています。

**この累積的な更新プログラムはそのほかの更新プログラムを含みますか?**

この累積的な更新プログラムは、それ自体はセキュリティ上の脆弱性ではない問題も修正し、正しく構成されていないシステムが攻撃者により悪用されることを防ぎます。具体的には、この累積的な更新プログラムは SQL Server の動作を変更し、権限を持たないユーザーを SQL Server データにクエリを実行するのみに制限します。この変更はSQL データ プロバイダ以外がシステムにインストールされており、そのプロバイダ用のドライバが適切なセキュリティ対策を講じていない場合、権限を持たないユーザーが悪用することを防ぐことができます。

**SQL Server 2000** **の認証機能に含まれる未チェックのバッファ** **(CAN-2002-1123) :** **この脆弱性でどのようなことが起こる可能性がありますか?**

これは[バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。影響を受けるサーバーに不正なログイン リクエストを送ることにより、攻撃者は SQL Server サービスを異常終了させる、またはデータベースで制御を取得する可能性があります。ユーザーが正常にサーバーに認証されない場合においても、この脆弱性が悪用される場合があります。

この脆弱性は SQL Server 2000 および MSDE 2000 のみに影響を及ぼします。この脆弱性により、データベースで制御が取得される可能性はありますが、既定の状態では、攻撃者によりオペレーティング システム レベルでの重要な制御が取得されることはありません。

**何が原因で起こりますか?**

認証リクエストを処理する SQL Server 2000 (および MSDE 2.0) の機能に未チェックのバッファが含まれるために、この脆弱性が起こります。綿密に選択したパラメータでこの機能を呼び出すことにより、攻撃者はバッファ オーバランの状態を発生させる可能性があります。

**これはどのような認証リクエストについてですか?**

サーバーの[構成](http://msdn2.microsoft.com/en-us/library/aa176599) (英語情報) 方法により、ユーザーを認証するために SQL Server 認証または Windows 認証のいずれかのメソッドが使用されます。しかし、実際の認証プロセスが行われる前に、SQL Server はいくつかの予備情報を交換します。この脆弱性はこの予備情報の交換に関連する機能に存在します。

**認証機能の何が問題になっていますか?**

この機能は未チェックのバッファの影響を受けます。このため、攻撃者がバッファをオーバランさせるような方法で予備情報の交換を開始し、SQL Server サービスのメモリを上書きする可能性があります。

**この脆弱性により、攻撃者は何ができますか?**

攻撃者はこの脆弱性を悪用し、次のいずれかを行う可能性があります。攻撃者がランダム データを入力した場合、サービスのメモリが上書きされ、サービスが異常終了する可能性があります。この場合、管理者は SQL Server を再起動することにより、通常の状態に復旧することができます。

一方、綿密に選択されたデータを入力することにより、攻撃者は SQL Server でフル コントロールを取得し、データの追加、削除、変更、SQL Server のパラメータの再構成、データベースでの任意の操作を行う可能性があります。

**誰がこの脆弱性を悪用する可能性がありますか?**

影響を受ける SQL Server に認証を試行することができるユーザーにより、この脆弱性が悪用される可能性があります。そのユーザーが正常に認証されるかどうかに関わらず、この脆弱性が悪用される場合があります。

**これは、攻撃者が有効な** **SQL Server** **のユーザー** **ID** **やパスワードを取得していない場合でも、この脆弱性が悪用されるという意味ですか?**

その通りです。認証機能に脆弱性が存在するため、この脆弱性を悪用しようとする攻撃者はサーバーにログ オンする必要はありません。認証の試行の開始を知らせるデータ パケットを配信することのみが必要となります。

**この脆弱性はインターネットから悪用される可能性はありますか?**

攻撃者が認証の交換を行うことができるかどうかによります。脆弱性を悪用するには、SQL Server ポート (ポート 1433) がファイアウォールで開かれていることが必要条件となります。ポートを閉じている場合 (この状態が必須である場合を除き)、攻撃者はこの脆弱性をインターネットから悪用することはできません。

**SQL Server 7.0** **を実行していますが、この脆弱性の影響を受けますか?**

いいえ、受けません。この脆弱性は SQL Server 2000 (および MSDE 2000) のみに影響を及ぼします。SQL Server 7.0 (または MSDE 1.0) はこの脆弱性の影響を受けません。しかし、このセキュリティ情報で説明されているその他の脆弱性が SQL Server 7.0 に影響を及ぼすため、SQL Server 7.0 の管理者はこの累積的な更新プログラムをインストールする必要があります。

**この累積的な更新プログラムはどのようにしてこの脆弱性を排除しますか?**

この累積的な更新プログラムにより、認証機能で適切なバッファのチェックが行われるようにします。

**Database Console Command** **に含まれる未チェックのバッファ** **(CAN-2002-1137) :** **この脆弱性でどのようなことが起こる可能性がありますか?**

これはマイクロソフト セキュリティ情報 [MS02-038](http://technet.microsoft.com/security/bulletin/ms02-038) で最初に説明された脆弱性の変種で、[バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。これにより、攻撃者は SQL Server を異常終了させる、またはデータベースで完全な制御を取得する可能性があります。

**何が原因で起こりますか?**

SQL Server の機能として提供されている Database Console Command (DBCC) ユーティリティの 1 つが、ユーザーの入力を処理するコードに未チェックのバッファを含むために、この脆弱性が起こります。

**Database Console Command (DBCC)** **とは何ですか?**

[DBCC](http://msdn2.microsoft.com/en-us/library/aa258281) (英語情報) とは SQL Server 2000 の機能として提供されるユーティリティ プログラムです。これらはデータベース管理者に日常の一般的なタスクを容易に実行する方法を提供します。たとえば、DBCC はデータベースの最適化、軽度なエラーの修復、統計情報の表示などを行うために利用することができます。SQL Server 2000 の一部として利用可能な DBCC の一覧は SQL Server 2000 オンライン ヘルプ機能にて紹介されています。

**この脆弱性はセキュリティ情報** **MS02-038** **で説明された** **DBCC** **の脆弱性とどのような相違点がありますか?**

この脆弱性はマイクロソフト セキュリティ情報 [MS02-038](http://technet.microsoft.com/security/bulletin/ms02-038) で説明された DBCC の脆弱性と 1 点を除き、同一の脆弱性です。[MS02-038](http://technet.microsoft.com/security/bulletin/ms02-038) で説明された DBCC の脆弱性との相違点は、この変種の影響を受ける DBCC を管理者権限を持たないユーザーが実行できるという点です。

**この累積的な更新プログラムはどのようにしてこの脆弱性を解決しますか?**

この累積的な更新プログラムにより、影響を受ける DBCC で適切なバッファ処理が行われるようにします。

**スケジュールされたジョブの出力ファイル処理の問題** **: (CAN-2002-1138):** **この脆弱性でどのようなことが起こる可能性がありますか?**

この脆弱性により、攻撃者は次のいずれかを行う可能性があります。それは、そのほかのユーザーがサーバーにログ オンした時に実行されるプログラムを作成する、またはシステムの動作を中断する目的で、システム ファイルを破損する可能性があります。

この脆弱性が悪用されるには、攻撃者が SQL Server に認証を行う必要があります。さらに、上記で説明した1 つ目の攻撃のシナリオでは、この脆弱性が悪用された場合の影響はシステムにログ オンしたユーザーの持つ権限により異なります。

**何が原因で起こりますか?**

ジョブ所有者がシステム管理者 (sysadmin サーバー ロール メンバ) でない場合、またはジョブ所有者が標準の SQL サーバー ユーザーである場合、SQL Server エージェントがスケジュールされたジョブの一部として出力ファイルを作成する時、ジョブを所有するユーザーの権限または構成されたプロキシ アカウントではなく、SQL Server エージェント自体の権限を使用して、出力ファイルを作成するため、この脆弱性が起こります。

**SQL Server** **エージェントとは何ですか?**

[SQL Server エージェント](http://www.microsoft.com/technet/prodtechnol/sql/default.mspx) (英語情報) は、スケジュールされたジョブの実行、データベース サービスの再起動およびそのほかの管理操作を行います。

**スケジュールされたジョブとは何ですか?**

[スケジュールされたジョブ](http://msdn2.microsoft.com/en-us/library/aa213815) (英語情報) は SQL Server が特定の時間に指定された処理を行うようにする方法を提供します。スケジュールされたジョブは管理者が定期的にスケジュールされたメンテナンス (バックアップなど) を実行するために頻繁に使用されます。

**誰がスケジュールされたジョブを作成できますか?**

すべてのユーザーがスケジュールされたジョブを作成できますが、SQL Server エージェントは、リクエストしたユーザーが適切な権限を持つ場合のみ、特定のジョブ ステップを実行します。

**SQL Server** **エージェントがスケジュールされたジョブを処理する方法の何が問題になっていますか?**

仕様上、スケジュールされたジョブのすべてのジョブ ステップは、ジョブを送信したユーザーの権限を使用して行われます。また、プロキシ アカウントの権限で行われる場合もあります。しかし、ジョブが出力ファイルを作成する場合、SQL Server エージェント自体の権限を使用してこれを行います。SQL Server エージェント サービス アカウントは、多くの場合、 Windows 管理者権限で構成されるため、ジョブはユーザーの権限に関わらず、システムのどこへでもファイルを作成することができます。

**この脆弱性により、攻撃者は何ができますか?**

攻撃者はこの脆弱性を悪用し、次のいずれかの目的で、システムにファイルを作成する可能性があります。

-   システムの動作を中断する。ランダム データでシステム ファイルを上書きすることにより、攻撃者はシステムを異常終了させる可能性があります。
-   他のユーザーに攻撃者が選択したプログラムを実行させる。有効なオペレーティング システム コマンドを含む出力ファイルを作成し、攻撃を行うためのフォルダ (例 : ユーザーのスタートアップ フォルダ) にそれを置くことにより、攻撃者はそのユーザーがシステムにログ オンする時に、そのコマンドが実行されるようにする可能性があります。

**攻撃者はどのようにこの脆弱性を悪用する可能性がありますか?**

この脆弱性を悪用するには、攻撃者が影響を受けるサーバーにログ オンする必要があります。攻撃者は次に出力ファイルを作成するスケジュールされたジョブを作成し、実行することにより、この脆弱性を悪用する可能性があります。

**攻撃者がシステムファイルを上書きした場合、通常の動作を再開するためには何を行う必要がありますか?**

上書きされたファイルにより異なります。管理者がサービスを再起動することのみで対応可能な場合もあります。しかし、最悪の場合、管理者はシステム修復ディスクを使用してシステム ファイルを復元する必要があります。

**攻撃者が他のユーザーのスタートアップフォルダにプログラムを作成した場合、どのようなことが起こりますか?**

そのユーザーが持つ権限により異なります。プログラムはそのユーザーが行えるすべての操作を行うことができます。

**この累積的な更新プログラムはどのようにしてこの脆弱性を解決しますか?**

この累積的な更新プログラムは、どのユーザーがジョブ ステップから出力ファイルを作成するための正しい権限を持っているかを確認する時、Windows 認証されたユーザーが関連する場合、SQL Server エージェントがジョブ所有者の資格情報を使用するようにし、また SQL Server 認証が関連する場合、プロキシ アカウントの資格情報を使用するようにします。この結果、ユーザーのジョブは引き続き出力ファイルを作成することができますが、ユーザーまたはプロキシ アカウントの権限が許可されるエリアのみでこれが行われるようにします。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

- Microsoft SQL Server 7.0:
  <http://support.microsoft.com/kb/327068>

  ダウンロード先で、次のファイルを選択してダウンロードしてください。

  日本語版 : 7.00.1077\_jpn.exe
- Microsoft SQL Server 2000:
  この問題に対する修正は SQL Server 2000 Service Pack 3 以降に含まれています。SQL Server 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

  <http://www.microsoft.com/japan/sql/prodinfo/previousversions/downloads/2000/sp3.mspx>

  なお、個別の更新プログラムは以下の Web サイトから入手できます。


  [http://support.microsoft.com/kb/316333](http://support.microsoft.com/kb/jp316333)
    ダウンロード先で、次のファイルを選択してダウンロードしてください。

    日本語版 : 8.00.0679\_jpn.exe

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**

-   SQL Server 7.0 用の更新プログラムは SQL Server 7.0 Service Pack 4 を実行しているシステムにインストールすることができます。
-   SQL Server 2000 用の更新プログラムは SQL Server 2000 [Service Pack 2](http://www.microsoft.com/japan/sql/prodinfo/previousversions/downloads/2000/sp2.mspx) を実行しているシステムにインストールすることができます。

**この修正を含む予定のサービスパック** **:**
この問題に対する更新プログラムは SQL Server 2000 [Service Pack 3](http://www.microsoft.com/japan/sql/prodinfo/previousversions/downloads/2000/sp3.mspx) に含まれています。

**再起動の必要性** **:**
なし。SQL サービスのみを再起動する必要があります。

**更新プログラムのアンインストール** **:**
ダウンロード可能なパッケージ内の Readme.txt にアンインストールの方法が含まれています。

**更新プログラムに含まれる過去の修正** **:**
この累積的な更新プログラムはマイクロソフト セキュリティ情報 [MS02-043](http://technet.microsoft.com/security/bulletin/ms02-043) で提供された累積的な更新プログラムを含みます。

**更新プログラムが正しくインストールされたかどうか確認する方法** **:**

-   SQL Server 7.0:
    この更新プログラムが正しくインストールされたことを確認するためには、マイクロソフト サポート技術情報 <http://support.microsoft.com/kb/327068> のファイル欄に挙げられているファイルの日付/タイム スタンプを参照し、各ファイルを確認して下さい。
-   SQL Server 2000:
    この更新プログラムが正しくインストールされたことを確認するためには、マイクロソフト サポート技術情報 <http://support.microsoft.com/kb/316333> のファイル欄に挙げられているファイルの日付/タイム スタンプを参照し、各ファイルを確認して下さい。

**警告** **:**

-   Microsoft Windows NT Server 4.0 Service Pack 6a または Microsoft Windows NT 4.0 Terminal Server Edition Service Pack 6 を実行している場合、この問題に対する更新プログラムを適用する前にサポート技術情報 [258437](http://support.microsoft.com/kb/258437) で説明されている 更新プログラム を適用する必要があります。258437 の更新プログラム は現在[ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)から入手可能です。詳細についてはサポート技術情報をご覧ください。
-   この累積的な更新プログラムにはマイクロソフト セキュリティ情報 [MS02-035](http://technet.microsoft.com/security/bulletin/ms02-035) で提供された Killpwd ツールの機能は含まれません。
-   この更新プログラムは SQL Server 2000 に含まれる MDAC 及び OLAP 用の更新プログラムは含んでいません。そのため、MDAC 及び OLAP に対するセキュリティ更新プログラムに関しては別途適用を行う必要があります。SQL Server 2000 Service Pack 2 以降にリリースされた SQL Server 2000 に対応した MDAC または OLAP 用の更新プログラムは、次のセキュリティ情報で説明されている更新プログラムです。

    -   マイクロソフト セキュリティ情報 [MS02-030](http://technet.microsoft.com/security/bulletin/ms02-030)
-   この累積的な更新プログラムをインストールするプロセスはサーバーの特定の構成により、若干異なります。システム管理者は、更新プログラム パッケージ内の Readme.txt ファイルを読み、更新プログラムが正しくインストールされていることを確認して下さい。

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-056）

    [http://www.microsoft.com/technet/security/bulletin/ms02-056.mspx](http://technet.microsoft.com/security/bulletin/ms02-056)
-   サポート技術情報 （KB） 文書番号 ： 316333
    [\[INF\] SQL Server 2000 Service Pack 2 のセキュリティ アップデート](http://support.microsoft.com/kb/316333)

**更新履歴** **:**

-   2002/10/3: このセキュリティ情報ページを公開しました。
-   2002/10/10: 「警告」 の欄を更新し、Windows NT 4.0 SP6a または SP6 に更新プログラムを適用する際の情報を記載しました。また、この問題に対する日本語版 KB を公開しました。
-   2003/2/3: このセキュリティ情報ページを更新し、この累積的な更新プログラムが MS02-061 で提供された更新プログラムに含まれることをお知らせしました。また、317748 の更新プログラムがこの累積的な更新プログラムと関連して適用される場合のインストール順序を明確にしました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
