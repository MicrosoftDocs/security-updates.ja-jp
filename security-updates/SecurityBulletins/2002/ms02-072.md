---
TOCTitle: 'MS02-072'
Title: 'マイクロソフト セキュリティ情報 MS02-072 - 緊急'
ms:assetid: 'ms02-072'
ms:contentKeyID: 61228497
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-072(v=Security.10)'
---


マイクロソフト セキュリティ情報 MS02-072 - 緊急
===============================================

Windows Shell の未チェックのバッファによりシステムが侵害される (329390)
-----------------------------------------------------------------------

公開日: 2002年12月19日 | 最終更新日: 2002年12月26日

#### 概要 :

**このセキュリティ情報の対象となるユーザー :**  
Microsoft® Windows® XP を使用しているお客様

**脆弱性の影響 :**  
攻撃者の選択したコードが実行される可能性があります。

**最大深刻度 :**  
緊急

**推奨する対応策 :**  
Microsoft Windows XP をご使用のお客様は、この更新プログラムを直ちに適用して下さい。

**影響を受けるソフトウェア: **

-   Windows XP Home Edition
-   Windows XP Professional
-   Windows XP Tablet PC Edition
-   Windows XP Media Center Edition

### 詳細

問題
----

<span></span>
**技術的な説明: **
Windows Shell は、Windows のユーザー インターフェース エクスペリエンスの基本フレームワークを提供する役割を果たします。Windows Shell は、Windows デスクトップとしてユーザーにより広く知られていますが、ファイルおよびフォルダの管理、アプリケーションを開始する方法の提供など、ユーザーのコンピューティング セッションの定義を支援するためのその他の様々な機能も提供します。
その Windows Shell が使用し、オーディオ ファイルからカスタム属性情報を抽出する機能の 1 つに未チェックのバッファが存在します。悪意のあるユーザーがバッファ オーバーラン攻撃を仕掛け、この問題を悪用しようとする可能性があるためにセキュリティ上の脆弱性が存在します。
攻撃者はこの脆弱性を悪用し、不正なカスタム属性を含む .MP3 または .WMA ファイルを作成し、それを Web サイトおよびネットワーク共有上にホストするか、または HTML 形式の電子メールで送信する可能性があります。ユーザーがそのファイル （Web ページまたはローカル ディスクのいずれかに配置されているファイル） のアイコンの上にマウス ポインタを移動するか、またはそのようなファイルが保存されている共有フォルダを開くと、この脆弱性の影響を受けるコードが呼び出される可能性があります。ユーザーがそのような HTML 形式の電子メールを開くかまたはプレビューした際に、そのメールにより、この脆弱性の影響を受けるコードが呼び出される可能性があります。この攻撃により、Windows Shell が異常終了するか、またはユーザーのコンピュータ上で、攻撃者のコードがそのユーザーのセキュリティ コンテキストで実行される恐れがあります。

**問題を緩和する要素: **

-   この脆弱性は、Windows Media Player ではなく、Windows Shell に存在します。したがって、Windows Media Player でオーディオ ファイルを再生しても、さらなる危険はありません。
-   Outlook 98 および 2000 （[Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)を適用） Outlook 2002、および Outlook Express 6 ではすべて HTML 形式のメールは制限付きサイトゾーンで開かれます。これらの製品をご使用のお客様、および [Windows XP Service Pack 1](http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/default.mspx) または制限付きサイト ゾーンのフレームを無効にする [Internet Explorer](http://technet.microsoft.com/ja-jp/security/default.aspx) 用のすべての最新の更新プログラムを適用したお客様は自動化された電子メール ベースの攻撃による危険はありません。しかし、これらのお客様でも悪質な HTML 形式の電子メールのハイパーリンクをクリックした場合、依然として攻撃を受ける可能性があります。
-   攻撃者のコードが実行された場合、そのコードはユーザーのセキュリティ コンテキストで実行されます。したがって、ユーザーのアクセス権の制限により、攻撃者のコードで実行できる操作も制限されます。

**深刻度: **

|                |      |
|----------------|------|
| **Windows XP** | 緊急 |

上記の[評価](http://technet.microsoft.com/security/bulletin/rating)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。

**脆弱性識別番号: **
[CVE-CAN-2002-1327](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1327)

**テストしたバージョン: **
マイクロソフトは Windows XP のテストを行い、この脆弱性による影響を評価しました。それ以前の Windows のバージョンに関しては、オーディオ ファイルに関するカスタム属性の自動解析は標準でサポートされておらず、この脆弱性の影響は受けません。

よく寄せられる質問
------------------

<span></span>
**どのようなことが起こる可能性がありますか?**

これは[バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者にこの脆弱性が悪用され、最悪の場合、ユーザーのシステムで任意のコードが実行される恐れがあります。これにより、攻撃者は正当なユーザーが実行可能なすべての操作を実行できる可能性があります。これらの操作には、データの作成、変更、削除、システムの再構成、ハード ドライブの再フォーマットなどが含まれる可能性があります。

**何が原因で起こりますか?**

この脆弱性は、.MP3 オーディオ ファイルおよび .WMA オーディオ ファイルに関連するカスタム属性を自動的に抽出する Windows Shell の一部に、未チェックのバッファが存在するために発生します。

**この脆弱性により攻撃者は何ができますか?**

この脆弱性が悪用された場合、最悪のケースで攻撃者によりユーザーのシステム上で攻撃者の任意のコードが実行される恐れがあります。Windows Shell はユーザーのコンテキストで実行されるため、攻撃者のコードもユーザーとして実行される可能性があります。データまたは構成情報を削除、追加、変更するユーザーのアクセス権の制限により、攻撃者によって実行される操作も制限されます。

**攻撃者はどのようにこの脆弱性を悪用する可能性がありますか?**

攻撃者は不正なカスタム属性を含む .MP3 オーディオ ファイルまたは .WMA オーディオ ファイルを作成することによって、この脆弱性を悪用しようとする可能性があります。攻撃者は、以下の 3 つの方法のいずれかで、この脆弱性を悪用する可能性があります。

-   不正なカスタム属性を含む .MP3 または .WMA のオーディオ ファイルを Web サイトにホストする可能性があります。この場合、ユーザーがそのようなファイルを含むページをブラウズし、その上にマウスを移動すると、この脆弱性が悪用されます。
-   不正なカスタム属性を含む .MP3 または .WMA のオーディオ ファイルをネットワーク共有にホストする可能性があります。この場合、ユーザーがネットワーク共有をブラウズし、そのようなファイルを含むフォルダを単に開くだけで、この脆弱性が悪用される恐れがあります。
-   電子メールを介して送信する可能性があります。攻撃者はユーザーが電子メールを開く際に表示されるフレームに不正なカスタム属性を含む .MP3 または .WMA のオーディオ ファイルを含む共有へのリンクを埋め込む可能性があります。攻撃者はまた、電子メール メッセージにこのようなファイルを添付し、そのファイルをデスクトップに保存するように提案するメッセージをつけ、ユーザーに送信する可能性があります。そのファイルがデスクトップに保存され、ユーザーがその上にマウスを移動すると、この脆弱性が悪用される可能性があります。最後に、攻撃者は電子メール メッセージにこのようなファイルを含む共有へのリンクおよびユーザーにそのリンクをクリックするように提案するメッセージを含む可能性があります。ユーザーがリンクをクリックした場合、共有が表示され、この脆弱性が悪用される可能性があります。

最後の例では、攻撃者はファイルがユーザーのコンピュータに保存されるようにすることはできません。ユーザーのみがローカル コンピュータにファイルを保存する操作をすることができます。

**Windows Shell** **とは何ですか?**

Windows Shell により、Windows ユーザー インターフェースの基本的なフレームワークが提供されます。Windows Shell は [Windows Desktop](http://www.microsoft.com/technet/prodtechnol/windows2000serv/reskit/) として最も一般的に使用されます。シェルは単なるデスクトップを越える多くの機能を提供し、コンピュータに一貫した外観にする方法を提供します。シェルは Windows Explorer からファイルおよびフォルダを検索するために使用することができ、\[スタート\] メニューのショートカットからアプリケーションを開始するための一貫した方法を提供し、またデスクトップ テーマと色の一貫したインターフェースを提供します。

**MP3** **ファイルおよび** **WMA** **ファイルとは何ですか?**

MP3 ファイルおよび WMA ファイルは、圧縮された音楽およびサウンド ファイルのことです。両方の種類のファイルは、.MP3 または .WMA のファイル拡張子から識別することができます。

**この脆弱性の影響を受ける別の種類のオーディオファイルはありますか?**

この脆弱性による影響を受けるのは .MP3 および .WMA の拡張子を持つファイルのみです。.WAV、.MPG、.MPEG、.AVI など、オーディオを含むその他の種類のファイルは影響を受けません。

**Windows Shell** **はこれらのファイル属性をどのように処理しますか?**

Windows Shell はマシン上のファイルおよびアイコンに関する情報の表示に関連する様々な操作を担います。たとえば、アイコン上にマウス ポインタを移動すると、そのアイコンに関する情報が表示されます。この情報を途切れなく表示するために、Windows Shell が呼び出され、ファイル属性が読み取られ、これらの情報が自動的に提供されます。他の例では、マシン上のファイルの 「縮小表示」 を表示するフォルダ ビューを変更することができます。この機能は、Windows Shell によって提供され、ファイルを処理するメカニズムによって呼び出されます。「縮小表示」 の設定がされたマシン上でフォルダが開かれると、Windows Shell が自動的に呼び出され、この表示が可能になります。

**Windows Shell** **の何が問題になっていますか?**

Windows Shell が特定のオーディオ ファイルのカスタム属性を自動的に抽出するための機能に、未チェックのバッファが含まれます。オーディオ ファイルに特定のデータが入力された場合、Windows Shell がそのファイルを読み取ろうとした際に、バッファのオーバーランが発生する可能性があります。バッファ オーバーランにより、通常アプリケーションが異常終了するか、またはマシンでコードが実行される可能性があります。

**Windows Shell** **はこれらの属性を読み取るためにどのように呼び出されるのですか?**

Windows Shell がこれらのカスタム属性の解析を試みる場合にのみ、未チェックのバッファを含む特定の機能が呼び出されます。これは以下の方法で起こります。

-   一つの例として、コンピュータ上のフォルダ内にファイルが存在する場所で起こります。ユーザーがフォルダを開くと、Windows Shell はこれらのカスタム属性を自動的に読み取ります。
-   別の例は、不正なファイルが Web サイトにホストされた場合に起こります。ユーザーがこの Web サイトを訪問し、マウスをそのファイル上に移動した場合、シェルが呼び出され、カスタム属性を解析する可能性があります。

**攻撃者がこの脆弱性を直接電子メールから悪用することはできますか?**

ユーザーが HTML 形式の電子メールを制限付きサイト ゾーンで表示する電子メール クライアントを実行し、[Windows XP Service Pack 1](http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/default.mspx)または [Internet Explorer](http://technet.microsoft.com/ja-jp/security/default.aspx) 用のすべての最新の累積的更新プログラムを適用した場合、攻撃者は HTML 形式のメールを介して直接この脆弱性を悪用することはできません。この脆弱性が悪用されるには、ユーザーが悪質な HTML 形式の電子メールのリンクをクリックすることが条件となります。

**HTML** **形式の電子メールを制限付きサイトゾーンで表示するのはどの電子メールクライアントですか?**

HTML 形式の電子メールを制限付きサイト ゾーンで表示するのは以下のクライアントです。

-   Outlook 2002
-   Office 2000 [Service Pack 2](http://office.microsoft.com/japan/downloads/2000/sp2upd.aspx) またはそれ以降のバージョンの Outlook 2000
-   [Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)をインストールした Outlook 98 または 2000
-   Outlook Express 6.0

**Windows XP Service Pack 1** **は、この脆弱性が悪用されるのをどのように制限しますか?**

Windows XP Service Pack 1 および Internet Explorer 向けの[最新](http://microsoft.com/japan/technet/security/current.aspx)の累積的セキュリティ更新プログラムにより、制限付きサイト ゾーンでのフレームが無効にされます。電子メール メッセージから不正なファイルを含む共有へのリンクを含むフレームが自動的に表示されることが不可能な場合、悪質な電子メールの送信者は、自分がメッセージに埋め込んだ共有へのリンクをユーザーがクリックすることを願うことになります。

**Windows XP** **を使用していません。この脆弱性による影響を受ける可能性がありますか?**

いいえ、ありません。この問題は、Windows XP のみに影響を及ぼします。その他のバージョンの Windows には影響ありません。

**Windows Media Technologies** **で** **WMA** **ファイルが使用される場合、それは** **Windows Media Player** **に問題があるという意味ですか?**

いいえ。Windows Media Player にはこの問題はありません。この問題は Windows Shell および Windows Shell がこれらのオーディオ ファイルの属性を自動的に読み取ろうとする方法に存在します。

**この脆弱性を悪用するために作成されたと思われるファイルを削除する安全な方法はありますか?**

不正なカスタム属性を含むオーディオ ファイルをマシンにダウンロードした可能性がある場合、Windows Explorer からそのファイルを削除しようとすべきではありません。悪質なオーディオ ファイルにマウス ポインタを移動するか、またはそのようなファイルを含むフォルダを開くと、Windows Shell がそのファイルを処理し、この脆弱性の影響を受けるコードが実行される可能性があります。最も安全な方法は、コマンド プロンプトを使用して、不正なファイルを削除する方法です。
コマンド プロンプトは以下の方法でアクセスすることができます。

1.  \[スタート\] ボタンから \[ファイル名を指定して実行\] を選択します。
2.  ボックスの中に cmd.exe と入力します。
3.  \[OK\] ボタンをクリックします。これによりコマンド プロンプトが起動します。
4.  コマンド プロンプトで、DEL コマンドを使用して、ファイルのパスを指定し、そのファイルを削除します。使用するスイッチに関する特定の情報は、DEL /? と入力し、ヘルプを利用してください。

**更新プログラムは何を修正しますか?**

この更新プログラムは問題になっている Windows Shell 機能で適切な入力確認が行われるようにし、この脆弱性を排除します。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

Microsoft Windows XP:

-   [32 bit 版](http://www.microsoft.com/downloads/details.aspx?familyid=a0be7af2-2653-4767-a85d-24bf68d28d20&displaylang=ja)
-   [64 bit 版](http://www.microsoft.com/downloads/details.aspx?familyid=fba972fb-ff2a-41d0-8745-d31eefb90437&displaylang=ja)

#### 更新プログラムに関する追加情報

**対象プラットフォーム: **
この更新プログラムは Windows XP および [Windows XP Service Pack 1](http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/default.mspx) を実行しているシステムにインストールすることができます。

**この修正を含む予定のサービスパック: **
この更新プログラムは Windows XP Service Pack 2 に含まれる予定です。

**再起動の必要性: **
あり

**更新プログラムのアンインストール: **
可

**更新プログラムに含まれる過去の修正: **
なし

**更新プログラムが正しくインストールされたかどうか確認する方法: **

-   Windows XP :
    この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP1\\Q329390
    各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP1\\Q329390\\Filelist
-   Windows XP Service Pack 1 :
    この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP2\\Q329390
    各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP2\\Q329390\\Filelist

**警告: **
なし

**他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。: **

-   セキュリティ更新プログラムは[マイクロソフト ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード探索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報: **

-   US マイクロソフトセキュリティ情報（MS02-072）
    [http://www.microsoft.com/technet/security/bulletin/ms02-072.mspx](http://technet.microsoft.com/security/bulletin/ms02-072)
-   サポート技術情報 （KB） 文書番号 ： 329390
    [\[MS02-072\] Windows Shell の未チェックのバッファによりシステムが侵害される](http://support.microsoft.com/kb/329390)

**謝辞: **
この問題を連絡し、顧客の保護に協力して下さった [Foundstone Research Labs](http://www.foundstone.com/) に対し、マイクロソフトは深い[謝意](http://technet.microsoft.com/security/bulletin/policy)を表します。

**更新履歴: **

-   2002/12/19: このセキュリティ情報ページを公開しました。
-   2002/12/26: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
