---
TOCTitle: 'MS04-015'
Title: 'マイクロソフト セキュリティ情報 MS04-015 - 重要'
ms:assetid: 'ms04-015'
ms:contentKeyID: 61228563
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms04-015(v=Security.10)'
---



マイクロソフト セキュリティ情報 MS04-015 - 重要
===============================================

「ヘルプとサポート センター」の脆弱性により、リモートでコードが実行される (840374)
----------------------------------------------------------------------------------

公開日: 2004年5月12日 | 最終更新日: 2004年5月12日

[](https://www.microsoft.com/japan/security/bulletins/ms04-015e.mspx)

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:** Microsoft® Windows® をご使用のお客様

**脆弱性の影響** **:** リモートでコードが実行される

**最大深刻度** **:** 重要

**推奨する対応策** **:** お客様はできるだけ早期にこの更新プログラムをインストールして下さい。

**含まれる過去のセキュリティ更新プログラム** **:** なし

**警告** **:**

-   ヘルプとサポート センター サービスを無効に設定したコンピュータに、このセキュリティ更新プログラムをインストールする際に起こる可能性がある既知の問題に関し、マイクロソフト サポート技術情報 [841996](https://support.microsoft.com/kb/841996) で説明しています。このセキュリティ更新プログラムを正しくインストールするには、ヘルプと サポート センター サービスを無効にしないことが必要です。マイクロソフト サポート技術情報 841996 では、この問題に対する、推奨される解決策に関しても説明されています。詳細は、[841996](https://support.microsoft.com/kb/841996) をご覧ください。
-   Windows XP および Windows XP Service Pack 1 の日本語版セキュリティ更新プログラムをアンインストールした後に、\[プログラムの追加と削除\] が操作できなくなる可能性があります。 詳細は、[842253](https://support.microsoft.com/kb/842253) をご覧下さい。 この問題は、日本語版でのみ確認されており、他の言語では発生しません。

**テストしたソフトウェアおよび更新プログラムのダウンロード先** **:**

**影響を受けるソフトウェア** **:**

|                                                                                                                                              | PC/AT                                                                                                                                                                                             |
|----------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Microsoft Windows XP および Microsoft Windows XP Service Pack 1![](../../images/Dn636386.mu_s(ja-JP,Security.10).gif) | [![](../../images/Dn636386.dl_arrow(ja-JP,Security.10).jpg)](https://www.microsoft.com/download/details.aspx?familyid=563f65a3-d793-47b4-a607-948caa5b3454&displaylang=ja) |
| Microsoft Windows XP 64-Bit Edition Service Pack 1![](../../images/Dn636386.mu_s(ja-JP,Security.10).gif)              | [![](../../images/Dn636386.dl_arrow(ja-JP,Security.10).jpg)](https://www.microsoft.com/download/details.aspx?familyid=eb954f03-efc6-45fa-b87c-e29135199dc9&displaylang=ja) |
| Microsoft Windows XP 64-Bit Edition Version 2003![](../../images/Dn636386.mu_s(ja-JP,Security.10).gif)                | [![](../../images/Dn636386.dl_arrow(ja-JP,Security.10).jpg)](https://www.microsoft.com/download/details.aspx?familyid=e05de6ab-fb0d-4a0e-b34e-bb69b9d6ba74&displaylang=ja) |
| Microsoft Windows Server™ 2003![](../../images/Dn636386.mu_s(ja-JP,Security.10).gif)                                  | [![](../../images/Dn636386.dl_arrow(ja-JP,Security.10).jpg)](https://www.microsoft.com/download/details.aspx?familyid=50ad42d7-81bd-4f96-9ad1-0e67310551df&displaylang=ja) |
| Microsoft Windows Server 2003 64-Bit Edition![](../../images/Dn636386.mu_s(ja-JP,Security.10).gif)                    | [![](../../images/Dn636386.dl_arrow(ja-JP,Security.10).jpg)](https://www.microsoft.com/download/details.aspx?familyid=e05de6ab-fb0d-4a0e-b34e-bb69b9d6ba74&displaylang=ja) |

![](../../images/Dn636386.dl_arrow(ja-JP,Security.10).jpg)このマークをクリックして、更新プログラムをダウンロードしてください。
更新プログラムをダウンロードおよびインストールする方法は、[更新プログラムのダウンロード方法](https://www.microsoft.com/japan/security/bulletins/dcsteps_vista.mspx)および[更新プログラムのインストール方法](https://www.microsoft.com/japan/security/bulletins/instsecupdate_vista.mspx)をご覧ください。

![](../../images/Dn636386.mu_s(ja-JP,Security.10).gif)このマークの付いている更新プログラムは [Microsoft Update](https://update.microsoft.com/microsoftupdate/) からインストールすることもできます。
Microsoft Update の利用方法については以下のサイトを参照してください。

-   Microsoft Update 利用の手順    
    <https://www.microsoft.com/japan/athome/security/update/j_musteps.mspx>

**影響を受けないソフトウェア** **:**

|                                                                                                                     |
|---------------------------------------------------------------------------------------------------------------------|
| Microsoft Windows NT® Workstation 4.0 Service Pack 6a                                                               |
| Microsoft Windows NT Server 4.0 Service Pack 6a                                                                     |
| Microsoft Windows NT Server 4.0 Terminal Server Edition Service Pack 6                                              |
| Microsoft Windows 2000 Service Pack 2, Microsoft Windows 2000 Service Pack 3, Microsoft Windows 2000 Service Pack 4 |
| Microsoft Windows 98, Microsoft Windows 98 Second Edition (SE) および Microsoft Windows Millennium Edition (ME)     |

上記のソフトウェアのテストを行い、この脆弱性による影響を評価しました。それ以前のバージョンに関してはサポートの対象となっていないため、この脆弱性による影響は不明です。ご使用中の製品およびバージョンのサポートライフ サイクルを確認するためには、[マイクロソフト サポート ライフサイクル](https://support.microsoft.com/lifecycle/)の Web サイトをご覧下さい。

### 詳細

要点
----


この更新プログラムにより、新たに確認された脆弱性が解決されます。「ヘルプとサポート センター」が HCP URL 検証を処理する方法が原因で、リモートでコードが実行される脆弱性が起こります。このセキュリティ情報の「脆弱性の詳細」の欄で、この脆弱性に関して説明しています。

ユーザーがシステム管理者の特権でログインしている際に、攻撃者がこの脆弱性を悪用した場合、影響を受けるコンピュータ上で、プログラムのインストール、データの表示、変更、作成、または完全な特権を持つ新規のアカウントの作成など、そのコンピュータを完全に制御する可能性があります。コンピュータでほとんど特権を持たないよう構成されているアカウントを持つユーザーは、管理者特権で操作を行うユーザーよりも、この脆弱性による危険にさらされる可能性が低くなります。

マイクロソフトは、この更新プログラムをできるだけ早期にインストールすることを推奨いたします。

**深刻度および脆弱性識別番号** **:**

| 脆弱性識別番号                                                                                                       | 脆弱性の影響                 | Windows XP | Windows Server 2003 |
|----------------------------------------------------------------------------------------------------------------------|------------------------------|------------|---------------------|
| ヘルプとサポート センターの脆弱性 - [CAN-2004-0199](https://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0199) | リモートでコードが実行される | 重要       | 重要                |

上記の[評価](https://technet.microsoft.com/security/bulletin/rating)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。

このセキュリティ更新プログラムに関するよく寄せられる質問
--------------------------------------------------------


**この更新プログラムにより、機能が変更されますか?**

はい。この更新プログラムにより、この「脆弱性の詳細」の欄に記載されている変更に加え、以下の機能が変更されます。

-   Windows XP では、DVD デコーダをアップグレードするオプションが自動的に提供される機能がサポートされています。この機能は、セキュリティを向上するため、また悪用される可能性をなくすために削除されます。マイクロソフトは、この機能の悪用に対する保護を追加する多層防御策として、この対策を考えています。この更新プログラムのインストール後、この機能を使用しようとすると、「ページを表示できません」というエラー メッセージが表示されます。マイクロソフトは、今後リリースされる Service Pack で、この機能を改善し、提供する予定です。
-   マイクロソフトはまた、別の多層防御の変更を行い、それにより、新しいハードウェアの検出ウィザードにも影響が及びます。「ヘルプとサポート センター」には、新しいハードウェアの検出ウィザードの実行後、ある特定の状況下で、ハードウェア プロファイル情報をマイクロソフトに送信するためのメッセージが表示される機能が含まれます。この機能は削除されています。このようなケースでは、この更新プログラムのインストール後、新しいハードウェアの検出ウィザードが完了すると、「ページを表示できません」というエラー メッセージが表示されます。

**Microsoft Baseline Security Analyzer (MBSA)** **を使用してこの更新プログラムが必要かどうかを確認することができますか?**

はい。MBSA により、この更新プログラムが必要かどうかを確認することができます。MBSA に関する詳細は、[Microsoft Baseline Security Analyzer](https://technet.microsoft.com/ja-jp/security/cc184924.aspx) の Web サイトをご覧下さい。

**Systems Management Server (SMS)** **を使用して、この更新プログラムが必要かどうかを確認することができますか?**

はい。SMS により、このセキュリティ更新プログラムを検出し、展開することができます。SMS に関する詳細は、[SMS Web サイト](https://www.microsoft.com/japan/technet/prodtechnol/sms/default.mspx)をご覧ください。

脆弱性の詳細
------------


#### 「ヘルプとサポート センター」の脆弱性 - CAN-2004-0199 :

HCP URL の検証を処理する方法が原因で、リモートでコードが実行される脆弱性が「ヘルプとサポート センター」に存在します。攻撃者がこの脆弱性を悪用した不正な HCP URL を作成し、ユーザーが悪質な Web サイトを訪問するか、または不正な電子メール メッセージを表示した場合、リモートでコードが実行される可能性があります。攻撃者によってこの脆弱性が悪用された場合、影響を受けるコンピュータの完全な制御が取得される可能性があります。しかし、攻撃者がこの脆弱性を悪用するには、多くのユーザー操作が行われることが必要条件となります。

#### 「ヘルプとサポート センター」の脆弱性の問題を緩和する要素 - CAN-2004-0199 :

-   Web ベースの攻撃シナリオにおいては、攻撃者がこの脆弱性を悪用するための Web ページを含む Web サイトをホストすることが必要条件となります。攻撃者は、そのような不正な Web サイトにユーザーを強制的に訪問させることはできません。その代わり、攻撃者は、通常攻撃者の Web サイトへのリンクをユーザーにクリックさせる等により、ユーザーを不正な Web サイトに誘導することが必要となります。ユーザーがそのようなリンクをクリックすると、いくつかの操作を指示するメッセージが表示されます。ユーザーがこれらの操作を行った場合にのみ、この攻撃が行われます。
-   既定で、Outlook Express 6、Outlook 2002、Outlook 2003 では、HTML 形式の電子メールは制限付きサイト ゾーンで開かれます。また、Outlook 98 および Outlook 2000 では、[Outlook 電子メール セキュリティ更新プログラム](https://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)がインストールされている場合、HTML 形式の電子メール メッセージが制限付きサイト ゾーンで開かれます。制限付きサイト ゾーンでは、この脆弱性の悪用を試みる攻撃の危険性が低減されます。

    HTML 形式の電子メールによる攻撃の危険性は、以下の条件がすべて満たされている場合、大幅に低減されます。

    -   マイクロソフト セキュリティ情報 [MS03-040](https://technet.microsoft.com/security/bulletin/ms03-040) またはそれ以降にリリースされた Internet Explorer 用の累積的なセキュリティ更新プログラムに含まれている更新プログラムを適用している
    -   Internet Explorer 6 またはそれ以降のバージョンを使用している
    -   Microsoft Outlook 電子メール セキュリティ更新プログラムを使用している、Microsoft Outlook Express 6 またはそれ以降のバージョンを使用している、または Microsoft Outlook 2000 Service Pack 2 またはそれ以降のバージョンを既定の構成で使用している

-   攻撃者はこの脆弱性を悪用し、ユーザーと同じ特権を取得する可能性があります。コンピュータ上で低い特権を設定しているアカウントを所有するユーザーの場合、管理者特権で実行しているユーザーよりも危険性は低減されます。
-   Windows 98、 Windows 98 Second Edition (SE) 、 Microsoft Windows Millennium Edition (ME) 、 Windows NT 4.0 および Windows 2000 はこの脆弱性による影響を受けません。

#### ｢ヘルプとサポート センター｣の脆弱性のよく寄せられる質問 - CAN-2004-0199:

**どのようなことが起こる可能性がありますか?**

これはリモートでコードが実行される脆弱性です。攻撃者はこの脆弱性を悪用し、影響を受けるコンピュータ上で完全な制御を取得する可能性があります。攻撃者は影響を受けるコンピュータで、プログラムのインストール、データの表示、変更、削除、または完全な特権を持つ新規アカウントの作成など、あらゆる操作を行う可能性があります。しかし、攻撃者がこの脆弱性を悪用するには、多くのユーザー操作が行われることが必要条件となります。

**何が原因で起こりますか?**

「ヘルプとサポート センター」により使用されるプロセスにより、データ入力が検証される方法のために、この脆弱性が起こります。

**「ヘルプとサポートセンター」とは何ですか?**

「ヘルプとサポート センター」(HSC) とは、様々なトピックに関するヘルプを提供する Windows の機能です。たとえば、HSC により、ユーザーは Windows の機能に関する知識の取得、ソフトウェアの更新のダウンロードおよびインストール、特定のハードウェアデバイスの Windows との互換性の確認、マイクロソフトからのヘルプを受けることができます。ユーザーおよびプログラムは、URL のリンクのプレフィックスを "https://" の代わりに "hcp://" を使用することにより、「ヘルプとサポート センター」への URL のリンクを実行することができます。

**HCP** **プロトコルとは何ですか?**

HTTP プロトコルが Web ブラウザを開くために URL リンクを実行することができるのと同様に、HCP プロトコルは、「ヘルプとサポート センター」機能を開くために URL リンクを実行することができます。

**「ヘルプとサポートセンター」の何が問題になっていますか?**

入力検証のエラーが発生します。

**この脆弱性により、攻撃者は何ができますか?**

この脆弱性により、攻撃者は、影響を受けるコンピュータで、プログラムのインストール、データの表示、変更、削除、または完全な特権を持つ新規アカウントの作成など、あらゆる操作を行う可能性があります。

**攻撃者はどのようにしてこの脆弱性を悪用する可能性がありますか?**

攻撃者がこの脆弱性を悪用するには、不正な Web サイトをホストし、ユーザーがそのサイトを表示するように誘導することが必要条件となります。また、攻撃者は、特別な細工をしたリンクを含む HTML 形式の電子メール メッセージを作成することが可能です。これにより、ユーザーがそのメッセージを表示し、その後、不正なリンクをクリックしてしまう可能性があります。ユーザーがそのメッセージを表示し、その後、不正なリンクをクリックするように誘導することが攻撃者にとっての必要条件となります。ユーザーがそのようなリンクをクリックした場合、Internet Explorer のウィンドウが攻撃者の任意の HCP URL で開きます。しかし、その際、ユーザーの多くの操作が必要となります。ユーザーがリンクをクリックした後、いくつかの操作を実行するように指示するメッセージが表示されます。ユーザーがそれらの操作を実行した場合にのみ攻撃が行われる可能性があります。

**この脆弱性により危険にさらされるのは主にどのようなコンピュータですか?**

Windows XP および Windows Server 2003 には、この影響を受けるバージョンの「ヘルプとサポート センター」が含まれます。そのほかのバージョンのプラットフォームには、「ヘルプとサポート センター」が含まれていないため、またはこれらのプラットフォーム上では、この脆弱性の性質が異なるため、この脆弱性による影響は受けません。

**Windows Server 2003** **上でInternet Explorer** **を実行しています。Windows Server 2003** **ではこの脆弱性の影響は緩和されますか?**

いいえ。既定で、Windows Server 2003 上の Internet Explorer は、Internet Explorer のセキュリティ強化の構成という制限されたモードで実行されます。しかし、既定で、HCP プロトコルは「ヘルプとサポート センター」にアクセスすることが可能です。そのため、Windows Server 2003 はこの脆弱性による影響を受けます。

Internet Explorer セキュリティ強化の構成に関する詳細は、次の [Web サイト](https://www.microsoft.com/japan/windowsserver2003/developers/iesecconfig.mspx)をご覧ください。

**更新プログラムは何を修正しますか?**

この更新プログラムは、「ヘルプとサポート センター」に渡されたデータの検証を変更し、この脆弱性を排除します。

**この脆弱性は、MS04-011** **によって修正された「ヘルプとサポートセンター」の脆弱性に関連性はありますか?**

両方の脆弱性は、「ヘルプとサポート センター」の機能に存在します。しかし、この更新プログラムは、MS04-011 の一部で、対応されなかった新たな脆弱性を修正します。MS04-011 では、そのセキュリティ情報で説明された脆弱性からコンピュータを十分に保護しますが、今回の新たな脆弱性は解決しません。この更新プログラムには、MS04-011 が含まれません。両方の脆弱性から保護するためには、MS04-011 の一部として提供された更新プログラムおよび今回の更新プログラムの両方をインストールする必要があります。

**マイクロソフトセキュリティ情報** **MS04-011** **が公開された際に、この脆弱性は一般に公開されていましたか？**

いいえ。マイクロソフトは、セキュリティ情報 MS04-011 の公開当初、この脆弱性が公開されていたことを示す情報は受け取っていませんでした。

**マイクロソフトセキュリティ情報** **MS04-011** **が公開された際に、マイクロソフトは、この脆弱性が悪用されていることに関する何らかの報告を受けていましたか?**

いいえ。マイクロソフトは、MS04-011 の公開当初、この脆弱性が悪用され、お客様が攻撃されていることを示す報告は受けていませんでした。また、公開された検証用コードのいかなる例の存在も確認していませんでした。

#### 「ヘルプとサポート センター」の脆弱性の回避策 - CAN-2004-0199 :

マイクロソフトは次の回避策のテストを行ないました。これらの回避策は根本的な脆弱性を修正しませんが、既知の攻撃を阻止する手助けとなります。回避策は機能の低下の原因となる場合もあります。その場合、下記に回避策を記します。

-   **HCP** **プロトコルの登録を解除する** **:**

    レジストリから、HKEY\_CLASSES\_ROOT\\HCP のキーを削除し、HCP プロトコルの登録を解除することで攻撃を防ぎます。以下の手順に従って、このキーをレジストリから削除してください。

    -   **\[スタート\]** メニューから、**\[ファイル名を指定して実行\]** を選択します。
    -   **regedit** と入力し、**\[OK\]** をクリックします。(レジストリ エディタ が起動します。)
    -   **HKEY\_CLASSES\_ROOT** を拡張し、**HCP** キーをハイライトします。
    -   **HCP** キーを右クリックし、**\[削除\]** をクリックします。

    **警告** **:** レジストリ エディタを誤って使用すると、Windows の再インストールが必要となる深刻な問題が起こります。マイクロソフトはレジストリエディタの誤った使用が原因で発生した問題を解決することは保証できません。お客様各自の責任において、レジストリ エディタを使用して下さい。

    **回避策の影響** **:** HCP プロトコルの登録を解除すると、hcp:// を使用するすべてのローカルの正当なヘルプ リンクが壊れます。たとえば、コントロール パネルのリンクが機能しなくなります。

-   **Outlook 2000 SP1** **またはそれ以前を使用している場合**、[**Outlook** **電子メールセキュリティ更新プログラム**](https://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)をインストールする

    既定で、Outlook Express 6、Outlook 2002、Outlook 2003 では、HTML 形式の電子メールは制限付きサイト ゾーンで開かれます。また、Outlook 98 および Outlook 2000 では、[Outlook 電子メール セキュリティ更新プログラム](https://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)がインストールされている場合、HTML 形式の電子メール メッセージが制限付きサイト ゾーンで開かれます。

    これらの製品のいずれかを使用しているお客様は、電子メール メッセージ中の不正なリンクをクリックしない限り、この脆弱性を悪用した電子メールによる攻撃の危険性は低減されます。

-   **Outlook 2002** **または** **Outlook Express 6 SP1** **またはそれ以降のバージョンを使用している場合、HTML** **形式の電子メールによる攻撃に対し保護を行なうために、電子メールをテキスト形式で読み取る**

    Office XP Service Pack 1 またはそれ以降を適用している Microsoft Outlook 2002 および Internet Explorer 6 Service Pack 1 を適用した Outlook Express 6 のユーザーはデジタル署名されていないすべての電子メールまたは暗号化されていない電子メール メッセージをテキストのみで表示する機能を有効にすることができます。

    デジタル署名された電子メールまたは暗号化された電子メールはこの設定の影響を受けません。また、その元の形式で読み取られる場合があります。Outlook 2002 のこの設定を有効にすることに関する情報はサポート技術情報 [307594](https://support.microsoft.com/kb/307594) をご覧下さい。

    Outlook Express 6 のこの設定に関する詳細は、サポート技術情報 [291387](https://support.microsoft.com/kb/291387) をご覧ください。

    **回避策の影響** **:** テキスト形式で表示された電子メールは写真、特別なフォント、アニメーション、またはそのほかのリッチ コンテンツを含むことはできません。さらに次の影響があります。

    -   変更がプレビュー ウィンドウおよび開封されたメッセージに適用されます。
    -   写真は紛失を避けるため、添付ファイルとなります。
    -   メッセージはメール ストアでは、リッチテキストまたは HTML 形式であるため、オブジェクト モデル (カスタムコード ソリューション) は予期されない動作をする場合があります。

セキュリティ更新プログラムに関する情報
--------------------------------------


**対象プラットフォームおよび必要条件** **:**

以下の情報の中から、ご使用のプラットフォーム向けのセキュリティ更新プログラムに関する情報をご覧ください。

#### Windows Server 2003 (すべてのバージョン) :

**必要条件** **:**

このセキュリティ更新プログラムを適用するには、Windows Server 2003 の製品版を実行している必要があります。

**この修正を含む予定のサービスパック** **:**

この問題に対する更新プログラムは Windows Server 2003 Service Pack 1 に含まれる予定です。

**インストール情報** **:**

このセキュリティ更新プログラムは次のセットアップ スイッチをサポートします。

**/help:** インストール スイッチの一覧を表示します 
 

**セットアップモード**  
**/quiet:** 自動モード (ユーザー入力を必要としません。表示もしません)
**/passive:** 無人モード (進行状況バーのみ)  
**/uninstall:** パッケージをアンインストールします
  

**再起動オプション**  
**/norestart:** インストールの完了後、再起動しません  
**/forcerestart:** インストール後、再起動します
  

**特別なオプション**  
**/l:** インストール済みの Windows 更新プログラムまたは更新プログラム パッケージを表示します
**/o:** 確認メッセージを表示せずに OEM ファイルを上書きします  
**/n:** アンインストールに必要なファイルのバックアップを作成しません  
**/f:** シャットダウン時に他のプログラムを強制終了します


**注** **:** これらのスイッチを 1 つのコマンド ラインに組み込むことができます。旧バージョンとの互換性のため、このセキュリティ更新プログラムは、セットアップ ユーティリティの以前のバージョンによって使用されるセットアップ スイッチもサポートしています。サポートされるインストール スイッチについての追加情報はマイクロソフト サポート技術情報 [262841](https://support.microsoft.com/kb/262841) をご覧ください。

**適用に関する情報** **:**

ユーザーの操作なしでセキュリティ更新プログラムをインストールするためには、Windows Server 2003 のコマンド プロンプトで、次のコマンド ラインを使用してください。

**Windowsserver2003-kb840374-x86-jpn /passive /quiet**

コンピュータを強制的に再起動せずにセキュリティ更新プログラムをインストールするためには、Windows Server 2003 のコマンド プロンプトで、次のコマンドラインを使用して下さい。

**Windowsserver2003-kb840374-x86-jpn /norestart**

Microsoft Software Update Services でこのセキュリティ更新プログラムの適用方法に関する情報は、次のマイクロソフトの Web サイトをご覧ください。

<https://www.microsoft.com/windowsserversystem/updateservices/evaluation/previous/susoverview.mspx>

**再起動の必要性** **:**

この更新プログラムで、再起動を必要としない場合があります。インストーラによって、必要なサービスが停止され、更新プログラムが適用され、サービスが再起動します。しかし、何らかの理由により、必要なサービスが停止されない場合、または必要なファイルが使用中の場合、この更新プログラムを適用すると、再起動が要求されます。この場合、再起動するメッセージが表示されます。

**削除に関する情報** **:**

この更新を削除するためには、\[コントロールパネル\] の \[プログラムの追加と削除\] を使用して下さい。

システム管理者は Spuninst.exe ユーティリティを使用し、このセキュリティ更新プログラムを削除することができます。Spuninst.exe ユーティリティは %Windir%\\$NTUninstallKB840374$\\Spuninst フォルダにあり、これは次のセットアップ スイッチをサポートします。

**/?:** インストール スイッチの一覧を表示します  
**/u:** 無人モードで実行します。
**/f:** コンピュータがシャット ダウンする時、そのほかのプログラムを強制的に閉じます      
**/z:** インストールが完了する時、再起動しません    
**/q:** 自動モードを使用します (ユーザーの操作なし)

**ファイル情報**

この更新プログラムの日本語版は次の表に挙げられているファイル属性 (またはそれ以降) を持ちます。

Windows Server 2003, Enterprise Edition、Windows Server 2003, Standard Edition、Windows Server 2003, Web Edition、および Windows Server 2003, Datacenter Edition:

| 日付       | 時間     | バージョン   | サイズ  | ファイル名                           | プラットフォーム | フォルダ |
|------------|----------|--------------|---------|--------------------------------------|------------------|----------|
| 2004/04/15 | 15:04:40 | 5.2.3790.161 | 782,848 | helpctr.exe                          | x86              | rtmgdr   |
| 2004/04/15 | 00:10:44 |              | 26,515  | hsc.system.errors.connection.htm.cab |                  | rtmgdr   |
| 2004/04/15 | 15:04:40 | 5.2.3790.161 | 10,240  | hscupd.exe                           | x86              | rtmgdr   |
| 2004/04/15 | 15:03:07 | 5.2.3790.161 | 782,848 | helpctr.exe                          | x86              | rtmqfe   |
| 2004/04/15 | 00:05:32 |              | 26,515  | hsc.system.errors.connection.htm.cab |                  | rtmqfe   |
| 2004/04/15 | 15:03:07 | 5.2.3790.161 | 10,240  | hscupd.exe                           | x86              | rtmqfe   |

Windows Server 2003 64-Bit Enterprise Edition、および Windows Server 2003 64-Bit Datacenter Edition:

| 日付       | 時間     | バージョン   | サイズ    | ファイル名                           | プラットフォーム | フォルダ |
|------------|----------|--------------|-----------|--------------------------------------|------------------|----------|
| 2004/04/10 | 22:23:40 | 5.2.3790.161 | 2,062,336 | helpctr.exe                          | IA-64            | rtmgdr   |
| 2004/04/15 | 00:10:34 |              | 26,515    | hsc.system.errors.connection.htm.cab |                  | rtmgdr   |
| 2004/04/10 | 22:21:50 | 5.2.3790.161 | 21,504    | hscupd.exe                           | IA-64            | rtmgdr   |
| 2004/04/10 | 23:50:18 | 5.2.3790.161 | 2,062,336 | helpctr.exe                          | IA-64            | rtmqfe   |
| 2004/04/15 | 00:05:30 |              | 26,515    | hsc.system.errors.connection.htm.cab |                  | rtmqfe   |
| 2004/04/10 | 23:49:02 | 5.2.3790.161 | 21,504    | hscupd.exe                           | IA-64            | rtmqfe   |


**注** **:** Windows Server 2003 または Windows XP 64-Bit Edition Version 2003 のコンピュータに、このセキュリティ更新プログラムをインストールするとき、コンピュータ上の更新対象ファイルのいずれかが、マイクロソフトの更新プログラムによって過去に更新されているかどうかがチェックされます。過去に更新プログラムをインストールしてこれらのファイルのいずれかを更新している場合は、RTMQFE ファイルがコンピュータにコピーされます。それ以外の場合は、RTMGDR ファイルがコンピュータにコピーされます。関連情報を参照するには、以下の「サポート技術情報」 (Microsoft Knowledge Base) をクリックしてください。

[824994](https://support.microsoft.com/kb/824994) Windows Server 2003 製品アップデート パッケージの内容に関する説明

**更新プログラムが正しくインストールされたかどうか確認する方法** **:**

影響を受けるコンピュータにセキュリティ更新プログラムがインストールされていることを確認するためには、Microsoft Baseline Security Analyzer (MBSA) ツールを使用して下さい。管理者は、一般的なセキュリティ上の誤った構成とともに、不足しているセキュリティ更新プログラムについて、ローカル コンピュータおよびリモート コンピュータをMicrosoft Baseline Security Analyzer (MBSA) を使ってスキャンすることができます。MBSA に関する追加情報は、[Microsoft Baseline Security Analyzer](https://technet.microsoft.com/ja-jp/security/cc184924.aspx) の Web サイトをご覧下さい。

また、次のレジストリ キーを調べることにより、このセキュリティ更新プログラムがインストールしたファイルを確認することもできます。

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB840374\\Filelist


**注** **:** 管理者または OEM メーカーによって 840374 のセキュリティ更新プログラムを Windows インストール ソース ファイルに統合またはスリップストリーム化されている場合、このレジストリ キーが適切に作成されない場合があります。

#### Windows XP (すべてのバージョン) :


**注** **:** Windows XP 64-Bit Edition バージョン 2003 (英語版) のセキュリティ更新プログラムは Windows Server 2003 の 64-bit バージョン用のセキュリティ更新プログラムと同じです。

**必要条件** **:**

このセキュリティ更新プログラムを適用するには、製品版の Windows XP または Windows XP Service Pack 1 (SP1) を実行している必要があります。 関連情報を参照するには、以下の「サポート技術情報」 (Microsoft Knowledge Base) をクリックしてください。

[322389](https://support.microsoft.com/kb/322389) 最新の Windows XP Service Pack を入手する方法

**この修正を含む予定のサービスパック:**

これらの問題に対する更新プログラムは Windows XP Service Pack 2 に含まれる予定です。

**インストール情報** **:**

このセキュリティ更新プログラムは次のセットアップ スイッチをサポートします。

**/help:** インストール スイッチの一覧を表示します 
 

**セットアップモード**  
**/quiet:** 自動モード (ユーザー入力を必要としません。表示もしません)
**/passive:** 無人モード (進行状況バーのみ)  
**/uninstall:** パッケージをアンインストールします
  

**再起動オプション**  
**/norestart:** インストールの完了後、再起動しません  
**/forcerestart:** インストール後、再起動します
  

**特別なオプション**  
**/l:** インストール済みの Windows 更新プログラムまたは更新プログラム パッケージを表示します
**/o:** 確認メッセージを表示せずに OEM ファイルを上書きします  
**/n:** アンインストールに必要なファイルのバックアップを作成しません  
**/f:** シャットダウン時に他のプログラムを強制終了します


**注** **:** これらのスイッチを 1 つのコマンド ラインに組み込むことができます。旧バージョンとの互換性のため、このセキュリティ更新プログラムは、セットアップ ユーティリティの以前のバージョンによって使用されるセットアップ スイッチもサポートしています。サポートされるインストール スイッチについての追加情報はマイクロソフト サポート技術情報 [262841](https://support.microsoft.com/kb/262841) をご覧ください。

**適用に関する情報** **:**

ユーザーの操作なしでセキュリティ更新プログラムをインストールするためには、Windows XP のコマンド プロンプトで、次のコマンドを使用して下さい。

**Windowsxp-kb840374-x86-jpn /passive /quiet**

コンピュータを強制的に再起動せずにセキュリティ更新プログラムをインストールするためには、Windows XP のコマンド プロンプトで、次のコマンドを使用して下さい。

**Windowsxp-kb840374-x86-jpn /norestart**

Microsoft Software Update Services でこのセキュリティ更新プログラムを適用する方法に関する情報は、次のマイクロソフトの Web サイトをご覧下さい。

<https://www.microsoft.com/windowsserversystem/updateservices/evaluation/previous/susoverview.mspx>

**再起動の必要性** **:**

この更新プログラムは、再起動を必要としない場合があります。インストーラによって、必要なサービスが停止され、更新プログラムが適用され、サービスが再起動します。しかし、何らかの理由により、必要なサービスが停止されない場合、または必要なファイルが使用中の場合、この更新プログラムを適用すると、再起動が要求されます。この場合、再起動する必要があることを示すメッセージが表示されます。

**削除に関する情報** **:**

この更新を削除するためには、\[コントロールパネル\] の \[プログラムの追加と削除\] を使用して下さい。

システム管理者は Spuninst.exe ユーティリティを使用し、このセキュリティ更新プログラムを削除することができます。Spuninst.exe ユーティリティは %Windir%\\$NTUninstallKB840374$\\Spuninst フォルダにあり、これは次のセットアップ スイッチをサポートします。

**/?:** インストール スイッチの一覧を表示します  
**/u:** 無人モードで実行します。
**/f:** コンピュータがシャット ダウンする時、そのほかのプログラムを強制的に閉じます      
**/z:** インストールが完了する時、再起動しません    
**/q:** 自動モードを使用します (ユーザーの操作なし)

**ファイル情報**

この更新プログラムの日本語版は次の表に挙げられているファイル属性 (またはそれ以降) を持ちます。

Windows XP Home Edition、Windows XP Professional、Windows XP Home Edition Service Pack 1、Windows XP Professional Service Pack 1、Windows XP Tablet PC Edition および Windows XP Media Center Edition:

| 日付       | 時間     | バージョン    | サイズ  | ファイル名                           | フォルダ |
|------------|----------|---------------|---------|--------------------------------------|----------|
| 2004/04/09 | 12:56:48 | 5.1.2600.137  | 726,528 | helpctr.exe                          | sp1      |
| 2004/04/15 | 14:36:24 |               | 26,290  | hsc.system.errors.connection.htm.cab | sp1      |
| 2004/02/26 | 21:30:00 | 5.1.2600.134  | 16,896  | hscupd.exe                           | sp1      |
| 2004/02/26 | 21:36:44 |               | 72,233  | hscxpsp1.cab                         | sp1      |
| 2004/04/14 | 17:50:06 | 5.1.2600.1515 | 740,864 | helpctr.exe                          | sp2      |
| 2004/04/15 | 01:26:18 |               | 26,291  | hsc.system.errors.connection.htm.cab | sp2      |
| 2004/04/10 | 19:53:14 | 5.1.2600.1515 | 16,384  | hscupd.exe                           | sp2      |

Windows XP 64-Bit Edition Service Pack 1:

| 日付       | 時間     | バージョン    | サイズ    | ファイル名                           | プラットフォーム | フォルダ |
|------------|----------|---------------|-----------|--------------------------------------|------------------|----------|
| 2004/04/10 | 19:05:22 | 5.1.2600.1515 | 2,425,856 | helpctr.exe                          | IA-64            |          |
| 2004/04/15 | 01:26:18 |               | 26,291    | hsc.system.errors.connection.htm.cab |                  |          |
| 2004/04/10 | 19:04:40 | 5.1.2600.1515 | 57,856    | hscupd.exe                           | IA-64            |          |

Windows XP 64-Bit Edition Version 2003:

| 日付       | 時間     | バージョン   | サイズ    | ファイル名                           | プラットフォーム | フォルダ |
|------------|----------|--------------|-----------|--------------------------------------|------------------|----------|
| 2004/04/10 | 22:23:40 | 5.2.3790.161 | 2,062,336 | helpctr.exe                          | IA-64            | rtmgdr   |
| 2004/04/15 | 00:10:34 |              | 26,515    | hsc.system.errors.connection.htm.cab |                  | rtmgdr   |
| 2004/04/10 | 22:21:50 | 5.2.3790.161 | 21,504    | hscupd.exe                           | IA-64            | rtmgdr   |
| 2004/04/10 | 23:50:18 | 5.2.3790.161 | 2,062,336 | helpctr.exe                          | IA-64            | rtmqfe   |
| 2004/04/15 | 00:05:30 |              | 26,515    | hsc.system.errors.connection.htm.cab |                  | rtmqfe   |
| 2004/04/10 | 23:49:02 | 5.2.3790.161 | 21,504    | hscupd.exe                           | IA-64            | rtmqfe   |


**注** **:** Windows XP および Windows XP 64-Bit Edition Version 2003 (英語版) 用のこのセキュリティ更新プログラムは、デュアルモード パッケージとして作成されています。デュアルモード パッケージには、Service Pack 未適用の Windows XP 製品版および Windows XP Service Pack 1 (SP1) 用のファイルが含まれています。 デュアルモード パッケージの関連情報を参照するには、以下の「サポート技術情報」 (Microsoft Knowledge Base) をクリックしてください。

[328848](https://support.microsoft.com/kb/328848) Windows XP のデュアル モード更新プログラム パッケージについて

Windows XP 64-Bit Edition Version 2003 (英語版) 用のセキュリティ更新プログラムをインストールするとき、コンピュータ上の更新対象ファイルのいずれかが、マイクロソフトの更新プログラムによって過去に更新されているかどうかがチェックされます。過去に更新プログラムをインストールしてこれらのファイルのいずれかを更新している場合は、RTMQFE ファイルがコンピュータにコピーされます。それ以外の場合は、RTMGDR ファイルがコンピュータにコピーされます。詳細情報を参照するには、以下の「サポート技術情報」 (Microsoft Knowledge Base) をクリックしてください。

[824994](https://support.microsoft.com/kb/824994) Windows Server 2003 製品アップデート パッケージの内容に関する説明

**更新プログラムが正しくインストールされたかどうか確認する方法** **:**

影響を受けるコンピュータにセキュリティ更新プログラムがインストールされていることを確認するためには、Microsoft Baseline Security Analyzer (MBSA) ツールを使用して下さい。管理者は、一般的なセキュリティ上誤った構成とともに、不足しているセキュリティ更新プログラムについて、ローカル コンピュータおよびリモート コンピュータをMicrosoft Baseline Security Analyzer (MBSA) を使ってスキャンすることができます。MBSA に関する追加情報は、[Microsoft Baseline Security Analyzer](https://technet.microsoft.com/ja-jp/security/cc184924.aspx) の Web サイトをご覧下さい。

また、次のレジストリ キーを調べることにより、このセキュリティ更新プログラムがインストールしたファイルを確認することもできます。

Windows XP Home Edition、Windows XP Professional、 Windows XP Home Edition Service Pack 1、Windows XP Professional Service Pack 1、Windows XP 64-Bit Edition Service Pack 1、Windows XP Tablet PC Edition、および Windows XP Media Center Edition:

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP2\\KB840374\\Filelist

Windows XP 64-Bit Edition Version 2003:

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB840374\\Filelist


**注** **:** 管理者または OEM メーカーによって 840374 のセキュリティ更新プログラムを Windows インストール ソース ファイルに統合またはスリップストリーム化されている場合、このレジストリ キーが適切に作成されない場合があります。

### その他の情報

**謝辞** **:**

この問題を連絡し、顧客の保護に協力して下さった下記の方に対し、マイクロソフトは深い[謝意](https://technet.microsoft.com/security/bulletin/policy)を表します。

-   このセキュリティ更新プログラムの一部として機能変更された「DVD アップグレード」の問題を報告してくださった [ExploitLabs.com](https://www.exploitlabs.com/) の Donnie Werner 氏

**他のセキュリティ更新プログラムの入手先** **:**

他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムは[マイクロソフト ダウンロード センター](https://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード探索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](https://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。
-   本セキュリティ情報及び公開された更新プログラムは、[TechNet CD サブスクリプション](https://www.microsoft.com/japan/technet/subscriptions/)でも入手可能です。

**他のセキュリティ情報** **:**

-   [Microsoft TechNet Security センター](https://technet.microsoft.com/ja-jp/security/default.aspx) では、製品に関するセキュリティ情報を提供しています。
-   Microsoft Software Update Services : <https://www.microsoft.com/japan/windowsserversystem/updateservices/>
-   Microsoft Baseline Security Analyzer (MBSA) : [https://www.microsoft.com/japan/technet/security/tools/Tools/mbsahome.asp](https://technet.microsoft.com/ja-jp/security/cc184924.aspx) MBSA ツールのセキュリティ更新プログラムの検出に関する制限は <https://support.microsoft.com/kb/306460> をご覧ください。
-   Microsoft Update : <https://update.microsoft.com/microsoftupdate/>
-   Windows Update カタログ : <https://support.microsoft.com/kb/323166>
-   Office のアップデート : <https://office.microsoft.com/officeupdate/>

**Software Update Services (SUS) :**

Microsoft Software Update Services (SUS) は、最新の重要な更新プログラムを適用し、Windows ベースのシステムを最新の状態に維持するプロセスを大幅に簡素化する目的で開発されました。SUS により、重要な更新プログラムを Windows® 2000 や Windows Server™ 2003 ベースのサーバー、ならびに Windows® 2000 Professional や Windows XP Professional を実行するデスクトップ コンピュータへ迅速かつ確実に配布することができます。

Software Update Services に関するより詳細な情報は以下をご覧ください:  
<https://www.microsoft.com/japan/windows2000/windowsupdate/sus/>

**Systems Management Server (SMS) :**

Microsoft Systems Management Server (SMS) は更新プログラムを管理するための、構成可能なエンタープライズ ソリューションを提供します。SMS により、管理者はセキュリティ更新プログラムを必要とする Windows ベースのコンピュータを識別し、エンタープライズ全体で、エンド ユーザーへの中断を最小限にして、これらの更新プログラムの制御された適用を実行することができます。セキュリティ更新プログラムを適用するための SMS 2003 の使用方法に関する詳細情報は [SMS 2003 セキュリティ パッチ管理 Web サイト](https://www.microsoft.com/japan/smserver/evaluation/tips.mspx)をご覧下さい。SMS 2.0 ユーザーもまた、[Software Updates Service Feature Pack](https://www.microsoft.com/japan/smserver/downloads/20/featurepacks/suspack/) を活用して、セキュリティ更新プログラムの適用を支援することができます。SMS に関する情報は [SMS の Web サイト](https://www.microsoft.com/japan/smserver/default.mspx)をご覧下さい。


**注** **:** SMS は Microsoft Baseline Security Analyzer および Microsoft Office 検出ツールを活用してセキュリティ情報で提供された更新プログラムの検出と適用について広範なサポートを提供します。これらのツールにより検出されないソフトウェアの更新プログラムもあります。管理者は、特定のコンピュータへの更新プログラムを対象とし、これらの場合に SMS のインベントリ機能を使用することができます。この手順に関する詳細情報は、[こちらの Web サイト](https://www.microsoft.com/technet/prodtechnol/sms/sms2003/patchupdate.mspx) (英語情報) をご覧下さい。コンピュータの再起動後、管理者権限を必要とするセキュリティ更新プログラムもあります。管理者は、SMS 2.0 Administration Feature Pack の上位権利での展開ツール ([SMS Administration Feature Pack](https://www.microsoft.com/smserver/downloads/2003/adminpack.asp) (英語情報) および [SMS 2.0 Administration Feature Pack](https://www.microsoft.com/japan/smserver/downloads/20/featurepacks/adminpack/) でご利用可能です) は、これらの更新プログラムのインストールに使用することができます。

**サポート** **:**

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](https://www.microsoft.com/japan/security/support/patchqa.mspx)

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS04-015）  
    [https://www.microsoft.com/technet/security/bulletin/ms04-015.mspx](https://technet.microsoft.com/security/bulletin/ms04-015)
-   サポート技術情報 （KB） 文書番号 ： 840374  
    [\[MS04-015\] 「ヘルプとサポート センター」の脆弱性により、リモートでコードが実行される](https://support.microsoft.com/kb/840374)

**更新履歴** **:**

-   2004/05/12 : このセキュリティ情報ページを公開しました。
-   2004/05/12 : 技術的な詳細の「要点」と、「よく寄せられる質問」を更新しました。
-   2004/05/12 : 「警告」を更新し、サポート技術情報 842253 に関する情報を追記しました。
-   2004/05/12 : 「警告」を更新し、サポート技術情報 842253 の問題が Windows XP Service Pack 1 日本語版でも発生する場合があることを記載しました。
-   2004/05/12 : 「よく寄せられる質問」の「この更新プログラムにより、機能が変更されますか?」に書かれている「このページを表示できません」を「ページを表示できません」に修正しました。
-   2004/05/12 : 「セキュリティ更新プログラムに関する情報」の「Windows XP (すべてのバージョン)」に書かれている「更新プログラムが正しくインストールされたかどうか確認する方法」を修正しました。
-   2004/05/12 : 「謝辞」を更新しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
