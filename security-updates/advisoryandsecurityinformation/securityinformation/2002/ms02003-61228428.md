---
TOCTitle: 'MS02-003'
Title: 'マイクロソフト セキュリティ情報 MS02-003 - 注意'
ms:assetid: 'ms02-003'
ms:contentKeyID: 61228428
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-003(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS02-003 - 注意
===============================================

Exchange 2000 System Attendant がレジストリ リモート アクセス権を不適切に設定する
---------------------------------------------------------------------------------

公開日: 2002年2月8日 | 最終更新日: 2002年2月25日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Exchange 2000 を使用しているシステム管理者

**脆弱性の影響** **:**
既定の設定のセキュリティの保護が弱くなる

**最大深刻度** **:**
低

**推奨する対応策** **:**
管理者は更新プログラムを適用してください。

**影響を受けるソフトウェア** **:**

-   Microsoft Exchange Server 2000

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
Microsoft Exchange System Attendant は Microsoft Exchange サービスの中心となるサービスの 1 つです。Microsoft Exchange System Attendant は、Exchange システムの定期的なメンテナンスに関連する様々な機能を実行します。Microsoft 管理コンソール （MMC） のExchange システム マネージャ スナップインを使用して Exchange Server をリモート管理することができるようにするために、System Attendant は Windows レジストリ上のアクセス権を変更し Exchange 管理者はリモートでレジストリに保存された設定を更新できるようになります。
この System Attendant がレジストリ設定を変更する方法に問題があります。この問題により、特権を持たないユーザーがサーバー上の設定情報にリモートでアクセスできるようになります。具体的には、この問題により、“Everyone” グループに WinReg キーへの特権が不正に与えられてしまいます。このキーにより、ユーザーおよびグループがレジストリにリモートで接続することができるようになります。既定では、管理者のみにこのキーのアクセス権限が与えられ、レジストリにリモートでアクセスすることができます。
この問題により、リモートによる接続以上の操作を実行することはできません。しかし、攻撃者が接続することができたレジストリに変更を加えることができるか否かは、レジストリ自体の中の特定のキーのアクセス権によって異なります。このように、この脆弱性自体では攻撃者がレジストリ設定を変更することができるようになりませんが、不適切にアクセス権を設定されたレジストリ設定と併せて使用することによってシステムのレジストリへアクセスし、変更を加えることができるようになる可能性があります。

**問題を緩和する要素** **:**

-   この脆弱性によって可能になることは、レジストリへのリモート接続のみです。レジストリのほかのアクセス権を低くすることはありません。
-   攻撃者がレジストリにリモート接続するためには、SMB トラフィックを標的とするシステムに送受信できることが必要です。ファイアウォールでの最善策として、NetBIOS およびダイレクト ホストが使用する使用するポート (tcp ポート 139 および 445) を閉鎖することが推奨されます。

**深刻度** **:**

|                          | インターネット サーバー | イントラネット サーバー | クライアント システム |
|--------------------------|-------------------------|-------------------------|-----------------------|
| **Exchange 2000 Server** | 低                      | 低                      | なし                  |

上記の[評価](http://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形態およびこの脆弱性がシステムに及ぼす影響に基づいています。インターネットに接続しているシステムのためには、tcp ポート 139 および 445 をファイアウォールでブロックすることが最善策であり、この対策によりレジストリへのリモート アクセスを防ぐことができます。データが侵害される可能性がありますが、この問題を緩和する大きな要素があります。

**脆弱性識別番号** **:**
[CAN-2002-0049](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0049)

**テストしたバージョン** **:**
マイクロソフトは Exchange 5.5 および Exchange 2000 のテストを行い、これらの脆弱性による影響を評価しました。それより前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**どのようなことが起こる可能性がありますか?**

この脆弱性により、特権を持たないユーザーが Exchange 2000 サーバーの構成情報にリモートでアクセスすることができる可能性があります。最悪の場合、これにより、攻撃者はサーバーの構成の設定を変更できる可能性があります。この脆弱性はいくつかの問題を緩和する要素による影響を受けます。

-   これにより、攻撃者は構成にアクセスすることができます。特定の構成値におけるアクセス許可は攻撃者がそれらを操作することができるかどうかを決定します。
-   通常のファイアウォールによるセキュリティ対策が講じられている場合、インターネットからの攻撃者はこの脆弱性を利用することはできません。

**何が原因で起こりますか?**

この脆弱性は Exchange 2000 System Attendant がレジストリ内の HKEY\_LOCAL\_MACHINE \\SYSTEM\\\\CurrentControlSet\\Control\\SecurePipeServers\\winreg のセキュリティ アクセス許可に間違って "Everyone グループ" を追加するために起こります。

**Exchange 2000 System Attendant** **とは何ですか?**

System Attendant とは Microsoft Exchange のコア サービスの 1 つです。これは定期的なメンテナンスに関連する様々な機能を実行します。また、アドレス一覧、オフライン アドレス帳、ディレクトリ参照機能など、Exchange システムの処理を実行します。
System Attendant が実行する重要な機能の 1 つは組織内の Exchange サーバーの構成設定を管理することです。システム管理者は Microsoft 管理コンソールの Exchange システム マネージャ スナップインを使用して、構成設定を表示し、変更を行うことができます。System Attendant はこれらの構成設定を適切な Exchange サーバーに伝達します。

**レジストリとは何ですか?**

[レジストリ](http://www.microsoft.com/technet/prodtechnol/winntas/tips/winntmag/inreg.mspx) (英語情報) とは Windows および Windows Application の構成情報のための中央レポジトリです。これはオペレーティング システム設定 (デバイス情報、起動シーケンス、ネットワーク構成)、アプリケーション設定 (調整情報、構成パラメータ) およびユーザー設定 (ユーザー設定、現在使用されているショート カット) をすべて保存することができる単一の場所です。

**レジストリはどのように保存している情報を安全にするのですか?**

レジストリはシステムの安定性とセキュリティにとって重要な情報を保存するため、セキュリティ モデルを使用して情報へのアクセスを制御します。レジストリは、ファイル システムのような物理的な 「ツリー構造」 で構成されるため、セキュリティ モデルは Windows NT Files System (NTFS) によって提供されるものと類似しています。このセキュリティ モデルは各ツリーのブランチと実際の値の末端でアクセス許可を割り当てます。アクセス許可はユーザーやグループがレジストリ値の情報の表示、追加、変更または削除を行うことができるかを決定します。例えば、管理者が "WinReg" 値からの情報を表示、追加、変更または削除することができますが、特権を持たないユーザーはこれらの権限を全く持たないか、あるいはいくつかを持ちます。

**WinReg** **値とは何ですか?**

レジストリが提供する管理機能の 1 つに、ほかの Windows ベースのシステムからリモートで接続ができる機能があります。この機能のセキュリティを確実にするために、この機能は認証されたユーザーのみがシステムのレジストリにリモートで接続することができるようにするセキュリティ メカニズムがあります。このメカニズムはいわゆる Winreg キーにより処理されます。具体的には、このキーは HKEY\_LOCAL\_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurePipeServers\\WinReg にあります。この値のセキュリティ アクセス許可は、どのユーザーまたはグループがレジストリにリモートで接続できるかを定義します。
既定で、管理者のみがこの値のアクセス権を持ちます。このため、マシンのレジストリにリモートで接続することができます。すべてのそのほかのユーザーはアクセスが拒否され、管理者以外のユーザーとしてマシンのレジストリに接続を試行することは失敗します。
WinReg キーについての詳細はマイクロソフト サポート技術情報 [153183](http://support.microsoft.com/kb/153183) で説明されています。

**WinReg** **値はレジストリ内の情報の追加、変更または削除を制御しますか?**

いいえ、しません。WinReg 値はマシンのレジストリにリモートで接続することのみを制御します。本質的には、ユーザーが特定のコンピュータのレジストリを開くことができるかどうかのみを制御します。WinReg 値自体はユーザーがレジストリ内の特定の情報を表示、追加、変更または削除することを制御しません。これはレジストリ内の個々のアクセス許可により制御されます。

**Exchange 2000 System Attendant** **が** **WinReg** **キーを処理する方法の何が問題になっていますか?**

Exchange サーバーの構成設定を管理するために、System Attendant は Exchange 管理者が Microsoft 管理コンソールの Exchange システム マネージャ MMC スナップインを使用して構成設定を表示し、変更を行うことができるようにするため、レジストリへのアクセスを必要とします。
このアクセスを許可するために、System Attendant は Exchange System Manager が接続することができるように、レジストリのアクセス許可を設定します。しかし、この変更を行うに当たり、Exchange 2000 System Attendant は “Everyone” グループを その構成設定の一部として WinReg キーに間違って追加します。

**攻撃者はどのようにこの脆弱性を利用するのですか?**

ネットワークの標的となるレジストリに接続を試行することにより、攻撃者はこの脆弱性を利用しようとする可能性が最も高いでしょう。この脆弱性の利用を成功させるためには、攻撃者は tcp ポート 139 または 445 を介し、マシンのレジストリへの接続を確立させる必要があります。また、この接続を確立させるためには、Remote Registry Service も実行されている必要があります。

**攻撃者はこの脆弱性をインターネットで利用することはできますか?**

ファイアウォールによるセキュリティ上の対策が講じられている限り、攻撃者はこの脆弱性をインターネットから利用することはできません。具体的には SMB およびダイレクト ホスト ポートがファイアウォールでブロックされている場合、攻撃者がインターネットからレジストリに接続することはできません。

**この脆弱性により、攻撃者は何ができますか?**

WinReg 値は単にリモートでレジストリにアクセスすることができるかどうかを制御します。これ自体では、この脆弱性により攻撃者はリモートでレジストリに接続することができるだけにとどまり、攻撃はレジストリへの直接のアクセスを取得します。この脆弱性自体では、攻撃者はレジストリにアクセスすることができるだけで、操作を行うことはできません。
しかし、重要なことは、攻撃者がいったんマシンのレジストリへのアクセスを取得すると、各キー、サブキーおよび値の特定のアクセス許可のみが攻撃者の操作を制限します。つまり、レジストリ値が不適切にアクセス許可の設定を持ち、例えば Everyone に書き込み権限が与えられていると、攻撃者はこの脆弱性を使用してアクセスを取得し、そのアクセス許可の設定を利用する可能性があります。
マシンの特定のレジストリのアクセス許可はインストールされているソフトウェア、管理者の設定、および Security Configuration Manager と Active Directory により伝達されたセキュリティ ポリシーによるものであるため、攻撃者が行う実際の操作の範囲はマシンによって異なります。また、上記で説明されている Guest アカウントが無効にされているため、認証されていないユーザーは既定ではマシンにアクセスすることができませんが、管理者の選択によりそのアカウントを有効にすることができます。このようにした場合、この脆弱性が影響を及ぼす範囲が広がります。

**更新プログラムは何を修正しますか?**

この更新プログラムは Exchange 2000 System Attendant の動作を修正し、これが WinReg 値のセキュリティ アクセス許可を Everyone グループに与えることを防ぎます。

**この更新プログラムは** **WinReg** **値から** **Everyone** **グループを削除するのですか?**

はい、そうです。System Attendant の動作を変更し、"Everyone" にWinReg 値でのアクセス許可を与えないようにするとともに、"Everyone" グループを WinReg 値から削除します。

**この更新プログラムはレジストリのアクセス許可に対し、ほかに何か変更しますか?**

いいえ。この更新プログラムは "Everyone" グループの WinReg 値でのアクセス許可を削除するのみです。すべてのほかのレジストリ アクセス許可は変更されません。

**それでは、つまりこの更新プログラムは** **WinReg** **値のアクセス許可を既定に戻すということですか?**

必ずしもそうではありません。更新プログラムは System Attendant が間違って追加する "Everyone" グループを削除しますが、そのほかの変更は行いません。つまり、管理者が WinReg 値のアクセス許可に変更を行った場合、このツールは管理者による変更を保持します。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft Exchange Server 2000:
    [http://www.microsoft.com/downloads/details.aspx?displaylang=ja&FamilyID=31c17c11-3d78-4ad4-9bd7-bfe99e2c83e0](http://www.microsoft.com/downloads/details.aspx?displaylang=ja&familyid=31c17c11-3d78-4ad4-9bd7-bfe99e2c83e0)

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**
この更新プログラムは Microsoft Exchange 2000 SP2 を実行しているシステムにインストールすることができます。

**この修正を含む予定のサービスパック** **:**
この問題に対する更新プログラムは Microsoft Exchange 2000 SP3 に含まれています。

**再起動の必要性** **:**
あり

**更新プログラムに含まれる過去の修正** **:**
なし

**更新プログラムが正しくインストールされたか確認する方法** **:**

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Updates\\Exchange Server 2000\\SP3\\Q316056
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。
    HKEY\_LOCAL\_MACHINE \\Software\\Microsoft\\Updates\\Exchange Server 2000\\SP3\\Q316056\\filelist

**警告** **:**
なし

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-003）
    [http://www.microsoft.com/technet/security/bulletin/ms02-003.mspx](http://technet.microsoft.com/security/bulletin/ms02-003)
-   サポート技術情報 （KB） 文書番号 ： 316056
    [\[XGEN\] Exchange 2000 Server Post-Service Pack 2 Admin 更新プログラム](http://support.microsoft.com/kb/316056)

**更新履歴** **:**

-   2002/2/8: このセキュリティ情報ページを公開しました。
-   2002/2/25: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
