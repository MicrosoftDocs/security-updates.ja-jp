---
TOCTitle: 'MS00-035'
Title: 'マイクロソフト セキュリティ情報 MS00-035 - 緊急'
ms:assetid: 'ms00-035'
ms:contentKeyID: 61228201
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-035(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS00-035 - 緊急
===============================================

「SQL Server 7.0 Service Pack のパスワード」 の脆弱性に対する対策
-----------------------------------------------------------------

公開日: 2000年5月31日 | 最終更新日: 2001年5月14日

#### 概要 :

2000 年 5 月 30 日、マイクロソフトは、Microsoft® SQL Server® 7.0 Service Packs 1 と 2 のインストール ルーチンにおけるセキュリティの脆弱性を排除する英語版更新プログラムが入手可能であることをお知らせしたセキュリティ情報をリリースしました。非推奨モードが設定されたマシンで実行した場合、サーバーにログオンできるユーザーなら誰でも読み出すことのできるログファイルに管理者パスワードが記録されます。
2000 年 6 月 15 日、このセキュリティ情報を更新し、最初にお知らせした場合と同じ状況下において、パスワードが 2 番目のファイルにも記録されてしまうことをお知らせしました。そして今回パスワードが両方のファイルに記録されるのを防ぐ新しいバージョンの更新プログラムが入手可能になりました。
2001 年 5 月 10 日、このセキュリティ情報の更新は、Service Pack 3 もまたこの脆弱性の影響を受けることをお知らせするためのものです。新たに Service Pack 3 用の更新プログラムが入手可能となり、また、サポート技術情報 Q263968 からファイルに記述される管理者パスワードの全てのインスタンスを削除するためのコマンド ライン ユーティリティ （Service Pack 適用後のためのもの） を提供しています。

**影響を受けるソフトウェアのバージョン** **:**

-   Microsoft SQL Server 7.0 Service Packs 1、2 および 3

### 詳細

問題
----

<span></span>
混合モードを使って認証を行うように設定されたマシンに SQL Server 7.0 Service Packs 1 や 2 または 3 をインストールした場合、SQL Server 標準セキュリティのシステム管理者（SA）のパスワードはファイル \\%TEMP%\\sqlsp.log に通常のテキストとして記録されます。そのファイルに対するデフォルトの権限は、対話的にサーバーにログオンできるユーザーなら誰にでもそれを読み出すことができるようになっています。
パスワードが記録されるのは、混合モードが使用されていて、サービス パックをインストールするときに管理者が SQL Server 認証を選択した場合だけです。弊社ではこれまでずっと長い間、SQL Serverの設定として、より安全な Windows NT 認証モードを推奨してきました。これに従っていただいたお客様はこの問題の影響を受けません。影響のあるマシンでも、通常のセキュリティ関する推奨事項に従って、普通のユーザーが対話的にマシンにログオンできないようにしておけば、パスワードが読み出されるような危険はありません。

よく寄せられる質問
------------------

<span></span>
**マイクロソフトセキュリティ情報** **MS00-035** **はどのような内容の通知ですか?**

マイクロソフト セキュリティ情報 MS00-035 は、Microsoft® SQL Server 7.0 Service Packs 1 および 2 の、インストール ルーチンにおけるセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことをお客様にお知らせするものです。この脆弱性のため、管理者のパスワードが特定の条件下で改ざんされることがあります。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**どのようなことが起こる可能性がありますか?**

混合モードでユーザー認証を行っているシステムに、SQL server 7.0 Services Pack 1 および 2 がインストールされると、特定の条件下で、インストール サーバー上の 2 つのファイルにデータベース管理者のパスワードが記録されます。このパスワードが悪意あるユーザーに発見された場合、データベース上の管理者権限を行使されます。
この脆弱性を利用するには、いくつかの重要な制限があります。

-   推奨される認証方法の Windows NT® 認証が使用されている場合には、影響はありません。
-   混合モードが使用されているときでも、特定の認証方法、つまりSQL Server 認証が使用されていない場合には、影響はありません。
-   デフォルトでは、サーバーに対話的にログオンできるユーザーのみ、パスワードが記録されているファイルを読むことができます。通常推奨しているセキュリティでは、データベース サーバーのようなセキュリティ重視のサーバーに普通のユーザーが[対話的にログオン](http://www.microsoft.com/japan/security/glossary.mspx)できないようになっています。

**何が原因で起こりますか?**

SQL Server が混合モードで認証を行わないように構成されていて、セットアップの最中に管理者が、Windows NT認証ではなくてSQL Server 認証を選択した場合、サービス パック1および2をインストールするときに、ユーザーは管理者のパスワードを入力するように求められます。上記の条件が正しい場合、インストール用ソフトウェアは、サーバー上のファイルにそのパスワードを記録します。

**パスワードが記録される** **2** **つのファイルは何ですか?**

Sqlsp.log および setup.iss です。

**混合モードとは何ですか?**

SQL Server がユーザーを認証する方法は、混合モードと Windows NT 認証モードの 2 種類です。混合モードでは、可能な場合には Windows NT アカウント情報を使用してクライアントを認証しますが、可能でない場合には、SQL Server データベースにローカルに保存されているユーザー名とパスワード情報を使用した SQL Server 認証を通じて行います。混合モードが最も一般的に使用されるのは、SQL Server が Windows® 95 または 98 の起動しているマシンのときです。
その対照に、Windows NT 認証モードは Windows NT (または Windows 2000) アカウント情報を使用する認証を行います。この認証の方がずっと安全なので、可能な限り Windows NT 認証モードを使用することを強く推奨します。Windows NT 認証モードを使用している場合には、この脆弱性の影響を受けることはありません。

**どうしてWindows NT** **認証モードより混合モードの方が、セキュリティ上危険なのですか?**

混合モードでは、ユーザー名とパスワード情報は SQL Server 自体に保存されます。混合モードは、サーバー、クライアント、ネットワーク インフラストラクチャが物理的に保護されていて、全てのユーザーが信頼されているネットワーク内だけで使用するように構成されています。これは、SQL Server 7.0 にのみ含まれていますが、以前にリリースされたものとの互換性のためにあるもので、Windows NT認証をサポートしない製品と一緒に使用できます。
その反対に、Windows NT 認証モードは通常のWindows NT 認証技術を使用しており、セキュリティの重要な環境での使用を目的に作られたものです。全ての認証情報は SQL Server ではなくドメイン コントローラに保存されるので、通信中でもドメイン コントローラ上でも、高度な暗号化のハッシュにより保護されます。
一般的な SQL Server 7.0 のセキュリティに関する情報は、認証モードに関するものも含めて、<http://www.microsoft.com/technet/prodtechnol/sql/70/maintain/secure.mspx> で参照してください。 特に、”セキュリティ付き SQL Server 7.0 のインストール” では、認証モードの変更を説明しています。

**混合モードを使用する全てのカスタマが、この脆弱性の影響を受けますか?**

いいえ、この脆弱性を利用するには、以下の 3 つの条件が揃っている必要があります。

-   SQL Server 7.0 Service Packs 1 または 2 が適用されている
-   SQL Server が混合モードで構成されている
-   管理者がサービス パックのいずれかをインストールするとき、SQL 認証を使用した

後者の項目は特に重要です。混合モードでは、ユーザーは Windows NT または SQL Server 認証のいずれかを用いて認証することができます。管理者がサービス パックをインストールするときに Windows NT 認証を選択した場合、パスワードはログファイルに記録されません。

**どんなパスワードがこの脆弱性に関係していますか?**

ここで問題になっているパスワードは SQL Server 標準セキュリティ システム管理者アカウント、つまり ”sa” アカウントに関係するものです。混合モードが使用されているとき、”sa” という名前のユーザー ID が SQL Server の管理者用の表に作られます。
“ｓa” アカウントが Windows NT 管理者アカウントと同一のものではないという点に注意してください。“ｓa” アカウントは SQL データベースに管理者権限を提供しますが、マシン自体には何も提供しません。重要なことは、悪意あるユーザーがこの脆弱性を利用しても、マシンやネットワーク ではなく SQL データベースのコントロール権しか取得できないということです。

**だれがパスワードを含むファイルを読むことができますか?**

デフォルトでは、 サーバーに対話的にログオンできるユーザーは誰でもファイルを読むことができます。ファイルはデフォルトでは共有できないので、リモート ユーザーは読むことができません。

**サーバーに対話的にログオンできる必要があるのは誰ですか?**

一般的な規則として、データベース サーバーのようなセキュリティ重視のマシンにログオンできるのは管理者のみの必要があります。推奨に従った場合、管理者のみファイルを読むことができます。(もちろん、管理者は既にパスワードを知っています。)
Windows 95 および 98 では、マシンにログオンすることができる人を制限する手段はありません。ユーザーに必要なことはマシンに物理的にアクセスすることです。このため、そのようなマシンの全てのハードウェアが物理的にセキュリティで保護され、全てのユーザーが信頼されている環境で使用する必要があるのです。

**この脆弱性の影響を最も受けるのはどのマシンですか?**

SQL Server 7.0 Service Packs 1 または 2 が起動しているマシンのみが影響を受けることになります。ただし、1 つ以上のサービス パックのセットアップ時に SQL Server 認証を使用している場合に限ります。

**この脆弱性の影響を受けるサービスパックの** **1** **つを既にインストールしていて、そのインストール時に** **SQL Server** **認証を使用しました。何をするべきでしょうか?**

以下の対策のいずれか 1 つをとってください。

1.  サポート技術情報 [263968](http://support.microsoft.com/kb/263968) の回避策で提供されているパスワード ユーティリティ ツールを実行します。
2.  sp\_password ストアド プロシージャを使用して sa アカウントのパスワードを変更します。
3.  Windows NT 統合認証のみでユーザーの認証を行うようにサーバーの設定を変更します。
4.  type=1&gt;以下のファイルのコピーを全て検索して、削除してください。
    -   sqlsp.log
    -   setup.iss

これらのファイルを復元することができないようにするには、Shift キーを押しながらファイルをごみ箱にドラッグしていくと完全に削除することができます。

**この脆弱性の影響を受けるサービスパックの** **1** **つを既にインストールしていて、そのインストール時に** **SQL Server** **認証を使用しました。何をするべきでしょうか?**

以下のファイルのコピーを全て検索して、削除してください。

-   sqlsp.log
-   setup.iss

これらのファイルを復元することができないようにするには、Shift キーを押しながらファイルをごみ箱にドラッグしていくと完全に削除することができます。

**SQL Server 7.0 Service Pack 2** **または** **3** **を適用する準備をしていますが、混合モードで起動しています。どうしたら良いのでしょうか?**

最も簡単な方法は、サービス パックをインストールするときに Windows NT 認証を使用することです。こうすると、パスワードを再現することはできず、上記で説明されているように、セキュリティ全体もより堅固なものになります。
SQL Server 認証を使用する必要のある場合、何台のマシンにサービス パックをインストールするかにより、2種類の方法があります。

-   少ない台数のマシンにサービス パックをインストールする場合、通常のインストールを行い sqlsp.log および setup.iss を削除します。
-   たくさんのマシンにサービス パックをインストールする場合、マイクロソフト セキュリティ情報に説明されている更新プログラムを適用します。サービス パックをフォルダの中で開き、更新プログラムをインストールします。これにより、影響を受けるファイルを、ログ ファイルを作らない新しいものに書き換えます。次にフォルダからサービス パックをインストールします。(この更新プログラムの元のバージョンでは、パスワードがsqlsp.log に記録されるのを阻止するだけでしたが、新しいバージョンでは、setup.iss に記録されるのも阻止する点に注意してください。マイクロソフト セキュリティ情報が更新されて新しいバージョンが入手可能になると、元のバージョンは削除されます。)

**更新プログラムはどのように使用するのですか?**

サポート技術情報 [263968](http://support.microsoft.com/kb/263968) には、お客様のサイトに更新プログラムを提供するための詳細な情報が記載されています。

**どこから更新プログラムを入手できますか?**

マイクロソフト セキュリティ情報 MS00-035 をご覧ください。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](http://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカルサポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](http://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、以下のサイトからダウンロードできます。

-   Microsoft SQL Server 7.0 Service Pack 2:
    この問題に対する更新プログラムは最新の SQL Server 7.0 Service Pack に含まれています。
    最新の SQL Server 7.0 Service Pack は[こちら](http://support.microsoft.com/kb/301511/)から入手することができます。
-   Microsoft SQL Server 7.0 Service Pack 3:
    [http://download.microsoft.com/download/sql70/SPpwfix/7.01/WIN98/EN-US/sqlsp3.exe](http://download.microsoft.com/download/sql70/sppwfix/7.01/win98/en-us/sqlsp3.exe)

**注** **:**
パスワードを削除するツールはサポート技術情報 [263968](http://support.microsoft.com/kb/263968) の回避策のセクションでも入手可能です。このツールは Service Pack の適用後、該当するファイルから全ての管理者パスワードを削除します。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS00-035）
    [http://www.microsoft.com/technet/security/bulletin/ms00-035.mspx](http://technet.microsoft.com/security/bulletin/ms00-035)
-   サポート技術情報 （KB） 文書番号 ： 263968
    [\[FIX\] Service Pack インストール時に標準セキュリティのパスワードが保存される](http://support.microsoft.com/kb/263968)

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
