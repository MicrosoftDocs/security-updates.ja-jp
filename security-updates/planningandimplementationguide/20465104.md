---
TOCTitle: 'ISA Server 2004 による HTTP 経由の Outlook Web Access と RPC 用の SSL VPN 機能の提供 : 今月の MVP に関する記事 - 2005 年 4 月'
Title: 'ISA Server 2004 による HTTP 経由の Outlook Web Access と RPC 用の SSL VPN 機能の提供 : 今月の MVP に関する記事 - 2005 年 4 月'
ms:assetid: 'b9094488-4e5d-4b56-9d27-aeb475ca54c3'
ms:contentKeyID: 20465104
ms:mtpsurl: 'https://technet.microsoft.com/ja-jp/library/Cc512659(v=TechNet.10)'
---

今月のセキュリティ MVP に関する記事 - 2005 年 4 月
==================================================

### ISA Server 2004 による HTTP 経由の Outlook Web Access と RPC 用の SSL VPN 機能の提供

企業ネットワークでホストされるリソースへのリモート アクセスは、今日のインターネット接続ビジネスの環境でうまく競争を進めていくことを求める組織にとっては必要条件になりました。オフサイトの従業員、在宅勤務者、出張中の役員、販売員はすべて、いつでもどこでも企業ネットワークでホストされる情報にアクセスする必要があります。このような情報ニーズにより、Microsoft Exchange Server は企業が自社の企業ネットワークで管理する最も重要な情報リソースの 1 つです。

IT プロフェッショナルやセキュリティ プロフェッショナルにとっての課題は、プライベートで、安全な、信頼できる方法で Exchange Server リソースへのリモート アクセスを提供することによって、自社の競争力を高めることです。

企業の IT 部門は、従来はネットワーク レベルで企業ネットワークへの VPN アクセスを提供していました。ネットワーク レベルの VPN は、PPTP または L2TP/IPSec を使用する VPN プロトコルに基づきます。ネットワーク レベルの VPN に関する問題は、プライベート接続は提供しても、必ずしもセキュリティで保護された接続を保証しなかったことです。ネットワーク レベルの VPN アクセスでは、Exchange Server のネイティブ Remote Procedure Call (RPC) プロトコルを使用して、Exchange Server の情報リソースのアレイ全体にアクセスできるようにします。リモート アクセスのネットワーク レベルの VPN 接続では、企業ネットワークに VPN クライアントの仮想ノードを作成します。したがって、これらの VPN クライアントは、イーサネット ネットワークに直接接続されているホストと同じ方法で、任意のプロトコルを使用して企業ネットワークのあらゆるサーバーのリソースにアクセスできます。このような VPN クライアントは、大部分の直接接続されたホストと同様に、VPN ゲートウェイでこれらの接続を積極的にはフィルタしません。

これが壊滅的な結果を招く可能性があります。管理の行き届いた企業ネットワークから切り離されることのないデバイスとは対照的に、VPN クライアント コンピュータは基本的にはリモート アクセスに使用されるデバイスなので、管理されていない、または管理のずさんなネットワークに接続されることがあります。その結果、デバイスがウイルス、ワーム、スパイウェアなどの侵入を許すことになります。その後これらの感染したデバイスがネットワークに接続されると、レベルの VPN リンクを使用した企業ネットワークを含めて、ネットワークの他のデバイスに悪意のあるペイロードを広めます。

これらのリスクを軽減する方法は、数多くあります。普及が増加しているリモート アクセス方法は、Secure Sockets Layer (SSL) VPN です。SSL VPN ではアプリケーションごとにユーザーへのリモート アクセスを提供する機能によって、ネットワーク レベルの VPN のプライバシーを提供し、従来のネットワーク レベルの VPN で達成が困難だったセキュリティのレベルを向上します。

ネットワーク レベルの VPN とは異なり、SSL VPN との間には制御チャネルと暗号化という主な違いがあります。SSL VPN は、大きく異なるリモート アクセス方法のコレクションを表し、SSL (実際は TLS) を共通の暗号化方式として共有します。さまざまな SSL VPN には、次のようなものがあります。

-   **Web** **対応アプリケーション向けのリバース** **Web** **プロキシ**  
    この種の SSL VPN を使用すると、サーバー上でホストされるデータへの Web アクセスに対する組み込みサポートを備えたサーバー アプリケーションを利用できます。Microsoft Office Outlook Web Access はこの種のアプリケーションの最適な例です。Microsoft Internet Security and Acceleration (ISA) Server 2004 では、Outlook Web Access のサイトにリバース Web プロキシを提供します。

-   **アプリケーションゲートウェイによる** **Web** **非対応アプリケーション向けのリバース** **Web** **プロキシ**  
    ネイティブの Web 統合を持たないサーバーアプリケーション向けに、SSL VPN にはアプリケーション ゲートウェイが含まれるものがあります。アプリケーション ゲートウェイは、Web ブラウザで変更ができるように、サーバー アプリケーションから返されたデータを変換して動的にサーバー データを再フォーマットするものです。

-   **クライアント/サーバープロトコルをカプセル化した** **HTTP** **用のアプリケーションプロキシ**  
    SSL VPN には、SSL VPN クライアントのクライアント アプリケーションによって、暗号化された HTTP ヘッダー (SSL) 内のネイティブのサーバー アプリケーション プロトコルをカプセル化または "ラップ" できるようにするものがあります。カプセル化された通信は SSL VPN プロキシに送信され、HTTP ヘッダーの "ラップ" を解除してネイティブのアプリケーション プロトコルを公開し、サーバーに送信します。HTTP 経由の Outlook 2003 RPC は、この種の SSL VPN の一例であり、ISA Server 2004 ではカプセル化された接続のためにリバース プロキシを提供できます。

-   **Network** **拡張**  
    ネットワーク レベルの VPN と同様に機能する SSL VPN は、ネットワーク拡張 SSL VPN と呼ばれます。これらの SSL VPN の実装によって、企業ネットワーク上で仮想ノードを SSL VPN クライアントに作成し、複雑な複数接続のアプリケーション プロトコルなど、あらゆるプロトコル向けの機能を提供することができます。

SSL VPN 接続の実装に使用されるテクノロジには大きな違いがある一方で、すべての SSL VPN は次に示す従来のネットワーク レベルの VPN のメリットを共有します。

-   SSL VPN では、VPN クライアントはファイアウォールと NAT デバイス経由で接続できます。NAT デバイスはリモート VPN サーバーに接続するために、PPTP、L2TP/IPSec、または IPSec トンネル モード用の送信方向のアクセスを提供しません。

-   SSL VPN は異種リモート アクセス テクノロジのコレクションを表します。このようなリモート アクセス テクノロジにより、サーバーとアプリケーションのアクセスをユーザーの資格情報に基づいて制限することができます。これにより、ユーザーが作業を行うのに必要のないリソースにアクセスするリスクを大幅に軽減できます。

-   SSL VPN によってエンド ユーザー エクスペリエンスが大幅に簡素化されます。ユーザーは仮想ネットワーク接続に関する問題を理解する必要はありません。許可されたリソースへのリンクを含む、明快でわかりやすいジャンプ先のページをユーザーに提供します。

-   SSL VPN では、バックエンド サービスに接続を転送する前に、ユーザーを事前認証することができます。これによって、悪意がある可能性を持つ認証されていない接続がバックエンド サーバーに到達することを防ぎます。

-   SSL VPN ゲートウェイでは、発信または着信 HTTP 通信のアプリケーション レイヤ検査を実行することができ、SSL VPN ゲートウェイと SSL VPN ゲートウェイにホストされる Web サービスに対する攻撃を防ぐのに役立ちます。

企業に Exchange Server リソースへの SSL VPN タイプのアクセスが必要な場合、専用の SSL VPN を購入する必要はありません。Microsoft では、次の 2 つのコア テクノロジを使用して Microsoft Exchange Server にホストされるデータにリモート アクセスするための SSL VPN 機能を含めました。

-   Outlook Web Access、Outlook Mobile Access、および Exchange ActiveSync 用の統合 Web サポート

-   HTTP プロトコル経由で Outlook 2003 または Exchange Server 2003 RPC を使用した、Exchange Server のネイティブ RPC 通信に使用する HTTP プロトコルのカプセル化

ISA Server 2004 では、HTTP プロトコル経由の統合 Exchange Server サービスの通信と RPC 用に、リバース Web プロキシ サポートと HTTP アプリケーション レイヤ検査を提供します。

**Outlook Web Access** **の** **SSL VPN** **接続**

Outlook Web Access (OWA) によって、ユーザーはどの Web ブラウザを使用していても Exchange Server でホストされる情報にアクセスできます。OWA の Exchange Server 2003 バージョンでは、Microsoft Office Outlook 2003 のインターフェイスによく似た、非常に機能豊富なユーザー エクスペリエンスを提供します。Exchange Server 2003 の OWA では、完全な Outlook 2003 クライアントを使用してアクセスできるほぼすべての機能とデータにアクセスできます。

ISA Server 2004 を OWA と組み合わせ、多機能の SSL VPN ソリューションに見られる次のような優れたセキュリティを提供することができます。

-   Exchange Server がホストするリソースへのクライアントレス リモート アクセス。

-   従来のネットワーク レベルのファイアウォールの送信アクセスを許可しないファイアウォールを経由してトンネルする機能。

-   SSL VPN を使用して企業のリソースにアクセスできる機能に対する厳密な制限。OWA では、Exchange Server サービスにのみアクセスできます。

-   ISA Server 2004 ファイアウォール経由で Exchange Server へ送信される、暗号化された HTTP コマンドとデータのアプリケーション レイヤ検査。ISA Server 2004 の SSL ブリッジ機能への SSL によって、暗号化された SSL トンネルの内部に隠されることになるデータのアプリケーション レイヤ検査が可能になります。

-   ISA Server 2004 では、OWA Web サイトにアクセスしていることをユーザーに明らかにする、魅力的でわかりやすいジャンプ先のページを提供します。

-   ISA Server 2004 では、OWA Web サイトに接続を転送する前に、ユーザーを事前認証することができます。

-   ISA Server 2004 に含まれるフォーム ベースの認証機能では、接続をタイムアウトすること、ユーザーが OWA Web サイトを離れるときにログアウトすること、および添付ファイルのダウンロードを防ぐことを適用できます。

これらすべての機能では、SSL VPN デバイス専用に実現される機能とほとんど区別のない、ISA Server 2004 ファイアウォール経由の OWA Web サイトへの接続を行います。

**Microsoft Exchange Server 2003** **への** **HTTP** **経由の** **Outlook 2003 RPC**

Outlook 2003 には、完全版の Outlook MAPI クライアントが通常 Exchange Server と通信するのに使用する、Exchange Server のネイティブ RPC プロトコルをカプセル化する機能があります。ネイティブ RPC 通信は、暗号化された HTTP ヘッダー (SSL) でカプセル化され、HTTP プロキシ経由で企業ネットワークの RPC に転送されます。HTTP プロキシ経由の RPC では、HTTP ヘッダーを削除し、Exchange Server にネイティブの RPC プロトコル通信を転送します。Exchange Server が HTTP プロキシ経由で RPC に応答を送信した後、プロキシは暗号化された HTTP (SSL) ヘッダーで RPC 通信を再びカプセル化し、Outlook 2003 クライアントに応答を返します。

HTTP ソリューション経由の RPC は、SSL VPN 接続のクライアントレスの側面には対応していませんが、SSL VPN 接続でしか見られない他の多くの機能を提供します。

-   HTTP 経由の RPC では、従来のネットワーク レベルの VPN 接続をサポートしないファイアウォール経由でトンネルできます。

-   Outlook 2003 のユーザーは Exchange Server サービスにのみアクセスできます。

-   ISA Server 2004 では、HTTP 通信経由の RPC 用にリバース プロキシを実行できます。

-   ISA Server 2004 では、Outlook 2003 クライアントと RPC プロキシ経由の HTTP の間の HTTP 通信のアプリケーション レイヤ検査を実行できます。

-   HTTP 接続経由の RPC の事前認証は、ISA Server 2004 ファイアウォールで行うことができます。これにより、HTTP プロキシ経由の RPC に対して起こり得る、認証されていないユーザーからの攻撃を防ぐことができます。

OWA Web サイトへのリモート アクセスと同様に、Outlook 2003、Exchange Server 2003、および ISA Server 2004 の組み合わせによって、専用の SSL VPN サーバーを必要とせずに、SSL VPN 接続が提供されます。

**まとめ**

従来のネットワーク レベルの VPN 接続では、プライベートであっても必ずしもセキュリティで保護されていない企業ネットワークへの接続であれば、リモート アクセス クライアントに提供することができます。SSL VPN テクノロジは、SSL 暗号化通信を使用してリモート アクセス クライアント用にプライベートな接続を提供し、ユーザーが作業を行うのに必要なリソースにのみアクセスできるため、次第に人気が高まっています。Microsoft Exchange Server 2003 への HTTP クライアント接続を経由した Outlook Web Access と Outlook 2003 RPC では、専用の SSL VPN デバイスの実装で見られる多くのプライバシー機能とセキュリティ機能が提供されます。

その他の[今月のセキュリティ MVP に関する記事](http://www.microsoft.com/japan/technet/community/columns/secmvp/default.mspx)も参照してください。

[](#mainsection)[ページのトップへ](#mainsection)