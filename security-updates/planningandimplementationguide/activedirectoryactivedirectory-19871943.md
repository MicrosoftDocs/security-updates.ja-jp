---
TOCTitle: 'Active Directory サイトとサービスの概要 ‐ Active Directory の複製'
Title: 'Active Directory サイトとサービスの概要 ‐ Active Directory の複製'
ms:assetid: 'e4f9e920-b4a3-48b1-9d1e-32e58309375e'
ms:contentKeyID: 19871943
ms:mtpsurl: 'https://technet.microsoft.com/ja-jp/library/Dd362998(v=TechNet.10)'
---

Active Directory サイトとサービスの概要
=======================================

### Active Directory の複製

最終更新日: 2003年1月17日

知識整合性チェッカー (KCC: Knowledge Consistency Checker) は、フォレストの複製トポロジを作成するビルトイン プロセスで、すべてのドメイン コントローラ上で実行されます。既定の設定では KCC は 15 分間隔で実行され、その時点で利用できる接続のうち、最も有利なものを利用して、ドメイン コントローラ間の複製ルートを指定します。KCC は同じサイト内のドメイン コントローラ間の複製接続を自動的に作成します。複数のサイトがあるときは、サイト間のリンクを構成すると、サイト間の接続も自動的に作成できます。

**トポロジのコンセプトとコンポーネント**

複製はドメイン コントローラのフォレスト全体の Active Directory 情報を同期する効果がありますが、実際の複製プロセスは、一度に 2 台のドメイン コントローラ間で発生します。複製トポロジが作成されると、どのドメイン コントローラを他のどのドメイン コントローラに複製するかが決定されます。特定のサイトのドメイン コントローラすべてに対して決定が行われると (各ドメイン コントローラが、同じ情報を格納したフォレスト内のすべてのドメイン コントローラの変更を受信できる必要がある点を考慮)、サイト内を複製する複製トポロジが生成されます。複数のサイトに属するドメイン コントローラがフォレストにある場合、コンピュータ間の複製接続の一部が、サイトをまたいで、サイト間の複製トポロジも作成する必要があります。

トポロジ全体は、事実上、複数の基礎となるトポロジによって構成されています。つまり、複製が必要なディレクトリ パーティションをひとつに組み合わせたものです。同一のドメイン ディレクトリ パーティションを格納しているドメイン コントローラは、相互に接続を持つ必要があります。また、すべてのドメイン コントローラは、スキーマと構成ディレクトリ パーティションを複製できる必要があります。スキーマと構成ディレクトリ パーティションは独立したトポロジ上に複製されますが、このディレクトリ パーティションとの接続は、ドメイン コントローラ間の場合と同じです。たとえば、2 台のドメイン コントローラが同じドメイン ディレクトリ パーティションを格納している場合、単一の接続を使用できます。

以下のようなディレクトリ パーティションの組み合わせに対するルートは、集約されて、トポロジ全体に到達します。

-   サイト内の構成とスキーマ

-   サイト内の各ドメイン ディレクトリ パーティション

-   サイト内のグローバル カタログ読み取り専用の部分的なディレクトリ パーティション

-   サイト間の構成とスキーマ

-   サイト間の各ドメイン ディレクトリ パーティション

-   サイト間のグローバル カタログ読み取り専用の部分的なディレクトリ パーティション

**トポロジ関連コンポーネント**

Active Directory はフォレスト全体の構成ディレクトリ パーティションに格納された情報を使用して、複製トポロジを構築および実行します。以下のような複数の構成オブジェクトによって、複製に必要なコンポーネントが定義されます。

-   コンポーネントに関連したサイトとドメイン コントローラ

-   サイト内のドメイン コントローラ間の複製時に使用するルートを特定する接続

-   サイト間の複製接続を可能にするリンク

-   リンクがサイト間の通信に使用するトランスポート

KCC はこれ以外のオブジェクトとプロパティも使用して、ディレクトリの更新を転送する接続を作成、管理し、特定のサーバー要求によって変更された 1 つ上のドメイン コントローラを特定します。相互に直接複製されるドメイン コントローラ同士を、*複製パートナー*と呼びます。KCC を実行するたびに (既定では 15 分間隔)、利用可能なドメイン コントローラと、ネットワーク上での相互の緊密度に基づいて、パートナーシップが必要に応じて自動的に追加、削除、または変更されます。

KCC は以下のコンポーネントを使用して複製を管理します。

**接続**。KCC によって接続が作成され、ドメイン コントローラの相互複製が可能になります。接続には、送信元である 1 台のドメイン コントローラから、宛先である別のドメイン コントローラへの入力方向のみのルートが定義されています。KCC は可能な場合、既存の接続を再使用します。また未使用の接続の削除、現在の要求を満たす接続がない場合の新たな接続の作成も行います。

**サーバー**。各ドメイン コントローラは、サーバー オブジェクトによって表わされます。サーバーは子オブジェクトである NTDS Settings を持っており、これには入力方向の接続が格納されています。すなわち、サーバーの接続オブジェクトは、送信元のドメイン コントローラ*から*サーバー オブジェクト*へ*の接続を指定します。

**サイト**。サイトには、速度とコスト面で適切に接続された一連のドメイン コントローラが定義されています。同一サイト内のドメイン コントローラは、通知があるごとに複製されます。この通知は、ドメイン コントローラが変更されると、複製パートナーに通知されるものです。通知されたパートナーは変更を要求し、複製を実行します。複製の速度またはコストを気にせずに済むので、サイト内の複製は計画的ではなく、必要に応じて実行されます。

**注意** : 通知ミスの原因となるネットワーク障害の可能性を考慮して、変更が通知された場合以外に、1 時間に 1 度、サイト内で複製を実行するスケジュールが既定で設定されています。

サイト間の複製が、スケジュールに基づいて実行されます。権限のある管理者は、スケジュールを使用し、ネットワーク トラフィックとコストに基づいて、複製を実施する最も有利な時間を指定することができます。サイトは、1 つ以上のインターネット プロトコル (IP) サブネットの集合体に相当します。

**注意** : 両方のサイト間の接続が開始できない場合 (1 方のサイトにダイヤルアップ接続が必要な場合など)、スケジュール単位ではなく、変更時に相互の複製を開始することができます。

**サブネット**。TCP/IP ネットワーク上のコンピュータは、サブネットまたはサブネット集合内での場所に基づいて、サイトへ割り当てられます。サブネットは、ネットワーク上での物理的な近さを識別し、コンピュータをグループ化します。サブネット情報は、ドメイン コントローラの場所を特定する際に使用され、ログオンしているコンピュータと同じサイト内のドメイン コントローラが検出されます。この情報は、Active Directory の複製時にも使用され、ドメイン コントローラ間の最適なルートを特定します。

**サイト リンク**。2 つのサイト間で複製を実行するには、サイト間のリンクを確立する必要があります。サイト リンクは自動的に作成されないので、\[Active Directory サイトとサービス\] を使って作成します。サイト リンクが適切でない場合、KCC は 2 つのサイトに属するコンピュータ間の接続を自動的に作成できず、またサイト間の複製も実行できません。各サイト リンクには、接続するサイト間でいつ複製を実行するか特定するスケジュールが含まれています。\[Active Directory サイトとサービス\] によって、すくなくとも 1 つのサイト リンクにすべてのサイトが確実に配置されます。サイト リンクは、2 つ以上のサイトで構成することができ、この場合すべてのサイトを適切に等しく接続します。

**ブリッジヘッド サーバー**。サイト リンク間で通信するには、KCC によってサイトごとにブリッジヘッド サーバーという単一のサーバーを自動的に指定し、サイト間複製を実行します。サイト内で複製が発生すると、それ以降の複製が実行されます。サイト リンクを確立するときに、サイト間の複製を受信するブリッジヘッド サーバーを指定することができます。サイト間の複製を受信する特定のサーバーを指定することで、任意の利用可能なサーバーを使用せずに、最も有利な条件のサイト間接続を指定できます。ブリッジヘッド サーバーによって、大半の複製を、サイト間ではなく、サイト内で実行できるようになります。

**サイト リンク ブリッジ**。 2 つ以上のサイトをリンクして複製し、同じトランスポートを利用するときは、コスト面からサイト リンクのすべてを「ブリッジ」するよう既定で設定されています。この場合、サイト リンクが共通のサイトを持っていることが前提になります。ブリッジされたサイト リンクは*推移的*です。すなわち、指定されたトランスポートのサイト リンクすべてが、黙示的にそのトランスポート用の単独のサイト リンク ブリッジに属します。したがって、完全にルートされた IP ネットワークの場合 (IP によってすべてのサイトが相互通信できる場合) 、一般的に、サイト リンク ブリッジを一切構成する必要がありません。IP ネットワークが完全にルートされていない場合、IP トランスポートの推移的なサイト リンク機能をオフにすることができます (IP トランスポート オブジェクトのプロパティ シートまたは SMTP トランスポート オブジェクトのプロパティ シートの **\[全般\]** タブの **\[サイト リンクをすべてブリッジ\]** オプション)。この場合、すべての IP サイト リンクが自動的であると見なして、サイト リンク ブリッジが構成されます。サイト リンク ブリッジは、別々のネットワークに相当します。ブリッジ内のすべてのサイト リンクは推移的にルートできますが、ブリッジ外にはルートされません。

[](#mainsection)[ページのトップへ](#mainsection)
