---
TOCTitle: 'Data Encryption Toolkit for Mobile PCs : 第 2 章 : BitLocker ドライブ暗号化'
Title: 'Data Encryption Toolkit for Mobile PCs : 第 2 章 : BitLocker ドライブ暗号化'
ms:assetid: '4e6ce820-fcac-495a-9f23-73d65d846638'
ms:contentKeyID: 19869227
ms:mtpsurl: 'https://technet.microsoft.com/ja-jp/library/Cc162804(v=TechNet.10)'
---

Data Encryption Toolkit for Mobile PCs : 第 2 章 : BitLocker ドライブ暗号化
===========================================================================

### 第 2 章 : BitLocker ドライブ暗号化

公開日: 2007年8月20日

**ダウンロード**
[Data Encryption Toolkit for Mobile PCs を入手する (英語)](http://go.microsoft.com/fwlink/?linkid=81666)

Microsoft® BitLocker™ ドライブ暗号化は、Enterprise および Ultimate バージョンの Windows Vista™ オペレーティング システムに不可欠なセキュリティの新機能で、コンピュータの大量のオフライン データおよびオペレーティング システムを保護します。

BitLocker はフル ボリューム暗号化テクノロジの 1 つで、インストールされたオペレーティング システムがオフラインの間にコンピュータが改ざんされた場合でも、Windows Vista を実行しているコンピュータに格納されたデータの漏えいを防止できます。 BitLocker は互換性のあるトラステッド プラットフォーム モジュール (TPM) マイクロチップおよび BIOS を備えたシステムに対応するように設計されています。 これらのコンポーネントが存在する場合は、それらを使用してデータの保護を強化し、初期ブート コンポーネントの整合性を確保することができます。 この機能は、ボリューム全体を暗号化することでデータを盗難や不正な閲覧から保護する場合に役立ちます。

TPM は通常、コンピュータのマザーボードにインストールされ、ハードウェア バスを使用して、コンピュータの他の部分と通信します。 TPM が組み込まれたコンピュータには、TPM によってのみ暗号化を解除できるように、暗号化キーを作成して暗号化する機能があります。 このプロセス (キーを *ラップする* または *バインドする* ということが多い) は、キーの漏えいを保護するのに役立ちます。 各 TPM にストレージ ルート キー (SRK) と呼ばれるマスタ ラップ キーがあり、そのキーは TPM 自体に格納されます。 TPM で作成されるキー ペアの秘密部分が、他のコンポーネント、ソフトウェア、プロセス、またはユーザーに公開されることは一切ありません。

BitLocker には次の 2 つの主要な機能があります。

-   オペレーティング システム ボリュームの内容を暗号化することで、コンピュータごとの暗号化を行います。 ボリュームを削除する攻撃者は、キーも取得していない限り、ボリュームを読み取ることはできません。キーを取得するには、元のコンピュータ上の復元インフラストラクチャまたは TPM を攻撃する必要があります。

-   Windows Vista で使用されるファイル、ブート セクタ、使用中のファイルに以前割り当てられたスラック スペースを含め、保護されたボリュームの内容全体を暗号化することで、フル ボリューム暗号化を行います。 このため、攻撃者はキーを回復せずにディスクの任意の部分を分析して有益な情報を回復することができなくなります。

回復する必要がある正当な状態が、許可されているユーザーに発生した場合に備えて回復メカニズムが用意されています。 たとえば、必要なアップグレードがある、TPM が組み込まれたマザーボードが交換される、またはオペレーティング システム ボリュームを含むハード ディスク ドライブが別のコンピュータに移動されるなどの理由で TPM が確認プロセスに失敗した場合は、システムが回復モードになり、ユーザーは USB デバイスまたは Active Directory® ディレクトリ サービスに格納された回復キーを使用してボリュームへのアクセスを回復する必要があります。

BitLocker のどのシナリオの場合も回復プロセスは同じです。 回復キーがコンピュータと別の場所に格納されている場合 (したがってコンピュータと共に紛失することがない)、ドメイン管理者などの部内者による攻撃でない限り、回復キーに対する攻撃は非常に困難になります。

BitLocker が保護されたオペレーティング システム ボリュームへのアクセスを認証した後、保護されたボリュームとの間でデータの読み書きが行われるときに、BitLocker ファイル システムのフィルタ ドライバがフル ボリューム暗号化キー (FVEK) を使用して、ディスク セクタを透過的に暗号化および暗号化の解除を行います。 コンピュータが休止状態になると、暗号化された休止状態ファイルが保護されたボリュームに保存されます。 アクセスの認証を保留にし、この保存されたファイルはコンピュータが休止状態から再開したときに暗号化が解除されます。

BitLocker は、コンピューティング デバイスのハードウェア機能および必要なセキュリティ レベルに応じて、複数のオプションをサポートします。 オプションは次のとおりです。

-   BitLocker と TPM を併用

-   BitLocker とユニバーサル シリアル バス (USB) デバイスを併用

-   BitLocker と TPM/個人識別番号 (PIN) を併用

-   BitLocker と TPM/USB を併用

##### トピック

[](#egaa)[BitLocker オプション : BitLocker と TPM を併用](#egaa)
[](#efaa)[BitLocker オプション : BitLocker と USB デバイスを併用](#efaa)
[](#eeaa)[BitLocker オプション : BitLocker と TPM/PIN を併用](#eeaa)
[](#edaa)[BitLocker オプション : BitLocker と TPM/USB デバイスを併用](#edaa)
[](#ecaa)[BitLocker リスク分析の要約](#ecaa)
[](#ebaa)[関連情報](#ebaa)

### BitLocker オプション : BitLocker と TPM を併用

BitLocker と TPM を併用するには、TPM バージョン 1.2 ハードウェアを搭載したコンピュータが必要です。 このオプションは、起動プロセスが何らかの方法で変更されることがなく、追加のパスワードまたはハードウェアが必要ないため、ユーザーにとっては透過的です。

TPM のみの認証モードは、セキュリティ ポリシーを満たすためにベースライン レベルのデータ保護が必要な組織に、最も透過的なユーザー エクスペリエンスを提供します。 TPM のみのモードは展開、管理、および使用が最も簡単です。 また、TPM のみのモードは、無人のコンピュータまたは無人で再起動する必要があるコンピュータにより適しています。

ただし、TPM のみのモードでは最低限のデータ保護しか提供されません。 このモードでは、初期ブート コンポーネントを変更する一部の攻撃から保護されますが、保護レベルがハードウェアまたは初期ブート コンポーネントの潜在的な弱点によって左右される可能性があります。 BitLocker の多層認証モードでは、これらの攻撃の多くを軽減できます。

機密性が非常に高いと見なされるデータをモバイル コンピュータに格納している部署が組織内にある場合は、ベスト プラクティスとしてこのようなコンピュータに多層認証を使用する BitLocker を展開することを検討してください。 ユーザーに PIN の入力または USB スタートアップ キーの挿入を要求することで、機密データに対する攻撃が大幅に難易度を増します。

次の図に、このオプションにおける暗号化解除プロセスの論理的な流れを示します。

![](images/Cc162804.d118f78b-f599-4be8-a53e-f1d62b9cad8c(ja-jp,TechNet.10).gif)

**図 2.1. TPM を使用する BitLocker の暗号化解除プロセス**

図示したプロセスの各ステップは、次のようになります。

1.  BIOS が起動して、TPM を初期化します。 信頼済み/測定済みコンポーネントが TPM とやり取りを行い、コンポーネント測定値を TPM のプラットフォーム構成レジスタ (PCR) に格納します。

2.  PCR の値が予測された値と一致した場合は、TPM がストレージ ルート キー (SRK) を使用してボリューム マスタ キー (VMK) の暗号化を解除します。

3.  暗号化された FVEK がボリュームから読み取られ、暗号化が解除された VMK を使用して暗号化が解除されます。

4.  ディスク セクタは、アクセスされる際に FVEK によって暗号化が解除されます。

5.  プレーンテキスト データがアプリケーションおよびプロセスに提供されます。

VMK をセキュリティで保護すると、ディスク ボリューム上のデータを間接的に保護することになります。 ディスク ボリューム全体の暗号化の解除および再暗号化には費用がかかるため、VMK を追加することによって、信頼連鎖の上流のキーが紛失または漏えいしたときに、容易にキーを更新できるようになります。

前述のとおり、BitLocker では、マスタ ブート レコード (MBR) コード、NTFS ブート セクタ、NTFS ブート ブロック、ブート マネージャなどの重要なコンポーネントの変更を検出した場合に、ボリュームの暗号化の解除およびオペレーティング システムの読み込みを防止します。

#### 軽減されるリスク : BitLocker と TPM を併用

TPM を使用する BitLocker オプションでは、データに対する次のリスクが軽減されます。

-   **オフライン攻撃によるキーの検出**。 VMK は、TPM ハードウェア内に保持された SRK を使用して暗号化され、 その後 FVEK の暗号化に使用されます。 暗号化されたボリューム上のデータの暗号化を解除するために、攻撃者はブルート フォース攻撃をしかけて、FVEK の値を特定しなければならなくなります。

    ![](images/Cc162804.note(ja-jp,TechNet.10).gif)**注 :**

    既定では、BitLocker は Advanced Encryption Standard AES-128 アルゴリズムと 128 ビットの強度の Elephant ディフューザを使用します (BitLocker にセキュリティを追加する際のディフューザの役割の詳細については、BitLocker ドライブ暗号化に関するホワイト ペーパー「[AES-CBC + Elephant diffuser](http://www.microsoft.com/downloads/details.aspx?familyid=131dae03-39ae-48be-a8d6-8b0034c92555&displaylang=en)」(英語) を参照してください)。 オプションで、AES-256 と、256 ビット バージョンの Elephant、プレーン AES-128、またはプレーン AES-256 を使用するように BitLocker を構成できます。BitLocker の暗号化強度を選択する方法の詳細については、Windows Vista のドキュメントを参照してください。

-   **オペレーティング システムへのオフライン攻撃**。 オペレーティング システムに対するオフライン攻撃では、攻撃者は TPM から SRK を回復し、それを使用して VMK の暗号化を解除するか、FVEK に対してブルート フォース攻撃をしかける必要があるため、実質的にリスクは軽減されます。 また、ディフューザ テクノロジ (既定で有効) で構成された BitLocker では、暗号文に小さな変更を加えた場合でも広い領域の暗号化が変更されるため、焦点を正確に定めたこのような攻撃のリスクが軽減されます。

-   **休止状態ファイルからのプレーンテキスト データの漏えい**。 BitLocker の主な目的は、コンピュータがオフまたは休止状態モードになっているときに、ハード ディスク ドライブにあるオペレーティング システム ボリュームのデータを保護することです。 BitLocker が有効な場合、休止状態ファイルは暗号化されます。

-   **システム ページング ファイルからのプレーンテキスト データの漏えい**。 BitLocker が有効な場合、システム ページング ファイルは暗号化されます。

-   **ユーザー エラー**。 BitLocker はボリューム全体を暗号化するテクノロジであるため、Windows Vista オペレーティング システム ボリュームに保存されたすべてのファイルが暗号化されます。 この機能は、暗号化を適用すべきかどうか適切に判断できない状況でユーザーによるミスを防ぐのに役立ちます。

#### 残留リスクおよびその軽減 : BitLocker と TPM を併用

次のリスクは、コントロールやポリシーを追加しないと、TPM を使用する BitLocker オプションでは軽減できません。

-   **休止状態のコンピュータ**。 ラップトップ コンピュータが休止状態になったときでも、そのラップトップの状態と BitLocker 暗号化キーは変わりません。 \[スタンバイから回復するときにパスワードの入力を求める\] 設定を有効にすると、このリスクを軽減できます。

-   **スリープ (スタンバイ) モードのコンピュータ**。 休止状態の場合と同様に、ラップトップ コンピュータがスリープ モードになったときでも、そのラップトップの状態と BitLocker 暗号化キーは変わりません。 スリープ モードから再開した後も、コンピュータでは FVEK にアクセスできる状態になっています。 \[スタンバイから回復するときにパスワードの入力を求める\] 設定を有効にすると、このリスクを軽減できます。

-   **ログオンしたままのコンピュータ、ロックされていないデスクトップ**。 コンピュータが起動されて VMK が開封された後は、キーボードにアクセスできるユーザーであればだれでも暗号化されていないデータにアクセスできます。 このリスクを軽減する最も優れた方法は、コンピュータ上に機密情報を持っているユーザーを対象としたセキュリティ意識向上トレーニングです。

-   **ローカル/ドメイン パスワードの検知**。 TPM はユーザーのコンピュータに永久的に取り付けられているので、暗号化ファイルの認証またはアクセスのための第 2 の資格情報とは見なされません。 ユーザーのパスワードが侵害された場合は、暗号化ソリューションも侵害されます。 このリスクを軽減するには、適切なパスワードを作成し、パスワードを共有したり目に付きやすい場所に書き留めたりしないようにユーザーを指導します。 ネットワーク パスワード ポリシーを強化すると、汎用ツールを使用した攻撃者による、パスワードに対する辞書攻撃を効果的に防止できます。

-   **部内者による暗号化ファイルの閲覧**。 BitLocker と TPM の併用では、コンピュータ上の暗号化されたデータにアクセスするために、有効なユーザー アカウント パスワード以外の資格情報は不要です。 したがって、コンピュータにログオン可能なユーザー アカウントを使用すれば、BitLocker で暗号化されたファイルの一部またはすべてにアクセスでき、BitLocker は有効にされていないも同然です。 このリスクに対して最も有効な軽減策は、コンピュータを使用するときに追加の認証要素を必須にすること (BitLocker の別のオプションによって設定可能)、またはログインが許可されるユーザーに関する各コンピュータのポリシーを厳密に制御することです。 さらに、EFS を適切に展開すると、このリスクを大幅に軽減できます。

-   **オペレーティング システムへのオンライン攻撃**。 オペレーティング システムに対するオンライン攻撃のリスクは、このオプションでは*軽減されません*。 攻撃者がボリュームを開封して、通常どおり起動させることができる場合、オペレーティング システムは、権限の昇格攻撃、リモート コードの実行攻撃などのさまざまな攻撃を受けやすくなります。

-   **プラットフォームへの攻撃**。 基本モード (TPM のみ) の BitLocker で構成されたコンピュータは、追加の BitLocker の認証要素を必要とせずに、オペレーティング システムを起動して Microsoft Windows® ユーザー資格情報インターフェイス (Winlogon サービス) までを読み込みます。 オペレーティング システムを暗号化されたボリュームから読み込むには、コンピュータに解読キーに対するアクセス権限が必要です。 TPM を使用して検証する Trusted Computing Base (TCB) 内で動作するため、この処理は安全に実行されます。 PCI バス全体での直接メモリ アクセス (DMA) などのプラットフォームに対する攻撃が行われると、キー マテリアルが漏えいする可能性があります。

-   **コンピュータに残された認証要素**。 TPM によってセキュリティ層が追加されますが、これは追加のセキュリティ層がないと封印されたボリュームの暗号化を解除できないためです。 この機能によって、暗号化されたボリュームをあるコンピュータから別のコンピュータに移動する攻撃を防ぐことができます。 ただし、TPM をコンピュータから削除することはできないため、TPM は必然的に常に存在し、同じ強度の完全に独立した認証要素を提供することはありません。 攻撃者がユーザーのコンピュータ アカウント パスワード (TPM のみを使用する BitLocker の場合)、ユーザーの USB トークン、ユーザーの BitLocker PIN などの追加の認証情報を検出した場合、TPM は保護機能を提供しません。

[](#mainsection)[ページのトップへ](#mainsection)

### BitLocker オプション : BitLocker と USB デバイスを併用

BitLocker は、TPM バージョン 1.2 チップを搭載していないコンピュータ上でフル ボリューム暗号化をサポートします。 このオプションには TPM が提供する追加の保護機能はありませんが、基本的な暗号化ソリューションを必要とする多くの組織で、USB デバイスを使用する BitLocker オプションを強力なユーザー アカウント パスワードなどのポリシーや \[スタンバイから回復するときにパスワードの入力を求める\] 設定と組み合わせると、十分有効であることがおわかりいただけるでしょう。

このオプションでは TPM は存在しないため、VMK に対する封印/開封の操作はありません。 代わりに、USB デバイスに存在する対称キーを使用する従来のソフトウェア メカニズムを通して VMK の暗号化および暗号化の解除が行われます。 USB デバイスがコンピュータに挿入されると、BitLocker はキーを取得して、VMK の暗号化を解除します。 その後、VMK を使用して FVEK の暗号化を解除します。次の図に、この暗号化解除プロセスの流れを示します。

![](images/Cc162804.5cc88486-b6fc-4393-9159-596ad2187ec5(ja-jp,TechNet.10).gif)

**図 2.2. USB デバイスを使用する BitLocker の暗号化解除プロセス**

図示したプロセスの各ステップは、次のようになります。

1.  オペレーティング システムが起動し、USB キーを含む USB デバイスを挿入するように求められます。

2.  USB デバイスに格納されたキーを使用して VMK の暗号化を解除します。

3.  暗号化された FVEK がボリュームから読み取られ、暗号化が解除された VMK を使用して暗号化が解除されます。

4.  ディスク セクタは、アクセスされる際に FVEK によって暗号化が解除されます。

5.  プレーンテキスト データがアプリケーションおよびプロセスに提供されます。

#### 軽減されるリスク : BitLocker と USB デバイスを併用

USB デバイスを使用する BitLocker オプションでは、データに対する次のリスクが軽減されます。

-   **休止状態のコンピュータ**。 休止状態になった後、BitLocker は USB デバイスの再認証を必要とします。

-   **ローカル/ドメイン パスワードの検知**。 BitLocker と USB デバイスを併用する場合、コンピュータ上の暗号化されたデータにアクセスするためには、有効なコンピュータ アカウント パスワード以外の認証要素が必須です。

-   **部内者による暗号化ファイルの閲覧**。 前述のリスク軽減の説明と同じです。

-   **オフライン攻撃によるキーの検出**。 VMK は USB デバイスに格納されたキーを使用して暗号化されます。 USB デバイスが利用できない場合、FVEK の値を確認するために、攻撃者はブルート フォース攻撃をしかける必要があります。

-   **オペレーティング システムへのオフライン攻撃**。 VMK は USB デバイスに格納されたキーを使用して暗号化されます。 USB デバイスが利用できない場合、攻撃者はオペレーティング システム モジュールを含む何千ものセクタを正しく操作して (ブルート フォース攻撃に相当する)、FVEK の値を特定する必要があります。 また、ディフューザ テクノロジ (既定で有効) で構成された BitLocker では、暗号文に小さな変更を加えた場合でも広い領域の暗号化が変更されるため、焦点を正確に定めたこのような攻撃のリスクが軽減されます。

-   **休止状態ファイルからのプレーンテキスト データの漏えい**。 BitLocker の主な目的は、コンピュータがオフまたは休止状態モードになっているときに、ハード ディスク ドライブにあるオペレーティング システム ボリュームのデータを保護することです。 BitLocker が有効な場合、休止状態ファイルは暗号化されます。

-   **システム ページング ファイルからのプレーンテキスト データの漏えい**。 BitLocker が有効な場合、システム ページング ファイルは暗号化されます。

-   **ユーザー エラー**。 BitLocker はボリューム全体を暗号化するテクノロジであるため、Windows Vista オペレーティング システム ボリュームに保存されたすべてのファイルが暗号化されます。 この機能は、暗号化を適用すべきかどうか適切に判断できない状況でユーザーによるミスを防ぐのに役立ちます。

#### 残留リスクおよびその軽減 : BitLocker と USB デバイスを併用

次のリスクは、コントロールやポリシーを追加しないと、USB デバイスを使用する BitLocker オプションでは軽減できません。

-   **スリープ (スタンバイ) モードのコンピュータ**。 ラップトップ コンピュータがスリープ モードになったときでも、そのラップトップの状態と BitLocker 暗号化キーは変わりません。 スリープ モードから再開した後も、コンピュータでは FVEK にアクセスできる状態になっています。 \[スタンバイから回復するときにパスワードの入力を求める\] 設定を有効にすると、このリスクを軽減できます。

-   **ログオンしたままのコンピュータ、ロックされていないデスクトップ**。 コンピュータが起動されて VMK が開封された後は、キーボードにアクセスできるユーザーであればだれでも暗号化されていないデータにアクセスできます。 このリスクを軽減する最も優れた方法は、コンピュータ上に機密情報を持っているユーザーを対象としたセキュリティ意識向上トレーニングです。

-   **オペレーティング システムへのオンライン攻撃**。 オペレーティング システムに対するオンライン攻撃のリスクは、このオプションでは*軽減されません*。 攻撃者が、起動時に USB デバイスを提供して通常どおり起動させることができる場合、オペレーティング システムは、権限の昇格攻撃、リモート コードの実行攻撃などのさまざまな攻撃を受けやすくなります。

-   **プラットフォームへの攻撃**。 BitLocker および USB デバイスで構成されたコンピュータは、USB デバイスに格納されたキーを使用して、オペレーティング システムを起動して Windows ユーザー資格情報インターフェイス (Winlogon) までを読み込みます。 PCI バス全体または IEEE 1394 インターフェイス経由の DMA などのプラットフォームに対する攻撃が行われると、キー マテリアルが漏えいする可能性があります。

-   **コンピュータに残された認証要素**。 USB デバイスは 1 つの物理的な認証要素で、暗号化ソリューションはそれに依存します。 トレーニングされていないユーザーや不注意なユーザーは USB デバイスをモバイル PC と同じバッグに入れることがありますが、これはデバイスの盗難の原因になります。 ユーザーがコンピュータと USB デバイスを同時に紛失するリスクを軽減するには、個人識別番号 (PIN)、パスワードなどの第 2 の非物理的認証要素を必須にするというリスク軽減アプローチを採用します。

[](#mainsection)[ページのトップへ](#mainsection)

### BitLocker オプション : BitLocker と TPM/PIN を併用

TPM バージョン 1.2 チップと、BitLocker をサポートする BIOS を搭載したコンピュータは、BitLocker で暗号化されたデータの暗号化解除に 2 つの要素を必須にするように構成できます。 1 番目の要素は TPM で、2 番目の要素は PIN です。

![](images/Cc162804.note(ja-jp,TechNet.10).gif)**注 :**

セキュリティを重視する組織では、優先するオプションとして TPM および PIN を使用する BitLocker を使用することをお勧めします。このオプションには、紛失したり攻撃される外部トークンがないためです。

BitLocker 対応コンピュータに PIN 要求を追加すると、利便性と管理性が低下しますが、BitLocker テクノロジのセキュリティは大幅に向上します。 このオプションでは、コンピュータを使用するユーザーは 2 つのパスワードを入力するように求められます。1 つは BitLocker 用のパスワード (起動時) で、もう 1 つはログオン時のコンピュータまたはドメイン用のパスワードです。 PIN はファンクション キーで入力する数字に限定されており、ほとんどのドメイン パスワード ポリシーでは数字のみのパスワードが拒否されるため、これらの 2 つのパスワードは異なる値にする必要があります。

PIN を使用することでセキュリティが強化されますが、PIN は非常に根気強い攻撃者または動機付けが強い攻撃者から攻撃される可能性があります。 BitLocker は、ローカライズされたキーボード サポートが利用できるようになる前に PIN を処理します。したがって、ファンクション キー (F0 ～ F9) のみが使用可能となります。 この機能によって、キーのエントロピーが制限され、ブルート フォース攻撃が可能になります (特に早いというわけではありません)。 幸いなことに、TPM PIN メカニズムは辞書攻撃に対して高い抵抗力を持つように設計されています。 詳細はベンダごとに異なりますが、どのベンダも正しくない PIN が入力されてから新しい数値の入力を許可するまでに、幾何級数的に増加する待ち時間を追加しています。 この待ち時間によって、実行可能なブルート フォース攻撃のペースが落ち、攻撃が無効になります。 この入力待ち時間は *ハンマリング防止* 対策と呼ばれます。 ユーザーは、7 桁で4 つ以上の一意の値を持つ比較的強力な PIN を選択することで、PIN に対するブルート フォース攻撃の可能性を軽減できます。 強力な PIN の選択の詳細については、MSDN の「[System Integrity Team Blog](http://blogs.msdn.com/si_team/archive/2006/04/10/572888.aspx)」(英語) を参照してください。

現在のバージョンの BitLocker は、PIN のバックアップを直接サポートしていません。 ユーザーには記憶すべきパスワードが 2 つあるため、ユーザーが BitLocker の PIN を忘れた場合に使用可能な BitLocker 回復キーを作成しておくことはさらに重要です。

次の図に、TPM および PIN を使用する BitLocker オプションにおける暗号化解除プロセスの論理的な流れを示します。

![](images/Cc162804.11056951-8e9f-4482-9ac4-bc7dac6e48a6(ja-jp,TechNet.10).gif)

**図 2.3. TPM および PIN を使用する BitLocker の暗号化解除プロセス**

図示したプロセスの各ステップは、次のようになります。

1.  BIOS が起動して、TPM を初期化します。 信頼済み/測定済みコンポーネントが TPM とやり取りを行い、コンポーネント測定値を TPM のプラットフォーム構成レジスタ (PCR) に格納します。 PIN を入力するように求められます。

2.  PCR の値が予期された値と一致し、なおかつ PIN が正しい場合は、TPM が SRK を使用して VMK の暗号化を解除します。

3.  暗号化された FVEK がボリュームから読み取られ、暗号化が解除された VMK を使用して暗号化が解除されます。

4.  ディスク セクタは、アクセスされる際に FVEK によって暗号化が解除されます。

5.  プレーンテキスト データがアプリケーションおよびプロセスに提供されます。

このオプションと基本的な TPM を使用する BitLocker オプションの相違点で興味深いのは、PIN が TPM キーと組み合わされて VMK を開封することです。 開封の操作が正しく実行された後の BitLocker の動作は基本オプションの場合と同じです。

#### 軽減されるリスク : BitLocker と TPM/PIN を併用

TPM および PIN を使用する BitLocker オプションでは、データに対する次のリスクが軽減されます。

-   **休止状態のコンピュータ**。 休止状態モードからラップトップを再開するときに PIN の入力を要求されるため、TPM と PIN を使用する BitLocker ではこのリスクが軽減されます。

-   **ローカル/ドメイン パスワードの検知**。 TPM と PIN を使用する BitLocker の主な利点は、コンピュータの起動のために、または休止状態モードからの再開のために、入力する必要がある要素 (つまり、資格情報) が追加されることです。 このような利点は、ソーシャル エンジニアリング攻撃を受けやすいユーザーや、パスワード利用上の注意事項に疎いユーザー (たとえば、信頼されていないコンピュータで Windows パスワードを使用してしまうユーザーなど) に有効です。

-   **部内者による暗号化ファイルの閲覧**。 許可されているドメイン アカウントを持つユーザーはコンピュータにログオンする必要があり、それにはコンピュータを起動する必要があります。 許可されているドメイン アカウントを持つユーザーが追加の認証要素を持っていない場合は、コンピュータを起動してログオンすることはできません。 PIN を知らないユーザーは、ドメイン ポリシーによってコンピュータへのログオンが別に許可されているドメイン ユーザーであっても、ラップトップからデータにアクセスすることはできません。

-   **オフライン攻撃によるキーの検出**。 VMK は、PIN と組み合わせた TPM ハードウェア内のキーで暗号化されます。 PIN が不明である場合、FVEK の値を確認するために、攻撃者はブルート フォース攻撃をしかける必要があります。

-   **オペレーティング システムへのオフライン攻撃**。 VMK は、PIN と組み合わせた TPM ハードウェア内のキーで暗号化されます。 PIN が不明である場合、FVEK の値を確認するために、攻撃者はブルート フォース オフライン攻撃をしかける必要があります。さらに、その値を使用してボリュームの暗号化を解除し、オペレーティング システム ファイルを攻撃する必要があります。

-   **休止状態ファイルからのプレーンテキスト データの漏えい**。 BitLocker の主な目的は、コンピュータがオフまたは休止状態モードになっているときに、ハード ディスクにあるオペレーティング システム ボリュームのデータを保護することです。 BitLocker が有効な場合、休止状態ファイルは暗号化されます。

-   **システム ページング ファイルからのプレーンテキスト データの漏えい**。 BitLocker が有効な場合、システム ページング ファイルは暗号化されます。

-   **コンピュータに残された認証要素**。 PIN は、メモなどに書き込んでおかない限りコンピュータで侵害されることがない第 2 の非物理的認証要素です。

-   **ユーザー エラー**。 BitLocker はボリューム全体を暗号化するテクノロジであるため、Windows Vista オペレーティング システム ボリュームに保存されたすべてのファイルが暗号化されます。 この機能は、暗号化を適用すべきかどうか適切に判断できない状況でユーザーによるミスを防ぐのに役立ちます。

#### 残留リスクおよびその軽減 : BitLocker と TPM/PIN を併用

次のリスクは、コントロールやポリシーを追加しないと、TPM や PIN を使用する BitLocker オプションでは軽減できません。

-   **スリープ (スタンバイ) モードのコンピュータ**。 ラップトップ コンピュータがスリープ モードになったときでも、そのラップトップの状態と BitLocker 暗号化キーは変わりません。 スリープ モードから再開した後も、コンピュータでは FVEK にアクセスできる状態になっています。 \[スタンバイから回復するときにパスワードの入力を求める\] 設定を有効にすると、このリスクを軽減できます。

-   **ログオンしたままのコンピュータ、ロックされていないデスクトップ**。 コンピュータが起動されて VMK が開封された後は、キーボードにアクセスできるユーザーであればだれでも暗号化されていないデータにアクセスできます。 このリスクを軽減する最も優れた方法は、コンピュータ上に機密情報を持っているユーザーを対象としたセキュリティ意識向上トレーニングです。

-   **オペレーティング システムへのオンライン攻撃**。 オペレーティング システムに対するオンライン攻撃のリスクは、このオプションでは*軽減されません*。

-   **プラットフォームへの攻撃**。 BitLocker、TPM、およびユーザー PIN で構成されたコンピュータは、ユーザー PIN が入力された後、オペレーティング システムを起動して Windows ユーザー資格情報インターフェイス (Winlogon) までを読み込みます。 ユーザーが PIN を入力するまで、プラットフォーム攻撃によってキー マテリアルが回復されることはありません。 PIN の入力後は、このような攻撃によってキー マテリアルが漏えいする可能性があります。

[](#mainsection)[ページのトップへ](#mainsection)

### BitLocker オプション : BitLocker と TPM/USB デバイスを併用

前のオプションでは、BitLocker は、TPM との認証の第 2 の要素として PIN を使用するように構成されていました。 PIN に代わるものとして、USB デバイスを使用することもできます。 このオプションでは、ユーザーは、起動時または休止状態モードから再開するときに、USB デバイスを挿入するように求められます。

次の図に、TPM および USB を使用する BitLocker オプションにおける暗号化解除プロセスの論理的な流れを示します。

![](images/Cc162804.da7b15a1-1d74-4a40-86b4-adb3720183c5(ja-jp,TechNet.10).gif)

**図 2.4. TPM および USB デバイスを使用する BitLocker の暗号化解除プロセス**

図示したプロセスの各ステップは、次のようになります。

1.  BIOS が起動して、TPM を初期化します。 信頼済み/測定済みコンポーネントが TPM とやり取りを行い、コンポーネント測定値を TPM のプラットフォーム構成レジスタ (PCR) に格納します。

2.  BitLocker キーを含む USB デバイスを挿入するように求められます。

3.  PCR の値が予期された値と一致した場合は、TPM が SRK を使用して中間キーの暗号化を解除します。 この中間キーが USB デバイスに格納されたキーと組み合わされて、VMK の暗号化を解除するために使用される別の中間キーが生成されます。

4.  暗号化された FVEK がボリュームから読み取られ、暗号化が解除された VMK を使用して暗号化が解除されます。

5.  ディスク セクタは、アクセスされる際に FVEK によって暗号化が解除されます。

6.  プレーンテキスト データがアプリケーションおよびプロセスに提供されます。

このオプションは、基本的な TPM を使用する BitLocker オプションまたは TPM および PIN を使用する BitLocker オプションとは異なります。このオプションでは、USB に格納されたキー マテリアルが TPM キーと組み合わされて VMK の暗号化を解除するためです。 開封の操作が正しく実行された後の BitLocker の動作は基本オプションの場合と同じです。

#### 軽減されるリスク : BitLocker と TPM/USB デバイスを併用

TPM および USB デバイスを使用する BitLocker オプションでは、データに対する次のリスクが軽減されます。

-   **休止状態のコンピュータ**。 休止状態になった後、BitLocker は USB デバイスの再認証を必要とします。

-   **ローカル/ドメイン パスワードの検知**。 前のオプションと同様、TPM と USB を使用する BitLocker オプションの主な利点は、コンピュータの起動のために、または休止状態モードからの再開のために、入力する必要がある要素 (つまり、資格情報) が追加されることです。

-   **部内者による暗号化ファイルの閲覧**。 このオプションは認証要素を追加するため、有効なアカウントを持つ許可されていないユーザーがコンピュータを起動したり、ログオンしたり、暗号化されたデータを読み取ったりするリスクが軽減されます。

-   **オフライン攻撃によるキーの検出**。 USB デバイスが存在しない場合、FVEK の値を確認するために、攻撃者は USB デバイスに保持されたキーに対してブルート フォース攻撃をしかける必要があります。

-   **オペレーティング システムへのオフライン攻撃**。 USB デバイスが存在しない場合、オペレーティング システムへの攻撃を成功させるために、攻撃者は USB デバイスに保持されたキーに対してブルート フォース攻撃をしかける必要があります。

-   **休止状態ファイルからのプレーンテキスト データの漏えい**。 BitLocker の主な目的は、コンピュータがオフまたは休止状態モードになっているときに、ハード ディスクにあるオペレーティング システム ボリュームのデータを保護することです。 BitLocker が有効な場合、休止状態ファイルは暗号化されます。

-   **システム ページング ファイルからのプレーンテキスト データの漏えい**。 Windows Vista の場合、一時的な対称キーを使用してページ ファイルが暗号化されます。この一時的なキーは、起動時に生成されますが、ディスクに書き込まれることはありません。 システムのシャットダウン後に、このキーは破棄されます。したがって、ページ ファイルからデータを回復するには、ブルートフォース攻撃をしかけ、ページ ファイルの暗号化に使用された対称キーを見つける必要があります。

-   **ユーザー エラー**。 BitLocker はボリューム全体を暗号化するテクノロジであるため、Windows Vista オペレーティング システム ボリュームに保存されたすべてのファイルが暗号化されます。 この機能は、暗号化を適用すべきかどうか適切に判断できない状況でユーザーによるミスを防ぐのに役立ちます。

#### 残留リスクおよびその軽減 : BitLocker と TPM/USB デバイスを併用

次のリスクは、コントロールやポリシーを追加しないと、TPM や USB デバイスを使用する BitLocker オプションでは軽減できません。

-   **スリープ (スタンバイ) モードのコンピュータ**。 ラップトップ コンピュータがスリープ モードになったときでも、そのラップトップの状態と BitLocker 暗号化キーは変わりません。 スリープ モードから再開した後も、コンピュータでは FVEK にアクセスできる状態になっています。 \[スタンバイから回復するときにパスワードの入力を求める\] 設定を有効にすると、このリスクを軽減できます。

-   **ログオンしたままのコンピュータ、ロックされていないデスクトップ**。 コンピュータが起動されて VMK の暗号化が解除された後は、キーボードにアクセスできるユーザーであればだれでも暗号化されていないデータにアクセスできます。 このリスクを軽減する最も優れた方法は、コンピュータ上に機密情報を持っているユーザーを対象としたセキュリティ意識向上トレーニングです。

-   **オペレーティング システムへのオンライン攻撃**。 攻撃者が、起動プロセスの一環として USB デバイスを提供して通常どおり起動させることができる場合、権限の昇格攻撃、リモートからの悪用などのさまざまな攻撃をしかけることができます。

-   **プラットフォームへの攻撃**。 BitLocker、TPM、および USB デバイスで構成されたコンピュータは、オペレーティング システムを起動して Windows ユーザー資格情報インターフェイス (Winlogon) までを読み込みます。 プラットフォーム攻撃によってキー マテリアルが漏えいする可能性があります。

-   **コンピュータに残された認証要素**。 USB デバイスは 1 つの物理的な認証要素で、暗号化ソリューションはそれに依存します。 ユーザーがコンピュータと USB デバイスを同時に紛失するリスクを軽減するには、PIN やパスワードなどの第 2 の非物理的認証要素を必須にします。

[](#mainsection)[ページのトップへ](#mainsection)

### BitLocker リスク分析の要約

次の表は、各データ リスクの軽減について、どの BitLocker オプションが有効かを示しています。 該当のオプションで軽減されるリスクには **Y** という文字、軽減されないリスクにはハイフン **–** が記載されています。

**表 2.1 BitLocker のリスク軽減**

![](images/Cc162804.fd057821-a2d0-48df-a0b1-5b07eaa7c90a(ja-jp,TechNet.10).gif)
[](#mainsection)[ページのトップへ](#mainsection)

### 関連情報

-   [System Integrity Team Blog (英語)](http://blogs.msdn.com/si_team/archive/2006/04/10/572888.aspx)

-   BitLocker ドライブ暗号化に関するホワイト ペーパー「[AES-CBC + Elephant diffuser](http://www.microsoft.com/downloads/details.aspx?familyid=131dae03-39ae-48be-a8d6-8b0034c92555&displaylang=en)」(英語)

[](#mainsection)[ページのトップへ](#mainsection)

##### 目次

-   [概要](https://technet.microsoft.com/ja-jp/library/abfc4696-a39a-43df-b559-133633e4bd5e(v=TechNet.10))
-   [第 1 章 : リスクの検討](https://technet.microsoft.com/ja-jp/library/df2c6d71-98f7-4212-b3b7-b9eb2f501348(v=TechNet.10))
-   第 2 章 : BitLocker ドライブ暗号化
-   [第 3 章 : 暗号化ファイル システム](https://technet.microsoft.com/ja-jp/library/dc2cde72-a84d-4716-9a30-f62b608efda1(v=TechNet.10))
-   [第 4 章 : BitLocker と EFS の併用](https://technet.microsoft.com/ja-jp/library/80c0d0af-2c2e-45d6-9b29-f850926296bb(v=TechNet.10))
-   [第 5 章 : 適切なソリューションを選択する](https://technet.microsoft.com/ja-jp/library/b77d6369-10e9-4e66-8c67-c9f8cb073ced(v=TechNet.10))

[](#mainsection)[ページのトップへ](#mainsection)
