---
TOCTitle: Exchange 2000 Server の公開
Title: Exchange 2000 Server の公開
ms:assetid: 'c3ed9e14-fb54-4424-a017-07f7ee6d9d3b'
ms:contentKeyID: 19869279
ms:mtpsurl: 'https://technet.microsoft.com/ja-jp/library/Cc750289(v=TechNet.10)'
---

Exchange 2000 Server の公開
===========================

最終更新日: 2003年7月4日

**Microsoft ISA Server 2000 Feature Pack 1 バージョン 1**

このマニュアルでは、インターネットからアクセスする必要がある特定のユーザーに、従来の方法で Microsoft Exchange 2000 Server のサービスを提供する場合について、簡単に説明します。ここでは、インターネット接続を可能にするための Exchange 2000 Server の構成方法、および Microsoft Internet Security and Acceleration (ISA) Server 2000 を使って、内部の Exchange サービスをインターネットクライアントが安全で効率的に利用できるようにするための方法の実現、という戦略における固有の問題について説明します。

##### トピック

[](#eeaa)[必要性の定義](#eeaa)

[](#edaa)[従来の方法での Exchange に対するセキュリティで保護されたアクセス](#edaa)

[](#ecaa)[Exchange Server の構成](#ecaa)

[](#ebaa)[インフラストラクチャ要件](#ebaa)

[](#eaaa)[ISA Server の構成](#eaaa)

### 必要性の定義

情報のトランスポートやアクセスの手段としてのインターネットの利用が高まるにつれ、従業員にインターネットを通じて内部サービスを提供する必要が企業に生じてきました。販売担当者がオフィスの外から企業の情報にアクセスする必要があるだけでなく、他の職種でも、仕事を自宅に持ち帰り、夜間に作業する従業員の数が非常に多くなっています。また、在宅勤務者の数も増えています。

電子メールは、このような従業員が最も強くアクセスを望むリソースです。

企業はメールサービスの共有が必要な複数の場所を接続する手段として、インターネットも利用しています。経済的な高速インターネットアクセスが実現したことにより、インターネットを通じて企業データに接続する方法が広く普及してきました。企業データに安全にアクセスできるように、多くの企業では VPN 接続を作成して、クライアントがインターネットを通じてセキュリティで保護されたトンネルを利用できるようにしています。しかし、ユーザーが単に自宅のコンピュータ、クライアントサイト、Web キオスクなどから電子メールにアクセスすることだけが必要な場合は、VPN 接続が実用的でないときもあります。以下のセクションでは、通常どおりの方法でインターネットを通じて Exchange にアクセスする方法について説明します。

[](#mainsection)[ページのトップへ](#mainsection)

### 従来の方法での Exchange に対するセキュリティで保護されたアクセス

Microsoft Exchange 2000 Server にはクライアントへのアクセスを可能にする 2 つの機能があります。Microsoft Outlook クライアントはインターネットを使用して接続を行い、その接続では以下の 3 つの基本的なシナリオを実行します。

-   RPC を使用して接続する Microsoft Outlook または他の MAPI クライアントを使用します。

-   
-   IMAP4 または POP3 アカウントを使用する Microsoft Outlook、Outlook Express、または他のメールクライアントを使用します。

-   
-   HTTP を使用して接続する、Microsoft Outlook Web Access (OWA) を使用します。

-   

これらの各シナリオの実行方法を、それぞれの利点、欠点と共に以下で説明します。

内部ネットワークでは、ほとんどのクライアントは Outlook を使用して Exchange Server に接続します。インターネットでは、ほとんどの企業は Outlook Web Access (OWA) を使用します。これは Web を使用した電子メールへのアクセス方法です。在宅従業員の多くは、Outlook Express などの POP3 または IMAP4 クライアントによってメールにアクセスします。しかし、Outlook クライアントのフル機能を使用したアクセスを必要とする、または要求するクライアントの数が増加しています。

**Outlook などの MAPI クライアントのフル機能**

Exchange クライアント、Outlook、Outlook Express は、Messaging Application Programming Interface (MAPI) を使用して Exchange 2000 Server ストアと通信できます。MAPI クライアントと接続すると、予定表作成情報へのアクセス、電子メールメッセージとしての Word や Excel のドキュメントのカプセル化などの機能を利用できます。ほとんどのクライアントは就業中だけでなく、自宅にいるときや旅行中でも Outlook クライアントを使用することを希望します。しかし、MAPI 要求はリモートプロシージャコール (RPC) として Exchange Server に送信されるため、インターネットで RPC を使用して接続することは、オーバーヘッド費用とセキュリティ上の問題が発生するために好ましくないと考えられています。

**オーバーヘッド**

RPC には多くの帯域幅が必要です。ダイヤルアップネットワークによる接続が標準的なときは、帯域幅のコストは時間的にも金銭的にも高価でした。オーバーヘッドを減らすために、予定表作成などの、RPC の機能の一部の利用をあきらめざるを得ませんでした。ブロードバンドプロバイダによって経済的で高速なインターネット接続が可能になると、待ち時間が問題にならなくなり、RPC の方が望ましい接続方法になりました。

**セキュリティ**

従来、Exchange の RPC 接続は安全とは考えられていません。これは、サービスがこの方法で動的ポートに割り当てられる方法によるものです。既定では、どのポートが Exchange サービスに関連付けられるか予測する方法はありません。サービスはある範囲内にロックできますが、追加の構成と管理のオーバーヘッドが必要になります。既定では、サーバー上の Exchange の汎用一意識別子 (UUID) は、すべての Exchange クライアントが認識する RPC エンドポイントマッパーによって登録されます。Active Directory のレプリケーションなどの他のサービスにも、登録済みの UUID があります。各 UUID によって、分散環境内でクライアントとサーバーの両方がアプリケーションを認識できるようになり、これにより、互換性と相互運用性が実現します。MAPI クライアントは RPC を使って Exchange Server に接続するとき、最初にポート 135/tcp を使って接続します。MAPI クライアントはこのポートを通じて RPC エンドポイントマッパーに接続します。エンドポイントマッパーは、Exchange の UUID が提示されると、クライアントに Exchange サービスの登録先の通信ポートを提供します。このポートの範囲は 1024 から 65535 です。この動的ポート割り当てでは、ファイアウォールで 1024 から 655535 の範囲のすべての送信接続が許可されることが必要になります。これにより、セキュリティで保護されたファイアウォールがセキュリティで保護されていない状態に変化します。管理者は、あまり多くのポートを開いた状態にすることに懸念を持つはずです。

後で説明するように、ISA Server 2000 は、MAPI クライアント用の Exchange を安全に公開する方法を提供します。

**RPC の利点と欠点**

RPC を公開すると、Outlook 2000 および Outlook 2002 クライアントのフル機能でのアクセスが可能になります。これにより、VPN 接続のオーバーヘッドを管理せずに、メールサービスに安全にアクセスできます。

しかし、RPC 接続に必要な動的なハイレベルポートへのアクセスをブロックする別のファイアウォールでクライアントが保護されている場合、RPC に関する問題が発生する可能性があります。

RPC を公開しても、MAPI クライアントを使っていないクライアントへのアクセスは可能になりません。ブラウザまたは Outlook Express から接続するユーザーは、予定表作成やメールによる通知などの Outlook の機能は利用できません。

**POP3 または IMAP4 クライアントを使ったメール専用アクセス**

多くのクライアントは電子メールにアクセスしなければなりませんが、MAPI クライアントの機能をすべて必要としているわけではありません。POP3 (Post Office Protocol 3) および Internet Message Access Protocol 4 (IMAP4) と接続することは、電子メールメッセージを受け取るための高速かつ信頼性の高い方法です。POP3 は業界標準です。クライアントは Exchange Server から電子メールメッセージをダウンロードして、サーバーとの接続が切断されたときでもそれらのメッセージを表示できるようにします。IMAP4 はサーバー上にあるメールへのアクセスを可能にし、高速アクセスを可能にするためにメッセージのヘッダーだけをダウンロードできるようにします。しかし、この機能ではより安定した Exchange Server との接続が必要です。Outlook Express では、現在市場に出回っている他の多くのメールリーダーと同様に、POP3 と IMAP4 の両方を使用します。Web ベースの電子メールポータルからは、POP3 と IMAP4 のメッセージストアに接続でき、いくつかのアカウントの電子メールメッセージを統合できます。ISA Server 2000 には \[ISA メールサーバーを安全に公開するためのウィザード\] が含まれています。このウィザードを使用するとメール公開のプロトコルを簡単に構成できます。

**POP3 または IMAP4 によるアクセスの利点と欠点**

ほとんどのクライアントは POP3 または IMAP4 をサポートし、これらの方法を使用した電子メールメッセージへのアクセスを可能にしています。しかし、電子メールへのアクセスが唯一の機能です。予定表作成、タスク一覧、またはパブリックフォルダは利用できません。

**OWA を使用する Web ベースのアクセス**

ブラウザがインターネットに接続されているインターネットカフェや公共のインターネットキオスクが、多くの場所で利用できるようになっています。このような設定では、電子メールや Exchange のパブリックインフォメーションストアに、Exchange Outlook Web Access (OWA) と呼ばれる Web ページを使用してアクセスできます。このシナリオでは、ユーザーはほとんどのブラウザから電子メールをチェックできますが、すべての機能を利用するには Internet Explorer 5.0 以降が必要です。OWA は Exchange 2000 Server では既定でセットアップされており、標準の HTTP ポート 80 や、ネットワークをセキュリティで保護する SSL アクセス用のポート 443 (推奨されるポート) 以外のポートを開く必要はありません。

OWA は使用しやすくできていますが、MAPI クライアントと同等の機能を備えているわけではありません。メールルール、履歴項目、スペルチェックは利用できません。予定表作成、タスク一覧、ミーティング項目の操作は可能ですが、Outlook で提供されている機能はありません。

**OWA の利点と欠点**

OWA を使用すると、インターネットに接続されたほぼすべてのブラウザから電子メールにアクセスできます。これは、どのインターネットカフェ、会議キオスク、または Web 対応電話からでも自社の電子メール、予定表、およびタスクにアクセスできる、ということです。

欠点は機能が限定されていることです。電子メールへのオフラインアクセスはサポートされておらず、予定表のサポートも限定されています。次の表は、Outlook Web Access 2000 の利点と欠点をいくつか示したものです。この表は、OWA が Exchange 2000 SP2 以降で実行され、Internet Explorer 5 以降からアクセスされていることを前提としています。

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >利点</th>
<th style="border:1px solid black;" >欠点</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">連絡先アイテムや予定表アイテムを含む、メールボックスとパブリックフォルダへのアクセス</td>
<td style="border:1px solid black;">機能拡張セキュリティ (S/MIME) が使用できない</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">新規のメール通知と予定表のアラーム</td>
<td style="border:1px solid black;">オフラインモードが使用できない</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">HTML 電子メールメッセージのリッチテキスト編集</td>
<td style="border:1px solid black;">新規のパブリックフォルダを作成できない</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">表示と記録に関するマルチメディア制御</td>
<td style="border:1px solid black;">Outlook ルールと取り消しメッセージを使用できない。また、削除した項目を回復できない</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">URL によるメールアクセス</td>
<td style="border:1px solid black;">ジャーナル、メモ、タスクがない</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">メールボックスフォルダ間でのドラッグアンドドロップ機能</td>
<td style="border:1px solid black;">Exchange 2000 Server メールボックスアクセスしかない</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">フロントエンドとバックエンドのサーバー構成のサポート</td>
<td style="border:1px solid black;">他のユーザーのメールボックスフォルダを開けない</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">不在およびプレビューウィンドウ</td>
<td style="border:1px solid black;">初期ダイヤルアップの速度が遅い</td>
</tr>
</tbody>
</table>
  
OWA のセットアップは、ISA Server 2000 Feature Pack 1 に含まれる \[OWA の公開ウィザード\] を使用すると簡単にできます。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
### Exchange Server の構成
  
Microsoft Exchange 2000 Server は、個人ユーザーと企業ユーザーのメッセージングおよびコラボレーションの要望に応えます。Exchange 2000 Server で実現する機能は数多くあります。たとえば、クライアント構成を簡単にする、サポートされた汎用プロトコルの各種コレクション、無制限のデータストア、機能拡張版の Outlook Web Access、複数の仮想サーバー機能、および Active Directory の統合などです。Exchange 2000 Server を理解することにより、ISA Server の構成を決定する前に、外部ユーザーによるメールへのアクセスを可能にできます。ここでは、Exchange 2000 Server の最適な構成方法、SMTP および HTTP 仮想サーバーなどの主要コンポーネントの最も効果的な利用方法、現在のメッセージングプラットフォームで最も安全性の高いセキュリティを実現するための、Exchange 2000 Server の配置場所について説明します。
  
ここで説明するシナリオを構成する手順については、Feature Pack に含まれるこのシナリオのマニュアルを参照してください。
  
**最適な構成の定義**
  
この説明の最も重要な目的は、Exchange 2000 Server の基本的な構成方法を理解することです。ここに示す情報は、提供されるシナリオに従って作業するときに発生する問題や矛盾を回避するための基礎になります。各ネットワークはそれぞれ固有のものですが、Windows ベースのサーバーと Exchange Server の構成は固有である必要はありません。
  
各 Microsoft コアオペレーティングシステムとサーバー製品用に Service Pack がリリースされています。通常、Service Pack とは、その Service Pack がリリースされる日までに公になったすべての修正プログラムとセキュリティ修正プログラムを集めたものです。根本的な変更がなされ、Service Pack には新しい機能が含まれなくなりました。この変更は Exchange 2000 Server Service Pack 2 と Service Pack 3 を比較するとはっきりわかります。Exchange 2000 Server Service Pack 2 には、Outlook Web Access に代表されるようにさまざまな機能変更が付属していますが、Exchange Service Pack 3 には追加機能はまったくありません。
  
指定したシナリオの中で次の前提条件が満たされた場合、ISA Server で Exchange を公開するときの成功率が高くなります。
  
-   Service Pack 2 以降が適用されている Windows 2000 がインストールされていること。Service Pack 3 が推奨です。
  
-     
-   サーバーが、最新の修正プログラムとセキュリティ修正プログラムが適用済みの最新のものであること。Windows 2000 および Exchange 2000 Server の両方に Service Pack 3 がインストールされており、追加の修正プログラムやセキュリティアップデートが不要な状態であること。更新済みの修正プログラムについては、http://www.microsoft.com/japan/security/ を参照してください。
  
-     
-   Service Pack 2 以降が適用されている Windows 2000 Server がインストールされていること。Service Pack 3 が推奨です。
  
-   
  
**Exchange のセキュリティに関する考慮事項**
  
Exchange 2000 Server を構成するときは、サーバーのセキュリティが重要です。Exchange 2000 Server の最も一般的なセキュリティ上の問題は、SMTP 中継です。SMTP 中継とは、メールサーバーが Exchange 2000 Server のメールクライアントに、外部組織のユーザーへのメール送信を許可するという意味です。状況によっては中継が必要な場合もありますが、ほとんどの企業ではこの構成を採用していません。これは、メールサーバーが開いた状態になるため、不要な電子メールメッセージが中継される可能性があり、それによって、表面上、そのメールサーバーがメッセージを送信したという形になってしまうためです。SMTP 中継は慎重に制御、監視して、サーバーが不要な電子メールメッセージを許可しないようにしなければなりません。SMTP 中継の詳細については、Microsoft Exchange Server の Web サイト (<http://www.microsoft.com/japan/exchange/>) を参照してください。
  
既定の設定は Exchange Server 5.5 と Exchange 2000 Server では異なります。この概要では、Exchange 2000 Server の SMTP 中継の既定構成について考えていきます。Exchange Server 5.5 の場合の SMTP 中継に関する情報については、Microsoft TechNet の Web サイト (<http://www.microsoft.com/japan/technet/>) を参照してください。
  
既定では、Exchange Server は自動的に構成され、認証されたユーザーだけが Exchange Server を経由してメールを中継できます。
  
認証されたユーザーだけが Exchange Server を通じてメールを中継できるため、内部ユーザーだけが外部のユーザーにメッセージを送信できます。組織の外部にいるユーザーは内部ユーザーに電子メールメッセージを送信できますが、組織の異なるユーザーには送信できません。
  
SMTP 中継を処理するための Exchange Server の構成がわからない場合は、その構成を確認してください。サーバーがしばらくの間オープン中継として構成されていたことがわかった場合、そのサーバーはネットワーク不正使用データベースに追加された可能性があります。このような種類のデータベースにメールドメインが追加されたかどうかを確認するには、<http://www.abuse.net> (英語情報) を参照してください。追加情報については、Microsoft サポート技術情報 [249266](http://support.microsoft.com/kb/249266) 「XFOR: Online Resources for Spam Mail Testing and Information」 (英語情報) を参照してください。
  
メッセージングインフラストラクチャの整合性を確実に保護するには、次のような一般的な手順に従ってください。
  
-   適切な時期に修正プログラムをインストールします。
  
-     
-   ホワイトペーパーの情報、チェックリスト、および IISLockdown や URLScan などのツールを使って、サーバーを堅牢にします。
  
-     
-   使用していないプロトコルやサービスを無効にします。たとえば、Exchange を SMTP でしか使用していない場合は、POP3、IMAP4、および HTTP プロトコルを無効にします。
  
-     
-   Exchange システムポリシーおよびメッセージの追跡を使って、ログ動作の設定を維持します。
  
-     
-   常に最新のウイルス通知を受け取って、最新のウイルス定義をダウンロードし、ネットワーク上でのウイルスの侵入を防ぎます。
  
-     
-   すべてのエントリポイントのセキュリティを確保することによって、ネットワークを保護します。
  
-     
-   ネットワーク上では強力で複雑なパスワードを使用します。
  
-   
  
**Exchange の内部**
  
Exchange サービスを公開したときに使用できるプロトコルは SMTP、HTTP (OWA) および RPC です。Exchange 2000 Server 上でのこれらのプロトコルの構成で、ユーザーに認められるアクセスの種類とオプションが定義されます。Exchange 2000 Server は、SMTP、HTTP、IMAP4、POP3 および NNTP といった仮想サーバーをサポートします。1 つのサーバーが使用できるプロトコルのインスタンスが 1 つだけだった前のバージョンの Exchange とは異なり、仮想サーバーの導入によって、管理者は 1 つの Exchange Server 上の 1 つのプロトコルに対し、複数の仮想サーバーを定義できるようになりました。仮想サーバーでは、プロトコルとポートを組み合わせて利用することによりこれが実現しました。たとえば、SMTP サーバーは既定によって SMTP とポート 25 のトラフィックをリッスンします。
  
**SMTP 仮想サーバー**
  
SMTP 仮想サーバーは組織からのメールの流れる方向を定義します。管理者が認証、中継およびアクセス制御などのオプションを構成できるためです。SMTP (簡易メール転送プロトコル) はメールサーバー間でのインターネットメールの転送用の標準となったネイティブプロトコルです。SMTP 仮想サーバーは、Exchange 2000 Server のインストールに伴い、既定でインストールされ、プロパティ設定を変更しなくてもメールを送信できる状態に設定されています。
  
SMTP 仮想サーバーの構成可能情報には 4 つのタブがあります。最も慎重に考慮する必要がある設定、および ISA Server コンピュータの背後で Exchange Server を公開することについて最大の危険を伴う設定に重点を置いてください。以下の表は、Exchange 2000 Server の SMTP 仮想サーバーを構成するときに再確認すべき主なプロパティ設定を定義しています。

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >プロパティ</th>
<th style="border:1px solid black;" >場所</th>
<th style="border:1px solid black;" >説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">発信セキュリティ</td>
<td style="border:1px solid black;">[配信] タブ | [送信セキュリティ]</td>
<td style="border:1px solid black;">SMTP 仮想サーバーが他の SMTP サーバーにメールを配信する方法を定義します。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">スマートホスト</td>
<td style="border:1px solid black;">[配信] タブ | [詳細設定]</td>
<td style="border:1px solid black;">SMTP サーバーは DNS を使って外部メールドメインを解決できなければなりません。
この解決は、SMTP サーバーが以下の場所にクエリを送信するように構成できます。
<ol>
<li>TCP/IP プロパティの優先 DNS サーバー設定に基づく、内部 DNS サーバー。</li>
<li></li>
<li>[詳細設定] タブで構成された外部 DNS サーバー。</li>
<li></li>
<li>外部 SMTP サーバーで、通常は、メールドメインの解決を行う ISP の SMTP サーバーであるスマートホスト。</li>
<li></li>
</ol></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">中継の制限</td>
<td style="border:1px solid black;">[アクセス] タブ | [中継]</td>
<td style="border:1px solid black;">SMTP 仮想サーバーを通じてメッセージを中継することを許可するコンピュータを定義します。ドメイン、個々の IP アドレス、またはサブネットによって指定できます。</td>
</tr>
</tbody>
</table>
  
不正アクセスを防止するには、SMTP 仮想サーバーのプロパティを理解し、メールサーバーがメッセージを中継する方法を決定し、すべての適切な認証レベルが構成されていることを確認します。
  
**HTTP 仮想サーバー**
  
Outlook Web Access では HTTP 仮想サーバーが使用されます。HTTP (ハイパーテキスト転送プロトコル) は、HTML ドキュメントの送受信用にインターネットで使用されるクライアント/サーバープロトコルです。HTTP はポート 80 で動作します。ほとんどのユーザーはこのポートを通じてインターネットに接続します。
  
HTTP 仮想サーバーは Exchange 2000 Server のインストール時に自動的に構成され、これにより、Outlook Web Access が利用できるようになります。
  
HTTP 仮想サーバーの構成は Exchange システムマネージャの中からは実行できません。あえて実行しようとすると、次のメッセージが表示されます。
  
この仮想サーバーの設定を管理するには、IIS 管理ツールを使用してください
  
HTTP 仮想サーバーは、インストールされている仮想ディレクトリと、インターネットサービスマネージャのコンソールにある既定の Web サイトを組み合わせたものです。
  
Outlook Web Access を構成する仮想ディレクトリは、以下のとおりです。
  
-   /Exchange - メールボックスへの Web ブラウザのアクセスを可能にします。
  
-     
-   /Exchweb - 実際の Exchange アプリケーションの開発者コードへのアクセスを可能にします。
  
-     
-   /Public - パブリックフォルダへの Web ブラウザのアクセスを可能にします。
  
-   
  
多くの構成オプションを含む SMTP 仮想サーバーとは異なり、HTTP 仮想サーバーのプロパティ設定は変更しないことをお勧めします。HTTP 仮想サーバーのプロパティを編集する必要はありません。OWA のアクセスをセキュリティで保護する場合のより効率的な方法は、フロントエンド/バックエンドモデルを利用し、インターネットクライアントと OWA フロントエンドサーバー間の通信に SSL を使用することです。また、HTTP 仮想サーバーは IIS の仮想ディレクトリの組み合わせであるため、IIS Lockdown ツールをインストールして、IIS をさらに堅牢にしてください。
  
Outlook Web Access へのクライアントアクセスは既定で有効になっています。社外にいるときに OWA への接続を制限するには、メールボックスレベルでの HTTP プロトコルの使用を無効にします。
  
**この既定の設定を変更するには**
  
1.  \[Active Directory ユーザーとコンピュータ\] を開き、OWA へのアクセスを許可しないユーザーのユーザーアカウントを見つけ、そのアカウントを右クリックして、\[プロパティ\] をクリックします。
  
2.  3.  \[Exchange の詳細設定\] タブ、\[プロトコル設定\] の順にクリックします。
  
    **注意** \[Exchange の詳細設定\] タブは、\[Active Directory のユーザーとコンピュータ\] の \[表示\] メニューで \[拡張機能\] を選択した場合にだけ表示されます。
  
4.  5.  \[HTTP\]、\[設定\] の順にクリックします。
  
6.  7.  既定では、\[メールボックスを有効にする\] チェックボックスがオンになっています。このオプションをオフにして 1 人のユーザーに対して
  
    OWA を無効にし、\[OK\] をクリックします。
  
8.  
  
**フロントエンド (アクセス) とバックエンド (記憶域) の Exchange ソリューション**
  
Exchange 2000 Server Enterprise Edition を使用して、企業は、Exchange への接続時に参照する 1 つのアクセスポイントと名前空間をユーザーに提供する、という主要目的を達成するために、フロントエンド/バックエンドソリューションを確立できます。このソリューションは、インターネットを通じてユーザーがメールに接続できるようにするときに便利です。
  
フロントエンドサーバーは、メールボックスを含まない Exchange 2000 Server です。主要な目的はクライアント要求を適切なバックエンドサーバーにプロキシすることです。フロントエンドサーバーはクライアントの要求をプロキシし、ユーザーデータは含まないため、このサーバーをネットワーク上の複数の場所に配置することができます。フロントエンドサーバーは ISA Server ファイアウォールの前または後ろに配置でき、境界領域のネットワーク ("非武装地帯"、"DMZ" および "スクリーンサブネット" とも呼ばれる) 内に配置することもできます。この場合、2 つの ISA Server ファイアウォールの間に配置します。
  
**注意** 提供されるシナリオでは、バックツーバック ISA 環境でのフロントエンド/バックエンドソリューションの構成に重点を置いています。
  
バックエンド Exchange Server には、一般的な Exchange Server と同じメールボックスストアとパブリックフォルダストアが含まれています。フロントエンド/バックエンドソリューションを実装することにより、管理者はバックエンドサーバーの SSL 処理の負担をなくすことができ、さらに ISA Server を利用して、処理を行って直接バックエンドサーバーに流せるトラフィックの種類を制御して、保護を強化することができます。現在の環境と必要なデータストアの数に応じて、1 つ以上のバックエンド Exchange Server を設置できます。
  
ユーザーがインターネットを経由してフロントエンドサーバーに接続する場合、そのフロントエンドサーバーが、ユーザーのメールボックスをどのバックエンドサーバーに設置するかを決定する必要があります。この通信は、フロントエンドサーバーから内部ネットワーク上にある Windows 2000 ドメインコントローラに LDAP クエリを送信することによって実行できます。内部ドメインコントローラは Active Directory データベースを参照して、メールボックスの正確な位置を判断します。
  
フロントエンド/バックエンド構成を使用するためにインターネットを通じて接続できるクライアントの種類は、HTTP、IMAP4、および POP3 クライアントだけです。Outlook Web Access 用の HTTP クライアントが最も一般的です。一般的な設計では、フロントエンドサーバーを 2 つの ISA Server ファイアウォールの間にある境界領域のネットワーク内に配置します。バックエンドサーバーと Active Directory ドメインコントローラは内部ネットワーク上に配置します。HTTP、POP3、および IMAP4 クライアントを接続するには、両方の ISA ファイアウォールで次のポートが開かれていることが必要です。
  
-   HTTP (80)
  
-     
-   グローバルカタログ (3268) および LDAP (389)
  
-     
-   SSL (443)
  
-     
-   POP3 (110)
  
-     
-   SMTP (25)
  
-     
-   IMAP4 (143)
  
-   
  
提供されるシナリオでは、フロントエンド/バックエンドソリューションを有効にするために、両方の ISA Server ファイアウォールで必要な構成の詳細が正確に示されます。フロントエンド/バックエンドソリューションの定義、設計、構成の詳細については、Microsoft のホワイトペーパー『Exchange 2000 フロントエンド/バックエンドトポロジ』を参照してください。
  
**Exchange Server の配置**
  
ここでは、いくつかの一般的なネットワーク設計について説明します。これらについては、Feature Pack で提供されているシナリオに詳細な説明があります。
  
-   Exchange と ISA Server の共存
  
-     
-   Exchange を ISA Server コンピュータの背後にある内部ネットワーク上に配置する
  
-   
  
**Exchange と ISA Server の共存**
  
ISA Server コンピュータ上に Exchange 2000 Server をインストールするのは一般的です。これは、ハードウェアや予算に制限があること、または Small Business Server 2000 が使用されていることによります。
  
次の図は、Exchange と ISA Server が同じサーバー上に共存している設計を示しています。
  
![](images/Cc750289.epo01(ja-jp,TechNet.10).gif)
  
**Exchange を ISA Server コンピュータの背後にある内部ネットワーク上に配置する**
  
最も一般的に使用されているのは、Exchange 2000 Server を ISA ファイアウォールの背後にある内部サーバー上に配置する設計です。ISA ファイアウォールは、Exchange サービスを公開し、目的のトラフィックを受信し、それを Exchange Server の内部 IP アドレスに送信するように構成されます。
  
次の図は、Exchange を ISA ファイアウォールの背後にある別の内部サーバー上に配置する設計を示しています。
  
![](images/Cc750289.epo02(ja-jp,TechNet.10).gif)
  
[](#mainsection)[ページのトップへ](#mainsection)
  
### インフラストラクチャ要件
  
Exchange 2000 Server は前のバージョンから大幅に変更されています。ISA Server コンピュータの背後にある Exchange サービスを公開するシナリオを実行する場合、クライアントが社外にいる間に電子メールメッセージにアクセスできるようにするには、多くの要素が関係してきます。RPC と OWS を外部のユーザーベースで利用できるようにする前に、Exchange 2000 Server と ISA Server の他に再確認すべきネットワーク上の要素があります。
  
再確認すべきネットワーク上の主な項目は、以下のとおりです。
  
-   Active Directory
  
-     
-   DNS
  
-     
-   ルーター
  
-   
  
**Active Directory**
  
Microsoft の最新のディレクトリサービスである Active Directory は、Windows 2000 Server オペレーティングシステムに含まれています。Active Directory は、ユーザー、グループ、コンピュータなどの、数百万にも及ぶネットワークオブジェクトを格納できる単体のディレクトリです。
  
**Exchange Server**
  
Exchange 2000 Server はそのディレクトリサービスとして Active Directory を利用します。つまり、2 つの製品が同じディレクトリを共有するということです。前のバージョンの Exchange ではネットワークオペレーティングシステム (NOS) で使用されるデータベースとは別個のディレクトリがありました。ネットワーク管理者が Exchange 2000 Server をインストールする場合、その環境にあらかじめ Active Directory が設定されていなければなりません。
  
ディレクトリサービスを Exchange Server 5.5 から Exchange 2000 Server に移行することは、企業がメールインフラストラクチャをアップグレードするには、先に NOS をアップグレードする必要があることを意味しました。一部の企業にとっては、これが Windows 2000 と Active Directory に移行する理由になりました。また別の企業にとっては、依存関係があるために Exchange 2000 Server へのアップグレードが遅れることを意味しました。
  
Exchange と Active Directory の依存関係の詳細については、Microsoft Exchange の Web サイトを参照してください。
  
**ISA Server**
  
ISA Server は Active Directory への依存関係を提供します。ただし、これは必須ではありません。ISA Server Standard Edition を購入した場合、Active Directory との相互関係を持たずに、Windows NT または Windows 2000 の環境にインストールできます。ISA Server Enterprise Edition は、この製品を Active Directory と統合することを求める企業のニーズを満たすように設計されています。管理者が ISA Server アレイ (1 つのキャッシュを共有する 1 台以上の ISA Server コンピュータ) を設定する場合、Active Directory は必須です。ISA Server には、ISA Server アレイを設定するためのエンタープライズ初期化ツールが含まれています。このツールを使用して、Active Directory のスキーマを準備および拡張して、必要な拡張機能をこのディレクトリにロードします。
  
このマニュアルの後の部分と、Feature Pack に含まれているシナリオベースのガイドでは、以下のことが前提となります。
  
-   Windows 2000 および Active Directory がネットワーク環境に導入されている。
  
-     
-   Exchange 2000 Server の少なくとも Service Pack 2 がインストールされている (Service Pack 3 が推奨)。
  
-     
-   ISA Server 2000 の最新の Service Pack がインストールされている。
  
-   
  
**DNS**
  
DNS (ドメインネームシステム) は、Exchange メールが組織で期待どおりに送受信されるようにするために不可欠なコンポーネントです。Microsoft ISA Server ニュースグループには、DNS および環境内でのその配置に関して、多くの投稿があります。
  
**定義**
  
このシナリオでは、以下の用語が使用されます。
  
-   DNS。コンピュータとネットワークサービスのネーミングシステムで、ドメインの階層として構成されます。DNS のネーミングは、インターネットなどの TCP/IP ネットワークで、ユーザーフレンドリな名前を使ってコンピュータとサービスの位置を特定するときに使用されます。
  
-     
-   再帰クエリ。クエリが送られると、ネームサーバーはドメイン名に関する情報を返すか、ドメイン名が存在しないという事実を返すことを要求されます。その要求では別のネームサーバーを参照できません。
  
-     
-   反復クエリ。依頼者からクエリを送られると、ネームサーバーは使用可能な情報を基に、提供できる最適な応答を返します。この応答では、正確な名前が返される場合、またはより詳しい情報を提供できる可能性のある別のネームサーバーへの参照が返される場合があります。
  
-     
-   スプリット DNS。この設計は、別個に更新されるそれぞれ独立した 2 つの DNS サーバーで構成されます。内部サーバーには組織内のすべての DNS 名のデータベースが含まれ、それに対し、外部サーバーは、電子メールのフォワーダや Web サーバーなどの外部の存在に対応する名前を解決します。
  
-     
-   フォワーダ。ネームサーバーからすべてのクエリと応答が渡される、1 つ以上のネームサーバーの IP アドレス。
  
-   
  
**DNS とは**
  
Exchange 管理者は、SMTP が、ユーザーのメールを外部ドメインに正確にルーティングするために DNS に依存していることに注意してください。たとえば、組織内部のユーザーが組織外にいる別のユーザーにメールを送信する場合、SMTP サーバーは必ず DNS サーバーにクエリを送ります。これにより、外部ドメインの IP アドレスを解決する要求を転送するか、スマートホストを使用するように構成できます。スマートホストはリモートサーバーです。Exchange Server はこのサーバーに向けて、特定のリモートドメインまたはルーティンググループ宛てのメッセージを送信できます。基本的に、スマートホストは中継ステーションのような働きをします。つまり、Exchange Server がメールをスマートホストに送信し、スマートホストはそれを受けて、DNS を使用してそのメールを宛先まで送信する役目を担う、ということです。
  
ISA Server にインストールされた Exchange サービスの公開を成功させるために、Microsoft は DNS 環境を "スプリット DNS" 設計で構成することをお勧めします。前に定義したように、スプリット DNS は 2 つの DNS サーバーを含んでいます。1 つはサーバーどうしが相手を検出したり、Active Directory を検出できるように内部に配置され、もう 1 つは SMTP サーバーがどこにあるメールドメインでも検出できるように外部に配置されます。内部 DNS サーバーは ISA Server コンピュータの背後に配置され、外部 DNS サーバーは ISA Server コンピュータの前に配置されます。
  
**ISA Server クライアント**
  
DNS の名前解決は、内部ネットワークでどの ISA クライアントを利用するか選択するときに主に考慮すべき項目です。以下の表は、各 ISA クライアントで DNS 名前解決がどのように実行されるかを簡単に説明しています。

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >ISA Server クライアント</th>
<th style="border:1px solid black;" >名前解決方式</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">SecureNAT クライアント</td>
<td style="border:1px solid black;">環境によって異なります。クライアントに内部 DNS サーバーを知らせるか、DNS クエリをクライアントから直接外部 DNS サーバーに渡すように ISA Server を構成する必要があります。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Web Proxy クライアント</td>
<td style="border:1px solid black;">ISA Server Web Proxy サービスが単純な DNS 機能を提供できるようにします。ISA Server コンピュータ自体の DNS 構成に基づきます。</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">ファイアウォールクライアント</td>
<td style="border:1px solid black;">ISA Server Firewall サービスが単純な DNS 機能を提供できるようにします。ISA Server コンピュータ自体の DNS 構成に基づきます。</td>
</tr>
</tbody>
</table>
  
**ルーター**
  
ネットワーク上のさまざまな層を経由してトラフィックをルーティングすることは、エンドユーザーに電子メールメッセージへのアクセスを許可するインフラストラクチャでは重要です。ルーティングトポロジは顧客によって異なります。組織によっては単純なフラットネットワークの場合も、複雑なセグメント化されたネットワークの場合もあります。内部ネットワーク、境界領域のネットワーク、および外部ネットワークを経由してトラフィックを引き渡すときのルーターの構成方法によって、メールが組織外のユーザーから送信された場合に Exchange Server に到達しないように設定できます。ルーターとルーターの構成方法を理解しておくと、これらの問題を特定して回避し、メールを確実に配信できます。
  
**定義**
  
ルーター。複数のネットワークを接続する物理装置。ルーターのインターフェイスには IP アドレスが割り当てられます。このアドレスは、ルーターがサービスを提供するネットワークのセグメントのデフォルトゲートウェイとして認識されます。
  
**ルーティング要件**
  
指定されるシナリオを開始する前に、以下の操作を行います。
  
-   公開された Exchange、OWA、および SMTP サーバーを SecureNAT クライアントとして構成します。
  
-     
-   ISA Server をインストールする前に、すべての内部ネットワークのルートを確立します。
  
-   
  
**SecureNAT クライアントの構成**
  
トラフィックを適切にルーティングするには、SecureNAT クライアント用のデフォルトゲートウェイを正しく構成する必要があります。この構成はネットワークトポロジによって異なります。
  
-   単純なネットワーク。単純なネットワークトポロジでは、SecureNAT クライアントと ISA Server コンピュータの間にルーターが配置されません。
  
-     
-   複雑なネットワーク。複雑なネットワークトポロジでは、SecureNAT クライアントと ISA Server コンピュータの間に構成された複数のサブネットが、1 台以上のルーターで接続されます。ルーターはインターネット宛てのトラフィックが破棄されない構成にしてください。
  
-   
  
次の表は、正しいルーティングを行うために、ネットワークトポロジに基づくデフォルトゲートウェイを構成する方法を示しています。

 
<p> </p>
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >トポロジ</th>
<th style="border:1px solid black;" >定義する構成</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">単純</td>
<td style="border:1px solid black;">SecureNAT クライアントのデフォルトゲートウェイのアドレスを、ISA Server コンピュータの内部ネットワークアダプタに割り当てられた IP アドレスに設定します。</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">複雑</td>
<td style="border:1px solid black;">SecureNAT クライアントのデフォルトゲートウェイのアドレスを、SecureNAT クライアントと ISA Server コンピュータを結ぶチェーンの最後のルーターに割り当てられた IP アドレスに設定します。</td>
</tr>
</tbody>
</table>
  
**ROUTE ADD コマンド**
  
複雑なネットワークの場合、内部ネットワークのすべてのネットワークセグメントに ISA Server 用のルートを定義します。ルーティングテーブルには ROUTE ADD コマンドを使って手動で書き込むことも、ルーティング情報プロトコル (RIP) などの動的ルーティングプロトコルを使うこともできます。
  
ROUTE ADD コマンドの構文は、以下のとおりです。
  
<codesnippet language displaylanguage containsmarkup="false"> ROUTE ADD &lt;宛先ネットワーク ID&gt; MASK &lt;デフォルトゲートウェイの IP アドレス&gt;   
```  
[](#mainsection)[ページのトップへ](#mainsection)
  
### ISA Server の構成
  
ISA Server 2000 には 2 つの基本的な機能があります。1 つは、クライアントがインターネットコンテンツにアクセスするときの速度を上げること、もう 1 つは、内部リソースを保護しながら、プライベートネットワークとの間でコンテンツをやり取りできるようにする、セキュリティで保護されたファイアウォールを提供することです。ISA Server は、Exchange サービスを外部クライアントが利用できるようにする、アプリケーション層のファイアウォールです。
  
このマニュアルで説明するシナリオを構成する手順については、Feature Pack に含まれているこのシナリオのマニュアルを参照してください。
  
**最適な構成の定義**
  
Exchange 環境にとっても最も安全な構成は、クライアントに必要なアクセスだけを提供する構成です。
  
-   指定した内部サーバーだけが、社外に情報を送信できます。社外から表示できるサーバーは、ISA Server コンピュータだけです。
  
-     
-   RPC、OWA、および SMTP トラフィックに対応する
  
    3 つのポートだけが、社外から表示できます。
  
-     
-   発信 SMTP および DNS トラフィックだけが許可されます。
  
-     
-   すべての Web トラフィックはセキュリティで保護されます。
  
-     
-   不要なメールをフィルタで除外するために、メッセージスクリーナが構成されます。
  
-   
  
潜在的に危険性がある点を減らすことは、クライアントアドレスセットとプロトコルルールを使用して、ネットワークとの間のアクセスを制限することを意味します。"クライアントアドレスセット" は、インターネットとの通信を行う内部サーバーを指定します。Exchange を公開するには、すべてのブリッジヘッドサーバーの IP アドレスを含むクライアントアドレスセットを 1 つだけ作成する必要があります。この場合、ブリッジヘッドサーバーとは、インターネットへ、またはインターネットから SMTP メールをルーティングする、メッセージ転送ポイントの働きをするサーバーのことです。この時点で "プロトコルルール" を作成します。このルールにより、HTTP や SMTP などの特定のプロトコル定義だけをネットワークとの間でやり取りできるようにします。必要なプロトコル定義だけがネットワークへのアクセスを許可されます。それ以外のトラフィックはすべてブロックされます。
  
**発信トラフィックの制限**
  
ISA Server 2000 では発信接続用のポートだけが作成されます。戻される着信トラフィックはブロックされません。ISA Server がトランザクションの継続時間中、ポートを動的に開くためです。Exchange Server からは、発信される SMTP および DNS トラフィックだけが許可されるようにして、内部ネットワークから発信できる情報の種類を制限します。Exchange では、次のプロトコルのみが必要とされます。SMTP 発信トラフィックは社外の受信者に電子メールメッセージを送信するために必要です。DNS トラフィックは、内部 DNS サーバーが FQDN の解決用に DNS クエリを実行できるように許可しなければなりません。
  
**表示可能なポートの制限**
  
ISA Server 2000 では、必要なアクセスだけを許可するために、表示可能なポートを TCP ポート 25、135、および 443 だけに制限する必要があります。ポート 25 では、社外からの電子メールメッセージを受信するための着信 SMTP トラフィックを受け入れることができます。SMTP トラフィックは、後で詳しく説明するビルトインメッセージスクリーナを使って、さらに強固に保護できます。ポート 135 は、エンドポイントマッパーサービスにアクセスするための MAPI クライアントからの RPC 要求の処理に必要です。エンドポイントマッパーサービスはクライアントを、動的に割り当てられたハイレベルポート上の Exchange サービスに接続します。
  
**LAT の要件**
  
ローカルアドレステーブル (LAT) は、どのコンピュータアドレスがネットワークの内部にあり、どのアドレスがネットワークの外部にあるのかを、ISA Server が解釈する方法を定義します。LAT は、ISA Server ファイアウォールの境界内にある IP アドレスの範囲を指定することにより、セキュリティで保護されたインフラストラクチャの基礎を定めます。LAT の外部にあるアドレスはすべて、ISA Server が指定する制限の対象になります。ISA Server 構成の LAT には、Exchange、SMTP、Active Directory、および内部 DNS サーバーなど、Exchange サービスに必要なすべてのサーバーが含まれます。
  
**ISA Server 公開**
  
サーバー公開は、ISA Server 2000 が、内部サーバーをインターネット上のクライアントが利用できるようにするための方法です。ISA Server は公開されたすべての内部サーバーに対するインターネットベースのクライアント要求を処理するため、ISA Server は外部クライアント用の Exchange Server に見えます。ISA Server はこの後、要求を Exchange Server にルーティングし、応答をクライアントに返します。ISA Server は、フォワードプロキシとリバースプロキシの両方の機能を実行できます。フォワードプロキシは、選択した外部のコンテンツを内部のクライアントに提供します。Exchange を公開すると、ISA Server はリバースプロキシサーバーとして動作し、内部のコンテンツを外部クライアントに提供します。これらのリバースプロキシ機能を実行するために、サーバー公開と Web 公開の両方が使用されます。Web 公開は、インターネットクライアントが OWA を利用できるようにすることだけを目的に使用されます。サーバー公開は、MAPI、POP3、および IMAP4 クライアントが Exchange を使用できるようにすることを目的に使用されます。
  
**ISA Server 公開のしくみ**
  
Outlook Express を実行しているクライアントコンピュータがその Exchange Server に接続する必要がある、というシナリオについて考えます。Exchange Server の IP アドレスは 10.1.1.22 です。ISA Server コンピュータには、ローカルネットワーク上で通信を行うための内部アドレス (10.1.1.33) と、インターネットと通信を行うための外部アドレス (68.79.25.25) があります。
  
-   クライアントコンピュータは Exchange Server にコンテンツを要求します。この Exchange Server の IP アドレスは ISA Server コンピュータの IP アドレスとして返されます。このとき、SMTP 要求の既定ポートであるポート 25 が使用されます。
  
    1.  ISA Server コンピュータはポート 25 でリッスンしています。要求を受信すると、公開ルールに従い、その要求がポート 25 で行われたと認識し、このコンテンツは Exchange Server にルーティングされます。
  
    2.  3.  Exchange Server は要求を処理し、ISA Server コンピュータにコンテンツを返します。このコンテンツはその後、クライアントに転送されます。Exchange Server は SecureNAT クライアントとして設定する必要があります。つまり、このサーバーにはデフォルトゲートウェイとして、ISA Server コンピュータの IP アドレスが構成されている必要があるということです。
  
    4.  
  
-   
  
**アクセスポリシー**
  
ISA Server では 3 つのルールに従って、LAT 内のコンピュータの内部ユーザーがどのインターネットサイトにアクセスできるか、それらのユーザーがどのポートを使用できるか、およびネットワークとの間でどのような種類のトラフィックをやり取りできるかが制御されています。
  
**サイトとコンテンツルール**
  
"サイトとコンテンツルール" は、サーバーが訪問できる外部サイトとアクセスできるコンテンツを決定します。ルールでは、すべてのサイトへのアクセスを許可することが必要です。すべてのメールサーバーの名前を予測することが不可能だからです。クライアントにアクセスさせたくない特定のサイトがあるときは、"宛先セット" を作成する必要があります。宛先セットでは、\*.nwtraders.com などのドメイン名、または IP アドレスを使用してインターネット上の宛先を定義します。次に、サイトとコンテンツルールを構成して、その宛先セットへのアクセスを拒否します。
  
**プロトコルルール**
  
プロトコルは UDP または TCP ポート番号またはポート範囲を指定し、アクセスがインターネットから入ってくるのか (着信)、ローカルネットワークから出て行くのか (発信) を指定して定義します。ISA Server には、HTTP、DNS、および SMTP などの最も一般的なプロトコルがあらかじめ定義されています。"プロトコルルール" は、ISA Server コンピュータがインターネットとの間でどのプロトコルをやり取りすることを許可するかを定義します。ISA Server では、Exchange、DNS、および SMTP サーバーのプロトコルルールを定義して、ポート 25、135、および 443 への着信アクセスと、ポート 25 および 53 への発信アクセスだけを許可します。
  
**パケットフィルタ**
  
"パケットフィルタ" は、特定のポートとの間で発着信されるアクセスを静的に開いたり、ブロックするための方法です。パケットフィルタを有効にすると、明示的に許可されたパケット以外のあらゆるパケットがファイアウォールの境界を通過できなくなるため、最も安全な環境を作成できます。パケットフィルタは既定では有効に設定されていません。通常、パケットフィルタは境界領域のネットワーク内のコンピュータで Exchange が構成されている場合にだけ定義する必要があります。境界ネットワークでは、Exchange Server は、ISA Server コンピュータによって内部ネットワークとインターネットの両方から分離されています。特定のパケットフィルタの定義の詳細については、Feature Pack のマニュアルで提供されている他のシナリオを参照してください。
  
**パケットフィルタとサーバー公開の違い**
  
パケットフィルタはポートを静的に開くため、どうしても必要なときにだけ使用してください。パケットフィルタは、サイトとコンテンツルール、プロトコルルール、および公開ルールとは異なります。これらは動的であり、要求があったときに開閉されます。サーバー公開ルールはパケットフィルタより具体的なため、より確実なセキュリティを実現します。サーバー公開では、静的マッピングによってプロトコルまたはポートを常時使用できる状態にしておくのではなく、それらのポートに接続されているトラフィックをある一定の状態のもとで特定の内部サーバーだけに送信するように指定できます。
  
ただし、以下の場合はパケットフィルタが必要です。
  
-   マルチホーム境界領域のネットワークを実行している場合。
  
-     
-   ISA Server 自体の上で実行されるサービスを公開する必要がある場合。
  
-     
-   TCP または UDP 以外のプロトコルを使用できるようにする必要がある場合。
  
-   
  
**\[メールサーバーのセキュリティウィザード\] を使用した公開ルールの構成**
  
サーバー公開によって、Exchange Server を組織外で利用することが可能になります。ISA Server には、Exchange Server の公開ルールを作成するために利用できるウィザードが用意されています。
  
\[メールサーバーのセキュリティウィザード\] では、Exchange サービスを迅速かつ確実にインターネットに公開するために必要なすべてのコンポーネントをセットアップできます。
  
**SMTP Filter とメッセージスクリーナの比較**
  
ISA Server には、ネットワーク上でのメールの中継、ウイルスの侵入、不要な添付ファイルを防止するための 2 つのコンポーネントが含まれています。SMTP Filter とメッセージスクリーナです。
  
SMTP Filter の目的は SMTP コマンド動詞とユーザー/ドメインのフィルタを可能にし、ポート 25 に到達するすべての SMTP トラフィックを受信して、ネットワークにアクセスできないようにすることです。SMTP アプリケーションフィルタは ISA Server と共にインストールされていますが、既定で無効になっています。
  
SMTP Filter は常に ISA Server コンピュータ上にあります。SMTP トラフィックが ISA Server コンピュータに到達すると、このトラフィックは構成されたルールと照合して分析され、許可されれば通過できます。
  
対照的に、メッセージスクリーナの目的は、SMTP Filter のプロパティの他のタブに示されているキーワードと添付ファイルをフィルタすることです。メッセージスクリーナは IIS 5.0 SMTP サーバーにしかインストールできないため、構成が複雑です。このサーバーは ISA Server コンピュータでなくてもかまいません。たとえば、ISA Server コンピュータ、Exchange 2000 Server コンピュータ、またはその他の内部 IIS 5.0 SMTP サーバーのどれにでも、メッセージスクリーナをインストールできます。メッセージスクリーナは Exchange 2000 Server を実行していない内部 SMTP サーバーにインストールすることをお勧めします。
  
[](#mainsection)[ページのトップへ](#mainsection)
