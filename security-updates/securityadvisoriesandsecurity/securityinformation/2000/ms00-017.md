---
TOCTitle: 'MS00-017'
Title: 'マイクロソフト セキュリティ情報 MS00-017 - 重要'
ms:assetid: 'ms00-017'
ms:contentKeyID: 61228183
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-017(v=Security.10)'
---
マイクロソフト セキュリティ情報 MS00-017 - 重要
===============================================

「パスに DOS デバイス名が含まれる場合」 の脆弱性に対する対策
------------------------------------------------------------

公開日: 2000年7月18日 | 最終更新日: 2001年2月28日

#### 概要 :

マイクロソフトは、Microsoft® Windows 95、Windows 98 および Windows 98 Second Edition のセキュリティに対し、悪影響を与える可能性のある問題に対応する更新プログラムをリリースしました。パスに特定の予約語を含むファイルやフォルダにアクセスした場合、ユーザーのシステムがクラッシュしてしまう場合があります｡

**影響を受けるソフトウェアのバージョン:**

-   Microsoft Windows 95
-   Microsoft Windows 98
-   Microsoft Windows 98 Second Edition

### 詳細

問題
----


パスには予約語である DOS デバイス名を含めることができないにもかかわらず、それが複数回含まれる場合、Windows はパスが不正であるというメッセージを返しません｡従って、Windows がそれをファイル リソースとして解釈してしまった場合、アクセス違反が発生し、システムがクラッシュしてしまう場合があります｡  

ユーザーは DOS デバイス名を含むファイルおよびフォルダを作成することはできません。従って通常の環境では、ユーザーはそれを含むパスを指定することはありません。しかし悪意のあるユーザーが、他のユーザーにそのようなファイルもしくはフォルダにアクセスするよう仕向ける場合があります。例えば Web サイトの作成者がそのようなパスを指定するハイパーリンクをはった場合、そのリンクをクリックするとマシンがクラッシュしてしまう場合があります｡同様に Web ページや HTML メールにそのようなローカルのファイルへのリンクがはられている場合、それを開くとマシンがクラッシュしてしまう場合があります。マシンがクラッシュしてしまった場合、コンピュータの再起動を行う必要があります｡

よく寄せられる質問
------------------


**マイクロソフトセキュリティ情報MS00-017はどのような内容の通知ですか?**

このマイクロソフト セキュリティ情報 MS00-017 は、Microsoft® Windows® 95、 Windows 98、およびWindows 98 Second Edition のセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことを、お客様にお知らせするものです。この脆弱性のため、状況によっては、攻撃されたコンピュータが異常終了してしまうことがあります。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**この脆弱性はどれくらいの範囲に影響を与えますか?**

コンピュータの[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)されてしまうことがあります。悪意のあるユーザーが、パスに特定の予約語を含むファイルを開くよう他のユーザーを導くことができた場合、そのユーザーのコンピュータを異常終了させてしまうことできる場合があります。

しかし、悪意のあるユーザーが、他のコンピュータを制御できてしまったり、データを読んだり、追加したり、修正できることはありません。コンピュータは、再起動すれば通常の状態に戻りますが、作業中であった保存されていないデータは失われてしまいます。

**この脆弱性の原因は何ですか?**

この脆弱性は、Windows 95 と 98 (Windows 98 Second Edition を含む) の、ファイルのパス名を解析する処理に問題があるために発生します。デバイス名、COM1、CON、および LPT1 は予約語であり、フォルダ名やファイル名として使用できません。Windows 95 と 98 のパス解析では、パスに DOS デバイス名が 1 つ含まれる場合は、それを無効なものだとみなし、エラーを返します。しかしそれが複数含まれている場合は、チェックを行わず、この脆弱性の原因となります。  

パスに複数の DOS デバイス名が含まれるファイルに対し、読み取り/書き込み処理が行われると、Windows 95 と 98 は無効なリソースにアクセスしてしまいます。その結果、コンピュータがブルースクリーンになってしまい、異常終了してしまうことがあります。一部、読み取り/書き込み処理を行っているファイル アプリケーションがハングしてしまう場合もあります。

**どのようなデバイス名がこの問題を発生させますか?**

DOS デバイス名は、アプリケーション開発メーカーが独自に作成し予約語にできるものです。したがって、それらをすべて網羅することはできません。マイクロソフトでは、[256015](http://support.microsoft.com/kb/256015) にて標準的な DOS デバイス名のリストを公開します。

**どういうことが発生すると影響を受けますか?**

通常、ユーザーは、ファイルに DOS デバイス名などの予約語を含むパスを作成することはできません。しかし悪意のあるユーザーがこの脆弱性を利用し、ユーザーに問題となる DOS デバイス名を複数含むパスのファイルを読んだり、聴くよう仕向けことが考えられます。例えば、C:\\COM1\\COM1 などというパスのフォルダを作成することはできませんが、故意に他のユーザーのコンピュータを異常終了させようとし、そのようなパスを持つファイルをユーザーに読ませり、聴かせたりすることができると影響を受けます。

**悪意のあるユーザーはどのようにこれを実行しますか?**

特定の予約語を含むパスのファイルにユーザーをアクセスさせようとします。例えば自分の Web サイトに、C:\\COM1\\COM1 などのパスのフォルダに含まれるファイルへのリンクをはり、開かせようとします。Web サイトはファイルを読んだり変換したりしないため、リンクをはる段階では通常問題となりません。しかし Web サイトの訪問者側の Windows がファイルを探す段階で、システムが異常終了してしまうことがあります。ユーザーのコンピュータに、実際にファイルがない場合でも、この動作自体がコンピュータの異常終了につながってしまいます。  

また上記のように、この脆弱性の影響を受けるリンクにユーザーを導かなくても、問題が発生するシナリオがあります。例えば、Web ページは、ユーザーのコンピュータ上の画像ファイルをページのバックグランドとして指定できます。この指定がなされると、単にページを開くだけでユーザーのコンピュータが異常終了してしまうことがあります。このシナリオは、HTML 形式の電子メールに応用される場合があります。

**プレビューウィンドウを有効にしている場合影響を受ける可能性は強いですか?**

はい。プレビュー ウィンドウで電子メールを参照していると、HTML 形式の電子メールはレンダリングされます。したがって、電子メールがプレビュー ウィンドウに表示されたとたんに、脆弱性の影響を受けてしまいます。

**Outlookでプレビューウィンドウが有効になっています。そのようなメールを受け取ったらどうすればよいですか?**

Outlook をコマンドプロンプトから起動し、/safe と /nopreview オプションを指定し、プレビュー ウィンドウを無効にしてください。これを実行する方法の詳細については、サポート技術情報 [197180](http://support.microsoft.com/kb/197180) と [182112](http://support.microsoft.com/kb/182112) を参照してください。この手順を実行後、Outlook を再度起動し、電子メール開かずに削除します。

**コンピュータが異常終了してしまったらサービスを再開するのにどうすればよいですか?**

コンピュータを再起動れば、サービスを再開できます。例えコンピュータが異常終了してしまっても、コンピュータの再起動後に影響が続くことはありません。しかし、保存していない作業中のデータが失われてしまうことがあります。

**この脆弱性は偶発的に発生しますか?**

いいえ、発生しません。上記のとおり、ここで問題となっている予約語を含むファイル名およびフォルダ名は、作成できません。したがって、この脆弱性が侵害されることを想定して作成された Web サイトを参照しないかぎり、この問題が発生することはありません。

**Windows NT 4.0またはWindows 2000もこの脆弱性の影響を受けますか?**

いいえ、受けません。

**どのようなコンピュータを使用している場合更新プログラムを適用すべきですか?**

Windows 95、Windows 98 および Windows 98 Second Edition をお使いのお客様は、本更新プログラムを適用してください。

**更新プログラムは何を変更するのですか?**

この更新プログラムを適用すると、DOS デバイス名を 2 つ以上含むパスも無効なものとして処理します。これは、本来そうあるべき仕様です。

**どこから更新プログラムを入手できますか?**

マイクロソフト セキュリティ情報 MS00-017 をご覧ください。

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する更新プログラムを開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 MS00-017 と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](http://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。
-   マイクロソフトはサポート技術情報 [256015](http://support.microsoft.com/kb/256015) を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](http://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカルサポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](http://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------


この脆弱性に対する日本語版更新プログラムは、以下のサイトからダウンロードできます。

-   Windows 95:
    -   PC/AT 互換機用  
        [http://www.microsoft.com/windows95/downloads/contents/WUCritical/
        dosdevice/Default.asp](http://www.microsoft.com/windows95/downloads/contents/wucritical/dosdevice/default.asp)  
        ダウンロード先のリストから Download now (Japanese) を選択してください。
    -   NEC PC-9800 シリーズ用  
        [http://download.microsoft.com/download/win95/Update/6467-NEC/W95/JA/256015NEC5.EXE](http://download.microsoft.com/download/win95/update/6467-nec/w95/ja/256015nec5.exe)  
-   Windows 98 および Windows 98 Second Edition:  
    -   PC/AT 互換機用  
        [http://download.microsoft.com/download/win98SE/Update/6467/W98/
        JA/256015JPN8.EXE](http://download.microsoft.com/download/win98se/update/6467/w98/ja/256015jpn8.exe)  
    -   NEC PC-9800 シリーズ用  
        [http://download.microsoft.com/download/win98/Update/6467-NEC/W98/JA/256015NEC8.EXE](http://download.microsoft.com/download/win98/update/6467-nec/w98/ja/256015nec8.exe)

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報:**

-   US マイクロソフトセキュリティ情報（MS00-017）  
    [http://www.microsoft.com/technet/security/bulletin/ms00-017.mspx](http://technet.microsoft.com/security/bulletin/ms00-017)
-   サポート技術情報 （KB） 文書番号 ： 256015    
    [パスに複数の MS-DOS デバイス名が含まれると致命的エラーが発生する](http://support.microsoft.com/kb/256015)

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
