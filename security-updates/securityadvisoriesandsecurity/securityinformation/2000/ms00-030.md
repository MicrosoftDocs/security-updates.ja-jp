---
TOCTitle: 'MS00-030'
Title: 'マイクロソフト セキュリティ情報 MS00-030 - 重要'
ms:assetid: 'ms00-030'
ms:contentKeyID: 61228196
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-030(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS00-030 - 重要
===============================================

「URL 内の変形された拡張子データ」 の脆弱性に対する対策
-------------------------------------------------------

公開日: 2000年5月12日 | 最終更新日: 2001年2月22日

#### 概要 :

マイクロソフトは、Microsoft® Internet Information Server のセキュリティ脆弱性を排除する日本語版更新プログラムをリリースしました。この脆弱性は、影響を受けるサーバーのパフォーマンスを遅くしたり、サーバーを一時的に完全停止したりするために利用される恐れがあります。

**影響を受けるソフトウェアのバージョン** **:**

-   Microsoft Internet Information Server 4.0
-   Microsoft Internet Information Server 5.0

### 詳細

問題
----


RFC 2396 に準拠して、IIS 内の URL を処理するアルゴリズムには、柔軟性が組み込まれており、ファイル拡張子やサブリソース識別子を任意に連続させたものを処理できるようになっています (RFC では path\_segments として説明されています)。特定の形に変形されたファイル拡張子情報を含む URL を提供することにより、悪質なユーザーがこの柔軟性を悪用し、URL の解析に関連する作業要素を任意に増加させてしまう恐れがあります。これにより、サーバー上の CPU 使用可能容量の多くまたはすべてが消費され、有効な作業を行うことができなくなる場合があります。

この脆弱性では、サーバーが障害を起こしたり、サーバー上でデータの追加、変更、削除が可能になったりすることはありません。同様に、この脆弱性によって Web サーバーの管理的制御が不正利用されることもありません。動作が遅くなるのは、URL の処理が終了するまでの間だけで、処理終了時点でサービスは通常に戻ります。

よく寄せられる質問
------------------


**マイクロソフト セキュリティ情報** **MS00-030** **はどのような内容の通知ですか?**

マイクロソフト セキュリティ情報 MS00-030 は、Microsoft® Internet Information Server のセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことをお客様にお知らせするものです。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**どのようなことが起こる可能性がありますか?**

これはサービスの拒否の脆弱性です。悪意のあるユーザーが改ざんされたファイル拡張子データを含む URL により、Web サーバーからファイルをリクエストすると、サーバーがしばらくの間応答なしとなります。
この脆弱性により、サーバーの異常終了、データの損失またマシンの管理者コントロールの不正使用はできません。この脆弱性を利用し、攻撃者は単にほとんどのまたは全ての CPU 使用可能許容量を消費するにとどまります。充分な時間が経過すると、サーバーは自動的に通常のオペレーションを再開します。

**何が原因で起こりますか?**

この脆弱性は IIS でファイル拡張子が扱われる方法が原因となって起きます。改ざんされた拡張子を含む URL を供給することにより、URL を処理しているアルゴリズムの操作が非常に非効率になります。最悪の場合、このタスクに CPU 使用可能量が 100% 使用され、正当なサービス要求に対するサーバーの応答を遅延させます。

**IIS** **が拡張子を扱う方法の何が問題となっていますか?**

IIS はファイル拡張子データを正確に取り扱います。URL のどの部分で発生したかに関わらず、IIS は正しく全てのファイル拡張子を識別します。そして、必要な産業仕様に完全に準拠しています。しかし、大量の過剰な拡張子データを含む URL を供給することにより、ファイル拡張子を解析するアルゴリズムは悪用されます。

**ファイル拡張子はピリオドに** **3** **文字続くだけの極めて単純なもの思われますが、ここで問題となっている 「過剰な拡張子データ」 とは何ですか?**

最も一般的に使用されているように、ファイル拡張子はピリオドに続く 3 文字で構成されており、ファイル名や URL の後に付いています。しかし、これだけが拡張子データの使用方法ではありません。拡張子の使用方法や使用場所に関しては実に柔軟性があります。特に URL で顕著です。例えば、http://www.microsoft.com/folder1.vti/folder2.doc/file.txt.zip のように理論的には、URL の全体に様々な拡張子が含まれることも可能です。各拡張子はサーバーに特定のフォルダやファイルの中にあるデータの処理方法と処理順序を伝えます。

ここで問題となっている 「過剰な拡張子データ」 とは、URL に挿入されている偽のファイル拡張子データで、単にアルゴリズムがそれを解析するために時間を費やすことを目的としています。現在実装されているように、作業要因は URL の複雑性で非線形を増加させます。大量な偽のファイル拡張子データを含む非常に複雑な URL を故意に送信することにより、悪意のあるユーザーはサーバーが有効な作業を行えなくなるまで任意にサーバーに負荷を増大することができます。

**「非常に複雑な」** **URL** **とは、どのくらい複雑なのですか?**

作業要因を充分に高くするために、URL は何千もの文字数を必要とし、大量のファイル拡張子データを含む必要があります。明らかに、これは通常の使用では起こらない状況です。

**この脆弱性を利用した攻撃はどのような影響を及ぼしますか?**

この脆弱性を利用した攻撃により、サーバーの応答を遅延させたり、完全に停止させたりすることができます。しかし、これでサーバーの異常終了やデータの損失は起こりません。サーバーが URL の解析を完了すると、処理は通常の状態に戻ります。しかし、悪意のあるユーザーはこのような URL を繰り返し送信し、サーバーを無限に停止させようとします。

**更新プログラムをインストールする以外にこれらの攻撃を阻止する方法はありますか?**

はい、あります。管理者はサーバーが受け入れられる URLの長さを制限することができます。これは URL の複雑性を制限する効果があります。受け入れを許可できる最長 URL （および HTTP ヘッダ） に対して次のレジストリ エントリを設定して下さい。詳細はマイクロソフト サポート技術情報 [260694](http://www.microsoft.com/japan/technet/security/bulletin/) をご覧下さい。

 
<p> </p>  
<table style="border:1px solid black;">
<tbody>
<tr class="odd">
<td style="border:1px solid black;">ハイブ</td>
<td style="border:1px solid black;">HKEY_LOCAL_MACHINE \SYSTEM<br />
</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">キー</td>
<td style="border:1px solid black;">CurrentControlSet\Services\W3SVC\Parameters<br />
</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">名前</td>
<td style="border:1px solid black;">MaxClientRequestBuffer<br />
</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">値の種類</td>
<td style="border:1px solid black;">DWORD</td>
</tr>
</tbody>
</table>
  
**IIS 4.0** **と** **IIS 5.0** **サーバーは同様にこのような攻撃の影響を受けますか?**
  
いいえ、受けません。デフォルトで IIS 5.0 サーバーは IIS 4.0 サーバーよりも影響を受けにくくなっています。理由は IIS 5.0 でのデフォルトの最長 URL が IIS 4.0 よりもはるかに短いためです。これは URL の複雑性を制限する効果を持っています。
  
**この脆弱性は偶発的に発生しますか?**
  
この脆弱性が偶発的に発生するのは極めてまれです。作業要因を充分に高くし、サーバーのパフォーマンスを遅らせるためには、URL に数千もの文字数と埋め込まれた大量の拡張子データが必要となります。そしてファイル拡張子データをできる限り非効率で困難に解析するようにされている必要があります。
  
**更新プログラムは何を修正しますか?**
  
更新プログラムは次の 2 つを行います。
  
-   URL がディレクトリ名の一部として実行可能ファイルの種類 （例として、com、exe など） に関連する拡張子を含んでいる場合、IIS が URL を無効として取り扱うようにします。  
-   有効な URL に含まれるドット文字総数の制限を確立します。サポート技術情報で説明されているように、レジストリ値により制限を設定することができます。
  
**どこから更新プログラムを入手できますか?**
  
マイクロソフト セキュリティ情報 MS00-030 をご覧ください。
  
**この問題に対してマイクロソフトはどのような対応をしていますか?**
  
-   マイクロソフトは、この脆弱性を排除する更新プログラムを開発しました。  
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 [MS00-031](http://technet.microsoft.com/security/bulletin/ms00-031) と、この faq を提供しています。  
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](http://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。  
-   マイクロソフトはサポート技術情報 [260205](http://support.microsoft.com/kb/260205) を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。
  
**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**
  
マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](http://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。
  
**テクニカル サポートを受けるにはどこに問い合わせればよいですか?**
  
マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](http://support.microsoft.com/gp/cntactms)を参照してください。
  
更新プログラム  
--------------
  

この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。
  
-   Internet Information Server 4.0:  
    この問題に対する更新プログラムは Windows NT 4.0 のセキュリティ ロールアップ パッケージ (SRP) に含まれています。  
    個別の更新プログラムよりもセキュリティ ロールアップ パッケージを適用することをお勧めします。  
    NT4.0 のセキュリティ ロールアップ パッケージは次のリンクから入手してください。
  
    [299444](http://support.microsoft.com/kb/299444) Post Windows NT 4.0 SP6a セキュリティ ロールアップ パッケージ (SRP)
  
    なお、個別の更新プログラムは次のリンクから入手することができます。  
    [http://www.microsoft.com/downloads/details.aspx?FamilyId=36FF8BC0-6D6A-4F5E-92AB-14E3800CF4DD&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=36ff8bc0-6d6a-4f5e-92ab-14e3800cf4dd&displaylang=ja)
  
-   Internet Information Server 5.0:  
    この問題に対する修正は [MS01-026](http://technet.microsoft.com/security/bulletin/ms01-026) の修正モジュールに含まれています(NEC PC98 シリーズを除く)。MS01-026 には、それまでの IIS 関連の修正がすべて含まれていますので、MS01-026 のご利用をお勧めします。  
    この問題に対する修正は Windows 2000 サービスパック 1 に含まれています。  
    個別の日本語版更新プログラムは、以下のサイトからダウンロードできます。  
    [Windows 2000 Internet Information Server 5 (IIS5) セキュリティ修正プログラム : URL 内の変形された拡張子データ](http://www.microsoft.com/downloads/details.aspx?displaylang=ja&familyid=d6f4f73c-457c-4575-a797-69fbfe4a5b13)
  
更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)
  
### その他の情報
  
**詳細情報** **:**
  
-   US マイクロソフトセキュリティ情報（MS00-030）  

    [http://www.microsoft.com/technet/security/bulletin/ms00-030.mspx](http://technet.microsoft.com/security/bulletin/ms00-030)  
-   サポート技術情報 （KB） 文書番号 ： 260205 
 
    [多数のドット/ドットスラッシュを含む HTTP 要求実行時のエラー](http://support.microsoft.com/kb/260205)
  
本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。
  
*Built at 2014-04-18T01:50:00Z-07:00*
