---
TOCTitle: 'MS00-054'
Title: 'マイクロソフト セキュリティ情報 MS00-054 - 緊急'
ms:assetid: 'ms00-054'
ms:contentKeyID: 61228220
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-054(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS00-054 - 緊急
===============================================

「無効な IPX Ping パケット」の脆弱性に対する対策
------------------------------------------------

公開日: 2000年8月10日 | 最終更新日: 2000年11月13日

#### 概要 :

Microsoft は、Microsoft® Windows 95、98 および 98 Second Edition の脆弱性を排除する英語版更新プログラムをリリースしました。この脆弱性によってマシンをダウンさせ、ネットワーク上でそのマシンに依存している他の多くのマシンに影響を与えることが可能になる場合があります。状況によっては、ネットワークに大量のデータをあふれさせる可能性があります。影響を受ける可能性があるこのシステム コンポーネントは、追加インストールを行わない限り通常はインストールされません。

**影響を受けるソフトウェアのバージョン :**

-   Microsoft Windows 95
-   Microsoft Windows 98
-   Microsoft Windows 98 Second Edition

### 詳細

問題
----

 
Microsoft が実装した IPX/SPX プロトコル (NWLink) は、診断用のポート 0x456 に対する IPX Ping コマンドをサポートします。Microsoft® Windows 95、98 および 98 Second Edition におけるプロトコル実装上の問題により、パケット中の送信元のネットワーク アドレスが意図的にブロードキャスト アドレスに書き換えられていても、NWLink は IPX Ping パケットに応答します。これにより、悪意のあるユーザーは一回の ping 要求が引き起こすブロードキャストを使用して攻撃を実行することができます。影響を受けたマシンは ping に応答し、その結果ブロードキャスト ストームが発生する可能性があります。大規模なネットワークでは、一時的にネットワーク帯域があふれる場合があります。また、先に述べたような応答が原因で、影響を受けた各マシンが応答処理を行おうとして最終的にマシンがダウンする可能性もあります。この脆弱性が原因となってダウンしたマシンは、再起動することでサービスを復旧できます。

IPX は Microsoft® Windows 98 および 98 Second Edition では既定ではインストールされません。Windows 95 の場合は、インストール時にネットワーク カードがマシンに装着されている場合にのみ IPX がインストールされます。IPX がインストールされていたとしても、悪意のあるユーザーがこの脆弱性を利用した攻撃を行うには、影響を受ける可能性があるマシンまで Ping パケットを到達させる必要があります。ルーターは IPX パケットを通さないように設定されている場合が多く、もしそのようなルーターが悪意のあるユーザーと影響を受ける可能性のあるマシンとの間に配置されている場合は、攻撃は不可能です。インターネット上のルーターは、IPX パケットを転送しないようにルールが定められており、これによってダイヤルアップ接続の場合と同様に、イントラネットが外部から攻撃されることを防いでいます。よく寄せられる質問に記載されているとおり、最も可能性が高いのは、イントラネット内部にいる悪意を持ったユーザーが、同一イントラネット内部にあるマシンを攻撃するケース、あるいはインターネット上の悪意のあるユーザーが、ケーブル モデムや DSL サブネットに接続されているマシンに攻撃を行うケースです。

よく寄せられる質問
------------------

 
**マイクロソフトセキュリティ情報 MS00-054 はどのような内容の通知ですか?**

マイクロソフト セキュリティ情報 MS00-054 は、Microsoft® Windows 95、98 そして 98 Second Edition のセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことをお客様にお知らせするものです。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**この脆弱性はどれくらいの範囲に影響を与えますか?**

[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)れることがあります。つまり、特定のコンピュータを異常終了させたり、大規模ネットワークでたくさんのレスポンスが一斉に返ってくるクエリを送信し、ネットワーク リソースをすべて使い切ってしまう 「ブロードキャスト ストーム」 を発生させることができる場合があります。

しかしこの脆弱性の原因となるシステム コンポーネントは、デフォルトでは通常インストールされていないものであるため、それが攻撃の可能性をかなり限定します。また例えインストールされていたとしても、特定の条件がそろわなければ攻撃を可能にしません。会社でお使いのコンピュータの場合、ネットワークにログオンできるユーザーからしか攻撃を受けることができません。またご自宅では、同じネットワーク セグメントにいる悪意のあるユーザーからしか攻撃を受けることができず、かつお使いのコンピュータがケーブルモデムもしくは DSL にてインターネットに接続していなければなりません。なお、Windows NT 4.0 と Windows 2000 は、この脆弱性の影響を受けません。

**この脆弱性の原因は何ですか?**

IPX が実装されている脆弱性の影響を受ける可能性のあるコンピュータに特別に改ざんされた Ping パケットが送信されると、受理され処理に入ってしまうことが原因です。処理結果として、コンピュータは送信元ではなくネットワーク全体に返信をしてしまい、ネットワーク全体をダウンさせてしまいます。

**IPX とは何ですか?**

IPX (Internetworked Packet Exchange、より厳密には IPX/SPX - Internetworked Packet Exchange/Sequenced Packet Exchange) とは、Novell Netware が広めたネットワーク プロトコルです。Windows では、Windows コンピュータと Netware コンピュータの通信を可能にする NWLink 機能で IPX が実装されています。

ルーティングができ比較的効率的な IPX は、小規模もしくは中規模ネットワークで主に使用されています。しかし IPX を使用しているとコンピュータが、通知操作のために定期的に送信するブロードキャスト メッセージにより、ネットワーク トラフィックが混雑してしまうことがあり、大規模ネットワークではあまり使用されていません。

**IPX プロトコルの問題ですか?**

いいえ、プロトコル自体の問題ではありません。影響を受けるシステムのプロトコルの実装上の問題のために発生します。

**IPX はデフォルトでインストールされますか?**

通常はデフォルトでインストールされません。Windows 98 と Windows 98 Second Edition では、デフォルトでインストールされません。Windows 95 では、プラグアンドプレイ対応のネットワークカードが挿入されていた場合､システムのインストール時にデフォルトでインストールされますが、多くの Windows 95 システムはそのようなネットワーク カードが存在しないときにインストールされていますので、Windows 95 でもあまりデフォルトでインストールされいないとと考えます。

**Ping パケットとは何ですか?**

「Ping」 機能は IPX プロトコルの一部で、コンピュータがネットワーク上でアクティブであるかどうか確認するために用いられるものです (TCP/IP などのプロトコルにも Ping 機能が実装されていますが、ここでは IPX に実装されている Ping 機能についてだけ言及します。)。 あるコンピュータから別のコンピュータに 「ping」 をすると、送信元と送信先アドレスを含むデータパケットがPingリクエストとして送信されます。

**Ping パケットの何が問題ですか?**

Ping パケットの送信元アドレスがブロードキャスト アドレスに改ざんされている場合、システムが不正に処理してしまい問題となります。

**ブロードキャストアドレスとは何ですか?**

IPX を含む多くのネットワーク プロトコルを使用して、ネットワーク上のすべてのコンピュータにパケットを送るときに使用するアドレスを、ブロードキャスト アドレスと呼んでいます。この脆弱性では、悪意のあるユーザーは、送信先ではなく送信元アドレスをブロードキャスト アドレスとして Ping パケットを送ります。

**影響を受けるシステムが問題のパケットを不正に処理するとはどのような意味ですか?**

送信元アドレスとしてパケットにブロードキャスト アドレスが含まれるのは明らかな不正で、本来であれば NWLink が受信時に破棄していなければなりません。しかし改ざんされたデータを含むパケットの処理をおこなってしまい、リクエスト者ではなくネットワーク全体に返信をしてしまいます。

**ネットワーク全体にレスポンスを送るとどうなりますか?**

2 つの影響があります。まず、コンピュータが Ping の 「送信者」、つまりブロードキャスト アドレスに Ping を返信してしまった場合の影響です。この場合、Ping の返信がネットワーク全体に送信されてしまい、すべてのコンピュータがその処理をすることになります。Ping の返信が 1 台のコンピュータからしかされないのであれば､ネットワーク全体と言っても影響は限定されます。しかし悪意のあるユーザーが、複数のコンピュータにパケットを送る場合もあります。また送信先と送信元両方をブロードキャスト アドレスに設定し、ブロードキャスト アドレスにアドレスが含まれる影響を受ける可能性があるコンピュータがすべて、ネットワーク全体に返信するような攻撃を仕掛けられてしまう場合があります。影響を受ける可能性があるネットワーク上のコンピュータの数によっては､ネットワーク上での処理を著しく妨げる 「ブロードキャスト ストーム」が発生してしまう場合があります。

ネットワーク上にコンピュータが 10 台あると仮定し説明をします。悪意のあるユーザーは、例えばまず改ざんされた Ping パケットを 1 つ、ブロードキャスト アドレスに送ります。それぞれのコンピュータがリクエストを処理し、ブロードキャスト アドレスに返信します。つまり 1 つリクエストを送ることができると、10 倍の数のトラフィックを発生させることができ、それぞれのコンピュータも他のコンピュータのレスポンスを処理しなければならなくなります。もしネットワーク上に影響を受ける可能性があるコンピュータが 1000 台あれば、改ざんされた 1 つの Ping パケットでレスポンスが 1000 発生してしまいます。影響を受ける可能性のあるコンピュータ数が多ければ､ネットワークがレスポンスで異常終了してしまうことがあります。

2 番目は、コンピュータが自身の送信したレスポンスを受け取った場合の影響です(レスポンスはネットワーク上のすべてのコンピュータに返されるからです)。コンピュータは自身の送ったレスポンスを処理しようとし､結果異常終了してしまうことがあります。

**ブロードキャストストームはどれくらい続きますか?**

短い間だけです。レスポンスはさらにレスポンスを誘発しませんし、自身が送信したレスポンスを受け取るとコンピュータは失敗するからです。

**コンピュータを正常な状態に戻すにはどうすればよいですか?**

再起動すれば、正常な状態に回復できます。

**この脆弱性を攻撃するための要件はありますか?**

以下の 3 つの要件があります。

-   Windows 95、98 もしくは 98 Second Edition を実行していなければなりません。
-   システムに IPX をインストールしていなければなりません。上述のとおり、通常 IPX はデフォルトではインストールされていません。
-   悪意のあるユーザーが IPX パケットをコンピュータに送信できなければなりません。

IPX パケットを送信できなければならないという要件によって、この脆弱性が侵害される可能性はかなり限定されます。IPX はルーティングができるプロトコルですが、多くのルーターは、IPX パケットをルートせず破棄するよう設定されています。ルーターにこの設定がされていると、コンピュータは守られます。悪意のあるユーザーが Ping パケットを送信できないということは、この脆弱性を攻撃できないということです。

**更新プログラムは全ての環境で必要ですか?**

いいえ。IPX がインストールされていないコンピュータは、この脆弱性の影響を受けません。また例えインストールされていたとしても、悪意のあるユーザーが IPX Ping パケットを送信できなければならないという要件があります。通常インターネット上のルーターは､IPX パケットを破棄するよう設定されており、これがインターネットを介しての攻撃を妨げます。特に LAN 上のコンピュータが外部コンピュータから攻撃されること、またダイアルアップ接続をしてインターネットに接続しているコンピュータが攻撃されることはありません。

LAN 上にある影響を受ける可能性があるコンピュータは、LAN 内のユーザーから攻撃される場合があります。また DSL もしくはケーブルモデムを使用してインターネットに接続しているコンピュータは､同じサブネット上のユーザーから攻撃される可能性があります。しかしいずれの場合も、ネットワーク管理者が悪意のあるユーザーのネットワークでの動作をモニタでき、ネットワークから追放できます。また LAN 上にコンピュータがある場合でも、ネットワーク上のルーターが IPX パケットを破棄するよう設定されていれば、攻撃される可能性は激減します。

**Windows NT 4.0 と Windows 2000 はこの脆弱性の影響を受けますか?**

いいえ、受けません。

**更新プログラムは全ての環境で必要ですか?**

マイクロソフトでは、IPX が有効になっており、LAN 上で影響をコンピュータを使用していたり、DSL もしくはケーブルモデムでインターネットに接続しているユーザーの方が、この更新プログラムを適用することを推奨します。

**更新プログラムは何を変更するのですか?**

ここで問題となっている改ざんされた情報を含む Ping リクエストを NWLink が無視するよう修正しています。

**どこから更新プログラムを入手できますか?**

誠に申し訳ございませんが、現在のところ日本語版更新プログラムのリリースは予定しておりません。英語版の Windows 98、Windows 98 Second Edition をご利用のお客様は、マイクロソフト セキュリティ情報 (英語情報) MS00-054 からダウンロードすることができます。

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する更新プログラムを開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 MS00-054 と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](http://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。
-   マイクロソフトはサポート技術情報 [265334](http://support.microsoft.com/kb/265334) を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](http://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカルサポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](http://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------

 
この問題を解決するための日本語版更新プログラムのリリースは予定しておりません。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報 :**

-   US マイクロソフトセキュリティ情報（MS00-054）  
    [http://www.microsoft.com/technet/security/bulletin/ms00-054.mspx](http://technet.microsoft.com/security/bulletin/ms00-054)
-   サポート技術情報 （KB） 文書番号 ： 265334  
    [IPX/SPX プロトコルを使用中に受ける可能性のあるサービス拒否攻撃](http://support.microsoft.com/kb/265334)

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。  

*Built at 2014-04-18T01:50:00Z-07:00*
