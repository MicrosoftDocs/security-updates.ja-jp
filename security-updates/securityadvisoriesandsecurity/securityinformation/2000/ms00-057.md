---
TOCTitle: 'MS00-057'
Title: 'マイクロソフト セキュリティ情報 MS00-057 - 重要'
ms:assetid: 'ms00-057'
ms:contentKeyID: 61228223
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-057(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS00-057 - 重要
===============================================

「正規化エラーによる、ファイルへの誤ったアクセス権の適用」 の脆弱性に対する対策
-------------------------------------------------------------------------------

公開日: 2000年8月15日 | 最終更新日: 2000年8月15日

#### 概要 :

マイクロソフトは、Microsoft® Internet Information Server のセキュリティ問題を修正するモジュールをリリースしました。極めて限定された状況でこの脆弱性を利用すると、悪意のあるユーザーは、Web サーバー上にホストされている特定の種類のファイルに対し、さまざまなアクセス権を追加取得できる場合があります。 

**影響を受けるソフトウェアのバージョン :**

-   Microsoft Internet Information Server 4.0
-   Microsoft Internet Information Server 5.0

### 詳細

問題
----

 
ある特定の状況で正規化 (canonicalization) エラーが発生する場合があり、このとき、IIS 4.0 または IIS 5.0 は、特定の種類のファイルに対して誤ったアクセス権を適用することがあります。特定のフォルダ内のアクセス権が制限されているファイルに対して、ある種の誤った URL 形式で要求があった場合、実際に適用されるアクセス権は、そのフォルダに指定されたアクセス権ではなく、そのフォルダの親あるいはそれより上位にあるフォルダのアクセス権となります。この親より上位の階層にあるフォルダに、正しいフォルダよりも高度なアクセス権が指定されている場合、悪意のあるユーザーは、問題のファイルに対し、高度なアクセス権を追加取得できます。

この脆弱性には、次の制限があります。

-   この脆弱性の問題は、ISAPI 拡張を使って実装されるファイルの種類とCGI スクリプトでだけ発生します。この問題は、静的 Web ページでは発生せず、 .exe、.doc、.bat など Web 以外のファイルで発生することもありません。
-   この問題は、Web フォルダ構造とサーバー上の物理フォルダ構造がミラーリング状態になっているサーバーでしか発生しません。
-   この脆弱性を利用して、任意のアクセ ス権を選択することはできません。取得できるアクセス権は、親フォルダかそれより上位のフォルダで指定されているアクセス権に限定されます。
-   この脆弱性により影響を受ける可能性のあるサーバーに対し、列挙およびファイル位置の特定は行えません。

よく寄せられる質問
------------------

 
**マイクロソフトセキュリティ情報 MS00-057 はどのような内容の通知ですか?**

マイクロソフト セキュリティ情報 MS00-057 は、Microsoft® Internet Information Server のセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことをお客様にお知らせするものです。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**この脆弱性はどれくらいの範囲に影響を与えますか?**

Web サーバー上のファイルに不正なアクセス権を設定できてしまうことがあります。不正なアクセス権を利用し、本来であれば権限のない、ファイルの読み取りや実行などの操作ができてしまうことがあります。

なお、この脆弱性には以下のような制限があります。これによりこの脆弱性がおよぶ範囲は限定されます。

-   特定のファイル形式にしか影響をおよぼすことはできません。特に HTML など静的なコンテンツに影響がおよぶことはありません。
-   Web フォルダの構造とサーバー上の物理フォルダの構造が完全にミラーリングされているサーバーでしか発生しません。
-   任意のアクセス権は設定できません。親フォルダかそれよりも上位のフォルダに対して設定されているアクセス権しか設定できません。
-   この脆弱性を利用して、サーバーのどこにファイルが保存されているかということを特定することはできません。

**この脆弱性の原因は何ですか?**

CGI スクリプトや ISAPI エクステンションに影響を与える正規化 (canonicalization) エラーが原因です。特定の方法で改ざんされたURL が、CGI スクリプトもしくは ISAPI からマップされているファイルをリクエストすると、それらに対して不正なアクセス権を適用できてしまうことがあります。その際、適用されるアクセス権はリクエストされたファイルに設定されているものではなく、そのファイルの親よりも上位の階層のフォルダに適用されているものになります。なお、仮想フォルダではなく物理フォルダに問題のファイルが存在する場合のみ、この脆弱性は発生します。

**正規化とは何ですか?**

正規化とは、同じものを示す複数の名前を、正規名 (canonical name) と呼ばれる、標準的な 1 つの名前に解決するためのプロセスです。例えば c:\\dir\\test.dat も test.dat も ..\\..\\test.dat もあるコンピュータでは同じファイルを指しているとします。正規化とは、それらの名前を c:\\dir\\test.dat などにマップさせるプロセスです。

**IIS の正規化ルーチンで何が問題なのですか?**

特別に改ざんされた URL を介して特定の形式のファイルが呼び出されると、正規化の処理が一部不正になってしまうことが問題です。ファイルは正しいものが検出されますが、不正な場所に保存されていると結論づけてしまい、結果違うフォルダに対して設定されているアクセス権を適用してしまいます。

**どのファイルのアクセス権が適用されてしまいますか?**

URL のどの部分が改ざんされるかによります。URL 内の問題のファイルの親もしくはそれより上位の任意の親フォルダに改ざんされた情報を挿入することで、改ざんをおこなった部分のフォルダに設定されているアクセス権が適用されてしまいます。

なお、悪意のあるユーザーは望む任意のフォルダのアクセス権を取得できてしまう訳ではありません。例えばファイル構造で兄弟関係にあるファイルのアクセス権や、全く関係のないフォルダのアクセス権を得ることはできません。選択した直系の親以上のフォルダに設定されているアクセス権しか取得できません。

**この脆弱性を利用してファイルに任意のアクセス権を適用することはできますか?**

いいえ、この脆弱性を利用してファイルに任意のアクセス権を適用することはできません。もしファイルの親よりも上位の階層のフォルダに望むアクセス権があればそれを適用することはできますが、それ以外はできません。

**どのような形式のファイルがリクエストされると脆弱性が発生しますか?**

CGI スクリプトもしくは ISAPI エクステンションを使用して実装されているファイル形式がリクエストされた場合、脆弱性が出ることがあります。ISAPI からマップされているファイル形式として最も良く知られているのは、おそらく .asp です。しかしこれ以外にも、ユーザーは任意の ISAPI エクステンションを作成することができ、それらのファイル形式も攻撃を受けるファイル対象となる場合があります。

なお .htm や .jpg や .gif などのような静的なファイル形式はこの脆弱性の影響を受けません。同様に Web 用のファイル形式でない .doc や .exe や .bat もこの脆弱性の影響を受けることはありません。

**ではCGI スクリプトや ISAPI からマッピングされているすべてのファイルで影響がでるのですか?**

いいえ、他に制限があります。CGI スクリプトや ISAPI からマップされているファイルは、仮想フォルダではなく**物理フォルダに保存されていなければなりません。**

**物理フォルダと仮想フォルダとは何ですか?**

「物理」 フォルダと 「仮想」 フォルダとは、Web サイトで表示されるフォルダの論理的な構造が、実際のサーバー上でのフォルダ構造と同じであるかどうかということです。Web サーバー上にある c:\\inetpub\\wwwroot\\test1\\test2\\test.asp というファイルを例にとり、説明します。Web サーバーから表示するフォルダ構造は、実際の保存場所を表示するかどうか、管理者が決定できます。

例えば管理者が test.aspを表示するために、ディレクトリを www.microsoft.com/test1/test2/test.asp に設定したとします。この場合、論理的なフォルダ構造が、サーバーのファイル システムをミラーしていることになります。これが物理フォルダで、このように設定されている場合、脆弱性の影響を受けることがあります。また管理者が test.asp を表示するために、ディレクトリを www.microsoft.com/windowsnt/information/test.asp と表示されるように設定したとします。これが仮想フォルダで、このような設定の場合、脆弱性の影響を受けることはありません。

**悪意のあるユーザーは何を実行できますか?**

物理フォルダ上にある問題の形式のファイル (CGI スクリプトもしくは ISAPI からマップされたファイル) が特定できると、この脆弱性を悪用し、本来のアクセス権ではなく、親もしくはそれよりも上位の階層の任意のフォルダのアクセス権を取得できてしまいます。具体的にどのような攻撃を仕掛けることができるかは、親より上位のフォルダに設定されたアクセス権に依存します。

具体的な例として、悪意のあるユーザーがファイルの実行しか許可されていない test2 フォルダに含まれる www.microsoft.com/test1/test2/test.asp というファイルをリクエストすると、test2 フォルダに設定されているアクセス権ではなく、test1 フォルダに設定されている読み取り権限が適用されてしまい test.asp を読むことができてしまうことがあるということです。しかしtest1 のアクセス権が test2と同じとき、攻撃をしかけることができても、アクセス権を追加することはできません。

**悪意のあるユーザーは Web サーバーを占拠できますか?**

いいえ、Web サーバー上にあるファイルの不正なアクセス権しか取得できません。サーバーのシステム ファイルや構成情報を入手することはできません。

**親もしくはそれよりも上位のフォルダに設定されているアクセス権を知ることができますか?**

いいえ、その都度攻撃をおこない、アクセス権を確認しなければなりません。

**問題のファイルが存在するかどうかということはどのように確認しますか?**

フォルダにどのようなファイルが含まれるか確認できるアクセス権でない限り、ファイルの存在を確認できません。すなわち、この脆弱性が存在しても www.microsoft.com/test1/test2/test.asp 自体があるということが確認できず、別の方法で存在を確認できなければなりません。

**攻撃を監査ログで確認できますか?**

はい。監査は通常どうりおこなわれますので、管理者は悪意のあるユーザーがなにをおこなったかを正確に把握できます。

**更新プログラムはなにを修正しますか?**

ファイルに対して常に正しいアクセス権が設定されるよう、正規化エラーを修正します。

**どこから更新プログラムを入手できますか?**

マイクロソフト セキュリティ情報 MS00-057 をご覧ください。

**更新プログラムはどのように使用するのですか?**

サポート技術情報 [269862](http://support.microsoft.com/kb/269862) には、お客様のサイトに更新プログラムを提供するための詳細な情報が記載されています。

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する更新プログラムを開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 MS00-057 と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](http://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。
-   マイクロソフトはサポート技術情報 [269862](http://support.microsoft.com/kb/269862) を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](http://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカルサポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](http://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------

 
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft IIS 4.0:  
    この問題に対する更新プログラムは Windows NT 4.0 のセキュリティ ロールアップ パッケージ (SRP) に含まれています。  
    個別の更新プログラムよりもセキュリティ ロールアップ パッケージを適用することをお勧めします。  
    NT 4.0 のセキュリティ ロールアップ パッケージは次のリンクから入手してください。  

    [299444](http://support.microsoft.com/kb/299444) Post Windows NT 4.0 SP6a セキュリティ ロールアップ パッケージ (SRP)

    なお、個別の更新プログラムは次のリンクから入手することができます。  
    <http://www.microsoft.com/ntserver/nts/downloads/critical/q269862/default.asp>

-   Microsoft IIS 5.0:  
    この問題に対する修正は Windows 2000 サービスパック 2 に含まれております。最新の Windows 2000 サービスパックについては次のリンクから入手してください。  
    [http://www.microsoft.com/downloads/details.aspx?FamilyID=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&DisplayLang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&displaylang=ja)  

    また、この問題に対する修正は [MS01-026](http://technet.microsoft.com/security/bulletin/ms01-026) の修正モジュールに含まれています(NEC PC98 シリーズを除く)。MS01-026 には、それまでの IIS 関連の修正がすべて含まれていますので、MS01-026 のご利用をお勧めします。  

    なお、個別の日本語版更新プログラムは下記のサイトからダウンロードできます。  
    <http://www.microsoft.com/windows2000/downloads/critical/q269862/default.asp>

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報 :**

-   US マイクロソフトセキュリティ情報（MS00-057）  
    [http://www.microsoft.com/technet/security/bulletin/ms00-057.mspx](http://technet.microsoft.com/security/bulletin/ms00-057)
-   サポート技術情報 （KB） 文書番号 ： 269862  
    [正規化エラー問題の更新プログラムのリリース](http://support.microsoft.com/kb/269862)

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
