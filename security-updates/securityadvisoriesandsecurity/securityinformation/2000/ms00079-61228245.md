---
TOCTitle: 'MS00-079'
Title: 'マイクロソフト セキュリティ情報 MS00-079 - 緊急'
ms:assetid: 'ms00-079'
ms:contentKeyID: 61228245
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms00-079(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS00-079 - 緊急
===============================================

「ハイパーターミナルのバッファ オーバーフロー」 の脆弱性に対する対策
--------------------------------------------------------------------

公開日: 2000年10月26日 | 最終更新日: 2002年3月14日

#### 概要 :

2000 年 10 月 18 日、マイクロソフトはこのセキュリティ情報の最初のバージョンをリリースし、Microsoft® Windows® 98、Windows 98 Second Edition、Windows Me および Windows 2000 に同梱されている HyperTerminal アプリケーションに存在するセキュリティ上の脆弱性を排除する更新プログラムが入手可能になったことをお知らせしました。2001 年 5 月 24 日、このセキュリティ情報を再リリースし、この脆弱性と、後に確認された変種を修正する新しい更新プログラムが入手可能になったことをお知らせしました。元の脆弱性とその変種の影響の範囲は同じです。特定の状況下で、これら 2 つの脆弱性のために、悪意のあるユーザーは他のユーザーのシステムで任意のコードを実行することができるようになります。これにより、悪意のあるユーザーが他のユーザーのシステムでデータを侵害したり、任意のコードを実行することができます。

**影響を受けるソフトウェアのバージョン** **:**

-   Microsoft Windows 98 および Windows 98SE
-   Microsoft Windows Me
-   Microsoft Windows NT 4.0
-   Microsoft Windows 2000

### 詳細

問題
----

<span></span>
The HyperTerminal アプリケーションは、Windows 98、98SE、Windows ME、Windows NT 4.0 および Windows 2000 の全てのバージョンに既定でインストールされる通信ユーティリティです。このアプリケーションは、2 つの未チェックのバッファを含んでいます。これらのバッファにより、攻撃者の選択したコードが他のユーザーのマシンで実行される可能性があります。

-   問題となっているバッファの 1 つは Telnet URL を処理するコードのセクションにあります。ユーザーが不正な Telnet URL を含む HTML 形式の電子メールを開き、HyperTerminal が既定の Telnet クライアントとして設定されている場合、バッファ オーバーランを引き起こします。HyperTerminal はWindows 98、98SE および ME で規定の Telnet クライアントです。しかし、Windows 2000 では既定の Telnet クライアントではありません。
-   もう 1 つのバッファはセッション ファイルを処理するコードのセクションに存在しています。このセッション ファイルにより、 HyperTerminal ユーザーは接続方法や宛先ホストなどのセッション パラメータを指定することができます。ユーザーが不正な情報を含むセッション ファイルを開く場合、そのファイルがバッファ オーバーランを引き起こします。

HyperTerminal はマイクロソフトの一部の製品に同梱されますが、サードパーティによって開発されたアプリケーションです。この脆弱性およびフル バージョン製品である HyperTerminal Private Edition の更新プログラムの関連情報については、Hilgrave Inc の Web サイト [www.hilgraeve.com](http://www.hilgraeve.com/) をご覧下さい。

よく寄せられる質問
------------------

<span></span>
**マイクロソフトセキュリティ情報** **MS00-079** **はどのような内容の通知ですか?**

マイクロソフト セキュリティ情報 MS00-079 は、Microsoft® Windows 98、98SE、Windows Me、および Windows 2000 のセキュリティ上の脆弱性を排除する更新プログラムがリリースされたことを、お客様にお知らせするものです。マイクロソフトでは、お客様の情報の保護に全力を挙げて努めております。この通知で、お客様に脆弱性の詳細とその対策をお知らせします。

**このセキュリティ情報はなぜ再リリースされたのですか?**

このセキュリティ情報の最初のバージョンがリリースされた後、マイクロソフトは最初の更新プログラムに関する問題を発見し、それを修正するために取り消しました。修正中に、ハイパー ターミナルに影響を及ぼすほかの脆弱性が確認されました。このため、新しい脆弱性に対する修正を更新プログラムに追加しました。

**ハイパーターミナルとは何ですか?**

ハイパーターミナルは、モデムかネットワーク カードを使用して、他のマシン、インターネット telnetサイト、電子掲示板 (BBSs)、オンライン サービスやホスト コンピュータと通信するのに用いられるプログラムです。
ハイパーターミナルは Microsoft 製品の一部の製品に同梱されていますが、サードパーティー (Hilgraeve, Inc.) によって開発されたアプリケーションです。この脆弱性およびフル バージョン製品である HyperTerminal Private Edition の更新プログラム関連情報については、Hilgraeve, Inc. の Web サイト [http://www.hilgraeve.com](http://www.hilgraeve.com/) (英語情報) を参照してください。

**この更新プログラムにより排除される** **2** **つの脆弱性とは何ですか?**

この更新プログラムはハイパー ターミナルに影響を及ぼす 2 つの脆弱性を排除します。

-   このセキュリティ情報の最初のバージョンで説明された脆弱性
-   このセキュリティ情報の最初のバージョンがリリースされた後に発見された新しい脆弱性

**最初の脆弱性でどのようなことが起こる可能性がありますか?**

ユーザーが、特に不正な Telnet URL を含む HTML メールを開いた場合、メール作成者がユーザーのシステム上で任意のコードを実行することができます。これにより、攻撃者はユーザーのコンピュータで、データの作成、削除、変更、Web サイトとの通信、ハード ドライブの再フォーマットなど、ユーザーが実行することができる任意の操作を行うことができる可能性があります。
ハイパーターミナルは Windows 95、Windows 98、Windows Me のデフォルトの Telnet クライアントですが、Windows 2000 のデフォルトの Telnet クライアントではありません。ですから、Windows 2000 ユーザーでハイパーターミナルをデフォルトの Telnet クライアントにする設定を行っていない場合は、この脆弱性による危険はありません。

**この脆弱性の原因は何ですか?**

ハイパーターミナル アプリケーションにおけるバッファ オーバーフローにより起こります。特に不正な Telnet URL により、任意のコードがユーザーのシステム上で実行されることがあります。特に不正な Telnet URL を含む不正な電子メールの作成者は、ユーザーがその HTML 電子メールを開けてオーバーフローを引き起こすようにしむける必要があります。

**ハイパーターミナルとは何ですか?**

ハイパーターミナルは、モデムかネットワーク カードを使用して、他のマシン、インターネット telnetサイト、電子掲示板 (BBSs)、オンライン サービスやホスト コンピュータと通信するのに用いられるプログラムです。
ハイパーターミナルは Microsoft 製品の一部の製品に同梱されていますが、サードパーティー (Hilgraeve, Inc.) によって開発されたアプリケーションです。この脆弱性およびフル バージョン製品である HyperTerminal Private Edition の更新プログラム関連情報については、Hilgraeve, Inc. 社の Web サイト [http://www.hilgraeve.com](http://www.hilgraeve.com/)を参照してください。

**ハイパーターミナルは** **NT4** **にも同梱されています。なぜこのバージョンでは、この脆弱性の問題がないのですか?**

Windows NT4 に同梱されているハイパーターミナル クライアントには TCP/IP の接続方法が含まれていません。 そのため NT4 ハイパーターミナル クライアントはデフォルトの Telnet クライアントとして設定されないので、提供された Telnet URL に応答して作動し始めることはありません。

**Windows 2000** **上でハイパーターミナルをデフォルトの** **Telnet** **クライアントとして登録するには、どうしたらよいですか?**

ハイパーターミナル アプリケーションが初めて起動するとき、ハイパーターミナルは自動的に自身をデフォルトの Telnet クライアントとして登録します。いったんデフォルトの Telnet クライアントとして登録されると、ブラウザまたは HTML 電子メール経由で telnet URL を呼び出し、ハイパーターミナル アプリケーションを作動し始めます。

**いったんハイパーターミナルをデフォルトの** **Telnet** **クライアントとして登録した場合、どのようにして登録の取り消しをすればよいですか?**

デフォルトの telnet クライアントは、下記のレジストリ キーで参照することができます。この例では、ハイパーターミナルがデフォルトのクライアントであることを示しています。
HKEY\_Classes\_Root/telnet/shell/open
command:REG\_SZ: C:\\Program Files\\Windows NT\\hypertrm.exe /t %1
(システムドライブが C:\\ である場合.)
コマンドライン クライアントを元に戻すには、オープン キーを以下の値に設定してください。
command:REG\_SZ: rundll32.exe url.dll,TelnetProtocolhandler %1

**ビルトインの** **Telnet** **クライアントには、この脆弱性の問題はありますか?**

Windows 2000 のデフォルトの Telnet クライアントは、コマンドライン クライアントである "telnet.exe" です。コマンドライン クライアントはこの脆弱性の影響を受けません。

**新しい脆弱性でどのようなことが起こる可能性がありますか?**

最初の脆弱性のように、新しい脆弱性により、攻撃者はほかのユーザーのマシンでコードを実行することができる可能性があります。しかし、この脆弱性を利用するためのシナリオはさらに困難です。攻撃者は不正なファイルをユーザーに送るだけでなく、ユーザーにそれを開くよう誘導する必要があります。しかし、ファイルを自動的に開くことはできません。

**何が原因で起こりますか?**

この脆弱性はセッション ファイルを読み取るソフトウェアの一部が、読み取るデータの文字列の長さを正しくチェックしないために起こります。不正なデータを含むセッション ファイルを作成し、ユーザーにそのファイルを開くよう誘導することにより、攻撃者は選択したコードをユーザーのマシンで実行することができる可能性があります。

**セッションファイルとは何ですか?**

セッション ファイルは特定のハイパー ターミナル セッションに関連するすべてのパラメータ (例 : 通信パラメータ、宛先のホストなど) を保持するものです。セッション ファイルを開くことにより、ユーザーは自動的にすべてのハイパー ターミナル パラメータをファイルで指定されたパラメータに設定することができます。

**ハイパーターミナルがセッションファイルを処理する方法の何が問題になっていますか?**

ハイパー ターミナルはセッション ファイルから入力を読み取る時、その入力の長さを正しくチェックしません。これにより、バッファ オーバーラン攻撃が可能になることがあります。

**この脆弱性を利用して攻撃者は何ができますか?**

攻撃者が不正なデータを含むセッション ファイルを作成すると、ハイパー ターミナルがファイルを処理しようとする時に、ハイパー ターミナルでバッファ オーバーランが発生する場合があります。これにより、攻撃者はユーザーのマシンでコードを実行することができる可能性があります。このようなコードはユーザーが行うことのできる操作を実行することができます。

**攻撃者はセッションファイルを強制的に自動で開くことができますか?**

いいえ、できません。この点はこの脆弱性による影響の範囲を著しく制限します。ファイルを作成し、それをユーザーに送った後でも、ユーザーに実際にそのファイルを開くよう誘導するためには、攻撃者は依然としてソーシャル エンジニアリングに頼る必要があります。この攻撃により、ユーザーの承認なしでファイルを強制的に開くことはできません。

**更新プログラムは何を変更するのですか?**

この更新プログラムはハイパー ターミナルで正しくバッファがチェックされるようにすることにより、この脆弱性を排除します。

**どのような場合に更新プログラムを適用する必要がありますか?**

言及されたオペレーティング システムを起動しているユーザーには、この更新プログラムをインストールすることが推奨されます。

**更新プログラムはどのように使用するのですか?**

サポート技術情報 [274548 (Win9x/Me)](http://support.microsoft.com/kb/274548) と [276471 (Win2K)](http://support.microsoft.com/kb/276471)には、お客様のサイトに更新プログラムを適用するための詳細な情報が記載されています。

**どこから更新プログラムを入手できますか?**

マイクロソフト セキュリティ情報 MS00-079 をご覧ください。

**この問題に対してマイクロソフトはどのような対応をしていますか?**

-   マイクロソフトは、この脆弱性を排除する更新プログラムを開発しました。
-   マイクロソフトは、セキュリティ上の脆弱性の詳細とその対策をお客様にご理解いただくために、セキュリティ情報 MS00-079 と、この faq を提供しています。
-   マイクロソフトは、マイクロソフト社の最新のセキュリティ情報を無料でご購読いただける[マイクロソフト プロダクト セキュリティ 警告サービス](http://technet.microsoft.com/ja-jp/security/dd252948.aspx) にて、購読の登録をされているお客様に、セキュリティ情報の通知を行っています。
-   マイクロソフトは、[274548 (win9x/me)](http://support.microsoft.com/kb/274548) と [276471 (win2k)](http://support.microsoft.com/kb/276471) を公開し、このセキュリティ上の脆弱性と更新プログラムの詳細と説明しています。

**推奨するセキュリティ設定の詳細情報はどこで入手できますか?**

マイクロソフトが提供するセキュリティ情報の詳細は、弊社の[セキュリティ](http://technet.microsoft.com/ja-jp/security/default.aspx)の Web サイトから入手してください。

**テクニカルサポートを受けるにはどこに問い合わせればよいですか?**

マイクロソフトの製品に関するテクニカルサポートは、[電話番号とサポートオプションのサイト](http://support.microsoft.com/gp/cntactms)を参照してください。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、以下のサイトからダウンロードできます。

-   Windows 98 および 98SE:
    [http://download.microsoft.com/download/win98/Update/12395/W98/
    JA/274548JPN8.EXE](http://download.microsoft.com/download/win98/update/12395/w98/ja/274548jpn8.exe)
-   Windows Me:
    [http://download.microsoft.com/download/winme/Update/12395/WinMe/
    JA/274548JPNM.EXE](http://download.microsoft.com/download/winme/update/12395/winme/ja/274548jpnm.exe)
-   Windows NT 4.0: (Windows NT 4.0 [Service Pack 6a](http://www.microsoft.com/japan/ntserver/downloads/sp6a.mspx) を動作しているシステムにインストールすることができます。)
    [http://www.microsoft.com/downloads/details.aspx?FamilyId=CF082F42-B556-4B49-AA29-85D3AFE23E41&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=cf082f42-b556-4b49-aa29-85d3afe23e41&displaylang=ja)
    -   PC/AT 互換機用
        ダウンロード先のリストから Japanese Language Version を選択してください。
    -   NEC PC-9800 シリーズ用
        ダウンロード先のリストから Japanese NEC Language Version を選択してください。
-   Windows 2000
    この問題に対する修正は Windows 2000 Service Pack 3 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。
    [http://www.microsoft.com/downloads/details.aspx?FamilyID=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&DisplayLang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&displaylang=ja)
    (Windows 2000、Service Pack 1、および Service Pack 2 にインストールすることができます。)
    -   PC/AT 互換機用
        ダウンロード先のリストから Japaneseを選択してください。
    -   NEC PC-9800 シリーズ用
        ダウンロード先のリストから Japanese NECを選択してください。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS00-079）
    [http://www.microsoft.com/technet/security/bulletin/ms00-079.mspx](http://technet.microsoft.com/security/bulletin/ms00-079)
-   サポート技術情報 （KB） 文書番号 ： 274548
    [「ハイパーターミナルのバッファ オーバーフロー」の脆弱性対策](http://support.microsoft.com/kb/274548)
-   サポート技術情報 （KB） 文書番号 ： 276471
    [Windows 2000 "ハイパーターミナルのバッファオーバーフロー"の脆弱性 修正モジュール](http://support.microsoft.com/kb/276471)

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
