---
TOCTitle: 'MS01-011'
Title: 'マイクロソフト セキュリティ情報 MS01-011 - 緊急'
ms:assetid: 'ms01-011'
ms:contentKeyID: 61228350
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms01-011(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS01-011 - 緊急
===============================================

ドメイン コントローラへの無効なリクエストが CPU を使い果たす
------------------------------------------------------------

公開日: 2001年2月21日 | 最終更新日: 2001年8月14日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**  
Microsoft® Windows® 2000 ドメイン コントローラを使用しているシステム管理者

**脆弱性の影響** **:**  
サービス拒否

**推奨する対応策** **:**  
ドメイン コントローラに更新プログラムをインストールして下さい。

**影響を受けるソフトウェアのバージョン** **:**  

-   Microsoft® Windows® 2000 Server
-   Microsoft Windows 2000 Advanced Server
-   Microsoft Windows 2000 Datacenter Server

### 詳細

問題
----

**技術的な説明** **:**  
全ての Windows 2000 ドメイン コントローラで動作するコア サービスにはある特定の無効なサービス リクエストを処理する方法に問題があります。（他のマシンで動作するサービスは該当しません。）このサービスはここで問題になっているリクエストが無効であることを確認し、単にそのリクエストを破棄して処理しなければなりません。しかし実際には、サービスはリソースを消耗する処理を行い、応答を送信します。

攻撃者が該当するマシンに特定の無効なリクエストのストリームを連続して送信すると、マシンのほとんど、または全ての CPU 使用可能容量が消費されます。これによりドメイン コントローラのサービスに対するリクエストの処理が遅くなります。または全く処理ができなくなることもあります。そして、マシンが処理できる新しいログオン数や Kerberos チケットの発行数が制限されます。

**脆弱性を緩和する要因** **:**

-   リクエストのストリームが停止されると、マシンは自動的に通常の処理を再開します。
-   理論的には攻撃者はこの脆弱性を利用してネットワーク ユーザーに対するサービスを完全に拒否することができますが、実際には攻撃者が利用可能な CPU リソースの 75% 以上を消費することはめったにありません。
-   既にログオンし、以前発行されたチケットを使用しているユーザーはこのドメイン コントローラの脆弱性による影響は受けません。
-   ドメインに多数のドメイン コントローラがある場合、影響を受けていないマシンが他のマシンのロードを引き続き行います。
-   通常のセキュリティ対策が講じられていれば、ファイアウォールや他の対策によりインターネット ユーザーは、直接ドメイン コントローラに行われるリクエストに対し保護されています。

**脆弱性識別番号** **:**
[CAN-2001-0018](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0018)

よく寄せられる質問
------------------

**どのようなことが起こる可能性がありますか?**

これは[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。ドメイン コントローラに特定の無効なパケットのストリームを連続して送信することにより、攻撃者はマシンのほとんど、または全てのリソースを消費することができます。これはユーザーの認証を妨害する可能性もあります。最悪の場合、最終結果として新規ユーザーがログオンできなくなります。また、ログオンしたユーザーがネットワーク リソースを使用できなくなります。

この攻撃の影響は永続的なものではありません。パケットのストリームが停止されると、通常の処理を再開します。ドメインに多数のドメイン コントローラがある場合、他のマシンは該当するマシンのロードの一部を引き続き行います。また、最善の対策が講じられていれば、この脆弱性を利用できるのはネットワーク内のユーザーのみとなります。この攻撃で使用されるポートはファイアウォールでブロックされている必要があります。

**何が原因で起こりますか?**

この脆弱性は Windows 2000 ドメイン コントローラが使用しているサービスの 1 つがリクエストの処理を行う前に、それらを適切に確認しないために起こります。サービスは無効なリクエストを単に破棄する代わりに処理を試行します。この処理は非常にリソースを消耗します。

**攻撃者はこの脆弱性を利用して何ができますか?**

ドメイン コントローラに特別に選択された無効なリクエストのストリームを連続して送信することにより、攻撃者はマシンでのサービスを中断させることができます。具体的な例として、無効なリクエストへの応答のためにマシンにリソースのほとんど、または全てのリソースを使用させることができます。これがマシンの他の有効なリクエストへの応答を遅らせたり、全く応答ができなくなる原因となります。

**このような方法でドメインコントローラのリソースが独占された場合、どのような影響があるのですか?**

ドメインに 1 台のドメイン コントローラしかなく、攻撃者がそのマシンのリソースを 100% 使用してしまう最悪の場合を考えてみましょう。このような状況で、この脆弱性を利用した攻撃が成功した場合、主な影響としてドメイン コントローラが新規ユーザーのログインを妨げます。そして、マシンは Active Directory に対するクエリを実行できなくなります。

**この攻撃は以前ログオンしたユーザーによるネットワークリソースの使用を妨害しますか?**

いいえ。Windows 2000 はデフォルト認証プロトコルとして [Kerberos](http://technet.microsoft.com/ja-jp/library/bb742516.aspx) を使用しています。Kerberos では、ドメイン コントローラはネットワーク リソースが使用される都度、認証を行うわけではありません。その代わり、ユーザーが初めて特定のリソースをリクエストする時に、再使用可能なチケットを供給します。その後ユーザーが特定のリソースの使用を必要とする時に、ドメインコントローラは認証プロセスに関わる必要がありません。つまり、攻撃が成功しても、ユーザーは既にチケットを取得しているリソースに関しては使用を続けることができます。しかし、他のリソースのための新しいチケットを取得することはできません。

**この脆弱性を利用してドメインコントローラを異常終了させることはできますか?**

いいえ。この脆弱性を利用してマシンや該当するサーバーを異常終了させることはできません。これはリソース消費の影響を受けたサービス拒否攻撃です。

**この脆弱性を利用して攻撃者は常にマシンの全てのリソースを独占することができますか?**

いいえ、できません。マイクロソフトで試験を行った結果、CPU 使用率を 75% 以上にすることはほとんどできませんでした。

**ドメインに数台のドメインコントローラがある場合はどうですか?**

多数のドメイン コントローラのあるドメインでは、マシンは共同で作業を行い、作業量を動的に移動しています。1 つのドメインにあるドメイン コントローラの台数が多いほど 1 台の損失は大きくありません。

**問題を含むサービスを単に無効にすることはできないのですか?**

いいえ、できません。該当するサービスはドメイン コントローラのコア サービスの 1 つであるため、無効にすることはできません。

**この問題はセキュリティ上の脆弱性というよりもフラッディング攻撃のようですが?**

この脆弱性とフラッディング攻撃には類似点がいくつかあります。例えば、この攻撃は攻撃者が該当するマシンにリクエストの送信を中止するまで続きます。一般的に、マイクロソフトはフラッディング攻撃のための更新プログラムはリリースしません。しかし、今回の問題は次の 2 つの理由により脆弱性として取り扱うことになりました。

-   この問題には通常のフラッディング攻撃にはない要因があります。特に、フラッディング攻撃は通常、処理するためにリソースを消耗する正当なリクエストを伴います。この場合、リクエストは無効で、サービスはその無効なリクエストを検査し、破棄しなければなりません。
-   この脆弱性の影響を受けるマシンはドメイン コントローラです。ドメイン コントローラはネットワークで中心的な役割を担っているため、警告ではなく更新プログラムを作成することにしました。

**この脆弱性はインターネットから利用することができますか?**

通常のセキュリティ対策が講じられていれば、この脆弱性はネットワーク内でしか利用することはできません。一般的に、ドメイン コントローラはネットワーク エッジ マシンとして使用されません。そしてファイアウォールの使用により、ネットワーク外のユーザーがドメイン コントローラに対し直接リクエストを行うことを防ぐことができます。これらの対策が講じられていれば、インターネット ユーザーは該当するサービスに無効なリクエストを送信することはできません。結果として、インターネット ユーザーがこの脆弱性を利用することはできません。

**この脆弱性は** **Windows NT® 4.0** **ドメインコントローラに影響を及ぼしますか?**

いいえ。Windows 2000 ドメイン コントローラだけがこの脆弱性の影響を受けます。

**この脆弱性は** **Windows 2000** **ワークステーションやメンバサーバーに影響を及ぼしますか?**

いいえ。この脆弱性はドメイン コントローラだけに影響を及ぼします。

**誰が更新プログラムを適用する必要がありますか?**

マイクロソフトはお客様に Windows 2000 ドメイン コントローラにこの更新プログラムを適用することを推奨します。

**更新プログラムは何を修正しますか?**

この更新プログラムは該当するサービスがここで問題となっているリクエストを無効として正確に取り扱うようにしてこの脆弱性を排除します。

更新プログラム
--------------

この問題に対する修正は Windows 2000 Service Pack 3 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。  
[http://www.microsoft.com/downloads/details.aspx?FamilyID=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&DisplayLang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&displaylang=ja)

なお、個別の更新プログラムはセキュリティ情報 [MS01-036](http://technet.microsoft.com/security/bulletin/ms01-036) で提供されている更新プログラムに含まれました。

#### この更新プログラムに関する追加情報

**対象プラットフォーム** **:**  
この更新プログラムは、Windows 2000、Service Pack 1 および Service Pack 2 を動作しているシステムにインストールすることができます。

**今後リリースされるサービスパックに含まれる更新プログラム** **:**    
この問題を解決する更新プログラムは Windows 2000 Service Pack 3 に含まれています。

**更新プログラムのインストールの確認** **:**    
このセキュリティ情報で以前提供されていた更新プログラムをインストールした場合のみ、下記の情報をご確認ください。セキュリティ情報 MS01-036 で提供されている (この問題に対する修正が含まれた) 更新プログラムをインストールする場合、MS01-036 で提供されている情報をご確認ください。

-   マシンに更新プログラムがインストールされたか確認するには、マシンに以下のレジストリ キーが作成されたことを確認してください。 : HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP2\\Q287397  
-   各ファイルを確認するには、以下のレジストリ キーにある日時とバージョン情報を使用してください。 :  
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP2\\Q287397\\Filelist

**警告** **:**  
なし

**他のセキュリティ更新プログラムの入手先** **:**  
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS01-011）  
    [http://www.microsoft.com/technet/security/bulletin/ms01-011.mspx](http://technet.microsoft.com/security/bulletin/ms01-011)
-   サポート技術情報 （KB） 文書番号 ： 287397  
    [ドメイン コントローラへの無効なリクエストがサービス拒否を発生させる](http://support.microsoft.com/kb/287397)

**更新履歴** **:**

-   2001/2/21: このセキュリティ情報ページを公開しました。
-   2001/2/23: この問題に対する日本語版更新プログラムを公開しました。
-   2001/3/12: この問題に対する日本語版 KB を公開しました。
-   2001/8/14: このセキュリティ情報を更新し、この問題に対する修正がセキュリティ情報 MS01-036 で提供されている更新プログラムに含まれていることをお知らせしました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*