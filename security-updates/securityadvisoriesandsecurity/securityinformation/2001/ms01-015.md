---
TOCTitle: 'MS01-015'
Title: 'マイクロソフト セキュリティ情報 MS01-015 - 重要'
ms:assetid: 'ms01-015'
ms:contentKeyID: 61228357
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms01-015(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS01-015 - 重要
===============================================

Internet Explorer がキャッシュされたコンテンツの場所を漏えいしてしまう
----------------------------------------------------------------------

公開日: 2001年3月9日 | 最終更新日: 2003年5月12日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**  
Microsoft® Internet Explorer を使用しているユーザー

**脆弱性の影響** **:**  
ユーザーが攻撃者の Web サイトを訪問したり、攻撃者が送信した HTML 電子メールを開いた場合、攻撃者が選択したコードが実行されてしまいます。この更新プログラムは、より限られた状況で利用される恐れのある他の 3 つの脆弱性も排除することができます。

**推奨する対応策** **:**  
下に記載されているInternet Explorer と Windows Script Host の更新プログラムを適用してください。Services for Unix 2.0 を使用している場合のみ Telnet 起動更新プログラムを適用してください。

**影響を受けるソフトウェア** **:**  

-   Microsoft Internet Explorer 5.01
-   Microsoft Internet Explorer 5.5
-   Microsoft Windows Script 5.1
-   Microsoft Windows Script 5.5

### 詳細

問題
----

**技術的な説明** **:**  
Internet Explorer のセキュリティ アーキテクチャでは、キャッシュ機構が提供されており、ユーザーのローカル マシン上にダウンロードして処理をする必要があるコンテンツを格納するために使用されます。キャッシュをする目的は、キャッシュされたコンテンツの物理的な位置を分かりにくくし、Web ページや HTML 形式の電子メールが Internet Explorer のセキュリティ アーキテクチャを介して情報にアクセスできるようにするためです。これにより、情報の使用が適切に制限されます。

この脆弱性はWeb ページやHTML 形式の電子メールがキャッシュされたコンテンツの物理的な場所を知ることができるために発生します。攻撃者はこの情報を悪用し、キャッシュされたコンテンツがローカル コンピュータ ゾーンで開かれるようにする可能性があります。これにより、実行可能ファイルへのショートカットを含むコンパイル済み HTML ヘルプ (.CHM) ファイルを起動させることができ、その結果、その実行可能ファイルを実行する可能性があります。

下に掲載されている更新プログラムはこの脆弱性を排除するだけでなく、以下の 3 つの脆弱性も排除します。それらの脆弱性の危険性は比較的少なく、極めて限られた状況下でのみ利用される可能性があるものです。

-   1つ目の脆弱性は、マイクロソフト セキュリティ情報 [MS00-033](http://technet.microsoft.com/security/bulletin/ms00-033)、[MS00-055](http://technet.microsoft.com/security/bulletin/ms00-055)、[MS00-093](http://technet.microsoft.com/security/bulletin/ms00-093) で説明されている 「フレームのドメイン照合」 の変種です。この脆弱性を利用すると、悪意のある Web サイト オペレータは、1 つのブラウザ ウインドウを Web サイトのドメインで、もう 1 つをユーザーのローカル ファイル システムで開き、後者から前者に情報を渡すことができます。これにより、Web サイト オペレータは、ブラウザ ウインドウで開くことができるユーザーのローカル コンピュータの全てのファイルを読み取ることができますが、変更することはできません。
-   2 つ目の脆弱性は 「フレームのドメイン照合」 の脆弱性と事実上同一のものですが、Internet Explorer ではなく Windows Script Host の問題によって発生します。しかし Internet Explorer を使用した場合にのみこの脆弱性を利用できるため、ここでその問題を修正するプログラムを提供しています。2001 年 3 月 6 日にリリースされた更新プログラムにはその後、新たにエラーが確認されたため、訂正バージョンを 2001 年 4 月 20 日にリリースしました。
-   3 つ目の脆弱性は、Internet Explorer を介して Telnet セッションが実行される方法に影響を及ぼします。仕様上では、Telnet セッションはInternet Explorer を介して開始することができます。しかし、Telnet セッションの際に、Internet Explorer がWeb サイトの指定するコマンド ライン オプションを使用してTelnet を起動してしまうために脆弱性が発生します。この脆弱性は Windows NT® 4.0 または Windows® 2000 マシンに Services for Unix (SFU) 2.0 の一部としてインストールされるTelnet クライアントのバージョンを使用している場合にのみ発生します。SFU 2.0 のTelnet クライアントのそのバージョンでは、Telnet セッションの逐語トランスクリプトを作成するオプションを提供しています。攻撃者は、ログ オプションを使用してセッションを開始し、実行可能なファイルをユーザーのシステムのある場所に流し、次にそのユーザーがマシンを起動した際に、自動的にそのファイルが実行されることになります。この問題は Telnet クライアントではなく、Internet Explorer にありますが、Internet Explorer でコマンド ライン引数を使用してTelnet をリモートで開始することは避ける必要があります。

**問題を緩和する要素** **:**

-   これらの脆弱性は全て、攻撃者の Web サイトをブラウズしたり、攻撃者からのメールを開いたりするといったユーザー側の行動が伴わなければ利用されないものです。安全に Web ブラウジングをしているお客様は、信頼できない Web サイトを訪問する可能性が低く、またセキュリティ ゾーン機能を使用して、HTML メールの実行制限の設定をされているお客様は、この脆弱性による影響を受ける可能性は低いと言えます。
-   上で説明している 「フレームのドメイン照合」 の変種は、ブラウザ ウインドウで開くことができる種類のファイルを表示する際にのみ利用される可能性があります。
-   Telnet の起動に影響を及ぼす脆弱性は、Services for Unix 2.0 の一部として出荷されている Telnet クライアントを使用しているお客様のみに関係します。Telnet の他のバージョンにはログ ファイルを作成するコマンド ライン機能が含まれていません。

**脆弱性識別番号** **:**

-   キャッシュされたコンテンツ識別の脆弱性 : [CAN-2001-0002](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0002)
-   「フレームのドメイン照合」 の変種 : [CAN-2001-0148](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0148)
-   Windows Script Host の脆弱性 : [CAN-2001-0149](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0149)
-   Telnet 起動の脆弱性 : [CAN-2001-0150](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0150)

**テストしたバージョン** **:**
マイクロソフトは Internet Explorer 5.01 および 5.5、Windows Script Host 5.1 および 5.5 をテストし、これらの脆弱性による影響を評価しました。それより前のバージョンに関しては、サポートしておらず、この脆弱性による影響は不明です。

よく寄せられる質問
------------------

**このセキュリティ情報はどのような脆弱性について説明していますか?**

ここでは 4 つの脆弱性について説明しています。

-   キャッシュされたコンテンツが Internet Explorer で処理される方法に影響を及ぼす脆弱性。
-   以前説明した 「フレームのドメイン照合」 の変種。
-   「フレームのドメイン照合」 の脆弱性と同一の影響を及ぼす脆弱性。しかし、この脆弱性 は Internet Explorer ではなく、実際には Windows Script Host に存在しています。
-   Telnet クライアントが起動される方法に影響を及ぼす脆弱性

**2001** **年** **5** **月** **10** **日にこのセキュリティ情報を更新したのはなぜですか?**

Windows Script Host に影響を与える脆弱性を排除するためにリリースした更新プログラムに、新たなエラーを確認しました。その脆弱性を修正した後、セキュリティ情報を更新し、お客様に状況を説明するとともに、新しいビルドへのアップグレードをお勧めします。この脆弱性は、他の全ての脆弱性を排除するための更新プログラムに影響を及ぼすことはありません。

**キャッシュされたコンテンツが処理される方法に影響を及ぼす脆弱性で、どのようなことが起こる可能性がありますか?**

攻撃者がこの脆弱性を利用すると、攻撃者の Web サイトを訪問しているユーザーや、攻撃者からの HTML 形式の電子メールを開いたユーザーのシステムで攻撃者が選択したコードを実行することができます。コードは、ファイルの追加、削除または変更、Web サイトとの通信そしてハード ドライブの再フォーマットなど、ユーザーが実行可能な操作を行うことができます。

この脆弱性は、攻撃者の Web サイトを参照または攻撃者から送信された電子メールを開くことなど、ユーザー側の行動が伴わなければ利用することはできません。安全な Web ブラウジングを行っているお客様は信頼できない Web サイトを訪問する可能性は低く、また、セキュリティ ゾーン機能を使用して、HTML メールができることを制限する設定をされているお客様は、この脆弱性による影響を受ける可能性は低いと言えます。

**何が原因で起こりますか?**

この脆弱性は特定の状況で、Internet Explorer のキャッシュ内に置かれたコンテンツの場所を知ることができるために起こります。

**キャッシュとは何ですか?**

キャッシュとは Internet Explorer のセキュリティ アーキテクチャにより制御されたフォルダの特別なセットです。HTML 形式のコンテンツ、つまり Web ページや HTML 形式の電子メールが受信者のディスクにファイルを作成する必要がある場合、そのファイルをキャッシュ内に格納する必要があります。仕様上、セキュリティ アーキテクチャだけがキャッシュされたファイルの取得方法を知っています。このようにして、Web ページや HTML 形式の電子メールがファイルにアクセスするためにセキュリティ アーキテクチャを介して動作し、そしてセキュリティ アーキテクチャが常にファイルが実行可能であることを制御できるようにします。

**「ファイルを作成する」とありますが、それは電子メールの添付ファイルを指すのですか?**

いいえ、違います。電子メールの添付ファイルはキャッシュに関わりはありません。そして、この脆弱性とは何の関係もありません。常に、電子メールの添付ファイルはユーザーが選択した場所に保存されます。ここで問題となっているファイルは Web ページにより参照されたものや HTML 形式の電子メール自体の中に含まれ、インラインで送信されたものです。このようなファイルは通常、ページや電子メールのテキストを表示する目的のフォーマット情報、背景画像、アニメーションなどを提供するために使用されます。

これらのファイルがディスクに保存される時、警告ダイアログは表示されません。なぜならば、これらのファイルは関連する特定の Web ページや HTML 形式の電子メールのみに使用され、しかも一時的に使用されるためです。これらのファイルは仕様上、常にキャッシュ内で格納され、セキュリティ アーキテクチャにより制限されるため、警告ダイアログなしでダウンロードしても安全であると考えられています。

**どのようにキャッシュは機能するのですか?**

Web ページや HTML 形式の電子メールがファイルを格納する必要がある場合、グローバル一意識別子 （GUID） を生成し、それをファイルに割り当てます。そしてセキュリティ アーキテクチャにそのファイルをキャッシュに入れるように依頼します。セキュリティ アーキテクチャはファイル用に無作為な名前を生成します。この名前はセキュリティ アーキテクチャだけが知っています。また、GUID とその無作為な名前との対応を内部テーブルに記録します。Web ページや HTML 形式のメールがそのファイルを使用する必要がある場合、GUID を介してリクエストし、セキュリティ アーキテクチャはそのファイルを取得し、適切なセキュリティ上の処置を行った後、そのファイルを開きます。

**キャッシュの操作方法の何が問題になっていますか?**

ファイルがキャッシュに入れられる時に割り当てられた無作為な名前を、特定の状況で、Web ページや HTML 形式の電子メールが知ることができます。このため、Web ページや HTML 形式の電子メールが直接ファイルを指定することができます。

**なぜ、それが** **Web** **ページや** **HTML** **形式の電子メールがキャッシュ内のデータを直接指定するというセキュリティ上の危険となるのですか?**

Internet Explorer のセキュリティ アーキテクチャでは、ファイルは直接指定されるか、キャッシュを介してアクセスされるかにより、ファイルの処理方法が異なります。直接指定されるファイルは ローカル コンピュータ セキュリティ ゾーンで開かれます。キャッシュを介してアクセスされるファイルは Web ページや HTML 形式の電子メールがあるセキュリティ ゾーンで開かれます。

他のゾーンに比べ、ローカル コンピュータ ゾーンはコンテンツに対し、多くの制限を課しません。このコンテキスト内で特に重要なことは、コンパイル済み HTML ヘルプ （.CHM） ファイルにどのような動作が許可されているかです。マイクロソフト セキュリティ情報 [MS00-037](http://technet.microsoft.com/security/bulletin/ms00-037)で説明されているように コンパイル済み HTML ヘルプ ファイルはプログラムを実行できるショートカットを含むことができます。MS00-037 で提供された更新プログラムはコンパイル済み HTML ヘルプ ファイルがプログラムを実行できる状況を制限し、ローカル コンピュータの .CHM ファイルだけがショートカットを使用できるようにします。この脆弱性を利用して、攻撃者はショートカットを含む .CHM ファイルをキャッシュ内に置き、直接指定することができます。このようにしてローカル コンピュータ ゾーンでショートカットを起動し、MS00-037 で説明されているような方法でプログラムを動作します。

**この脆弱性がユーザーに対し危険を及ぼす可能性はどのくらいありますか?**

この脆弱性を利用する Web サイトによる攻撃の可能性は主にユーザーの Web ブラウジング習慣によります。ほとんどのお客様はよく訪問し、信頼できる少数の Web サイトを訪問していると思います。このような Web サイトが訪問者を攻撃することは極めてまれです。また、多くのお客様は IE Security Zones を使用して、信頼されていない Web サイトができることを制限しています。信頼されていない Web サイトで Active Scripting を無効にしているお客様はこの脆弱性による危険にさらされることはありません。

HTML 形式の電子メールによる攻撃の可能性はメール クライアントがどのように設定されているかによります。Outlook と Outlook Express では、どの IE セキュリティ ゾーンで HTML 形式の電子メールを開くかを指定することができます。メール クライアントが制限付きサイト ゾーンで電子メールを開くように設定し、さらにそのゾーンで Active Scripting を無効にするように設定しているお客様はこの脆弱性による危険にさらされることはありません。

**この更新プログラムはどのようにしてこの脆弱性を排除しますか?**

この更新プログラムは Web ページ上や電子メール内の HTML 形式のコードが、ファイルが置かれているキャッシュ内での場所を知ってしまうという問題を解決します。これはWeb サイトや HTML 形式の電子メールに関連するセキュリティ ゾーンで、常にキャッシュされたコンテンツが実行されるという以前の状態を復元します。

**この問題の対策として** **Internet Explorer 5.01 SP1** **の更新プログラムをインストールしようとしましたが、リンク先の** **Web** **ページではセキュリティ情報** **MS00-093** **に関しての説明も掲載されていました。これは何かの間違いですか?**

いいえ、その情報は間違いではありません。この更新プログラムと MS00-093 で説明されている更新プログラムは同様にここで問題になっている脆弱性を排除します。しかしこれは、IE 5.01 SP1 バージョンの更新プログラムの場合のみです。サポートされている IE のバージョンは他に、IE 5.5 SP1 がありますが、IE 5.5 SP1 ではこの問題を修正するプログラムと MS00-093 の脆弱性を修正するプログラムが同一のものではないことにご注意ください。

**「フレームのドメイン照合」の変種で、どのようなことが起こる可能性がありますか?**

その可能性はマイクロソフト セキュリティ情報 [MS00-033](http://technet.microsoft.com/security/bulletin/ms00-033)で説明されている最初の脆弱性と全く同じです。この脆弱性を利用して、悪意のある Web サイト運営者は Web サイトを訪問しているユーザーのコンピュータにあるファイルを表示することができます。悪意のある Web サイト運営者はそのユーザーのコンピュータにあるファイルの名前と場所を知る必要があります。そしてブラウザ ウインドウで開くことのできるファイルだけが表示されます。

**どこで「フレームのドメイン照合」の脆弱性に関する情報を入手することができますか?**

マイクロソフト セキュリティ情報 [MS00-033](http://technet.microsoft.com/security/bulletin/ms00-033) 、[MS00-055](http://technet.microsoft.com/security/bulletin/ms00-055) 、[MS00-093](http://technet.microsoft.com/security/bulletin/ms00-093) で、この脆弱性についての詳細を説明しています。

**変種と以前の脆弱性との違いはありますか?**

変種は以前報告した脆弱性と全く同じ原因、影響、対処策があります。しかし、次の 2 つの違いがあります。

-   公開時にはこの脆弱性は Windows Media Player のコンテキストの中で説明されました。この脆弱性は Windows Media Player を介して利用することができますが、実際には問題は Internet Explorer に存在しています。
-   以前の脆弱性と異なり、変種は Internet Explorer 5.5 および Internet Explorer 5.5 Service Pack 1 だけに影響を及ぼします。他のバージョンの Internet Explorer は影響を受けません。

**この更新プログラムは変種とともに、最初の脆弱性も排除しますか?**

はい。この更新プログラムは上記で説明した Internet Explorer のキャッシュ機構を伴う脆弱性とともに、既知の全ての変種も排除します。しかし、下記に説明する 2 つの脆弱性は排除しません。これらの 2 つの脆弱性には別の更新プログラムが必要です。

**Windows Script Host** **に関する脆弱性はどれくらいの範囲に影響を与えますか?**

この脆弱性の影響の範囲は、上部で説明されている 「フレームのドメイン照合」 の変種と全く同じです。この脆弱性を利用すると、悪意のあるWeb サイト オペレータは、訪問しているユーザーのコンピュータ上にあるファイルを表示できる恐れがあります。悪意のあるWeb サイト オペレータは、そのユーザーのコンピュータ上のファイル名と保存場所を知る必要があり、ブラウザ ウインドウで開くことができるファイルのみを表示できます。

この脆弱性と 「フレームのドメイン照合」 の脆弱性の唯一の違いは、問題が発生する場所の違いです。「フレームのドメイン照合」 の脆弱性は Internet Explorer の問題によって発生します。一方、「ドメインを超えたファイルの読み取り」 の脆弱性は Windows Script Host (WSH) の問題によって発生します。

**この脆弱性が** **WSH** **に存在するのなら** **Internet Explorer** **に関して説明しているページで更新プログラムを提供するのはなぜですか?**

根本的な問題は WSH にあるのですが、この脆弱性は、Internet Explorer を使用したWeb サイトを介しての方法で利用される可能性が高いため、またこの問題は 「フレームのドメイン照合」 の脆弱性と類似しているという理由で、Internet Explorer に関する情報の一部でこの更新プログラムを提供するのが適当だという結論に達しました。

**WSH** **の何が問題になっていますか?**

ある特定の状況下で、WSHにある要求がされるとき、WSH はドメインを適切に確認しません。ほとんどの場合、このような要求はWeb サイトが IE を介して作成します。結果、悪意のあるユーザーの Web サイトがユーザーのローカル ファイル システム上でウインドウを開き、データの読み取りができるようになります。上で説明されている 「フレームのドメイン照合」 の脆弱性にあるように、この脆弱性は、ユーザーが信頼できない Web サイトを訪問し、悪意のあるユーザーからの HTML メールを開いた場合にのみ利用される可能性があるものです。

**Windows Script Host** **の影響を受けるバージョンを使用しているかどうかはどのように調べられますか?**

使用している WSH のバージョン番号が必要になります。下の手順に従って確認してください。

1.  \[スタート\] メニューから、\[検索\]、次に \[ファイル\] または \[フォルダ\] を選択します。
2.  Jscript.dll か VBscript.dll のどちらかを検索します。（どちらでも OK です。）
3.  検索結果が表示されたら、そのファイル上で右クリックをし、プロパティを選択します。（注: 検索によって複数のファイルが見つかったら、Windows 95、98 または Me を動作している場合は、C:\\windows\\system にあるファイルを、Windows NT または Windows 2000 を動作している場合は C:\\WINNT\\system32 にあるファイルを選択してください。）
4.  バージョン タブを選択し、そこに表示されたバージョン番号を確認してください。

バージョン番号は "x.x.x.xxxx" という形をとり、ｘ は全ての数字を使うことができます。バージョンを確認できたら、以下の方法で更新プログラムが必要か確認してください。

-   最初の 2 桁が 5.1 で、**かつ**最後の 4 桁が 6330 より少ない場合、更新プログラムのWSH 5.1 用のバージョンを適用してください。
-   最初の 2 桁が 5.5 で、**かつ**最後の 4 桁が 6330 より少ない場合、更新プログラムのWSH 5.5 用のバージョンを適用してください。
-   最初の 2 桁が 5.1 より少ない場合、最後の 4 桁に関係なく WSH の最新バージョンに[アップグレード](http://msdn.microsoft.com/scripting/)する必要があります。WSH 5.1 または WSH 5.5 のどちらのバージョンにもアップグレードすることができます。
-   以上のうちのどれにも当てはまらない場合には、この脆弱性による影響を受ける WSH のバージョンがインストールされていないことを意味します。

**WSH** **のバージョンをアップグレードする必要があるのはなぜですか?** **なぜ更新プログラムをインストールするだけではいけないのですか?**

Windows Script Host 全体でも多くの更新プログラムより大きさが小さく、新しいビルドをインストールしても、損害はほとんどありません。しかし、Host の新しいビルドを使用して修正する場合、以下のような 2 つのメリットがあります。

-   新しいビルドを使用すると、この脆弱性を排除するだけでなく、セキュリティには関係しない多くの他のバグも修正します。
-   WSH 5.1 から WSH 5.5 にアップデートする必要があるユーザーは、WSH 5.5 の最新のビルドをインストールすれば、WSH 5.5 にアップデートしたことになります。

**では、Windows Script Host 5.1** **を動作している場合、Windows Script Host 5.5** **用の更新プログラムをインストールすることができるのですか?**

はい、できます。新しいビルドを介して更新プログラムが提供されているため、WSH 5.1 を使用しているお客様は新しいビルドの WSH 5.5 をインストールし、現在マシンにある WSH のバージョンをアップグレードすることができます。

**WSH** **のバージョンをアップグレードした場合、「フレームドメイン照合」の脆弱性の変種も排除できるのですか?**

いいえ、できません。Windows Script Host の脆弱性と 「フレーム ドメイン照合」 の脆弱性の変種は類似点がありますが、基本的な問題は全く別のものです。両方の脆弱性に対する防御を行うためには、アップグレードされたバージョンの WSH を使い、「フレーム ドメイン照合」 の脆弱性の変種用の更新プログラムをインストールすることが必要です。

**Telnet** **起動の脆弱性はどのくらいの範囲に影響を与えますか?**

この脆弱性を利用すると攻撃者は、自分の Web サイトに訪問したユーザーと送信した特別なフォーマットの HTML メールを開いたユーザーのシステム上にファイルを書き込むことができます。攻撃者はこの脆弱性を利用して様々な攻撃を実行できますが、最も深刻な場合にはユーザーのシステムにプログラムを入れ込み、そのユーザーがログオンした際に常に自動的にプログラムが実行されてしまう恐れがあります。

この脆弱性は、ある特定の Telnet ユーティリティがシステムにインストールされている場合にのみ利用される可能性があります。このバージョンは Windows NT 4.0 と Windows 2000 システム上にのみインストール可能なアドオン パッケージの一部としてのみ入手可能なもので、プラットフォームの一部としてデフォルトで出荷されるものではありません。

**この脆弱性の原因は何ですか?**

Services for Unix 2.0 に同梱されている Telnet のこのバージョンには Telnet セッションのトランスクリプトを作成するオプションが含まれています。Telnet はWeb ページまたは HTML メールを介して自動的に起動できるため、攻撃者はこのオプションを使用してユーザーのシステム上に自分が選択したファイルを書き込むことができてしまいます。

**Telnet** **とは何ですか?**

Telnet は クライアントがリモート サーバー上でコマンド ライン セッションを確立するための 標準 TCP/IP プロトコルのことです。このセッションを通じて、クライアントはプログラムを実行したり、リモート マシン上でコマンドを発行することが可能になります。Telnet クライアントは、全ての Windows プラットフォームの一部として供給されています。

**Telnet** **クライアントの何が問題になっていますか?**

クライアントには何も問題はありません。しかし、Services for Unix 2.0 に同梱されている Telnet クライアントのバージョンに導入されたログ機能が Internet Explorer を介して不正に使用される危険性があります。

**Services for Unix 2.0** **とは何ですか?**

[Services for Unix 2.0](http://www.microsoft.com/windows2000/sfu/default.asp) は、相互運用性のあるコンポーネントを供給するアドオン パッケージで、それを使用すると Windows NT 4.0 と Windows 2000 を既存のUnix 環境に容易に統合することができます。この脆弱性を利用するために Services for Unix 2.0 に関して 2 つの重要なポイントがあります。この脆弱性を解決する Telnet のバージョンを入手するにはServices for Unix 2.0 をインストールすることが唯一の方法である、という点と Services for Unix 2.0 は Windows NT 4.0 と Windows 2000 システム上にのみインストールできる、という点の 2 点です。

**ログ機能とは何ですか?**

ログ機能を使用すると、Telnet セッションの逐語トランスクリプトを作成することができます。セッション中に交換された全ての情報はユーザーが選択したファイルに記録されます。

**ログ機能でどんな危険が生じますか?**

ほとんどの場合、ログ機能による危険性はありません。通常の Telnet セッションでは、クライアント マシンを使用しているユーザーが Telnet クライアントを起動し、任意の Telnet サーバーに接続します。ユーザーは使用するオプションを選択し、セッションでの実行を制御します。つまり、ユーザーがセッションを制御します。

この脆弱性は Web ページや HTML メールが Internet Explorer を介した Telnet セッションを要求できてしまうために発生します。このことが発生した場合、Web ページや HTML メールが指定したコマンド ライン オプションを使用して Telnet クライアントはユーザーのマシン上で起動されます。攻撃者がログ オプションを指定し、クライアントにデータを流した場合、全てのデータがログ ファイルに記録されてしまいます。

**これにより攻撃者は何ができますか?**

Internet Explorer のセキュリティ アーキテクチャでは、ファイルはキャッシュによって直接指定されているか、アクセスされているかによって異なる処理がされます。直接指定できるファイルは ローカル コンピュータ セキュリティ ゾーンで開くことができ、 キャッシュ経由でアクセスされるファイルは、Web ページや HTML メールがある[セキュリティ ゾーン](http://support.microsoft.com/kb/174360)のどこでも開くことができます。

ローカル コンピュータ ゾーンでは、他のゾーンよりコンテンツへの制限がありません。このコンテキストによってコンパイル済み HTML ヘルプ (.CHM) に与えられる機能がコンテキストで特に重要になります。マイクロソフト セキュリティ情報 MS00-037 で説明されているように、コンパイル済み HTML ヘルプ ファイルには、プログラムが実行されるショートカットを含むことができます。MS00-037 で提供されている更新プログラムは、ローカル コンピュータ上の .CHM ファイルのみがショートカットを使用できるように実行の条件を限定します。攻撃者はこの脆弱性によって ショートカットを含む .CHM ファイルをキャッシュに送信し、それらのファイルを直接指定し、その後ローカル コンピュータ ゾーンで起動する可能性があります。そしてその結果、 MS00-037 で説明されているような方法でプログラムを実行することができてしまいます。

**なぜ** **Internet Explorer** **ではWeb** **ページと** **HTML** **メールによって** **Telnet** **セッションが起動してしまうのですか?**

IE は様々な TCP/IP プロトコルをサポートしていますが、それらはすべて URL で指定できます。例えば、http://www.microsoft.com のようなおなじみの URL を例にとります。この URL の中では、“http:” が、Hypertext Transfer Protocol (HTTP) を使用してリソースの www.microsoft.com を表示するように指定します。IE がこのような URL を処理する際、HTTP に必要なアプリケーション、つまりブラウザを実行します。

このように、Telnet を使用して表示する必要があるリソースを指定する URL、また他の TCP/IP プロトコルがあるのは理にかなっています。論理上、リソースはクライアントではなくサーバーにあるため、このことは安全なオペレーションです。セッションでは、ユーザーはクライアントで、クライアントが常にセッションを制御している必要があります。しかし、この場合、ログ機能を使用すると明らかにセッションが安全に実行できなくなります。

**この更新プログラムはどのようにしてこの脆弱性を排除しますか?**

この更新プログラムは、コマンド ライン オプションがURL 経由で Telnet クライアントに渡されないようにしてこの脆弱性を排除します。これにより、攻撃者はログ オプションを指定できなくなります。

**この問題のための更新プログラムは、上記で説明されている他の脆弱性も排除しますか?**

いいえ、排除しません。この更新プログラムは、この特定の脆弱性のみを排除します。上記で説明されている他の脆弱性を排除する更新プログラムは入手可能です。

**Telnet** **への機能を取り除いてはどうですか?**

多くのユーザーはブラウザから様々な種類のリソースを訪問する機能を必要とします。しかし、その機能が必要ないユーザーは削除することができます。Telnet は [Asynchronous Pluggable Protocol (APP)](http://msdn.microsoft.com/workshop/networking/pluggable/overview/overview.asp)の一例です。レジストリを編集し、必要のない APP を[削除](http://msdn.microsoft.com/workshop/networking/pluggable/overview/appendix_a.asp) することができます。

**Services for Unix 2.0** **をインストールしていませんが、この脆弱性による影響を受けますか?**

いいえ、受けません。Telnet の影響を受けるのバージョンは Services for Unix 2.0 をインストールした場合のみに存在します。

**Services for Unix 2.0** **をインストールしてあるかはっきりしません。確認する方法はありますか?**

確認するにはマシン上の Telnet クライアントのバージョンをチェックすることです。影響を受ける telnet.exe のバージョンは、1999 年 12 月 7 日作成の .2000.0328.1. です。

更新プログラム
--------------

この問題に対する日本語版更新プログラムは、以下のサイトからダウンロードできます。

-   キャッシュされた内容識別の脆弱性 および 「フレームのドメイン照合」 の変種 :

    -   Internet Explorer 5.01 SP1:  
        [http://www.microsoft.com//windows/ie/download/critical/279328.htm](http://www.microsoft.com/windows/ie/download/critical/279328.htm)   
        ダウンロード先のリストから Japanese Language Version を選択した後、Internet Explorer 5.01 SP1 を選択してください。
    -   Internet Explorer 5.5 SP1:  
        [http://download.microsoft.com/download/ie55sp1/secpac15/5.5\_SP1/
        W98NT42KMe/JA/q286045.exe](http://download.microsoft.com/download/ie55sp1/secpac15/5.5_sp1/w98nt42kme/ja/q286045.exe)

    **注** **:**  
    マイクロソフトは 全てのお客様に Windows Script Host のバージョンの更新プログラムをインストールすることを推奨します。

-   Telnet 起動の脆弱性 :  
    この問題に対する修正は、MS02-005 以降の累積的な更新プログラムに含まれました。最新の累積的な更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/) または、[こちら](http://go.microsoft.com/fwlink/?linkid=16266&clcid=0x411)の Web サイトから入手できます。

#### この更新プログラムに関する追加情報

**対象プラットフォーム** **:**

-   Internet Explorer の更新プログラムは Internet Explorer 5.01 SP1 および Internet Explorer 5.5 SP1 を動作しているシステムにインストールすることができます。
-   Windows Script Host の更新プログラムは Windows Script Host 5.1 および 5.5 を動作しているシステムにインストールすることができます。

**今後リリースされるサービスパックに含まれる更新プログラム** **:**

-   Internet Explorer の問題に対する修正は Internet Explorer 5.01 Service Pack 2 および Internet Explorer 5.5 SP2 に含まれる予定です。
-   Windows Script Host の問題に対する修正は Windows Script Host 5.6 に含まれる予定です。

**更新プログラムのインストール確認方法** **:**

-   キャッシュされたコンテンツ識別の脆弱性 および 「フレームのドメイン照合」 の変種 :
    -   この更新プログラムがマシンにインストールされたことを確認するためには、Internet Explorer を起動し、Internet Explorer の \[バージョン情報\] をご覧下さい。IE 5.01 SP1 を適用している場合、更新バージョンのフィールドに Q279328 が表示されます。IE 5.5 SP1 を適用している場合、Q286045 が表示されます。
    -   各ファイルを確認するためには、サポート技術情報 [279328](http://support.microsoft.com/kb/279328) または [286045](http://support.microsoft.com/kb/286045) のファイル欄を参照して下さい。
-   Windows Script Host の脆弱性 :
    -   アップグレードされたバージョンの Windows Script Host がマシンにインストールされたか確認するには、「よく寄せられる質問」 で説明されている手順 (「Windows Script Host の影響を受けるバージョンを使用しているかどうかはどのように調べられますか?」 ) にしたがい、マシン上の Windows Script Host がこの問題の影響を受けないバージョンであることを確認してください。

**警告** **:**

-   この更新プログラムをインストールするように設計されたもの以外の IE のバージョンを動作しているシステムにこの更新プログラムをインストールした場合、「この更新プログラムが必要ありません」 というメッセージが表示されます。このメッセージは不適切で、このメッセージが表示された場合は、サポートされている IE のバージョンにアップグレードし、次にこの更新プログラムを再度インストールする必要があります。

**他のセキュリティ更新プログラムの入手先** **:**  
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報  

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS01-015）  
    [http://www.microsoft.com/technet/security/bulletin/ms01-015.mspx](http://technet.microsoft.com/security/bulletin/ms01-015)
-   サポート技術情報 （KB） 文書番号 ： 280768  
    [\[INFO\] 「クロスドメイン制限を越えるファイル読み出し」問題の修正ファイル](http://support.microsoft.com/kb/280768)  
-   サポート技術情報 （KB） 文書番号 ： 286043  
    [「Telnet のログ オプション」の脆弱性を解決する更新プログラム](http://support.microsoft.com/kb/286043)  
-   サポート技術情報 （KB） 文書番号 ： 286045  
    [キャッシュされたコンテンツの識別に関する脆弱性を解決する更新プログラム](http://support.microsoft.com/kb/286045)

**更新履歴** **:**  

-   2001/3/9: このセキュリティ情報ページを公開しました。
-   2001/3/22: この問題に対する日本語版 KB を公開しました。
-   2001/5/10: セキュリティ情報を更新し、最初にリリースされた Windows Script Host アップグレードにエラーが確認されたため、お客様に最新のビルドをインストールするようにご案内しました。また、この問題に対する Internet Explorer 用の日本語版更新プログラムを公開しました。
-   2001/5/30: この問題に対する Internet Explorer 5.5 SP1 用日本語版更新プログラムを公開し、注意書きを記載しました。
-   2001/7/4: IE 5.01 SP1 の「キャッシュされたコンテンツ識別の脆弱性」 に関する「更新プログラムのインストール確認方法」 の情報を追加しました。
-   2003/5/12: Windows Script Host のダウンロード リンクを更新しました。また、Telnet 起動の脆弱性に対する更新プログラムが MS02-005 以降の累積的な更新プログラムに含まれていることをお知らせしました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*