---
TOCTitle: 'MS01-036'
Title: 'マイクロソフト セキュリティ情報 MS01-036 - 緊急'
ms:assetid: 'ms01-036'
ms:contentKeyID: 61228397
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms01-036(v=Security.10)'
---


マイクロソフト セキュリティ情報 MS01-036 - 緊急
===============================================

LDAP SSL で公開される機能がパスワードの変更を可能にする
-------------------------------------------------------

公開日: 2001年6月26日 | 最終更新日: 2001年7月13日

#### 概要 :

**このセキュリティ情報の対象となるユーザー:**  
Microsoft® Windows® 2000 を使用しているシステム管理者

**脆弱性の影響 :**  
特権の昇格

**推奨する対応策:**  
現在 LDAP SSL セッションを提供しているお客様は直ちにこの更新プログラムを適用して下さい。

**影響を受けるソフトウェア:**

-   Microsoft Windows 2000

### 詳細

問題
----


**技術的な説明:**
この脆弱性はある LDAP 機能に関連しています。その LDAP 機能は、SSL セッションでの LDAP をサポートするように LDAP サーバーが設定されている場合のみ利用可能なもので、その目的は、ユーザーがディレクトリ プリンシパルのデータ属性を変更できるようにすることにあります。仕様上、この LDAP 機能はリクエストを完了する前にユーザーの権限をチェックします。しかし、ディレクトリ プリンシパルがドメイン ユーザーで、データ属性がドメイン パスワードである場合に限り、エラーが発生します。この場合、この LDAP 機能はリクエストを行ったユーザーの権限をチェックせず、結果として、あるユーザーがほかのユーザーのドメイン ログイン パスワードを変更できるようにする可能性があります。

攻撃者は次のいずれかの目的でほかのユーザーのパスワードを変更する可能性があります。1 つは、ほかのユーザーのログオンを妨害することにより、サービスの拒否を引き起こすことを目的とするものです。もう 1 つは、ユーザーのアカウントにログインし、そのユーザーの持つ権限を取得することを目的とするものです。最も深刻な例としては、攻撃者がドメイン管理者のパスワードを変更し、管理者のアカウントにログインすることなどがあげられます。

仕様上、この LDAP 機能は、匿名セッションを介して接続するユーザーも含めて、LDAP サーバーに接続することができるすべてのユーザーにより呼び出すことができます。このため、該当するサーバーと接続を確立することができるユーザーであれば、この脆弱性を利用することができます。

**問題を緩和する要素:**

-   管理者が LDAP サーバーにデジタル証明書をインストールしていない限り、LDAP SSL セッションは動作しません。このため、Windows 2000 の既定のインストールではこの脆弱性の影響を受けません。
-   ファイアーウォールが tcp ポート 636 をブロックするように設定されている場合、外部のユーザーはこの脆弱性を利用することはできません。
-   この脆弱性を利用して、個々のマシンのローカル ユーザー アカウントのパスワードを変更することはできません。

**脆弱性識別番号:**
[CAN-2001-0502](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0502)

**テストしたバージョン:**
マイクロソフトは Windows 2000 および Windows NT® 4.0 のテストを行い、この脆弱性による影響を評価しました。それより前のバージョンに関してはサポートしておらず、この脆弱性による影響は不明です。

よく寄せられる質問
------------------


**どのようなことが起こる可能性がありますか?**

この脆弱性を利用すると、攻撃者は Windows 2000 ドメインのユーザー （ドメイン管理者を含む） のパスワードを変更することができます。パスワードの変更は、次の 2 つのいずれかの目的で実行される可能性があります。1 つは、ユーザーがドメインにログオンできないようにするため、もう 1 つは、攻撃者がほかのユーザーのアカウントでログインするためです。

この脆弱性を利用するためには、いくつかの大きな制約があります。

-   この脆弱性は、LDAP SSL セッションを介してのみ利用することができます。LDAP サーバーが、LDAP SSL をサポートするように設定されている場合にのみ、このようなセッションを確立できます。Windows 2000 LDAP サーバーの既定の設定では、LDAP SSL は有効ではないため、この脆弱性による影響はありません。
-   ファイアウォールでの対策が取られている場合、インターネット ユーザーは社内ネットワークに対してこの脆弱性を利用することはできません。
-   この脆弱性を利用できるのは、ドメイン ユーザー アカウントのパスワードを変更する場合のみです。個々のマシンのローカル ユーザー アカウントのパスワードを変更するためには利用できません。

**この脆弱性の原因は何ですか?**

この脆弱性は Windows 2000 の LDAP SSL で公開される機能に問題があるために発生します。この問題を攻撃者が利用すると、ユーザー オブジェクトのパスワード属性を変更することができます。

**LDAPとは何ですか?**

LDAP (Lightweight Directory Access Protocol) は権限のあるユーザーが、メタディレクトリのデータに問い合わせたり、変更することを可能にする業界標準のプロトコルです。例えば、Windows 2000 では、Active Directory のデータにアクセスするために LDAP が使用されています。

**LDAP SSLとはどういう意味ですか?**

Windows 2000 では、セキュリティで保護されていないセッションでも、セキュリティで保護された SSL セッションでもLDAP リクエストを送信することができます。セキュリティで保護されたセッションでのみ利用できる機能もあり、この脆弱性は、そのようなセキュリティで保護されたセッションでのみ利用できる機能により引き起こされます。したがって、ドメインの LDAP サーバーで、LDAP SSL が使用できる場合にのみこの脆弱性が利用される可能性があります。

**LDAP SSLは既定で利用できますか?**

いいえ、できません。LDAP サーバーにおいて、SSL による通信を利用するためには、管理者はデジタル証明書を取得し、サーバーにインストールしておく必要があります。デジタル証明書をインストールしていないと、LDAP SSL は利用できず、この脆弱性は利用されません。

これは Windows 2000 の既定のインストールでは、この脆弱性による危険性がないことを意味します。しかし、マイクロソフトは、将来 LDAP SSL サービスを利用する可能性があるお客さまに、予防策としてこの更新プログラムを適用することを推奨します。

**この脆弱性を含む機能の何に問題がありますか?**

この機能は、ディレクトリに保存されたデータを変更できるように設計されています。しかし、本来この機能は、個々のデータに関するアクセス権にしたがってデータを変更する必要があります。この脆弱性は、あるデータ属性 (ユーザーのパスワード属性) を変更する際に、アクセス権を正しくチェックせず、単純にリクエストを処理してしまうために発生します。これにより攻撃者はこの機能を悪用し、ほかのユーザーのドメイン パスワードを変更する恐れがあります。

**この脆弱性により攻撃者は何ができますか?**

ほかのユーザーのドメイン パスワードを変更できるようになると、攻撃者は次の 2 つの操作を実行する可能性があります。単にアカウントの所有者がログオンできないように、ユーザーのドメイン パスワードを、そのユーザーがわからないような何らかの値に変更する可能性があります。あるいは、攻撃者はパスワードを変更し、そのアカウントのアクセス特権を得るためにそのアカウントにログオンする可能性があります。

**攻撃者はドメイン管理者のパスワードを変更することができますか?**

はい、できます。これはこの脆弱性による最も深刻な危険です。攻撃者がドメイン管理者のパスワードを変更した場合、管理者のアカウントにログインし、ドメインの管理的制御を取得することができます。

**攻撃者はドメイン管理者のパスワードを変更することができますか?**

はい、できます。これはこの脆弱性による最も深刻な危険です。攻撃者がドメイン管理者のパスワードを変更した場合、管理者のアカウントにログインし、ドメインの管理的制御を取得することができます。

**この脆弱性を利用するために、攻撃者はどのようなアクセス権を必要としますか?**

この脆弱性を包含する機能はドメインのメンバーでないユーザーも含む、どのユーザーにでも呼び出すことができます。このため、該当するサーバーと同じファイアーウォール側のユーザーであれば、実質的に全てのユーザーがこの脆弱性を利用することができます。しかし、ファイアーウォールで tcp ポート 636 をブロックしている限り、ファイアーウォールの外側のユーザーはこの脆弱性を利用することはできません。

**この脆弱性を利用して個々のコンピュータのローカル アカウントのパスワードを変更することができますか?**

いいえ、できません。個々のコンピュータのローカル ユーザー アカウントはディレクトリに保存されていないため、LDAP を介して変更することはできません。ドメイン アカウントのパスワードだけがこの脆弱性により変更されます。

**NT 4.0を使用していますが、この脆弱性の影響を受けますか?**

いいえ、受けません。LDAP SSL サービスを提供している Windows 2000 システムだけがこの脆弱性の影響を受けます。

**Windows 2000を使用していますが、どのマシンにこの更新プログラムを適用する必要がありますか?**

この更新プログラムは LDAP SSL を提供している Windows 2000 サーバーにだけ適用する必要があります。

**更新プログラムは何を修正しますか?**

この更新プログラムは該当する機能が、変更権限を持つユーザーだけにデータ属性の変更を許可するようにして、この脆弱性を排除します。

更新プログラム
--------------


この問題に対する日本語版更新プログラムは、以下のサイトからダウンロードできます。

-   Windows 2000 Server および Advanced Server:
    この問題に対する修正は Windows 2000 Service Pack 3 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

    <http://www.microsoft.com/japan/windows2000/downloads/>
    なお、個別の更新プログラムは以下の Web サイトから入手できます。

    -   PC/AT 互換機用
        [/downloads/details.aspx?FamilyId=C1E53F35-D4A0-4274-A6E0-4E08A39BAEB3&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=c1e53f35-d4a0-4274-a6e0-4e08a39baeb3&displaylang=ja)
    -   NEC PC-9800シリーズ用
        [http://download.microsoft.com/download/win2000platform/PatchNEC/Q299687/NT5/JA/Q299687\_W2k\_SP3\_nec98\_ja.exe](http://download.microsoft.com/download/win2000platform/patchnec/q299687/nt5/ja/q299687_w2k_sp3_nec98_ja.exe)
-   Windows 2000 Datacenter Server:
    Microsoft Windows 2000 Datacenter Server 用の更新プログラムは、ハードウェア特有で、そのハードウェアの製造元から入手することができます。

#### 更新プログラムに関する追加情報

**対象プラットフォーム:**
この更新プログラムは Windows 2000 [Service Pack 1](http://www.microsoft.com/japan/windows2000/downloads/servicepacks/sp1/) または Service Pack 2 を動作しているシステムにインストールすることができます。

**今後リリースされるサービス パックに含まれる更新プログラム:**
この問題に対する更新プログラムは Windows 2000 Service Pack 3 に含まれています。

**再起動の必要性:**
あり

**更新プログラムに含まれる過去の修正:**
この更新プログラムにはマイクロソフト セキュリティ情報 [MS01-011](http://technet.microsoft.com/security/bulletin/ms01-011) および [MS01-024](http://technet.microsoft.com/security/bulletin/ms01-024) で提供された修正も含まれています。

**更新プログラムのインストール確認方法:**

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP3\\Q299687
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP3\\Q299687\\Filelist

**警告:**
なし

**他のセキュリティ更新プログラムの入手先:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報:**

-   US マイクロソフトセキュリティ情報（MS01-036）
    [http://www.microsoft.com/technet/security/bulletin/ms01-036.mspx](http://technet.microsoft.com/security/bulletin/ms01-036)
-   サポート技術情報 （KB） 文書番号 ： 299687
    [LDAP over SSL の機能によりパスワードの変更が可能になる](http://support.microsoft.com/kb/299687)

**更新履歴:**

-   2001/6/26: このセキュリティ情報ページを公開しました。
-   2001/7/13: このセキュリティ情報を更新し、この問題に対する更新プログラムにはマイクロソフト セキュリティ情報 MS01-024 で提供された修正も含まれていることをお知らせしました。また、この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
