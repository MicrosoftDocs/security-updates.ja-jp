---
TOCTitle: 'MS01-040'
Title: 'マイクロソフト セキュリティ情報 MS01-040 - 重要'
ms:assetid: 'ms01-040'
ms:contentKeyID: 61228405
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms01-040(v=Security.10)'
---


マイクロソフト セキュリティ情報 MS01-040 - 重要
===============================================

無効な RDP データの受信により、ターミナル サービスでメモリ リークが発生する場合がある
-------------------------------------------------------------------------------------

公開日: 2001年7月26日 | 最終更新日: 2001年8月30日

#### 概要 :

**このセキュリティ情報の対象となるユーザー:**  
Microsoft® Windows® 2000 および Windows NT 4.0 Terminal server を使用しているシステム管理者

**脆弱性の影響 :**  
サービス拒否

**推奨する対応策:**  
システム管理者はこの更新プログラムのインストールを検討して下さい。

**影響を受けるソフトウェア:**  

-   Microsoft Windows NT 4.0, Terminal Server Edition
-   Microsoft Windows 2000 Server
-   Microsoft Windows 2000 Advanced Server
-   Microsoft Windows 2000 Datacenter Server

### 詳細

問題
----


**技術的な説明:**  
Windows 2000 ターミナル サービスおよび Windows NT 4.0 Terminal Server Edition において、通信ポート 3389 を介して受信する Remote Data Protocol データを処理する機能の 1 つにメモリ リークが発生する可能性があります。これは、ある特定の不正なデータを含む RDP パケットが処理されるごとに、メモリ リークが発生することにより、サーバー全体のメモリを徐々に消費し、そして使い果たします。

攻撃者が該当するマシンに、このようなデータを大量に送信した場合、システムのメモリを使い果たし、応答時間を遅延させたり、マシンの応答をすべて停止させることができます。ターミナル サービスに限らず、すべてのシステム サービスが影響を受けます。メモリリークが発生した後の対応としては、システムを再起動することにより、メモリを解放し、通常の操作を再開することができます。

**問題を緩和する要素:**  

-   通常はファイアウォールを使用することにより、攻撃者がインターネットからこの脆弱性を利用することを防ぐことができます。具体的には、通信ポート 3389 をブロックすることで、攻撃者が該当するサービスにデータを送信することを妨ぐため、この脆弱性が利用されることを防ぎます。
-   この脆弱性を利用して、データの改ざんや権限の不正使用等を行うことはできません。

**脆弱性識別番号:**  
[CAN-2001-0540](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0540)

**テストしたバージョン:**  
マイクロソフトは Windows NT 4.0 および Windows 2000 においてテストを行い、この脆弱性による影響を評価しました。それより前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------


**どのようなことが起こる可能性がありますか?**

これは[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者は該当するターミナル サーバーに、不正なデータを大量に送信し、サーバーで実行中の有効なセッションが分裂されるため、サーバーで新たなセッションを開始するのを妨害します。

攻撃者がこの脆弱性を利用して、サーバー上のデータを改ざんしたり、マシンの権限を不正に使用することはできません。該当のマシンの管理者はマシンを再起動することによって、通常のサービスを再開することができます。

**何が原因で起こりますか?**

Windows 2000 Terminal Server のサービスにメモリ リークの問題があるためにこの脆弱性が発生します。ある特定の不正なデータを含むデータ パケットを大量に受信すると、サーバーはメモリを使い果たし、作業を実行できなくなります。

**メモリ リークとは何ですか?**

メモリ リークとはシステムで使用可能なメモリを使い果たしてしまう実装上のエラーのことです。コンピュータ上のプロセスが実行される際に、プロセスには一定のメモリが必要であり、必要なメモリの量は、コンピュータが実行している動作によって異なります。プロセスがより多くのメモリを必要とすると、コンピュータはオペレーティング システムにメモリを要求します。メモリが必要なくなった場合は、メモリをオペレーティング システムに返却し、他のプロセスに割り当てることができます。

プロセスがオペレーティング システムにメモリを適切に返却しない場合、プロセスがそのメモリを使用していないにもかかわらずそのプロセスに割り当てられたままとなり、そのメモリを別のプロセスに再び割り当てることができなくなります。これにより、メモリ ブロックが利用できない状態になります。この場合、Windows 2000 でサポートされた、ターミナル サーバー サービス セッションの実装にエラーがあったため、ある無効なデータが送信されるとメモリ リークが発生する場合があります。

**問題になっているデータが受信されるとどのくらいのメモリがリークしますか?**

ここでのリークは比較的少量です。パフォーマンスに影響が及んだり、メモリが使い果たされるまでには、非常に大量のパケットをサーバーが受信する必要があります。

**攻撃者はこの脆弱性を利用して、何をする可能性がありますか?**

攻撃者はサーバーが使用可能なメモリを使い果たすために、故意に大量の不正なデータ パケットを送信することができます。これにより、攻撃者より、サーバーが有益な動作をするのを妨げることができる可能性があります。

**攻撃者はこの脆弱性を利用するために、ターミナル サービスを介してログインする必要がありますか?**

いいえ、必要ありません。攻撃者がターミナル サービスにデータを送信できることは可能ですが、マシンに認証を行う必要はありません。

**この脆弱性を利用して攻撃が成功した場合、ターミナル サーバーのセッションが中断されるだけですか?それともシステムのほかのサービスも影響を受けますか?**

この脆弱性により、マシン上のすべてのサービスが使用するメモリ プールが使い果たされるため、この脆弱性を利用して攻撃が成功した場合、ターミナル サービスだけでなくマシン上のすべてのサービスが影響を受けます。このため、例えばそのマシンがファイル共有サービスを提供している場合、マシンが攻撃を受けると、ユーザーが共有ファイルにアクセスすることができなくなる可能性があります。

**この脆弱性により攻撃者はマシンでの特権を獲得することができますか?**

いいえ、できません。この脆弱性を利用した攻撃が成功した場合の唯一の影響は、正規のユーザーへのサービス拒否のみです。

**影響を受けたサーバーは、どのようにしてサービスを再開できますか?**

サーバー管理者は該当のマシンを再起動することで、通常のサービスを再開することができます。

**Windows 2000マシンでターミナル サービスを有効にしてありません。何か対策をとる必要がありますか?**

いいえ、必要ありません。この問題はターミナル サービスにあります。したがってターミナル サービスが有効になっていなければこの脆弱性が利用されることはありません。

**この脆弱性はリモートで利用される可能性がありますか?**

攻撃者が該当のマシンにパケットを送信することができれば、この脆弱性を利用することができます。しかし、通常のファイアウォールによる対策が取られている場合、ターミナル サービスで使用される通信ポート （ポート 3389) はブロックされます。これにより、インターネット ユーザーによってこの脆弱性が利用されるのを防ぐことができます。

**Windows NT 4.0ターミナル サーバー を使用しています。この脆弱性の影響を受ける可能性がありますか?**

はい。この脆弱性は Windows NT 4.0 ターミナル サーバーにも影響を及ぼします。

**更新プログラムは何を修正しますか?**

更新プログラムにより Windows 2000 のターミナル サービスが、ここで問題になっているリクエストを処理したあとに適切にメモリを開放するように修正され、この脆弱性を排除します。

更新プログラム
--------------


この問題に対する日本語版更新プログラムは、以下のサイトからダウンロードできます。

-   Microsoft Windows NT 4.0, Terminal Server Edition:
    [http://www.microsoft.com/downloads/details.aspx?FamilyId=5CBF406A-E8C8-4EFB-8BBA-BC9784B0CCC5&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=5cbf406a-e8c8-4efb-8bba-bc9784b0ccc5&displaylang=ja)
-   Microsoft Windows 2000:
    この問題に対する修正は Windows 2000 Service Pack 3 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

    <http://www.microsoft.com/japan/windows2000/downloads/>
    なお、個別の更新プログラムは以下の Web サイトから入手できます。

    [http://www.microsoft.com/downloads/details.aspx?FamilyId=E3E46A58-17F5-4793-AE0A-61E18DF6134C&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=e3e46a58-17f5-4793-ae0a-61e18df6134c&displaylang=ja)
-   Microsoft Windows 2000 Datacenter Server:
    Windows 2000 Datacenter Server の更新プログラムの適用に関してはそれぞれのデータセンター サーバーを購入されたハードウェア ベンダー様へご相談下さい。

#### 更新プログラムに関する追加情報

**対象プラットフォーム:**  

-   Windows NT 4.0 の更新プログラムは、Windows NT 4.0, Terminal Server Edition [Service Pack 6](http://www.microsoft.com/japan/technet/downloads/winnt.mspx) を実行しているシステムにインストールすることができます。
-   Windows 2000 の更新プログラムは Windows 2000 Service Pack 1 または、Service Pack 2 を実行しているシステムにインストールすることができます。

**今後リリースされるサービス パックに含まれる更新プログラム:**  
この問題に対する更新プログラムは Windows 2000 Service Pack 3 に含まれています。

**再起動の必要性:**  
あり

**更新プログラムに含まれる過去の修正:**  
なし

**更新プログラムのインストール確認方法:**  

-   Windows NT 4.0, Terminal Server Edition:
    -   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。

        HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Hotfix\\Q292435
-   Windows 2000:
    -   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。

        HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP3\\Q292435.
    -   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。

        HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP3\\Q292435\\Filelist

**警告:**  
なし

**他のセキュリティ更新プログラムの入手先:**  
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報:**  

-   US マイクロソフトセキュリティ情報（MS01-040）
    [http://www.microsoft.com/technet/security/bulletin/ms01-040.mspx](http://technet.microsoft.com/security/bulletin/ms01-040)
-   サポート技術情報 （KB） 文書番号 ： 292435
    [ポート 3389 (RDP) の無効な TCP チェックサムによるカーネル モードのメモリリーク](http://support.microsoft.com/kb/292435)

**更新履歴:**  

-   2001/7/26: このセキュリティ情報ページを公開しました。
-   2001/8/30: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
