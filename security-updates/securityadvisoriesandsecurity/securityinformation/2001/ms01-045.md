---
TOCTitle: 'MS01-045'
Title: 'マイクロソフト セキュリティ情報 MS01-045 - 重要'
ms:assetid: 'ms01-045'
ms:contentKeyID: 61228410
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms01-045(v=Security.10)'
---


マイクロソフト セキュリティ情報 MS01-045 - 重要
===============================================

H.323 ゲートキーパーのメモリーリーク及び Web Proxy のクロスサイトスクリプティングの脆弱性
-----------------------------------------------------------------------------------------

公開日: 2001年8月17日 | 最終更新日: 2001年8月27日

#### 概要 :

**このセキュリティ情報の対象となるユーザー:**  
Microsoft® Internet Security and Acceleration (ISA) Server 2000 を実行しているシステム管理者

**脆弱性の影響 :**  
サービス拒否、クロスサイト スクリプティング

**推奨する対応策:**  
システム管理者は、更新プログラムのインストールを検討して下さい。

**影響を受けるソフトウェア:**

-   Microsoft ISA Server 2000

### 詳細

問題
----


**技術的な説明:**
このセキュリティ情報では 3 つのセキュリティ上の脆弱性に関して説明しています。これらの脆弱性は ISA Server 2000 に影響を与えるという点以外には関連性はありません。

-   H.323 Gatekeeper サービスに関連するサービス拒否の脆弱性 : H.323 Gatekeeper サービスは、ファイアウォール経由の Voice-over-IP トラフィックのトランスミッションをサポートするサービスです。そのサービスに、ある特定の種類の不正の H.323 データによって引き起こされるメモリ リークの問題があります。このようなデータを受信するたびに、サーバー上で使用可能なメモリを徐々に消費し、攻撃者が繰り返しこのようなデータを送信した場合、サーバーのパフォーマンスが悪化し、ファイアウォール経由のすべての通信を妨害する可能性があります。サーバー管理者は、H.323 サービスを再起動することにより、通常のサービスを再開することができます。
-   Firewall サービスのサービス拒否の脆弱性 : この脆弱性は、上記の問題と同じく H.323 フィルタが原因で発生します(H.323 フィルタは Firewall サービスと共に動作します)。この脆弱性が利用されると、メモリーリークが発生し、Firewall サービスのパフォーマンスが低下し、ついには Firewall サービスのすべての通信が中断する場合があります。
-   失敗した Web ページのリクエストに応答して Web Proxy が生成するエラー ページに影響を与える[クロスサイト スクリプティング](http://msdn2.microsoft.com/ja-jp/library/240ww6sz(vs.80).aspx)の脆弱性 : 攻撃者は、この脆弱性を利用して、ユーザーを誘導し、ISA Server 2000 に以下の特徴をもつ URL を提出することができます。

    (a) 信頼された Web サイトを参照する URL
    (b) 存在していないページまたは、エラーを発生させるページなど、取得することができないサイト内のページをリクエストする URL
    (c) スクリプトタグに囲まれたスクリプトが含まれる URL

    エラーページは、ISA Server 2000 によって生成され、組み込まれたスクリプト コマンドが含まれています。ユーザーのブラウザにそのページが表示された際、そのスクリプト コマンドが実行されます。スクリプトは、URL で参照された Web サイトのセキュリティ コンテキストで実行され、そのサイトがユーザーのマシンに書き込んだすべてのクッキーにアクセスすることができます。

**問題を緩和する要素:**
H.323 サービス拒否の脆弱性 :

-   この脆弱性は、H.323 Gatekeeper サービスがインストールされている場合にのみ利用することが可能です。H.323 は、“完全インストール” を選択した場合にのみ、既定でインストールされ、“標準インストール” を選択した場合には、H.323 はインストールされません。
-   攻撃者はこの脆弱性を利用して該当のサーバー上で権限を獲得したり、既存の Voice-over-IP セッションにトラフィックを追加することはできません。これはサービス拒否の脆弱性のみです。

Firewall サービスのサービス拒否の脆弱性 :

-   この脆弱性は、内部のユーザーのみが利用することができます。インターネット ユーザーはこの脆弱性を利用することはできません。
-   攻撃者はこの脆弱性を利用して、該当のサーバー上で権限を獲得したり、サーバー上のキャッシュされたコンテンツを改ざんしたりすることはできません。これはサービス拒否の脆弱性のみです。

Web Proxy のクロスサイト スクリプティングの脆弱性 :

-   信頼されるサイトのセキュリティ ドメインでスクリプトを実行するためには、攻撃者は、ユーザーが信頼するサイトの存在を知っている必要があります。ほとんどのユーザーは、すべての Web サイトに既定のセキュリティ設定を適用しているため、攻撃者がスクリプトを実行する目的でこの脆弱性を利用しても、メリットはありません。
-   攻撃者がユーザーのマシン上で、ほかのサイトのクッキーを読み取ろうとしても、そのマシンにクッキーを設定したサイトを知る方法はありません。攻撃者は、攻撃者がアクセスしようとするクッキーが設定されたそれぞれの Web サイトに対してこの脆弱性を利用していく必要があります。
-   ユーザーのマシンでクッキーが設定されているサイトを正しく予測できたとしても、最善策が講じられている場合は、クッキーに機密情報が含まれることはありません。

**脆弱性識別番号:**

-   H.323 サービス拒否の脆弱性 : [CAN-2001-0546](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0546)
-   Firewall サービスのサービス拒否の脆弱性 : [CAN-2001-0547](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0547)
-   Web Proxy のクロスサイト スクリプティングの脆弱性 : [CAN-2001-0658](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0658)

**テストしたバージョン:**
マイクロソフトは ISA Server 2000 および Proxy Server 2.0 のテストを行い、これらの脆弱性による影響を評価しました。それより前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------


**このセキュリティ情報はどのような脆弱性について説明していますか?**

このセキュリティ情報は [ISA Server 2000](http://www.microsoft.com/japan/isaserver/) に影響を及ぼす、互いに関連のない 3 つの脆弱性について説明しています。

-   H.323 Gatekeeper サービスのサービス拒否の脆弱性
-   Firewall サービスのサービス拒否の脆弱性
-   Web Proxy サービスのクロスサイトクロスサイトスクリプティングの脆弱性

**1番目の脆弱性でどのようなことが起こる可能性がありますか?**

1 番目の脆弱性は[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。特定の不正なデータを繰り返し送信することにより、攻撃者は該当する ISA Server のパフォーマンスを低下することができ、サーバーでの通信を中断させる可能性もあります。サーバーのネットワーク内での位置によっては、ネットワークの部分を隔離、またはネットワーク内のユーザーがインターネットを使用できなくなる可能性があります。

IP テレフォニーをサポートする特定のサービス(H.323 ゲートキーパー) が有効になっている場合、この脆弱性が起こります。このサービスは通常のインストールでは、既定でインストールされません。

**何が原因で起こりますか?**

この脆弱性は ISA Server の H.323 Gatekeeper サービスでメモリ リークが発生するために起こります。

**H.323 Gatekeeperサービスとは何ですか?**

H.323 とは国際テレフォニー標準で、インターネットなどのメディアでの音声通信の処理方法を指定します。ISA Server の H.323 Gatekeeper サービスはこの標準を実装しています。これにより voice-over-IP 通信がファイアウォールを通過することができます。

**メモリ リークとは何ですか?**

メモリ リークとはシステムで利用可能なメモリを使い果たす実装上のエラーです。コンピュータでのプロセスが動作する時、その動作の内容に応じてメモリを使用します。プロセスがさらにメモリを必要とする場合、オペレーティング システムにそのメモリを要求します。プロセスが使用していたメモリを必要としなくなった場合には、オペレーティング システムがほかのプロセスにそのメモリを割り当てられるように、メモリをオペレーティング システムに返却します。

プロセスがメモリをオペレーティング システムに正しく返却しない場合、プロセスが使用しなくなったメモリがそのプロセスに割り当てられたままとなり、他のプロセスに対する再割り当てができなくなります。この結果、プロセスが使用しなくなったはずのメモリが他のプロセスから利用ができないことを意味します。今回の脆弱性の場合、H.323 Gatekeeper サービスに、特定の無効なデータが送信されるとメモリ リークが発生する実装エラーがあります。

**この脆弱性を利用して攻撃者は何ができますか?**

攻撃者は不正な H.323 データを故意に大量に送信することによって、サーバーの利用可能なメモリを使い果たすことが可能になります。攻撃を続行してサーバーのメモリプールが減少させていくと、サーバーのパフォーマンスも除々に低下し、場合によってはサービスを全く提供できなくなる可能性もあります。

**攻撃が成功するとH.323がサービスを提供できなくなるということですか?それともISA Serverのサーバー全体がサービスを提供できなくなるのですか?**

メモリ リークはシステムのすべてのソフトウェアによって使用されるメモリのプールに影響を及ぼします。このため、攻撃が成功すると、サーバー全体が影響を受けます。

**システムのサービスが中断すると、どのような影響がありますか?**

ISA Server はファイアウォール、Web プロキシ、またはその両方として設定することができます。いずれの場合も、ISA Server はネットワークのある部分とある部分の間や、ネットワークとインターネット間で、通信の導管としての役割を果たします。H.323 Gatekeeper サービスがこの脆弱性を利用した攻撃を受けると、これらの通信が遅延、またはブロックされる可能性があります。

**どのようにして影響を受けたサーバーを通常のサービスに戻すことができますか?**

サーバー管理者は ISA Server を再起動することにより通常のサービスを回復することができます。

**この脆弱性はインターネットから利用することができますか?**

はい、できます。内部および外部のユーザーは H.323 Gatekeeper サービスにデータを送信することができます。

**H.323 Gatekeeperサービス が無効にされている場合、この脆弱性を利用することができますか?**

いいえ、できません。この脆弱性は H.323 Gatekeeper サービスが有効になっている ISA Server にのみ影響を及ぼします。ISA Server をインストールするときに 「完全インストール」 を選択すると、H.323 Gatekeeper サービスがインストールされて、スタートアップでサービスが自動的に開始されます。しかし、「標準インストール」 を選択した場合は　H.323 Gatekeeper サービスはインストール**されません**。

**この脆弱性を利用して、攻撃者はサーバーでの管理機能を取得することができますか?またファイアウォールのセキュリティを侵害することができますか?**

いいえ、できません。この脆弱性により、サーバーでの管理権限を取得することはできません。この脆弱性は正規のユーザーに対しサービスを拒否するためにのみ利用することができます。

**この脆弱性を利用して、攻撃者はvoice-over-IPセッションを盗聴することができますか?また偽のデータをvoice-over-IPセッションに追加することができますか?**

いいえ、できません。この脆弱性を利用して、攻撃者は既存の H.323 セッションに侵入することはできません。

**更新プログラムは何を修正しますか?**

この更新プログラムは H.323 Gatekeeper サービスがメモリの割り当てを正し制御できるようにし、メモリ リークを排除します。

**この脆弱性でどのようなことが起こる可能性がありますか?**

この脆弱性は上記で説明した 1 番目の脆弱性と事実上、同一です。H.323 フィルタに関連した脆弱性を利用して ISA Server を実行しているシステムのパフォーマンスを低下させ、内部および外部のネットワーク間の通信が中断させられる可能性があります。この脆弱性の深刻さを緩和する要素として、この脆弱性はネットワーク内でしか利用できないという事実があります。

**何が原因で起こりますか?**

上記で説明した 1 番目の脆弱性のように、この脆弱性はメモリ リークが原因となって起こります。ただし、この場合、メモリーリークは ISA Server の Firewall サービス内で発生します。

**この脆弱性を利用して何ができますか?**

上記の例のように、この脆弱性を利用して攻撃者は ISA Server のパフォーマンスを低下させ、ISA Serverを介した通信を中断させる可能性があります。

**これらの2つの脆弱性に異なる点はありますか?**

はい、あります。H.323 Gatekeeper サービスのメモリ リークとは異なり、Firewall サービスのメモリ リークはネットワーク内から利用されます。つまり、インターネットの攻撃者はこの脆弱性を利用できません。

**Firewallサービスは既定でインストールされますか?**

はい。

**更新プログラムは何を修正しますか?**

この更新プログラムは Firewall サービスがメモリの割り当てと解放を正しく行うようにします。

**3番目の脆弱性でどのようなことがおこる可能性がありますか?**

この脆弱性により、攻撃者は以下の 2 つの操作を実行できます。

-   Web コンテンツを信頼されるサイトにあわせたセキュリティ設定で実行
-   信頼されるサイトが設定したクッキーの読み取り

しかし実際には、この脆弱性を利用するのは非常に困難です。攻撃者はある特定のユーザーが信頼する Web サイトを知ることはできません。同様に、最善策が講じられ、サイトのクッキーに機密情報を含んでいない場合、クッキーを読み取ることができても、攻撃者には何もメリットはありません。

**何が原因で起こりますか?**

この脆弱性は、ISA Server がリクエストされた Web ページを取得することができない場合に作成するエラーメッセージが、クロスサイト スクリプティングの影響を受けるために発生します。

**クロスサイト スクリプティングとは何ですか?**

[クロスサイト スクリプティング](http://msdn2.microsoft.com/ja-jp/library/240ww6sz(vs.80).aspx)はセキュリティ上の脆弱性の 1 つで、Web コンテンツが入力を適切にフィルタリングしない場合に発生します。ほとんどの場合、クロスサイト スクリプティングは Web ページが、ある種類のユーザーの入力 （例えば、検索のフレーズの入力など） を受信し、その入力を使用してページを作成する場合に発生します。そのページがユーザーの入力にスクリプトがあるかどうかチェックしない場合、スクリプトが Web ページの一部として処理されると、その Web サイトのドメインでそのスクリプトが実行されます。

このような状況は、ユーザーが入力した場合には危険ではありません。というのは、ユーザーはその操作を、スクリプトを使用してではなく、直接行うこともできた可能性があります。しかし、第三者がユーザーの Web セッションにスクリプトを含む入力を注入することが可能になる場合があります。これにより Web ページに適合したセキュリティ設定が使用され、第三者のスクリプトをユーザーのブラウザで実行できるようになります。

**クロスサイト スクリプティングを利用すると何ができますか?**

クロスサイト スクリプティングを利用すると、攻撃者は、以下の 2 つのことを実行できます。

-   信頼されると思われるほかの Web サイトのセキュリティ設定でスクリプトを実行 : 例えば、ジョンという人物が Web サイト A を信頼し、ブラウザのセキュリティ設定を低くし、その信頼に見合った操作をできるようにしているとします。次にジェーンという人物が Web サイト A のクロスサイト スクリプティングの脆弱性を確認したとします。ジェーンがこの脆弱性を利用できた場合、ジェーンは自分の作成したスクリプトが Web サイト A から送信されるように見せ、その結果、ジョンが低く設定したセキュリティ設定を利用して、そのスクリプトを実行することができます。
-   クッキーの読み取りと書き込み : スクリプトが Web サイト A から送信されているかのように実行されるため、Web サイト Ａ がジョンのコンピュータに設定したクッキーは、ジェーンのスクリプトによってアクセスされ、変更される可能性があります。

**このことはISA Serverとどのような関係がありますか?**

ISA Server が Web ページを取得するリクエストを受け、そのページが存在しない、またはサーバーにアクセスできないなどの理由でページを取得できない場合、ISA Server はエラー情報を生成し、ユーザーのブラウザに表示します。このエラー情報は、Web ページの形式をとり、リクエストされた URL が含まれています。しかし、ISA Server は、そのページを生成する際、URL にスクリプト コマンドが含まれているかチェックをしません。そのため、クロスサイト スクリプティングの影響を受けます。

**このことにより、攻撃者は何をすることができますか?**

ほかのクロスサイト スクリプティングと同様に、攻撃者はほかの Ｗｅｂ サイトのセキュリティ ドメインでコードを実行したり、そのサイトのクッキーにアクセスできます。

**攻撃者はどのようにしてこの脆弱性を利用することができますか?**

攻撃者は次の 2 つのいずれかの方法で、この脆弱性を利用することができます。

-   攻撃者はユーザーが信頼していると思われる Ｗｅｂ サイト上の実在しないページに対するリンクを自分の Ｗｅｂ サイトに挿入しておきます。ユーザーが攻撃者をサイトを開くよう誘導できた場合、攻撃者は偽のリンクを開かせることができ、この脆弱性が利用されます。
-   HTML 形式のメールにリンクを挿入し、標的となるユーザーに送信することによって利用することができます。受信者がそのメールを開封すると、偽のリンクが開きます。

**この脆弱性はどのくらい危険なのですか?**

マイクロソフトは、すべてのセキュリティ上の脆弱性を深刻に扱うことを推奨します。しかし、この脆弱性を信頼されるサイトのセキュリティ設定でスクリプトを実行する目的や、ほかのサイトのクッキーにアクセスする目的で利用することは困難だと考えています。

-   ほかのサイトの設定でコードを実行したいと考えている攻撃者にとって問題なのは、ユーザーが信頼しているサイトを知ることが困難、または不可能であるということです。実際、ほとんどのユーザーは既定のセキュリティ設定を変更していません。このような場合、攻撃者のコードは、どのサイトから送信された場合であれ、既定のセキュリティ制限で実行されます。
-   クッキーに関して困難な点は、Ｗｅｂ サイトがクッキーを適切に処理すると、クッキーに機密情報が含まれることはなく、改ざんされることもありません。

**Ｗｅｂ サイトの中には、自分の ＩＤ でログオンできず、開始したセッションを何者かに“ハイジャック”される可能性があるクッキーに情報を保存しているものがあると聞きました。攻撃者がこの脆弱性を利用してこのようなクッキーを読み取った場合、どうなりますか?**

Ｗｅｂ サイトの中には、セッションが進行中にユーザーを確認するために、クッキーに情報を保存しているものがあるのは事実です。攻撃者がこのようなクッキーにアクセスしようと試みた場合、攻撃者がセッションにコマンドを注入することができ、セッションが “ハイジャック” される可能性があります。

しかし、以下のようなシナリオを考慮に入れておくことが重要です。

-   大抵の場合、攻撃者はこのようなクッキーが使用されているサービスにアクセスしているユーザーを特定することはできません。
-   攻撃者がこのようなサービスにアクセスしているユーザーを特定できたとしても、通常攻撃者がタイミングの問題を解決することは不可能です。つまり、攻撃者がハイジャックをすると狙ったサービスのセッションを開始した被害者となるユーザーを特定することはできません。
-   攻撃者がセッション情報を獲得できたとしても、実際にセッションをハイジャックすることは非常に困難です。攻撃者は無作為にパケットを送信する必要があり、それでも攻撃が成功する確証はまったくありません。

**更新プログラムは何を修正しますか?**

この更新プログラムは ISA Server の Web Proxy サービスが返すエラーページ中で URL トークンをサポートしないように修正します。

更新プログラム
--------------


更新プログラムについては、下記サポート技術情報を参照してください。

**他のセキュリティ更新プログラムの入手先:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報:**

-   US マイクロソフトセキュリティ情報（MS01-045）
    [http://www.microsoft.com/technet/security/bulletin/ms01-045.mspx](http://technet.microsoft.com/security/bulletin/ms01-045)
-   サポート技術情報 （KB） 文書番号 ： 289503
    [\[ISA\] 異常なパケットにより H.323 Gatekeeper と Firewall サービスでメモリリークが発生する](http://support.microsoft.com/kb/289503)
-   サポート技術情報 （KB） 文書番号 ： 295389
    [\[ISA\] ISA Server のエラーページでスクリプト実行の可能性](http://support.microsoft.com/kb/295389)

**更新履歴:**

-   2001/8/17: このセキュリティ情報ページを公開しました。
-   2001/8/27: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
