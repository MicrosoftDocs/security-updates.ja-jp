---
TOCTitle: 'MS01-057'
Title: 'マイクロソフト セキュリティ情報 MS01-057 - 警告'
ms:assetid: 'ms01-057'
ms:contentKeyID: 61228422
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms01-057(v=Security.10)'
---


マイクロソフト セキュリティ情報 MS01-057 - 警告
===============================================

特別な形式の HTML メールのスクリプトが Exchange 5.5 OWA で実行される
--------------------------------------------------------------------

公開日: 2001年12月10日 | 最終更新日: 2001年12月26日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**  
Microsoft® Exchange 5.5 Server を使用して、Outlook Web Access を展開しているシステム管理者

**脆弱性の影響** **:**  
攻撃者による任意のコードが実行される

**最大深刻度** **:**  
中

**推奨する対応策** **:**  
OWA を実装しているお客様は直ちに更新プログラムを適用して下さい。

**影響を受けるソフトウェア** **:**

-   Microsoft Exchange 5.5 Server Outlook Web Access

### 詳細

問題
----


**技術的な説明** **:**  
2001 年 12 月 6 日 （米国時間）、マイクロソフトは、このセキュリティ情報英語版の元のバージョンをリリースしました。2001 年 12 月 7 日、この問題に対する更新プログラムのファイル依存に関して、ある問題が確認され、このセキュリティ情報英語版を更新し、その情報を追加し再びリリースしました。具体的には、この更新プログラムが適切に機能するために、更新プログラムをインストールする Outlook Web Access (OWA) サーバーに Internet Explorer (IE) 5.0 またはそれ以降のバージョンがインストールされている必要があります。IE の 5.0 より前のバージョンがインストールされているシステムに、この更新プログラムをインストールする場合、予測されていない現象が起こる可能性があります。下の 「警告」 の欄が更新され、この更新プログラムのバージョンの要件に関する情報が掲載されています。さらに、この情報が更新された時点で適用できる依存コンポーネントに推奨されるバージョンに関する情報も含まれています。また、FAQ 「よく寄せられる質問」 にて IE の 5.0 より前のバージョンがインストールされているシステムにこの更新プログラムを適用したお客様のための対処法を提供しています。
OWA は Exchange 5.5 Server のサービスの 1 つで、OWA によりユーザーは Web ブラウザを使用して Exchange のメールボックスにアクセスし、メッセージを処理することができます。  
OWA が Internet Explorer と連携してメッセージのインライン スクリプトを処理する方法に問題があります。特別な形式のスクリプトを含む HTML メッセージが OWA で開かれる場合、メッセージが開かれる際にそのスクリプトが実行されます。OWA ではスクリプティングが OWA サーバーがあるゾーンで有効になっている必要があるため、このスクリプトがユーザーの Exchange メールボックスに対し、メッセージの送信、移動、削除といったユーザー自身が実行できるすべての操作を実行できるために脆弱性が発生します。攻撃者は特別に手を加えたメッセージをユーザーに送信することにより、この問題を悪用する恐れがあります。そしてユーザーが OWA でそのメッセージを開いた場合、スクリプトが実行される可能性があります。  
スクリプトはユーザーと同様に 1 つのメッセージを送信できますが、スクリプトがユーザーのアドレス帳の複数のアドレスにメッセージを送信することは不可能です。したがってこの問題を大量のメール攻撃として利用することはできません。また、攻撃を成功させるためには、標的にした被害者が使用しているメール クライアントとメールを読み取る習慣に関する情報を得ている必要があります。悪意を持って作成されたメッセージが OWA を介するブラウザ以外のすべてのメール クライアントで読み取られた場合、その攻撃は失敗に終わる可能性があります。  

**問題を緩和する要素** **:**

-   攻撃を成功させるためには、標的にされたユーザーは OWA を使用した IE のみでメッセージを読み取っている必要があります。そのほかのメール クライアントで読み取る場合、この攻撃は失敗に終わる可能性があります。
-   攻撃を成功させるためにはまた、使用されている OWA のバージョンがわかっていることが必要になります。OWA のほかのバージョンでは、攻撃は失敗する可能性があります。
-   攻撃が成功した場合、ユーザーが Exchange Server のメールボックスで実行できる操作のみを実行することができます。ユーザーのローカル マシン上での操作を実行することはできません。ほかのユーザーのメールボックスで直接何らかの操作を実行することはできません。また Exchange Server 上で直接何らかの操作を実行することもできません。

**深刻度** **:**

|                      | インターネット サーバー | イントラネット サーバー | クライアント システム |
|----------------------|-------------------------|-------------------------|-----------------------|
| **Exchange 5.5 OWA** | 中                      | 中                      | なし                  |

上記の[評価](http://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形態およびこの脆弱性がシステムに及ぼす影響に基づいています。攻撃を成功させるためには、被害者となる可能性があるユーザーのコンピュータ環境と習慣に関するある特定の情報を得ていることが必要となります。

**脆弱性識別番号** **:**  
[CAN-2001-0726](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0726)

**テストしたバージョン** **:**  
マイクロソフトは Exchange 5.5 および Exchange 2000 のテストを行い、これらの脆弱性による影響を評価しました。それより前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------


**このセキュリティ情報はなぜ更新されたのですか?**

2001 年 12 月 6 日 (米国日付) に、このセキュリティ情報英語版を最初にリリースした直後、マイクロソフトは OWA サーバーでの Internet Explorer に、更新プログラムが適切に機能するための、バージョン特定のファイル依存要件があることを発見したため、このセキュリティ情報英語版を更新しました。この要件を満たさないサーバーに更新プログラムを適用した場合、OWA クライアントに予期されない結果がもたらされる場合があります。マイクロソフトはこの情報を追加し、セキュリティ情報英語版を更新しました。  
さらに、OWA はサーバーのそのほかの製品に依存します。その製品とは具体的に言うと Internet Explorer と IIS です。マイクロソフトはこのセキュリティ情報作成時点での、セキュリティ上の更新プログラムの対象となる依存するコンポーネントのバージョンを詳説する推奨されるバージョンの一覧を作成しました。  
最後に、マイクロソフトは Internet Explorer のバージョン要件を満たさないシステムに更新プログラムを展開したお客様のための対処法に関する情報を追加しました。

**どのようなことが起こる可能性がありますか?**

この脆弱性を利用して、攻撃者はメールのメッセージにスクリプトを埋め込み、ユーザーの Exchange メールボックスで攻撃者が選択したスクリプトを実行する可能性があります。アクティブになると、そのような悪質なメッセージはメールボックスのデータの追加、変更、削除など、ユーザーがメールボックスで実行可能な操作を行うことができます。

**何が原因で起こりますか?**

この脆弱性は OWA のコンテンツ フィルタ機能がスクリプトを検知できないことがあるために起こります。有効なメッセージがスクリプトの存在を分かりにくくするように意図的に作成されている場合、依然としてそのスクリプトを実行することが可能です。

**Outlook Web Access (OWA)** **とは何ですか?**

OWA とは Exchange 5.5 および Exchange 2000 の機能で、これによりユーザーはメール クライアントではなく、 Web ブラウザを介し電子メールにアクセスすることができます。本質的に OWA は、認証されたユーザーにインターネットを介して電子メールの読み取りや送信、予定表の管理、またはそのほかの電子メール機能を実行させる Web サイトとして Exchange サーバーを機能させます。

**Internet Explorer** **を使用している場合、OWA** **がメッセージ スクリプトを処理する方法の何が問題になっていますか?**

OWA がユーザーのリクエストを処理し、電子メールのメッセージを検索する時、特定の方法でスクリプトを埋め込み、OWA がそのスクリプトを正しくフィルタせず、スクリプトを実行するようにすることができます。

**このような** **HTML** **形式の電子メール メッセージは偶発的に作成されることはありますか?**

いいえ、ありません。偶発的に、スクリプトのフィルタリングを回避する文書が作成されることはありません。特定の詳細な知識を要し、そのようなメッセージは悪意を持って作成される必要があります。

**OWA** **のすべてのバージョンがこの脆弱性の影響を受けますか?**

いいえ。この脆弱性は Exchange 5.5 の OWA のみに影響を及ぼします。

**この脆弱性は** **Outlook** **または** **Outlook Express** **に影響を及ぼしますか?**

いいえ。この脆弱性は Outlook Web Access のみに影響を及ぼします。Outlook または Outlook Express クライアントには影響を及ぼしません。

**この脆弱性は** **OWA** **を使用するすべてのブラウザに影響を及ぼしますか?**

いいえ。この問題は OWA と共に Internet Explorer を使用している場合のみ発生します。そのほかのブラウザは影響を受けません。

**この脆弱性を利用して攻撃者は何ができますか?**

メッセージはユーザーが Exchange メールボックスで実行可能な操作を行うことができます。この操作とはメッセージやフォルダを完全な制御により操作することも含まれます。

**攻撃者はこの脆弱性をどのように使用する可能性がありますか?**

この脆弱性を利用するために、攻撃者は特別にメッセージを作成し、それを電子メールのメッセージとして標的となるユーザーに送信する必要があります。標的となるユーザーは OWA を使用しその電子メール メッセージを開く必要があります。重要な点として、ユーザーが Outlook クライアントでメッセージを開く場合、その攻撃は失敗します。この理由は、攻撃はユーザーが特定のメール クライアントを使用すること、そしてこの脆弱性の利用を成功させるためには相当のソーシャル エンジニアリングが必要となるためです。

**更新プログラムは何を修正しますか?**

この更新プログラムは OWA がインライン スクリプトを処理する方法を変更することにより、この脆弱性を排除します。更新プログラムの適用後、OWA は メッセージを Internet Explorer に送信する前にインライン スクリプトを削除します。

**どのサーバーに更新プログラムを適用する必要がありますか?**

この更新プログラムは IIS で Exchange 5.5 OWA サービスを実行しているサーバーのみに向けられています。IIS で Exchange 5.5 OWA サービスを実行していないサーバーにはこの更新プログラムを適用する必要はありません。

**更新プログラムを適用するサーバーを明確にできますか?** **この更新プログラムを** **Exchange Server** **にインストールする必要がありますか？**

明確にはできません。この更新プログラムを OWA サーバーにインストールして下さい。OWA サーバーとは OWA サービスをインストールしている IIS サーバーです。OWA サーバーが Exchange を実行しているかどうかは設定により異なります。  
ある設定では、OWA サーバーもまた Exchange を実行しています。このような設定については、このサーバーはOWA を実行しているため、サーバーに更新プログラムを適用して下さい。  
そのほかの設定では、OWA サーバーは OWA をインストールしていない Exchange を実行する別のサーバーに接続しています。このような設定については、OWA サーバーに更新プログラムを適用し、OWA をインストールしていない Exchange には更新プログラムを適用しなくてよいでしょう。
OWA をインストールしていない Exchange サーバーではなく、OWA を実行しているサーバーにのみこの更新プログラムを適用して下さい。

**これは** **MS01-030** **で修正された問題と同じですか?**

いいえ、違います。この問題は類似していますが、異なります。MS01-030 で説明した問題は HTML 形式の添付ファイルの機能がスクリプトを実行できることに関連していました。この問題はメッセージ自体の Body に特別に埋め込まれたスクリプトが実行できることに関連しています。

**しかし、MS01-030** **の 「よく寄せられる質問」 で、OWA** **は電子メールのメッセージから危険を含む可能性のあるコンテンツを削除すると説明されていました。この説明は矛盾しないのですか?**

いいえ。仕様上、Exchange 5.5 および Exchange 2000 の OWA は電子メールのメッセージの Bodyから危険を含む可能性のあるコンテンツを削除しますが、Exchange 5.5 のみに影響をおよぼすこの問題により、ある特別に作成された HTML 形式の電子メール メッセージはこの保護を無効にすることができます。

**このセキュリティ情報で説明されているバージョン要件とは何ですか?** **そのバージョン要件とは通常の** **OWA** **要件とどのように異なりますか?**

「警告」 欄では要件と Exchange 5.5 OWA サービスの基本となる要件を一覧にしています。
OWA サーバーにこの更新プログラムを正しくインストールするためには、この基本となる要件とこの追加の要件の両方を満たしている必要があります。
このセキュリティ情報のバージョン要件を満たしていないシステムにこの更新プログラムを適用した場合、予期されない結果を招くことがあります。

**使用中のサーバーはこの要件を満たしていませんが、この更新プログラムをインストールするためには何をする必要がありますか?**

使用中のサーバーがこの更新プログラムに対する Internet Explorer の要件を満たしていない場合、最初にサーバーをアップグレードしてから更新プログラムを適用して下さい。

**どのバージョンにアップグレードする必要がありますか? Internet Explorer 5.0** **にアップグレードするだけでよいのでしょうか?**

Internet Explorer 5.0 にアップグレードした場合、この更新プログラムを正しくインストールすることができます。しかし、[MS01-055](http://technet.microsoft.com/security/bulletin/ms01-055) のような最近の Internet Explorer のセキュリティ情報で説明されているように、Internet Explorer 5.5 SP2 より前のバージョンはこのセキュリティ情報作成時点で更新プログラム サポートの対象となっていません。  
このため、Internet Explorer 5.5 SP2 またはそれ以降のバージョンにアップグレードし、Internet Explorer の更新プログラム サポートの対象となるようにすることを推奨します。

**それでは使用中の** **OWA** **クライアントまたは** **OWA** **サーバーの** **Internet Explorer** **をアップグレードする必要があるのですか?**

OWA サーバーをアップグレードする必要があります。この更新プログラムに対するバージョン要件はクライアントではなく、サーバーのみに向けられています。

**このセキュリティ情報で説明されている推奨されるバージョンとは何ですか?** **それは通常の** **OWA** **要件とどのように異なるのですか?**

Exchange 5.5 OWA サービスは Internet Explorer と IIS の両方に依存します。これらの依存は OWA に必要な要件を満たしていますが、これらの要件に挙げられたバージョンは Internet Explorer に関して [MS01-055](http://technet.microsoft.com/security/bulletin/ms01-055) で、また IIS について [MS01-044](http://technet.microsoft.com/security/bulletin/ms01-044) で説明されているように、セキュリティ更新プログラムサポートの対象外です。  
このため、すべての依存するコンポーネントがセキュリティ更新プログラムサポートの対象であることを確認するため、推奨されるバージョンの一覧を作成しました。このセキュリティ情報作成時点で、これらの推奨はセキュリティ更新プログラムサポートの対象となっています。  
お客様のシステムを充分に安全にするために、基本となる OWA 推奨に加え、これらの推奨されるバージョンを満たしていることを推奨します。

**この更新プログラムのバージョン要件を満たさないシステムに更新プログラムをインストールしましたが、これを修正するために何ができますか?**

バージョン要件を満たさない OWA サーバーにこの更新プログラムをインストールした場合、Internet Explorer をバージョン 5.0 またはそれ以降にアップグレードすることができます。しかし、このセキュリティ情報で説明されているように、セキュリティ更新プログラムサポートの対象となるバージョンにアップグレードすることを推奨します。このセキュリティ情報作成時点では、そのバージョンとは Internet Explorer 5.5 SP2 またはそれ以降です。

**上記の説明に従いましたが、依然として問題があります。これからどのようにすればよいですか?**

更新プログラムの適用後、依然として問題がある場合には、マイクロソフト プロダクト サポート サービスにご連絡下さい。セキュリティ上の更新プログラムに関するすべての問い合わせは無償です。<http://support.microsoft.com/> に、プロダクト サポート サービスへの連絡方法に関する情報があります。

更新プログラム
--------------


この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft Exchange 5.5:
    [http://download.microsoft.com/download/exch55/Patch/05.05.77.2655/NT45/JA/Q313576jpni386.EXE](http://download.microsoft.com/download/exch55/patch/05.05.77.2655/nt45/ja/q313576jpni386.exe)

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**  
この更新プログラムは Exchange 5.5 SP4 OWA Service を実行しているシステムにインストールすることができます。

**再起動の必要性** **:**  
あり  
インストーラがイベント ビューアなどの外部のアプリケーションに使用され続けているために、バイナリを更新することができない場合、再起動が必要となります。

**更新プログラムに含まれる過去の修正** **:**  
[MS01-030](http://technet.microsoft.com/security/bulletin/ms01-030)

**更新プログラムのインストール確認方法** **:**

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Exchange Server 5.5\\SP5\\Q313576
-   各ファイルを確認するためには、サポート技術情報 [313576](http://support.microsoft.com/kb/313576) で、日付、時間そしてバージョン情報を参照して下さい。

**警告** **:**

-   **この更新プログラムに対する依存コンポーネントのバージョンの要件** **:**  
    この更新プログラムのインストールを成功させるためには、OWA サーバーに IE 5.0 またはそれ以降のバージョンがインストールされている必要があります。
-   **OWA** **の依存コンポーネントに推奨されるバージョン** **:**  
    この情報がリリースされた時点では、OWA サーバーの依存コンポーネントに以下のバージョンが推奨されています。
    -   IIS
        -   Windows NT 4.0 SP5 またはそれ以降のバージョン上に IIS バージョン 4.0
        -   Windows 2000 SP1 またはそれ以降のバージョン上に IIS バージョン 5.0
    -   IE:
        -   IE バージョン 5.5 SP2
        -   IE バージョン 6.0

**他のセキュリティ更新プログラムの入手先** **:**  
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS01-057）
    [http://www.microsoft.com/technet/security/bulletin/ms01-057.mspx](http://technet.microsoft.com/security/bulletin/ms01-057)
-   サポート技術情報 （KB） 文書番号 ： 313576
    [\[XGEN\] Exchange Server 5.5 SP4 以降の Outlook Web Access 更新プログラム](http://support.microsoft.com/kb/313576)

**更新履歴** **:**

-   2001/12/10: このセキュリティ情報ページを公開しました。
-   2001/12/26: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
