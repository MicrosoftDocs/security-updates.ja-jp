---
TOCTitle: 'MS01-044'
Title: 'マイクロソフト セキュリティ情報 MS01-044 - 緊急'
ms:assetid: 'ms01-044'
ms:contentKeyID: 61228409
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms01-044(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS01-044 - 緊急
===============================================

2001 年 8 月 15 日 IIS 用の累積的な修正プログラム
-------------------------------------------------

公開日: 2001年8月16日 | 最終更新日: 2001年8月30日

#### 概要 :

**このセキュリティ情報の対象となるユーザー :**
Microsoft® Windows NT® 4.0 または Windows® 2000 で Web サーバーを使用しているシステム管理者

**脆弱性の影響 :**
特権の昇格、サービス拒否をもたらす 5 つの脆弱性

**推奨する対応策 :**
システム管理者は IIS 4.0 または 5.0 を実行しているすべてのマシンに、直ちにこの更新プログラムをインストールして下さい。

**影響を受けるソフトウェア :**

-   Microsoft Internet Information Server 4.0
-   Microsoft Internet Information Services 5.0

### 詳細

問題
----

<span></span>
**技術的な説明 :**
この更新プログラムは累積的な更新プログラムで、Windows NT® 4.0 [Service Pack 5 以降](http://www.microsoft.com/japan/ntserver/downloads/sp6asrp.mspx) から現在までにリリースされた全ての IIS 5.0 用および IIS 4.0 用の更新プログラムの機能を含んでいます。この更新プログラムに含まれる更新プログラムの一覧については下記の 「更新プログラムに関する追加情報」 欄をご覧下さい。更新プログラムを適用する前に、システム管理者は同じ欄にある 「警告」 を読んでください。

この更新プログラムは、以前リリースされたすべてのセキュリティ更新プログラムとともに、IIS 4.0 および 5.0 に影響を及ぼす 5 つの新しく確認された脆弱性に対する更新プログラムも含みます。

-   URL のリダイレクトが有効である場合、IIS 4.0 サービスを異常終了させることができるサービス拒否の脆弱性。“Code Red” ワームがこの脆弱性を利用するトラフィックを生成できる場合があります。その結果、ワームの感染を受けにくかった IIS 4.0 マシンもワームにより、サービスを中断させられる可能性があります。
-   IIS 5.0 Web サーバーでのサービスを一時的に中断することができるサービス拒否の脆弱性。WebDAV は特定の長い、無効なリクエストを正しく処理しません。このようなリクエストが IIS 5.0 サービスを異常終了させる可能性があります。既定で、IIS 5.0 サービスは自動的に再起動します。
-   IIS 5.0 が特定の無効な MIME ヘッダーを含むコンテンツを解釈する方法に関連するサービス拒否の脆弱性。攻撃者がこのような異常を含むコンテンツをサーバーに配置し、リクエストした場合、その Web サイトの File Type テーブルから偽造のエントリが取り除かれるまで、IIS 5.0 サービスはコンテンツを提供することができません。
-   サーバー側インクルード (SSI) を実行するコードに関連するバッファのオーバーランの脆弱性。攻撃者がサーバーにコンテンツを置くことができる場合、そのコンテンツが処理される時に、攻撃者の選択したコードが Local System コンテキストで実行される原因となる不正な SSI ディレクティブをインクルードすることができます。
-   IIS 5.0 が、プロセスがインプロセスかアウトオブプロセスかどうかを決定する時に参照するテーブルに問題があるために起こる特権の昇格の脆弱性。IIS 5.0 には、常にインプロセスで実行するべきシステム ファイルの一覧を持つテーブルがあります。しかし、この一覧は絶対アドレス指定とともに相対アドレス指定を使用するファイルを提供します。このため、この一覧にあるファイル名と一致するファイルがインプロセスで実行される可能性があります。

さらに、この更新プログラムは、FTP および W3SVC での UPN 形式のログオンの正しい機能を元に戻すことにより、以前の IIS 用の累積的な更新プログラム (マイクロソフト セキュリティ情報 [MS01-026](http://technet.microsoft.com/security/bulletin/ms01-026) の警告欄で説明されています。) の二次的影響も排除します。

**問題を緩和する要素 :**
URL リダイレクト のサービス拒否の脆弱性 :

-   この脆弱性は IIS 4.0 のみに影響を及ぼします。IIS 5.0 はこの脆弱性の影響を受けません。
-   この脆弱性は URL リダイレクトが有効である場合のみ、発生します。
-   この脆弱性を利用して、サーバー上のデータを改ざんしたり、サーバーの管理機能を獲得することはできません。

WebDAV リクエストのサービス拒否の脆弱性 :

-   この脆弱性は IIS 5.0 のみに影響を及ぼします。IIS 4.0 はこの脆弱性の影響を受けません。
-   この脆弱性を利用した攻撃は一時的なものです。不正なリクエストが受信されなくなると、サーバーは自動的に通常のサービスを再開します。
-   この脆弱性を利用して、攻撃者は WebDAV リクエストを行うことはできません。
-   この脆弱性を利用して、サーバー上のデータを改ざんしたり、サーバーの管理機能を獲得することはできません。

MIME ヘッダーのサービス拒否の脆弱性 :

-   この脆弱性は IIS 5.0 のみに影響を及ぼします。IIS 4.0 はこの脆弱性の影響を受けません。
-   この脆弱性を利用するために、攻撃者はサーバーにコンテンツを配置する権限を持っている必要があります。しかし、既定では高い権限を持たないユーザーはサーバーにコンテンツを配置する権限はありません。最善のセキュリティ対策として、信頼されていないユーザーに、この権限 (書き込み) を付与しないことを強く推奨します。

SSI の特権の昇格の脆弱性 :

-   この脆弱性を利用するために、攻撃者はサーバーにコンテンツを配置する必要があります。しかし、既定では高い権限を持たないユーザーはサーバーにコンテンツを配置する権限はありません。最善のセキュリティ対策として、信頼されていないユーザーに、この権限 (書き込み) を付与しないことを強く推奨します。

システム ファイル一覧の特権の昇格の脆弱性 :

-   この脆弱性は IIS 5.0 のみに影響を及ぼします。IIS 4.0 はこの脆弱性の影響を受けません。
-   この脆弱性を利用するために、攻撃者はサーバーにコンテンツを配置する必要があります。しかし、既定では高い権限を持たないユーザーはサーバーにコンテンツを配置する権限はありません。最善のセキュリティ対策として、信頼されていないユーザーに、この権限 (書き込み) を付与しないことを強く推奨します。

**脆弱性識別番号 :**

-   URL リダイレクトのサービス拒否の脆弱性 : [CAN-2001-0545](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0545)
-   WebDAV のサービス拒否の脆弱性 : [CAN-2001-0508](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0508)
-   MIME ヘッダーのサービス拒否の脆弱性 [CAN-2001-0544](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0544)
-   SSI の特権の昇格の脆弱性 : [CAN-2001-0506](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0506)
-   システム ファイル一覧の特権の昇格の脆弱性 : [CAN-2001-0507](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0507)

**テストしたバージョン :**
マイクロソフトは IIS 4.0 および IIS 5.0 のテストを行い、この脆弱性による影響を評価しました。それより前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**累積的な更新プログラムとは何ですか?**

この更新プログラムは新たに発見されたいくつかの脆弱性を解決するだけでなく、これまでにリリースされた IIS 4.0 および IIS 5.0 を修正するプログラムも含んでいます。

**これまでにリリースされた更新プログラムで、この更新プログラムにまとめられたものはどれですか?**

IIS 4.0 の更新プログラムはService Pack 5 のリリース以降に IIS 4.0 用にリリースされたすべての機能を含んでいます。IIS 5.0 の更新プログラムは、これまでに IIS 5.0 用にリリースされたすべての更新プログラムの機能を含んでいます。これらの更新プログラムが含む更新プログラムの一覧はこのセキュリティ情報の 「更新プログラムに関する追加情報」 の欄に記載されています。

**この更新プログラムによって修正されない IIS に影響を及ぼすセキュリティ上の脆弱性がありますか?**

はい、あります。セキュリティ情報 MS01-044の 「警告」 の欄で説明しているように、IIS 4.0 に影響する脆弱性の中には更新プログラムではなく、管理者の操作が必要なものがいくつかあります。一方、管理者の操作が必要な IIS 5.0 の脆弱性はありません。したがって、この累積的な更新プログラムはすべてのIIS 5.0 の脆弱性を修正します。

**この更新プログラムは、IIS サーバーによく見られる Index Server やほかの製品に関する問題の修正も含んでいますか?**

原則として IIS の更新プログラムには、IIS サーバーによくみられる Index Server などほかの製品の修正は含まれていません。しかし、マイクロソフト セキュリティ情報 [MS01-033](http://technet.microsoft.com/security/bulletin/ms01-033) で説明している Index Server の脆弱性に関しては例外としました。IIS サーバーについての深刻性を考慮し、この更新プログラムに修正が含まれました。

**この更新プログラムを適用する必要があるのはどのようなマシンですか?**

少なくとも Web サーバーには適用する必要があります。しかし、ほかのシステムにも適用する必要があるものがあります。例えば、Exchange 2000 は Outlook Web Access がインストールされている場合は IIS 5.0 を使用します。この更新プログラムが必要か否かを確認するのに最も良い方法は、実行しているサービスの一覧を確認することです。IIS 4.0 または 5.0 を実行している場合、この更新プログラムを適用する必要があります。

**この更新プログラムで対処している新しいセキュリティ上の脆弱性とはどのようなものですか?**

新たに発見された脆弱性は以下の 5 つです。

-   攻撃者が IIS Web サーバーのサービスを一時的に中断させることができる 3 つの脆弱性 : 1 つ目は IIS 4.0 のみに影響を及ぼし、“Code Red” ワームによって利用される可能性があるため特に深刻です。2 つ目と 3 つ目は IIS 5.0 のみに影響を及ぼします。
-   Web サーバー上で既に高い権限を所有している攻撃者がさらに高い権限を獲得する可能性がある 2 つの脆弱性 : そのうちの 1 つ目は IIS 4.0 および IIS 5.0 の両方に影響を及ぼし、2 つ目は IIS 5.0 のみに影響を及ぼします。

**1 つ目の脆弱性でどのようなことが起こる可能性がありますか?**

1 つ目の脆弱性は、[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者がこの脆弱性を利用すると、IIS サーバーの Web リクエストへのサービスを一時的に妨害することができます。この脆弱性は、“Code Red” ワームによって活発に利用されており、その問題は、マイクロソフト セキュリティ情報 [MS01-033](http://technet.microsoft.com/security/bulletin/ms01-033) で提供されている更新プログラムにある問題のためだと広範囲にわたって不適切に報告されています。実際には、これは全く異なる脆弱性で、以前には知られていなかったものです。

この脆弱性は、IIS 4.0 サーバーのみに影響を及ぼし、さらにそれが既定以外の設定で操作されている場合にのみ影響があります。IIS 5.0 サーバーはこの脆弱性による影響は受けません。この脆弱性により、攻撃者がサーバー上の管理機能を獲得することはできません。

**何が原因で起こりますか?**

この脆弱性は URL のリダイレクトを行う IIS 4.0 内のコードが、リクエストの実際の長さが、リクエストで指定された長さと異なるケースを正しく処理しないために発生します。このようなリクエストによって、一連のイベントを引き起こし、アクセス違反が起こり、さらにはサービスが異常終了します。

**URL リダイレクトとは何ですか?**

Web ページをリクエストすると、例えば http://www.microsoft.com/technet/security のような URL を入力します。Web サーバーは、例えば、c:\\inetpub\\technet\\security\\default.asp のようなサーバー上のある特定のファイルのリクエストに、この URL をマッピングします。しかし、コンテンツを別のマシンや新しいフォルダ構成に移動させる必要がある場合がよく発生します。URL リダイレクトにより、このようなメンテナンス作業が Web サイトの訪問者にもわかるようになります。

例えば、身近な例では、Web サイトのコンテンツが再構築され、以前はc:\\inetpub\\technet\\security\\default.asp にあった Web ページが c:\\inetput\\abc\\xyz\\default.asp に移動したとします。もちろん訪問者はhttp://www.microsoft.com/abc/xyz にナビゲートし、コンテンツを表示することができますが、Web 管理者は、Web サイトへの訪問者が古い URL を使用して、“page not found” のエラーになることは避けたいと考えます。URL リダイレクトにより、Web 管理者がhttp://www.microsoft.com/technet/security によって示されるファイルを、訪問者が引き続き正しい Web ページを見ることができるように、リダイレクトすることができます。

**IIS 4.0 がURL リダイレクトをする方法の何が問題になっていますか?**

Web ページ リクエスト内には、リクエストの長さの情報があります。その情報が正しくない場合、またリクエストの実際の長さが情報の数字よりも長い場合、複雑な一連のイベントを開始し、最終的にサービスを異常終了させます。

**これはバッファ オーバーランのように思えますが、違いますか？**

バッファ オーバーランではありません。このリクエストにより、バッファをオーバーランさせることはありません。これは重要なポイントです。というのは、この問題を利用してできることは、サービスを中断させることで、サーバーの権限を獲得するために、この脆弱性を利用できないということを意味するからです。

**この脆弱性を利用して攻撃者は何ができますか?**

攻撃者は、このようなリクエストをサーバーに送信し、サーバーの有益なサービスを妨害しようとする可能性があります。

**サービスを再開するためには何をする必要がありますか?**

管理者は IIS 4.0 サービスを再起動することにより、通常のサービスを再開できます。

**この問題に Code Red ワームが関連しているのはなぜですか?**

Code Reｄ ワームがサーバーを感染しようとする場合、マイクロソフト セキュリティ情報 [MS01-033](http://technet.microsoft.com/security/bulletin/ms01-033) で説明している脆弱性を利用するリクエストを送ることによって、サーバーを感染させます。しかし、そのリクエストには、新たに発見されたサービス拒否の脆弱性を利用するのに必要な情報と一致する不正な長さの情報が含まれています。その結果、Code Reｄ ワームは、[MS01-033](http://technet.microsoft.com/security/bulletin/ms01-033) で説明されている脆弱性を利用してサーバーに感染するだけでなく、この脆弱性を利用してほかのサーバーのサービスも中断させることができます。

**この問題は、実はマイクロソフト セキュリティ情報で提供された更新プログラムに問題があるために起こったと聞きましたが、これは本当ですか?**

いいえ、違います。[MS01-033](http://technet.microsoft.com/security/bulletin/ms01-033) で提供した更新プログラムは、バッファ オーバーランの脆弱性が利用されるのを防ぐために設計され、実際に防護策となりました。ここで説明している脆弱性とはまったく異なります。

**それが正しいならば、なぜ MS01-033 の更新プログラムをインストールしたサーバーのみがこの脆弱性の影響を受けるのですか?**

MS01-033 の更新プログラムをインストールしたサーバーのみがこの脆弱性による影響を受けるわけではありません。IIS URL リダイレクトを行うすべての IIS 4.0 サーバーが、[MS01-033](http://technet.microsoft.com/security/bulletin/ms01-033) の更新プログラムをインストールしたか否かに関わらず、この脆弱性の影響を受けます。しかし、皆さんが [MS01-033](http://technet.microsoft.com/security/bulletin/ms01-033) の更新プログラムに問題があったと誤解されるのはもっともです。

Code Red ワームは [MS01-033](http://technet.microsoft.com/security/bulletin/ms01-033)で説明している脆弱性を利用してシステムに感染し、基本的に、手を加えたシステム ソフトウェアをサーバーに注入します。IIS 4.0 システムを感染させるために必要な変更は、IIS 5.0 システムを感染させるために必要な変更とは異なり、お互いに互換性はありません。Code Red ワームの作成者は、IIS 4.0 または IIS 5.0 のコードをどちらかの攻撃を与えるサーバーに注入するのかを選択する必要があり、IIS 5.0 コードを注入することを選択しました。その結果、ワームが IIS 4.0 システムに侵害した場合、ワームは IIS 5.0 のコードをサーバーに注入しており、実行されません。その代わり、感染させようとした結果は、IIS 4.0 サーバーが異常終了します。

これが2 つのまったく異なる脆弱性がまったく同じ結果をもたらす原因となります。IIS 4.0 サーバーに [MS01-033](http://technet.microsoft.com/security/bulletin/ms01-033) の更新プログラムがインストールされていない場合、Code Red ワームにより IIS 4.0 サーバーが異常終了します。しかし、更新プログラムがサーバーに適用されていても、URL リダイレクトが有効になっている場合、Code Red ワームにより、サービスは異常終了します。その原因は、[MS01-033](http://technet.microsoft.com/security/bulletin/ms01-033) で説明している脆弱性ではなく、このセキュリティ情報で説明している脆弱性によります。したがって、URLリダイレクトの実行を設定している IIS 4.0 サーバーの管理者が、[MS01-033](http://technet.microsoft.com/security/bulletin/ms01-033) の更新プログラムに欠陥があった、と考えてしまう可能性がありますが、実際には欠陥ではありません。

**URL リダイレクトは IIS 4.0 で既定で有効にされますか?**

いいえ、Web 管理者が有効に設定する必要があります。

**URL リダイレクトを有効に設定してあります。無効にする必要がありますか?**

最善の対策は、もちろん更新プログラムを適用することです。更新プログラムにより、この脆弱性の脅威がない場合には、引き続き URL リダイレクトを使用することができます。しかし、URL リダイレクトを無効にする必要がある場合、下の作業手順に従ってください。

-   インターネット サービス マネージャで、Web サイト上で右クリックをし、プロパティをクリックします。
-   \[ホーム ディレクトリ\] タブを選択します。
-   このリソースへの接続時に使用されるコンテンツの場所: というセクションで、「URL へのリダイレクト」 **以外を**選択します。
-   \[OK\] をクリックし、変更を承認します。

**この脆弱性は IIS 5.0 に影響を及ぼしますか?**

いいえ、IIS 5.0 の URL リダイレクトにはこの脆弱性による影響はありません。

**更新プログラムは何を修正しますか?**

この更新プログラムは IIS 4.0 が、長さの情報と実際の長さが異なっていても URL のリダイレクトが正しく行われるように修正し、脆弱性を排除します。

**2 つ目の脆弱性はどのようなものですか**

2 つ目の脆弱性は[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者はこの脆弱性を利用して、IIS 5.0 サーバーの Web サービスを一時的に中断させることができます。

この脆弱性を利用する影響は、一時的なものです。IIS 5.0 がこのような攻撃を受けた場合、既定で自動的に再起動します。しかし、攻撃が行われた際、有効なセッションは切断され、再びセッションを確立する必要があります。

**何が原因で起こりますか?**

この脆弱性はWebDAV は特定の長い、無効なリクエストを処理する方法のために発生します。実際の影響は、アクセス違反が起き、結果的に IIS 5.0 のプロセスが異常終了します。

**WebDAV とは何ですか?**

WebDAV とは何であるかを説明するためには、まず [HTTP](http://www.ietf.org/rfc/rfc2616.txt) （英語情報） に関して説明する必要があります。HTTP、Hypertext Transfer Protocol はWeb コンテンツを通信するための業界標準のプロトコルです。HTTP により、クライアントはWeb コンテンツをリクエストすることができ、Web サーバーがコンテンツを提供したり、クライアントにコンテンツが提供できない理由を伝えたりすることができます。

[WebDAV](http://www.ietf.org/rfc/rfc2518.txt) （英語情報） は HTTP 使用の拡張機能です。“WebDAV” の “DAV” とは “distributed authoring and versioning” を表し、権限が与えられたユーザーは、リモートで Web サーバーのコンテンツを追加、管理できる機能が得られます。WebDAV は Windows 2000 では完全にサポートされており、製品の一部として同梱されています。

**WebDAV の何が問題になっていますか?**

WebDAV はある特定の種類のリクエスト、特に長く、無効のデータを含むリクエストを正しく処理しません。WebDAV にある問題により、このようなリクエストを処理すると、アクセス違反が発生し、IIS 5.0 の処理が異常終了する結果となります。

**これはバッファ オーバーランのように思えますが、違いますか？**

いいえ、違います。この脆弱性はとても長いリクエストで発生しますが、この脆弱性を実際に発生させるのはリクエストの長さではありません。とにかく、この場合のリクエストではバッファをオーバーランさせることはありません。これは重要なポイントです。というのは、この問題を利用してできることは、サービスを中断させることで、サーバーの権限を獲得するためにこの脆弱性を利用できないということを意味するからです。

**この脆弱性により、攻撃者は何をすることができますか?**

攻撃者はこの脆弱性を利用して、IIS 5.0 サーバーのサービスを中断させることができます。この脆弱性を利用すると、IIS 5.0 のサービスが異常終了し、その結果、現行のセッションはすべて失われます。またユーザーは新たにセッションを開始することはできません。しかし、IIS 5.0 は既定で自動的に再起動するように設定されているため、その影響は長くは続きません。

**誰がこの脆弱性を利用する可能性がありますか?**

該当のサーバーとアクセスできるすべてのユーザーがこの脆弱性を利用することができます。攻撃者はマシンに対して認証を行う必要はありません。

**この脆弱性によって、攻撃者は該当のマシンで管理操作を行うことができますか?**

いいえ、できません。この脆弱性によって、攻撃者ができることはシステムのサービスを中断させることのみです。この脆弱性によって、認証されていない WebDAV コマンドを実行し、システム上のデータを改ざんしたり、管理操作を行ったりすることはできません。

**WebDAV は既定でインストールされ、実行されますか?**

はい、WebDAV は既定で IIS 5.0 Web サーバーにインストールされます。

**この脆弱性は偶然利用されることはありますか?**

いいえ。ユーザーが偶発的にここで説明したような長さと不正な WebDAV リクエストを作成してしまうことは極めて可能性が低いといえます。

**この脆弱性は IIS 4.0 に影響を及ぼしますか?**

いいえ、 WebDAV は IIS4.0 の一部として同梱されていません。

**IIS 4.0 を実行しています。この更新プログラムは必要ない、ということですか?**

はい、必ずしも必要ということではありません。この更新プログラムでは、このセキュリティ情報で説明されているすべての脆弱性の問題が扱われています。このセキュリティ情報で説明している脆弱性のいずれかによる影響を受ける場合は、この更新プログラムを適用してください。

**この更新プログラムはどのようにしてこの脆弱性を排除しますか?**

この脆弱性に関する種類の WebDAV リクエストが、アクセス違反を起こさないで拒否されるように確認します。

**3 番目の脆弱性は何ですか?**

3 番目の脆弱性は[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。この脆弱性を利用して、攻撃者は該当する Web サーバーを妨害する可能性があります。

この脆弱性を利用するために、攻撃者は該当する Web サーバーにコンテンツを配置する権限が必要です。しかし、最善のセキュリティ対策として、信頼されないユーザーにコンテンツを Web サーバーに配置する権限を付与しないことを強く推奨します。この脆弱性は IIS 5.0 サーバーのみに影響を及ぼします。攻撃者はこの脆弱性を利用して、サーバーでの権限を取得することはできません。

**何が原因で起こりますか?**

この脆弱性は IIS 5.0 がコンテンツを提供する時に MIME 情報を処理する方法に関連する問題が原因で起こります。MIME コンテンツ形式の情報が特定の方法で改ざんされている場合、サービスがその情報の処理を試行すると、サービスが異常終了する可能性があります。

**MIME とは何ですか?**

MIME とは Multipurpose Internet Mail Extensions の略称で、インターネットのコンテンツをエンコードするための業界標準プロトコルです。この名称は電子メールだけを示しているようですが、Web コンテンツなど、ほとんどのインターネット コンテンツが MIME 標準を使用して、そのコンテンツがどのような形式の情報であるかを指定します。

**Web サーバーのコンテンツはどのように MIME を使用しますか?**

Web サーバーがあるコンテンツへのリクエストを受信する際、そのコンテンツがテキスト、図形、音楽、ビデオ データなど、どのようなもので構成されているかを知る必要があります。各 Web コンテンツ ファイルにはヘッダーがあり、このような情報を提供しています。この場合、セキュリティ上の脆弱性はヘッダー内の情報が特定の方法で改ざんされている場合に発生します。

**IIS 5.0 が MIME 情報を処理する方法の何が問題になっていますか?**

IIS 5.0 サーバーの Web コンテンツが特定の無効な MIME 情報を含んでいる場合、その Web コンテンツは無効なエントリをシステム テーブルに挿入します。このため、そのエントリが取り除かれるまで、サーバーは正しくコンテンツを提供することができません。

**この脆弱性を利用して攻撃者は何ができますか?**

攻撃者が、ここで問題となっている改ざんを含むコンテンツをサーバーに配置した場合、そのコンテンツをリクエストすることで、サーバーが訪問者にコンテンツを提供できなくなる状態にすることができます。

**攻撃者はどのようにコンテンツをサーバーに配置するのですか?**

本来、攻撃者はコンテンツをサーバーに配置できるべきではありません。最善のセキュリティ対策として、信頼されないユーザーにコンテンツを Web サーバーに配置する権限を許可しないことを強く推奨します。この対応策が講じられている場合、攻撃者はこの脆弱性を利用することはできません。

**どのようにして影響を受けたサーバーはサービスを再開することができるのですか?**

Web サーバー管理者は、次の手順を行い、システム テーブル内の偽造エントリを取り除いて下さい。

-   インターネット サービス マネージャを開きます。
-   コンテンツを含む仮想ディレクトリで右クリックし、プロパティをクリックます。
-   \[HTTP ヘッダー\] タブを表示し、\[ファイルの種類\] ボタンをクリックします。
-   一覧で MIME 形式が空欄のエントリを検索し、それを削除します。

**更新プログラムは何を修正しますか?**

この更新プログラムは IIS 5.0 がここで問題となっている改ざんを含むコンテンツを、そのコンテンツの MIME 形式を指定していないように取り扱うようにします。これにより、コンテンツがリクエストされると、クライアント アプリケーションがその解析方法を知っているということを前提として、そのコンテンツが送信されるようにします。

**4 番目の脆弱性でどのようなことが起こりますか?**

4 番目の脆弱性は[バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。この脆弱性を利用して、攻撃者は該当するサーバーの管理機能を獲得し、サーバーで任意の操作を行う可能性があります。

しかし、この脆弱性はサーバーで実行しているコードによってのみ利用することができます。このため、この脆弱性を利用するために、攻撃者はサーバーにソフトウェアをインストールする権限を持っている必要があります。最善のセキュリティ対策として、信頼されないユーザーに Web サーバーにソフトウェアをインストールすることを許可しないことを強く推奨します。

**何が原因で起こりますか?**

サーバー側インクルード ファイルを処理するコードに未チェックのバッファが含まれています。改ざんされたサーバー側インクルード ディレクティブを含むサーバー側ファイルを、該当するサーバーにインストールすることにより、次にユーザーがそのファイルをリクエストした時に、攻撃者はバッファをオーバーフローさせることができます。

**サーバー側ファイルとは何ですか?**

静的な HTML ファイルなどの Web ページはブラウザによって処理されます。このような Web ページがリクエストされる場合、Web サーバーの役割は単に適切なファイルを見つけ、すべての操作を行うクライアントにそれを送信します。このようなファイルは 「クライアント側」 ファイルと呼ばれます。

これとは対照的に、多くの先進的な Web 技術では、サーバーが Web ページをブラウザに送信する前に、あるプロセスを行う必要があります。例えば、[Active Server Pages](http://msdn2.microsoft.com/en-us/library/ms972317.aspx) (英語情報) は本質的には、リクエストされると、サーバーで実行し、ブラウザに送信される HTML ファイルを生成するプログラムです。このようなファイルは 「サーバー側」 ファイルと呼ばれています。この脆弱性では、サーバー側インクルード ファイルと呼ばれるサーバー側ファイルと関連する特定の種類のファイルが処理される方法に問題があります。

**サーバー側インクルード ファイルとは何ですか?**

[サーバー側インクルード (Server-side includes)](http://www.microsoft.com/windows2000/ja/server/iis/htm/core/iisiwelc.htm) (SSI) により、Web 開発者はサーバー側ファイルを作成するために必要な作業を減らすことができます。SSI ディレクティブをサーバー側ファイルにインクルードすることにより、Web 開発者は １ つのファイル (SSI ファイルと呼ばれています) のコンテンツを別のファイルに組み入れることができます。その後組み合わされたファイルが処理されます。

例えば、特定の Web サイトの各 Web ページに企業の著作権表示が必要であるとします。著作権表示を表示するために各サーバー側ファイルにコードを追加する代わりに、開発者は HTML コードを含む SSI ファイルを作成することができます。そして SSI ディレクティブをサーバーの各 Web ファイルに追加し、そのファイルが著作権表示ファイルを組み入れるようにします。これにより、コーディングの手間を省き、開発者は SSI ファイルの SSI ディレクティブを変更するだけで、各 Web ページの著作権表示を変更することができます。

**SSI ファイルが処理される方法の何が問題なのですか?**

IIS 4.0 および 5.0 は SSI ディレクティブを処理するコードに未チェックのバッファを含んでいます。サーバー側ファイルが特定の不正な SSI ディレクティブを含むようにコーディングされた場合、そのファイルがリクエストされると、バッファのオーバーランが発生します。

通常のバッファのオーバーランのように、次のいずれかの影響があります。バッファがランダムなデータでオーバーランさせられると、該当するコード （この場合は IIS プロセス） が異常終了します。また、バッファが綿密に選択されたデータでオーバーランさせられると、未チェックのバッファを含むコードが変更される可能性があります。この説明の後半部では、その深刻性のため、後者の例に焦点を当てます。

**これにより攻撃者は何ができますか?**

IIS プロセスに攻撃者の選択した新しい操作をさせるために、攻撃者はこの脆弱性を利用して、IIS プロセスが実行中に、このプロセスを変更することができます。

**どのセキュリティ コンテキストで攻撃者のコードが実行されるのですか?**

未チェックのバッファを含むコードは Local System コンテキストで実行するため、攻撃者のコードも同様に Local System コンテキストで実行します。Local System コンテキストはシステムで最も高いセキュリティ コンテキストであるため、この脆弱性を利用して、攻撃者はマシンの管理機能を取得することができます。また、Web コンテンツの変更、システムの再設定、ハード ドライブの再フォーマットなど、実質上そのほかの任意の操作を行うことができます。

**攻撃者はどのようにこの脆弱性を利用するのですか?**

この脆弱性を利用するために、攻撃者はサーバー側ファイルを作成し、それを該当するサーバーに配置する権限が必要です。これが行われると、ファイルへのリクエストが攻撃者またはほかのユーザーにより行われても、バッファのオーバーランが引き起こされます。

**しかし、上記の説明では、攻撃者がサーバーにファイルを配置できることが前提となっています。攻撃者がこれを行うことができる可能性はどの程度ですか?**

既定の状態では、信頼されていないユーザーはサーバーにファイルを配置することはできません。IIS 4.0 および 5.0 の既定の許可では、Web サイト訪問者がファイルをサーバーにアップロードすることを拒否します。そしてこの脆弱性はこの制限を回避する手段を提供しません。攻撃者は既に Web サーバーをある程度妨害している必要があります。例えば、この脆弱性を利用する前に、サーバーの構成を変更している必要があります。

しかしながら、この脆弱性を軽視するべきではありません。攻撃者がある程度、サーバーへのアクセスを取得した場合、この脆弱性により、攻撃者は妨害の範囲を著しく広げることができます。

**この更新プログラムはどのようにしてこの脆弱性を排除しますか?**

この更新プログラムは該当するコードに正しい入力チェックを設けることによって、この脆弱性を排除します。

**5 番目の脆弱性でどのようなことが起こる可能性がありますか?**

5 番目の脆弱性は[特権の昇格](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。IIS 5.0 Web サーバーに自分が選択したプログラムをロードし、そして実行する権限を持つ攻撃者は、この脆弱性を利用してオペレーティング システム自体のセキュリティ コンテキストでそのプログラムを実行することができます。これにより、攻撃者のプログラムは実質上、サーバーで任意の操作を行うことができます。

攻撃者が Web サーバーにプログラムをロードし、それを実行することができるという条件は、この脆弱性を利用することを非常に困難にしています。最善のセキュリティ対策が講じられている場合、信頼されているユーザーだけがこれを行うことができ、そのユーザーのコードだけが後に検査されています。

**何が原因で起こりますか?**

IIS 5.0 には、既定で 「イン プロセス」 で動作する実行可能ファイルの一覧があります。この脆弱性は名前を指定するこの一覧が、絶対パスとともに相対パスを使用し、「イン プロセス」 で動作するために起こります。ここで、相対パスを使用するということは、一覧にある名前と同じ名前を持つ実行可能ファイルがサーバーのフォルダにアップロードされ、実行されると、そのファイルはイン プロセスで実行します。これが行われると、実行可能ファイルは定義により、システム権限を取得します。

**「イン プロセス」 で実行するとはどのような意味ですか?**

IIS ではプログラムがサーバーで実行される時に、IIS プロセスの一部として実行されるか、または別のプロセスとして実行されるかを設定することができます。前者の例は 「イン プロセス」 で実行すると呼ばれます。そして後者の例は 「アウト オブ プロセス」 で実行すると呼ばれます。

イン プロセスで実行はアウト オブ プロセスで実行よりもさらによい性能を提供します。しかし、これは潜在的なセキュリティ上の代償をともないます。仕様上、イン プロセスで実行しているプログラムは常に親プロセス、この場合 IIS 自体の権限、を取得できます。IIS 4.0 では、すべてのプログラムは既定でイン プロセスで実行します。このため、管理者は信頼されるコードだけがサーバーにロードされることを確認する必要があります。IIS 5.0 では、いくつかの例外を除いて、プログラムはアウト オブ プロセスで実行します。この脆弱性はこれらの例外が処理される方法のため起こります。

**その例外とは何ですか? また例外が処理される方法の何が問題になっていますか?**

IIS 5.0 には信頼され、サーバーでの既定の設定に関わらず、イン プロセスで実行が許可されているプログラムの一覧があります。この一覧にあるプログラムはすべて製品に同梱されています。問題はこの一覧がプログラムを指定する方法にあります。

**例外が指定される方法の何が問題なのですか?**

セキュリティ上の脆弱性は例外の一覧にあるファイルが、絶対パス名 (例 : c:\\folder1\\folder2\\program.dll) と相対パス名 (例 : program.dll) を使用して指定されるために起こります。このため、この例外と同じ名前を持つプログラムがサーバーのフォルダにロードされ、実行されると、そのプログラムはイン プロセスで実行し、システム レベルの権限を取得することができます。

**これにより攻撃者は何ができますか?**

攻撃者が自分が選択したプログラムを IIS 5.0 サーバーにロードし、それを実行できる場合、そのコードはシステム権限を取得することができます。これにより、攻撃者はサーバーで管理機能を取得することができます。攻撃者は Web ページの変更、サーバーの再設定、ハード ドライブの再フォーマットなど、任意の操作を行うことができます。

**しかし、上記の説明では、攻撃者がプログラムをサーバーにロードし、実行できることが前提となっています。攻撃者がこれを行うことができる可能性はどの程度ですか?**

既定の状態では、信頼されていないユーザーはサーバーにプログラムをロードし、実行することはできません。このため、攻撃者がこの脆弱性を利用する前に、次のいずれかが必要条件となります。それは管理者がサーバーを誤った設定をする、または攻撃者が何らかの手段で、サーバーの作成者権限を取得することです。

**この脆弱性は IIS 4.0 に影響を及ぼしますか?**

いいえ、IIS 4.0 には影響を及ぼしません。その理由をここで明確にしておきます。上記の説明から 2 点思い出して下さい。

-   イン プロセスまたはアウト オブ プロセスで実行するプログラムのメカニズムは IIS 5.0 で導入されました。
-   IIS 4.0 では、すべてのプログラムは既定でイン プロセスで実行します。

この脆弱性は IIS 4.0 にはない、新しく導入されたメカニズムに問題があるため起こります。しかし、攻撃者がプログラムを IIS 4.0 サーバーにロードし、それを実行した場合、既定でコードはイン プロセスで実行するため、攻撃者は IIS 4.0 サーバーでの権限を取得することができます。したがって、IIS 4.0 サーバーの管理者にとって、信頼されたコードだけをサーバーにロードすることは非常に重要です。

**IIS 4.0 を実行していますが、更新プログラムは必要ですか?**

はい、必要です。この更新プログラムはこのセキュリティ情報で説明されているすべての脆弱性 (このうち 1 つは IIS 4.0 に影響を及ぼします。) を解決します。システムがこのセキュリティ情報で説明されている脆弱性の影響を受ける場合、この更新プログラムを適用して下さい。

**更新プログラムはどのようにしてこの脆弱性を排除しますか?**

この更新プログラムはイン プロセスで実行すべきプログラムの一覧が絶対アドレス指定のみを使用して指定されるようにします。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft IIS 4.0(Windows NT 4.0):
    [http://www.microsoft.com/downloads/details.aspx?FamilyId=7DD8F695-FA97-4378-B57B-7BCCF3533BE3&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=7dd8f695-fa97-4378-b57b-7bccf3533be3&displaylang=ja)
-   Microsoft IIS 5.0(Windows 2000):
    この問題に対する修正は Windows 2000 Service Pack 3 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

    <http://www.microsoft.com/japan/windows2000/downloads/>
    なお、個別の更新プログラムは以下の Web サイトから入手できます。

    -   PC/AT 互換機用 :
        [http://www.microsoft.com/downloads/details.aspx?FamilyId=F74552AC-4313-4F93-9412-539DCA0753EB&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=f74552ac-4313-4f93-9412-539dca0753eb&displaylang=ja)
    -   NEC PC-9800シリーズ用 :
        [http://download.microsoft.com/download/win2000platform/patchNEC/q301625/NT5/JA/Q301625\_W2k\_sp3\_nec98\_ja.exe](http://download.microsoft.com/download/win2000platform/patchnec/q301625/nt5/ja/q301625_w2k_sp3_nec98_ja.exe)

#### 更新プログラムに関する追加情報

**対象プラットフォーム :**

-   IIS 4.0 用更新プログラムは Windows NT 4.0 Windows NT 4.0 Service Pack 5 または [Service Pack 6a](http://www.microsoft.com/japan/ntserver/downloads/sp6a.mspx) を実行しているシステムにインストールすることができます。
-   IIS 5.0 用更新プログラムは Windows 2000 Service Pack 1 または Service Pack 2 を実行しているシステムにインストールすることができます。

**今後リリースされるサービス パックに含まれる更新プログラム :**
これらの問題に対する更新プログラムは Windows 2000 Service Pack 3 に含まれています。

**再起動の必要性 :**

-   IIS 4.0: あり
-   IIS 5.0: ほとんどの場合、更新プログラムは再起動を必要としません。インストールプログラムは、必要なサービスを停止し、更新プログラムを適用し、そしてサービスを再起動します。しかし、必要なサービスが何らかの理由で停止できない場合、再起動が必要となります。このような場合は、再起動が必要であるというメッセージが表示されます。

**更新プログラムに含まれる過去の修正 :**

-   IIS 4.0 用更新プログラムは次のセキュリティ情報で提供された更新プログラムを含みます。

    -   マイクロソフト セキュリティ情報 [MS01-033](http://technet.microsoft.com/security/bulletin/ms01-033)
    -   マイクロソフト セキュリティ情報 [MS01-026](http://technet.microsoft.com/security/bulletin/ms01-026) (これは以前の IIS 用の累積的な更新プログラムで、追加の更新プログラムを含みます。)
-   IIS 5.0 用更新プログラムは次のセキュリティ情報で提供された更新プログラムを含みます。

    -   マイクロソフト セキュリティ情報 [MS01-033](http://technet.microsoft.com/security/bulletin/ms01-033)
    -   マイクロソフト セキュリティ情報 [MS01-026](http://technet.microsoft.com/security/bulletin/ms01-026) (これは以前の IIS 用の累積的な更新プログラムで、追加の更新プログラムを含みます。)

**更新プログラムのインストール確認方法 :**
IIS 4.0:

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Hotfix\\Q301625
-   各ファイルを確認するためには、サポート技術情報 [297860](http://support.microsoft.com/kb/297860) のファイル欄を参照して下さい。

IIS 5.0:

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP3\\Q301625
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP3\\Q301625\\Filelist

**警告 :**

-   IIS 4.0 サーバーに影響を及ぼす 4 つの脆弱性に対する更新プログラムはこの更新プログラムに含まれていません。その理由として、これらの更新プログラムはソフトウェア変更ではなく、管理者の操作が必要であるためです。管理者はこの更新プログラムの適用とともに、次のセキュリティ情報で説明されている管理操作を行ってください。

    -   マイクロソフト セキュリティ情報 [MS00-028](http://technet.microsoft.com/security/bulletin/ms00-028)
    -   マイクロソフト セキュリティ情報 [MS00-025](http://technet.microsoft.com/security/bulletin/ms00-025)
    -   マイクロソフト セキュリティ情報 [MS99-025](http://technet.microsoft.com/security/bulletin/ms99-025) (英語情報) (このセキュリティ情報では、マイクロソフト セキュリティ情報 [MS98-004](http://technet.microsoft.com/security/bulletin/ms98-004) (英語情報) と同じ問題について説明しています。)
    -   マイクロソフト セキュリティ情報 [MS99-013](http://technet.microsoft.com/security/bulletin/ms99-013) (英語情報)
-   Front Page Server Extensions および Index Server などの製品は IIS に密接な関連があり、通常 IIS サーバーにインストールされますが、このような IIS 以外の製品に関連する脆弱性に対する更新プログラムはこの更新プログラムに含まれていません。現在までリリースされたセキュリティ情報でこれらの脆弱性について説明しているものは以下の通りです。

    -   マイクロソフト セキュリティ情報 [MS01-043](http://technet.microsoft.com/security/bulletin/ms01-043)
    -   マイクロソフト セキュリティ情報 [MS01-025](http://technet.microsoft.com/security/bulletin/ms01-025)
    -   マイクロソフト セキュリティ情報 [MS00-084](http://technet.microsoft.com/security/bulletin/ms00-084)
    -   マイクロソフト セキュリティ情報 [MS00-006](http://technet.microsoft.com/security/bulletin/ms00-006)
        しかし、1 つ例外があります。マイクロソフト セキュリティ情報 [MS01-033](http://technet.microsoft.com/security/bulletin/ms01-033) で説明されている Index Server に影響を及ぼす脆弱性に対する更新プログラムは、この更新プログラムに含まれます。IIS サーバーに関するこの問題の深刻性のため、この更新プログラムが含まれることになりました。
-   IIS 5.0 サーバーで WebDAV を無効にしているお客様は、この更新プログラムをインストールする前に、WebDAV を再度有効にし、httpext.dll の更新されたバージョンがインストールされていることを確認して下さい。
-   IIS 4.0 を使用しているお客様は、この更新プログラムやほかのセキュリティ更新プログラムをインストールする前に正しい[インストールの順序](http://www.microsoft.com/japan/products/ntserver/white_papers/install.htm)をご覧下さい。特に、IIS 4.0 サービスをインストールした後、Windows NT 4.0 Service Pack 5 または 6a を適用した (または再適用した) お客様は、この正しいインストールの順序を確認して下さい。

**他のセキュリティ更新プログラムの入手先 :**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報 :**

-   US マイクロソフトセキュリティ情報（MS01-044）
    [http://www.microsoft.com/technet/security/bulletin/ms01-044.mspx](http://technet.microsoft.com/security/bulletin/ms01-044)
-   サポート技術情報 （KB） 文書番号 ： 294774
    [分離 レベル が \[高 (分離 プロセス )\] の設定が有効にならない](http://support.microsoft.com/kb/294774)
-   サポート技術情報 （KB） 文書番号 ： 297860
    [\[IIS\] IIS5 セキュリティと NT4 SP5 以降の IIS4 更新プログラムのロールアップ](http://support.microsoft.com/kb/297860)
-   サポート技術情報 （KB） 文書番号 ： 298340
    [WebDAV のサービス拒否に対する更新プログラム](http://support.microsoft.com/kb/298340)
-   サポート技術情報 （KB） 文書番号 ： 301625
    [SSI の特権の昇格の弱点のために利用可能な更新プログラム](http://support.microsoft.com/kb/301625)
-   サポート技術情報 （KB） 文書番号 ： 304867
    [MIME ヘッダーのサービス拒否の脆弱性に対する更新プログラム](http://support.microsoft.com/kb/304867)
-   サポート技術情報 （KB） 文書番号 ： 305359
    [無効なContent Lengthが原因でWebサービスにエラーが発生](http://support.microsoft.com/kb/305359)

**更新履歴 :**

-   2001/8/16: このセキュリティ情報ページを公開しました。
-   2001/8/20: この問題に対する IIS 4.0 の日本語版更新プログラムを公開しました。
-   2001/8/24: このセキュリティ情報を更新し、再起動の必要性に関する情報を明確にしました。
-   2001/8/27: この問題に対する日本語版 KB JP305359、JP304867、JP294774、JP301625、および JP298340 を公開しました。
-   2001/8/30: この問題に対する日本語版 KB JP297860 を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
