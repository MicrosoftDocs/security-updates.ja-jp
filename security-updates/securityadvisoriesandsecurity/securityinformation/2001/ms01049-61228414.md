---
TOCTitle: 'MS01-049'
Title: 'マイクロソフト セキュリティ情報 MS01-049'
ms:assetid: 'ms01-049'
ms:contentKeyID: 61228414
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms01-049(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS01-049
========================================

深くネスト化した OWA リクエストによりサーバーの CPU が消費される
----------------------------------------------------------------

公開日: 2001年9月27日 | 最終更新日: 2001年10月10日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Exchange 2000 を使用しているシステム管理者

**脆弱性の影響** **:**
サービス拒否

**推奨する対応策** **:**
Outlook Web Access でメール サービスを提供している管理者は、更新プログラムを適用してください。

**影響を受けるソフトウェア** **:**

-   Microsoft Exchange 2000 Server Outlook Web Access

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
Exchange 2000 Outlook Web Access は、認証されているユーザーのフォルダ構成が有効であるか最初に確認せずに、そのユーザーのメールボックスの中のアイテムのリクエストを受け、処理してしまうためにセキュリティ上の脆弱性が存在します。攻撃者は、自分のメールボックスの使用していない深くネスト化したフォルダにリクエストを繰り返し送信することによってサービス拒否の攻撃を仕掛けることができます。
この脆弱性が利用されると必ず OWA サーバー自体に影響が及ぶというわけではありません。この脆弱性の影響によって、攻撃者のメールボックスのサービスの処理が、サービスを実行しているサーバー上で使用可能な CPU のほとんど、あるいはすべてを消費する可能性があります。ほとんどの場合、この処理は OWA サーバー上で実行され、OWA サーバーの CPU が消費されます。しかし、攻撃者のメールボックスのサービスの処理がバック エンド サーバー上で行なわれている場合、この脆弱性が利用されると、バック エンド サーバーの CPU が消費されることになります。いずれの場合も、リクエストが処理されると該当のサーバーは通常のサービスを再開します。

**問題を緩和する要素** **:**

-   サーバーに認証されているユーザーのみがこの脆弱性を利用することができます。
-   攻撃者がこの脆弱性を利用するためには、最低 1 つのメールボックスへのアクセス権を所有している必要があります。
-   ユーザーは、アクセス権があるメールボックスに対してのみこのタスクを実行することができます。
-   この脆弱性により、メールボックス ストアがメールボックスのデータをクラッシュさせたり、腐敗させたりすることはありません。

**脆弱性識別番号** **:**
[CAN-2001-0666](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2001-0666)

**テストしたバージョン** **:**
マイクロソフトは Exchange 5.5 および Exchange 2000 のテストを行い、これらの脆弱性による影響を評価しました。それより前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**どのようなことが起こる可能性がありますか?**

これは[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者がこの脆弱性を利用すると、一時的にメール サーバーのリソースのほとんど、あるいはすべてを消費させ、サーバーの動作を遅くさせるかまたはほかのユーザーがメールにアクセスできないように妨害することができます。
攻撃者はこの脆弱性を利用しても、ほかのユーザーのメールを追加、削除、変更、表示することはできません。この脆弱性を利用するためには、攻撃者はサーバー上のメールボックスへのアクセス権を最低でも 1 つは所有している必要があります。この脆弱性が利用された場合の影響は一時的で、攻撃が止まるとサーバーは通常のサービスを再開します。

**何が原因で起こりますか?**

この脆弱性は、Exchange 2000 Outlook Web Access （OWA） が、認証されたユーザーのサーバーへのリクエストが複雑であってもそれを規制しないために発生します。極端に複雑な構造のリクエストを作成することにより、ユーザーはリクエスト アイテムを処理するサーバーで使用可能な CPU をすべて消費することができる可能性があります。

**OWA** **とは何ですか?**

OWA はExchange 5.5 および 2000 の機能の 1 つで、この機能により、メール クライアントではなく Web ブラウザを介して電子メールにアクセスすることができます。基本的には OWA により、認証されたユーザーがメールの読み取り、送信、カレンダの管理、インターネット経由でのほかのメールの操作の実行が可能になる Web サイトとしてもExchange サーバーが機能するようになります。

**OWA** **の何が問題になっていますか?**

OWA がユーザーからのある特定のメール フォルダにアクセスするためのリクエストを処理する際、OWA はそのフォルダが実際に存在するか最初にチェックしません。極端に複雑なフォルダ構造 （例えば、1 つのツリーに 1 万フォルダの深さにネスト化したフォルダ） のリクエストを送信することによって、サーバーがそのリクエストを処理するのに非常に長い時間を費やす可能性があります。

**フォルダは実際に存在する必要がありますか?**

いいえ、リクエストされたフォルダは有効である必要はありません。非常に深くネスト化したリクエストならばすべてこの脆弱性を利用できます。

**この脆弱性を利用して、攻撃者は何ができますか?**

深くネスト化したフォルダにリクエストを繰り返し送信することにより、攻撃者は使用可能なサーバーの CPU を占有し、その結果、サーバーの応答を遅らせたり、リクエストが終了するまで完全に反応できないようにさせる可能性があります。

**この脆弱性を利用した場合の影響はどのくらい継続しますか?**

リクエストの複雑性によって異なります。しかし、そのリクエストの処理が終了すると、サービスは通常に回復します。

**この脆弱性によりどのくらいのサーバーが影響を受けますか?**

サーバーの構成によって異なります。OWA はユーザーのメールボックスを管理するプロセスにリクエストを送信します。そのプロセスが OWA と同じサーバーで実行されている場合、OWA サーバーのみが影響を受けます。一方そのプロセスがほかのサーバー上で実行されている場合は、OWA サーバーではなく、そのサーバーが影響を受けます。この更新プログラムは、ユーザーのメールボックスをホストしている Exchange サーバーのみに適用する必要があります。

**誰がこの脆弱性を利用する可能性がありますか?**

メール サーバーに認証されたユーザーのみがこの脆弱性を利用することができ、それもサーバー上のメールボックスへのアクセスを所有している場合にのみこの脆弱性を利用できます。

**この脆弱性を利用してサーバーを制御することはできますか?**

いいえ、できません。悪意のあるユーザーがこの脆弱性を利用してできることは、サービス拒否の攻撃のみです。その場合、そのユーザーは認証されている必要があります。

**Exchange** **を使用していますが、OWA** **は提供していません。更新プログラムが必要ですか?**

いいえ、必要ではありません。OWA を提供している Exchange サーバーのみが更新プログラムが必要です。

**更新プログラムは何を修正しますか?**

この更新プログラムは、認証されたユーザーからのネスト化したリクエストの深さを制限することによってこの脆弱性を排除します。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft Exchange 2000:
    [http://www.microsoft.com/downloads/details.aspx?FamilyId=BCE1283E-12F5-4BCE-A43C-D21473F16ECD&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=bce1283e-12f5-4bce-a43c-d21473f16ecd&displaylang=ja)

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**
この更新プログラムは Microsoft Exchange 2000 Service Pack 1 を実行しているシステムにインストールすることができます。

**今後リリースされるサービスパックに含まれる更新プログラム** **:**
この問題に対する更新プログラムは Exchange 2000 Service Pack 2 に含まれています。

**再起動の必要性** **:**
あり

**更新プログラムに含まれる過去の修正** **:**
[MS01-041](http://technet.microsoft.com/security/bulletin/ms01-041)

**更新プログラムのインストール確認方法** **:**

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Updates\\Exchange Server 2000\\SP2\\Q303451
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。
    HKEY\_LOCAL\_MACHINE \\Software\\Microsoft\\Updates\\Exchange Server 2000\\SP2\\Q303451\\filelist

**警告** **:**
なし

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS01-049）
    [http://www.microsoft.com/technet/security/bulletin/ms01-049.mspx](http://technet.microsoft.com/security/bulletin/ms01-049)
-   サポート技術情報 （KB） 文書番号 ： 304233
    [Exchange 2000 Server SP1 コンピュータでStore.exeのCPU使用率が増加](http://support.microsoft.com/kb/304233)

**更新履歴** **:**

-   2001/9/27: このセキュリティ情報ページを公開しました。
-   2001/10/10: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。  

*Built at 2014-04-18T01:50:00Z-07:00*
