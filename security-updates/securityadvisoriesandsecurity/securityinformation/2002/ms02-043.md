---
TOCTitle: 'MS02-043'
Title: 'マイクロソフト セキュリティ情報 MS02-043 - 警告'
ms:assetid: 'ms02-043'
ms:contentKeyID: 61228468
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-043(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS02-043 - 警告
===============================================

SQL Server 用の累積的な修正プログラム (316333)
----------------------------------------------

公開日: 2002年8月16日 | 最終更新日: 2003年2月3日

#### 概要 :

このセキュリティ情報の対象となるユーザー **:**
Microsoft® SQL Server™ 7.0 および SQL Server™ 2000、Microsoft Desktop Engine 1.0 および 2000 を使用しているシステム管理者

**脆弱性の影響** **:**
特権の昇格

**最大深刻度** **:**
中

**推奨する対応策** **:**
システム管理者は、影響を受けるシステムに更新プログラムを適用してください。

**注** **:**
このセキュリティ情報で提供された累積的な更新プログラムは "SQL Slammer" ワーム ウイルスに対し、SQL Server 2000 および MSDE 2000 を保護する効果があります。しかし、この累積的な更新プログラムは [MS02-061](http://technet.microsoft.com/security/bulletin/ms02-061) でリリースされた更新プログラムに含まれています。MS02-061 の更新プログラムにはこれらの製品に存在するそのほかの脆弱性に対する修正も含まれています。マイクロソフトは SQL 2000 および MSDE 2000 を使用しているお客様に [MS02-061](http://technet.microsoft.com/security/bulletin/ms02-061) でリリースされた更新プログラムを適用することを推奨します。

**影響を受けるソフトウェア** **:**

-   Microsoft SQL Server 7.0
-   Microsoft Data Engine (MSDE) 1.0
-   Microsoft SQL Server 2000
-   SQL Server 2000 Desktop Engine (MSDE 2000)

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
この累積的なセキュリティ更新プログラムは、マイクロソフト サポート技術情報 [317748](http://support.microsoft.com/kb/317748) で提供された更新プログラム (これは SQL Server 2000 および MSDE 2000 の安定動作に必要となります) を含みません。[317748](http://support.microsoft.com/kb/317748) の更新プログラムを適用する前に、SQL Server 2000 または MSDE 2000 インストールにこの累積的な更新プログラムを適用した場合、この累積的な更新プログラムのファイルを上書きしないために、ファイルの上書きの確認メッセージが表示された場合、\[いいえ\] を選択して下さい。

これは累積的な更新プログラムで、SQL Server 7.0 および 2000 用に、過去にリリースされたすべての更新プログラムを含みます。さらに、新たに確認された脆弱性を排除します。

SQL Server 7.0 および SQL Server 2000は拡張ストアド プロシージャを提供しています。拡張ストアド プロシージャ は、C または C\# などのプログラミング言語で記述された外部ルーチンです。これらのプロシージャは、ユーザーには一見通常のストアド プロシージャのように見え、同じように呼び出し、実行することができます。既定で、SQL Server 7.0 および SQL Server 2000 には様々なヘルパー機能として使用される多くの拡張 ストアド プロシージャがあります。

マイクロソフトが提供している、SQL Server サービス アカウントとしてデータベースに再接続する機能を持つ、いくつかの拡張ストアド プロシージャで、共通の問題が存在します。その問題により、権限を持たないユーザーにその拡張ストアド プロシージャを実行できる弱いアクセス権が与えられてしまいます。これらの拡張ストアド プロシージャは、データベース上で、管理者権限で実行できるため、権限を持たないユーザーがストアド プロシージャをデータベース上で、管理者権限で実行できる可能性があります。

攻撃者は、次のいずれかの方法でこの脆弱性を悪用する可能性があります。まず、攻撃者は影響を受ける拡張ストアド プロシージャの 1 つを呼び出すデータベース クエリを読み込み、実行を試みる可能性があります。または、Web サイトや他のデータベースのフロントエンドが任意のクエリにアクセスし、処理する設定がされている場合、攻撃者は問題となっている機能の 1 つを不正なパラメータを使用して呼び出すようなクエリを実行できる可能性があります。

**問題を緩和する要素** **:**

-   この脆弱性が悪用された場合の影響は、SQL Server サービスの構成によって異なります。SQL Server は管理者が選択したセキュリティ コンテキストで実行するように設定することができます。既定で、このコンテキストはドメイン ユーザーに設定されます。既定が選択されている場合、攻撃者が引き起こす可能性がある被害を最小限にすることができます。
-   セキュリティ上の最善策を講じることによって、この脆弱性が悪用されるのを防ぐことができます。具体的には、信頼されないユーザーがデータベース サーバーで任意のクエリを読み込み、実行できないように設定しておく必要があります。また、データベースが外部からアクセスできる場合、そのデータベースに対するクエリは、すべての入力を処理前にフィルタリングする必要があります。

**深刻度** **:**

|                                            | インターネット サーバー | イントラネット サーバー | クライアント システム |
|--------------------------------------------|-------------------------|-------------------------|-----------------------|
| **SQL Server 7.0 (MSDE 1.0** **を含む)**   | 中                      | 中                      | 中                    |
| **SQL Server 2000 (MSDE 2000** **を含む)** | 中                      | 中                      | 中                    |

上記の[評価](http://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。この脆弱性を悪用すると、管理者としてストアド プロシージャを実行することができますが、セキュリティ上の最善策を講じ、クエリを実行する権限を制限することによって、この脆弱性の危険性を大幅に削減することができます。

**脆弱性識別番号** **:**
[CVE-CAN-2002-0721](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0721)

**テストしたバージョン** **:**
マイクロソフトは SQL Server 7.0 および SQL Server 2000 のテストを行い、これらの脆弱性による影響を確認しました。それより前のバージョンに関してはサポートの対象となっていないため、この脆弱性による影響は不明です。攻撃者がこの脆弱性を悪用すると、サーバー上でコードを実行することができる可能性がありますが、セキュリティ上の最善策が講じられている場合、この脆弱性が悪用される可能性および攻撃された場合の被害は制限されます。

よく寄せられる質問
------------------

<span></span>
**この累積的な更新プログラムを**[**317748**](http://support.microsoft.com/kb/317748)**で説明された更新プログラムと関連してインストールする場合の正しい順序を教えて下さい。**

この累積的なセキュリティ更新プログラムは、サポート技術情報 [317748](http://support.microsoft.com/kb/317748) で提供された更新プログラム (これは SQL Server 2000 および MSDE 2000 の安定動作に必要となります) を含みません。インストールの正しい順序は、まず [317748](http://support.microsoft.com/kb/317748) の更新プログラムを適用し、次にこの累積的なセキュリティ更新プログラムを適用します。サポート技術情報 [317748](http://support.microsoft.com/kb/317748) の更新プログラムを適用する前に、SQL Server 2000 または MSDE 2000 のインストールにこの累積的な更新プログラムを適用した場合、この累積的な更新プログラムのファイルを上書きしないために、ファイルの上書きの確認メッセージが表示された場合、\[いいえ\] を選択して下さい。

**この累積的な更新プログラムがインストールされているかどうかはどのように確認するのですか?**

この累積的な更新プログラムを適用したインスタンスの \\MSSQL\\BINN フォルダ内の ssnetlib.dll のバージョンが 2000.80.636.0 であることを確認して下さい。

\\MSSSQL\\BINN フォルダ内の ssnetlib.dll のバージョンが 2000.80.636.0 より前である場合、この累積的な更新プログラムを再適用する必要があります。しかし、マイクロソフトは [MS02-061](http://technet.microsoft.com/security/bulletin/ms02-061) で説明されているように、最新のセキュリティ更新プログラムを適用することを推奨します。この理由は、最新の更新プログラムにはこれらの製品に存在するそのほかのセキュリティ上の脆弱性に対する修正が含まれているためです。

**この更新プログラムはどのような脆弱性を排除しますか?**

これは[特権の昇格](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。この脆弱性は、マイクロソフトが提供する拡張ストアド プロシージャのいくつかで発生します。影響を受ける拡張ストアド プロシージャで、攻撃者がこの脆弱性を悪用した場合、データベースおよびサーバー自体を制御できる可能性があります。最悪の場合、攻撃者はデータベースでデータの追加、変更、削除,オペレーティング システムの再構成、新たなソフトウェアのインストール、ハードドライブの再フォーマットを行なう可能性があります。しかし、以下のセキュリティ上の最善策が講じられている場合、この脆弱性の影響を大幅に軽減できます。

-   SQL Server は最小限の特権管理の規則に従ったセキュリティ コンテキストで実行するように構成することができます。既定で、SQL Server は、サーバー上で権限が非常に限定されたドメイン ユーザーのセキュリティ コンテキストで実行されます。これが講じられている場合、攻撃者がオペレーティング システム上で実行できる操作を制限することができます。
-   この脆弱性を悪用するには、攻撃者が作成したクエリをサーバー上で読み込み、実行するか、任意の情報をシステム上の既存のクエリに渡す必要があります。これらの操作が実行できないよう、セキュリティ上の最善策を講じることを推奨します。

**何が原因で起こりますか?**

この脆弱性は、SQL Server を使用してデータベースに再接続することができる拡張ストアド プロシージャの中に、弱いアクセス権を持つものがあるために発生します。

**SQL Server** **拡張ストアドプロシージャとは何ですか?**

拡張ストアド プロシージャにより、データベース設計者および管理者は、C または C\# などのプログラミング言語で、独自の外部ルーチンを作成することができます。拡張ストアド プロシージャは、すべての用途において、ユーザーには通常のストアド プロシージャのように見え、同じ方法で実行されます。データベース クエリは拡張ストアド プロシージャにデータを渡し、拡張ストアド プロシージャは結果とステータスを返します。

SQL Server に含まれる、標準の拡張ストアド プロシージャの中には、たとえば以下のような電子メール機能を提供するものがあります。

-   xp\_startmail : SQL Mail クライアント セッションを開始します。
-   xp\_sendmail : 電子メールまたはページを送信します。

**これらの拡張ストアドプロシージャが、サービスアカウントとして** **SQL Server** **に再接続することができるということは何を意味するのですか?**

いくつかの例外はありますが、通常、拡張ストアド プロシージャは、SQL Server が実行されるサービス アカウントのセキュリティ コンテキストで実行されます。たとえば、限られた権限しか持たないユーザーが拡張ストアド プロシージャを実行しようとした場合、そのサービス アカウントと同じ権限で実行されます。

これらの拡張ストアド プロシージャの中に、綿密に作成した入力データをパラメータとして渡すことによって SQL server に再度接続できるものがあります。

その場合、その拡張ストアド プロシージャがデータベースで実行できるすべての操作は、SQL Server サービス アカウントのコンテキストで実行され、そのサービス アカウントは、データベース上で高い権限を持っている可能性があります。

**拡張ストアドプロシージャの何が問題になっていますか?**

マイクロソフトが提供している拡張ストアド プロシージャの中に、不適切に弱いアクセス権を持つものがあります。その結果、権限を持たないユーザーがこれらの拡張ストアド プロシージャを読み込み、実行する可能性があります。

**この脆弱性により、攻撃者は何をすることができますか?**

この脆弱性により、攻撃者は SQL Server の管理者権限を取得する可能性があります。その結果、攻撃者はデータベース上で管理者が実行できるすべての操作を行うことができます。さらに、データベース サーバーの構成によっては、攻撃者は SQL Server が実行できる操作をオペレーティング システム上で実行する恐れがあります。

**攻撃者はどのようにしてこの脆弱性を悪用するのですか?**

攻撃者がこの脆弱性を悪用する方法はいくつかあります。最も直接的な攻撃の方法としては、影響を受ける拡張ストアド プロシージャを呼び出すクエリを作成することが考えられます。しかし、これを成功させるためには、信頼されないユーザーが任意のクエリを読み込み、実行できるようにサーバーが設定されている必要があります。セキュリティ上の最善策として、信頼されないユーザーが作成したクエリを読み込み、実行できないようにすることを強く推奨しています。

**攻撃者がこの脆弱性を悪用するほかの方法はありますか?**

クエリを直接読み込み、実行できない場合でも、攻撃者はシステム上に既に存在するクエリを使用し、この脆弱性を悪用する恐れがあります。

たとえば、データベースが Web ベースの検索ツールの一部で、問題になっているプロシージャの 1 つがその Web サイトによって呼び出される場合、攻撃者はこの脆弱性を悪用するクエリを作成する可能性があります。しかし、このようなクエリを作成するには、Web サイトの検索機能の内部に関する詳しい知識が必要となります。

しかし、サイトで適切な入力チェックを行わない Web ベースのクエリが実装されている場合、攻撃者は影響を受ける機能への呼び出しを含むデータベース コマンドをデータベース クエリ パラメータに組み込む可能性があります。このため、データベース サーバーに入力パラメータを渡す前に、チェックすることが非常に重要になります。

**更新プログラムは何を修正しますか?**

この更新プログラムは、問題となっている拡張ストアド プロシージャのアクセス権を変更し、管理者のみが実行できるようにすることで、この脆弱性を排除します。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft SQL Server 7.0
    <http://support.microsoft.com/kb/327068>

    ダウンロード先で、次のファイルを選択してダウンロードしてください。

    日本語 : 7.00.1076\_jpn.exe
-   Microsoft SQL Server 2000
    この問題に対する修正は SQL Server 2000 Service Pack 3 以降に含まれています。SQL Server 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

    <http://www.microsoft.com/japan/sql/prodinfo/previousversions/downloads/2000/sp3.mspx>

    なお、個別の更新プログラムは以下の Web サイトから入手できます。

    <http://support.microsoft.com/kb/316333>

    ダウンロード先で、次のファイルを選択してダウンロードしてください。

    日本語版 : 8.00.0667\_jpn.exe

    **お詫び** **:**
    SQL Server 2000 の更新プログラム内のファイルの一部に以前の累積的更新プログラム [MS02-038](http://technet.microsoft.com/security/bulletin/ms02-038) よりもファイル日付の古いファイルが含まれています。本件の確認のために一時的に更新プログラムのご案内を取りやめておりましたが、事実確認ができましたのでご案内を再開いたします。本更新プログラムは正しくセキュリティ問題への対策がなされておりますので、適用に関しては問題ございません。 すでに適用いただいているお客様は、再適用の必要はありません。 本更新プログラムにより、ご迷惑をお掛けしましたことを深くお詫び申し上げます。

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**

-   SQL Server 7.0 の更新プログラムは SQL Server 7.0 Service Pack 4 を実行しているシステムにインストールすることができます。
-   SQL Server 2000 の更新プログラムは SQL Server 2000 [Service Pack 2](http://www.microsoft.com/japan/sql/prodinfo/previousversions/downloads/2000/sp2.mspx) を実行しているシステムにインストールすることができます。

**今後リリースされるサービスパックに含まれる更新プログラム** **:**
この問題に対する更新プログラムは SQL Server 2000 [Service Pack 3](http://www.microsoft.com/japan/sql/prodinfo/previousversions/downloads/2000/sp3.mspx) に含まれています。

**再起動の必要性** **:**
なし。更新プログラムの適用後、SQL Server サービスの再起動のみが必要です。

**更新プログラムのアンインストール** **:**
可。インストールの手順が記載されている readme.txt に更新プログラムを削除する手順も記載されています。

**更新プログラムに含まれる過去の修正** **:**

**SQL Server 7.0** **および** **MSDE 1.0 :**

-   この更新プログラムには、マイクロソフト セキュリティ情報 [MS02-020](http://technet.microsoft.com/security/bulletin/ms02-020) で提供された累積的な更新プログラムも含まれています。

**SQL Server 2000** **および** **MSDE 2000 :**

-   この更新プログラムには、マイクロソフト セキュリティ情報 [MS02-038](http://technet.microsoft.com/security/bulletin/ms02-038) および [MS02-039](http://technet.microsoft.com/security/bulletin/ms02-039) で提供された更新プログラムも含まれています。

**更新プログラムが正しくインストールされたか確認する方法** **:**

**SQL Server 7.0 :**

-   更新プログラムが正しくインストールされたかを確認するためには、サポート技術情報
    <http://support.microsoft.com/kb/327068> のファイル欄で、日付、タイム スタンプを参照し、各ファイルを確認してください。

**SQL Server 2000 :**

-   更新プログラムが正しくインストールされたかを確認するためには、サポート技術情報
    <http://support.microsoft.com/kb/316333> のファイル欄で、日付、タイム スタンプを参照し、各ファイルを確認してください。

**警告** **:**

-   この更新プログラムには、マイクロソフト セキュリティ情報 [MS02-035](http://technet.microsoft.com/security/bulletin/ms02-035) で提供された Killpwd ツールの機能は含まれません。
-   この更新プログラムは SQL Server 2000 に含まれる MDAC 及び OLAP 用の更新プログラムは含んでいません。そのため、MDAC 及び OLAP に対するセキュリティ更新プログラムに関しては別途適用を行う必要があります。SQL Server 2000 Service Pack 2 以降にリリースされた SQL Server 2000 に対応した MDAC または OLAP 用の更新プログラムは、次のセキュリティ情報で説明されている更新プログラムです。

    -   マイクロソフト セキュリティ情報 [MS02-030](http://technet.microsoft.com/security/bulletin/ms02-030)
-   この更新プログラムのインストール手順は、サーバーの構成によって多少異なります。システム管理者は、更新プログラムのパッケージの中の Readme.txt ファイルを読み、更新プログラムが正しくインストールされたことを確認してください。

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-043）
    [http://www.microsoft.com/technet/security/bulletin/ms02-043.mspx](http://technet.microsoft.com/security/bulletin/ms02-043)
-   サポート技術情報 （KB） 文書番号 ： 316333
    [\[INF\] SQL Server 2000 Service Pack 2 のセキュリティ アップデート](http://support.microsoft.com/kb/316333)
-   サポート技術情報 （KB） 文書番号 ： 327068
    [\[INF\] SQL Server 7.0 Service Pack 4 のセキュリティ アップデート](http://support.microsoft.com/kb/327068)

**更新履歴** **:**

-   2002/8/16: このセキュリティ情報ページを公開しました。
-   2002/8/26: この問題に対する日本語版 KB を公開しました。
-   2003/2/3: このセキュリティ情報ページを更新し、この累積的な更新プログラムが MS02-061 で提供された更新プログラムに含まれることをお知らせしました。また、317748 の更新プログラムがこの累積的な更新プログラムと関連して適用される場合のインストール順序を明確にしました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
