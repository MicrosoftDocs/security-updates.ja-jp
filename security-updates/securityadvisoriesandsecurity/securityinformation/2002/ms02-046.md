---
TOCTitle: 'MS02-046'
Title: 'マイクロソフト セキュリティ情報 MS02-046 - 警告'
ms:assetid: 'ms02-046'
ms:contentKeyID: 61228471
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-046(v=Security.10)'
---

マイクロソフト セキュリティ情報 MS02-046 - 警告
===============================================

TSAC ActiveX コントロールのバッファ オーバーランにより、コードが実行される (327521)
-----------------------------------------------------------------------------------

公開日: 2002年8月23日 | 最終更新日: 2002年10月11日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Windows® システムを使用しているお客様

**脆弱性の影響** **:**
攻撃者の選択したコードが実行されます

**最大深刻度** **:**
中

**推奨する対応策** **:**

-   TSAC ActiveX コントロールをホストしている Web サイトの管理者は直ちに新しいコントロールをインストールして下さい。
-   ユーザーは Internet Explorer 用の最新の累積的な更新プログラムを適用して下さい。(このセキュリティ情報作成時点では、最新の累積的な更新プログラムは、マイクロソフト セキュリティ情報 [MS02-047](http://technet.microsoft.com/security/bulletin/ms02-047) で提供されています。)

**影響を受けるソフトウェア** **:**

-   Microsoft Terminal Services Advanced Client (TSAC) ActiveX コントロール。これはすべての Windows システムにインストールすることができます。

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
Terminal Services Advanced Client (TSAC) Web コントロールは、Internet Explorer 内で Terminal Services セッションを実行するために使用される ActiveX コントロールです。ダウンロード可能な ActiveX コントロールは、完全な Terminal Services クライアントとほとんど同じ機能を提供しますが、この機能を Web で提供するようにデザインされています。

TSAC コントロールは Windows クライアント システムの一部としてインストールされていませんが、クライアントはターミナル サービスを提供している Web サーバーから、このコントロールを取得します。IIS サーバーがターミナル サービスを提供できるようにする構成のプロセスには、コントロールを含むキャビネット ファイルをサーバーにインストールすることが含まれます。次にサーバーは、キャビネット ファイルを、必要としているクライアント システムに配信し、クライアントはそのキャビネット ファイルを介し、コントロールをインストールします。

このコントロールには、入力パラメータの 1 つを処理するコード内に未チェックのバッファが含まれているため、この脆弱性が発生します。クライアント システムでコントロールを呼び出し、バッファをオーバーランさせることにより、攻撃者は、現在ログ オンしているユーザーのセキュリティ コンテキストでコードを実行する可能性があります。これにより、攻撃者はユーザーのシステムで任意の操作を行うことができる可能性があります。攻撃者は、訪問するユーザーに対し、この脆弱性を悪用する Web ページをホストするか、または、そのほかのユーザーに HTML 形式の電子メールを送ることにより、攻撃を開始する可能性があります。

**問題を緩和する要素** **:**

-   この脆弱性は TSAC コントロールをホストする IIS サーバーにより、TSAC コントロールがユーザーのシステムにインストールされた場合のみ、悪用される可能性があります。
-   コントロールをホストするサーバーは、この脆弱性による危険にさらされません。コントロールはサーバーに存在しますが、キャビネット ファイル内でカプセル化されており、実行することはできません。
-   Outlook 98 または Outlook 2000 ([Outlook電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)と関連して使用されているもの)、Outlook Express 6 および Outlook 2002 が既定の設定で使用されているシステムでは、HTML 形式の電子メールによる攻撃を受ける可能性はありません。

**深刻度** **:**

|                                                                                 | インターネット サーバー | イントラネット サーバー | クライアント システム |
|---------------------------------------------------------------------------------|-------------------------|-------------------------|-----------------------|
| **Microsoft Terminal Services Advanced Client (TSAC) ActiveX** **コントロール** | 低                      | 低                      | 中                    |

上記の[評価](http://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。

**脆弱性識別番号** **:**
[CAN-2002-0726](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0726)

**テストしたバージョン** **:**
マイクロソフトは Terminal Services Advanced Client のテストを行い、これらの脆弱性による影響を評価しました。

よく寄せられる質問
------------------

<span></span>
**どのようなことが起こる可能性がありますか?**

これは[バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者は Web ページまたは HTML 形式の電子メールを介しこの脆弱性を悪用し、ユーザーのシステムを完全に制御する可能性があります。これにより、攻撃者はシステム上のデータの追加、削除、変更、ハード ドライブの再フォーマットなどの操作を行うことができる可能性があります。

この脆弱性にはいくつかの制限があります。

-   この脆弱性はユーザーのシステムにコントロールがインストールされている場合のみ、悪用される可能性があります。しかし、このコントロールはWindows のすべてのバージョンで、既定でインストールされません。
-   [Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)をインストールした Outlook 98 または Outlook 2000 を使用しているお客様、また Outlook Express 6 または Outlook 2002 を使用しているお客様は電子メール ベースの攻撃の可能性による危険にさらされません。

**何が原因で起こりますか?**

Terminal Services Advanced Client (TSAC) ActiveX コントロールに未チェックのバッファが含まれるためにこの脆弱性が起こります。このコントロールが特定の方法で Web サイトにより呼び出される場合、バッファ オーバーランが発生し、結果として攻撃者はコントロールにユーザーのシステムで任意の操作を行わせる可能性があります。

**TSAC ActiveX** **コントロールとは何ですか?**

Terminal Services Advanced Client (TSAC) ActiveX は Windows システムにターミナル サービス セッションを Internet Explorer で実行する方法を提供します。これにより完全なターミナル サービス クライアントとほぼ同様の機能が提供されますが、この機能が Web で提供されます。コントロールを介し、ユーザーは適切に構成された IIS サーバーからターミナル サーバー セッションを確立することができます。

**TSAC** **コントロールは既定でインストールされますか?**

いいえ。実際、ターミナル サービスを提供している Web サイトを訪問する以外の手段で、このコントロールをインストールすることはできません。コントロールはサーバーからクライアント システムにセッション接続シーケンスの一部としてダウンロードされます。

**TSAC** **コントロールのインストールプロセスはどのように機能するのですか?**

既定で、IIS Web サイトはターミナル サービス対応マシンへのアクセスを提供しません。管理者がそれらを提供するように Web サイトを構成する場合、管理者はマイクロソフトの Web サイトからホスト可能なバージョンのコントロールをダウンロードする必要があります。(Windows XP Professional の場合、コントロールのホスト可能なバージョンはインストール CD からも入手可能です。) これが行われると、ユーザーが Web サイトとターミナル サービス セッションを開始できる状態となった時点以後、サーバーはコントロールを Web サイトを訪問するすべてのマシンにダウンロードします。

**このコントロールはユーザーに知らされずに** **Web** **サイトによりインストールされますか?**

いいえ。インストールのプロセスは常にユーザーへの警告を表示するため、ユーザーにはインストールをキャンセルする機会があります。

**TSAC ActiveX** **コントロールの何が問題になっていますか?**

このコントロールには未チェックのバッファが含まれています。このコントロールが特定の種類の不正な入力値を使用して呼び出されると、バッファがオーバーランする可能性があります。この影響として、本質的にコントロールの機能が変更され、プログラムされた動作ではなく、不正な動作を行うようにされる可能性があります。

**この脆弱性により攻撃者は何ができますか?**

攻撃者はこの脆弱性を悪用し、別のユーザーのコンピュータを制御する可能性があります。攻撃者がバッファ オーバーランを発生させる方法により、攻撃者がコントロールに任意の操作を行わせる可能性があります。コントロールはユーザーのコンテキストで操作を行うため、ユーザーが実行可能な任意の操作を攻撃者は行うことができる可能性があります。

**攻撃者はどのようにしてこの脆弱性を悪用しますか?**

攻撃者はコントロールを呼び出し、上記で説明した不正な入力値を提供する Web ページを作成する必要があります。そして攻撃は次のいずれかの方法で行われます。1 番目として、攻撃者は Web サイトに Web ページをホストします。ユーザーがその Web サイトを訪問すると、Web ページはコントロールを実行し、この脆弱性が悪用されます。2 番目として、攻撃者は Web ページを HTML 形式の電子メールとして送ります。受信者により Web ページが開かれると、Web ページはコントロールの実行を試行し、この脆弱性が悪用されます。

**Web** **ページがコントロールの実行を「試行」するとのことですが、この「試行」が成功したかどうかはどのように分かるのですか?**

次の 2 つの要素により攻撃が成功したかどうかが決定されます。

-   ユーザーが以前 Web サイトからコントロールのインストールを承諾したかどうか。コントロールがシステムに存在しない場合、コントロールは呼び出されません。上記で説明したように、コントロールは既定で、どの Windows のバージョンにもインストールされません。
-   ActiveX コントロールがユーザーのシステムで実行されることが許可されているかどうか。Internet Explorer の[セキュリティ ゾーン](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/zone_ovr.mspx) (英語情報) メカニズムにより、Web サイトが実行できる動作を制限する方法が提供されます。その制限の中に、ActiveX コントロールを実行できるかどうかがあります。既定で、「制限付きサイト ゾーン」 の Web ページは ActiveX コントロールを実行することはできません。これは HTML 形式の電子メールによる攻撃の場合、特に顕著であるということがわかっています。

**それはなぜですか?**

既定で、Outlook Express 6.0 および Outlook 2002 は HTML 形式の電子メールを 「制限付きサイト ゾーン」 で開きます。さらに Outlook 98 および 2000 は、[Outlook電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)がインストールされている場合、HTML 形式の電子メールを 「制限付きサイト ゾーン」 で開きます。これらの製品のいずれかを使用しているお客様は電子メールを悪用した攻撃による危険はありません。

**セキュリティ情報の「概要」欄で、ターミナルサービスを提供している** **Web** **マスターはこの更新プログラムを適用することが推奨されていますが、この脆弱性は** **Web** **サイトに脅威をもたらすという意味ですか?**

いいえ。この脆弱性はこのシナリオでのクライアントに脅威をもたらします。サーバーでホストされている場合、コントロールは圧縮ファイル (キャビネット ファイルと呼ばれています) でカプセル化されています。この状態では、コントロールは実行されません。

**この脆弱性が** **Web** **サイトに脅威をもたらさないとすれば、なぜサーバーに新しい更新プログラムをインストールする必要があるのですか?**

ここで明確にしますが、更新プログラムをインストールする必要がない場合もあります。ターミナル サービスを提供し、TSAC コントロールをホストしている Web サイトにのみ、この新しい更新プログラムを適用する必要があります。しかし、ターミナル サービスを提供している場合、Web サイトがコントロールの最新バージョンをホストしていることを確実にするために、更新プログラムを適用する必要があります。ターミナル サービスを提供していない場合、マイクロソフトが下記で推奨している対応策を行うユーザーは Web サイトからターミナル サービス対応のマシンへのアクセスが使用できなくなります。

**Web** **サーバーにこの更新プログラムをインストールした後、そのほかの対応策を行う必要はありますか?**

はい、あります。マイクロソフト サポート技術情報 [JP327521](http://support.microsoft.com/kb/327521) の説明に従い、Web ページが新しいコントロールを使用するように更新して下さい。

**セキュリティ情報の「概要」欄で、ユーザーはこの更新プログラムではなく、最新の** **Internet Explorer** **用の累積的な更新プログラムを適用することが推奨されていますが、それはなぜですか?**

最新の Internet Explorer 用の累積的な更新プログラムは (この 「よく寄せられる質問」 の作成時点では、マイクロソフト セキュリティ情報 [MS02-047](http://technet.microsoft.com/security/bulletin/ms02-047) で提供されています。) コントロールに "Kill Bit" を設定します。この操作自体でユーザーは脆弱性から充分に保護されます。この理由は、これにより、脆弱性の影響を受けるコントロールのバージョンが Internet Explorer でインスタンスを作成されなくなります。("Kill Bit" に関する詳しい情報は、マイクロソフト サポート技術情報 [240797](http://support.microsoft.com/kb/240797) をご覧ください。)

**それではなぜ、システムにインストールするための更新されたコントロールをユーザーに提供しないのですか?**

更新されたコントロールはユーザーに上記で説明した通常のインストール プロセスを介し提供されます。つまり、次回ユーザーが、更新プログラムが適用されている、ターミナル サービスを提供する Web サイトを訪問する時、更新されたコントロールがユーザーのシステムに提供されます。(一方、Web サイトに更新プログラムが適用されていない場合、ユーザーはターミナル サービスを使用できません。コントロールの古いバージョンが使用されると、セキュリティ上の危険性が発生するため、これは正しい動作です。)

**TSAC** **コントロールをインストールした** **Web** **サイトを以前に訪問したかどうか分かりません。最新の** **Internet Explorer** **用の累積的な更新プログラムを適用する必要がありますか?**

はい。マイクロソフト セキュリティ情報 [MS02-047](http://technet.microsoft.com/security/bulletin/ms02-047) で提供された累積的な更新プログラムはこの脆弱性に対する修正だけでなく、数多くの脆弱性に対する修正を含んでいます。TSAC ActiveX コントロールをインストールしていなくても、累積的な更新プログラムを適用することは有益です。

**TSAC ActiveX** **がコンピュータにすでに存在しているかどうかをどのように確認できますか?**

コントロールがコンピュータに存在しているかどうかを確認するために、以下の手順に従って下さい。

1.  Internet Explorer を起動します。
2.  \[ツール\] を選択し、\[インターネット オプション\] をクリックします。
3.  \[全般\] タブをクリックします。
4.  \[設定\] をクリックし、\[オブジェクトの表示\] をクリックします。
5.  一覧から Microsoft Terminal Services Client Control または Microsoft RDP Client Control というプログラム ファイル名を探します。
6.  これらのいずれのファイルも表示されない場合、TSAC コントロールはインストールされていません。
7.  Microsoft Terminal Service Client Control または Microsoft RDP Client Control が表示される場合、これを右クリックし、\[プロパティ\] を選択します。次に、次のいずれかの ID があるかどうかを確認してください。いずれかが表示される場合、TSAC ActiveX コントロールのこの脆弱性の影響を受けるバージョンがインストールされています。

    -   {1fb464c8-09bb-4017-a2f5-eb742f04392f}
    -   {791fa017-2de3-492e-acc5-53c67a2b94d0}

**この脆弱性の影響を受けるコントロールがシステムに存在しますが、Internet Explorer** **用の累積的な更新プログラムをインストールしたくありません。ほかにシステムを保護する方法はありますか?**

はい、あります。手動で "Kill Bit" を設定することができます。マイクロソフト サポート技術情報 [240797](http://support.microsoft.com/kb/240797) の説明に従い、次の ID に "Kill Bit" を設定して下さい。

-   {1fb464c8-09bb-4017-a2f5-eb742f04392f}
-   {791fa017-2de3-492e-acc5-53c67a2b94d0}

**使用中のシステムは管理者により** **ActiveX** **コントロールをインストールしないようにセットアップされましたが、何をする必要がありますか?**

ユーザー グループの一部である場合、既定では ActiveX コントロールのインストールは許可されません。管理者に ActiveX コントロールのインストール方法を聞いてください。管理者は組織で使用されるメソッドを確認するでしょう。

**この更新プログラムは何を修正しますか?**

この更新プログラムは TSAC ActiveX コントロールで正しい入力データ チェックを行うことにより、この脆弱性を解決します。

更新プログラム
--------------

<span></span>
この問題に対する修正は Windows XP Service Pack 1 以降に含まれています。Windows XP 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

<http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/>
なお、個別の更新プログラムは以下の Web サイトから入手できます。

-   ターミナル サービスを提供する Web サイトの Web マスターは次の Web サイトの更新プログラムをインストールして下さい。

    <http://www.microsoft.com/windowsxp/pro/downloads/rdwebconn.asp>

    ダウンロード先のリストから Japaneseを選択してください。

    **注意** **:**
    この更新プログラムの適用後に、いくつかファイルを削除する必要があります。詳細は、[327521](http://support.microsoft.com/kb/327521) のインストール情報をご覧ください。

-   お客様は Internet Explorer 用の最新の累積的な更新プログラムをインストールして下さい。このセキュリティ情報作成時点では、最新の累積的な更新プログラムはマイクロソフト セキュリティ情報 [MS02-047](http://technet.microsoft.com/security/bulletin/ms02-047) で利用可能です。

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**
TSAC Web パッケージは Windows NT 4.0、Terminal Server Edition、Windows 2000 および Windows XP を実行しているシステムにホストすることができます。サービス パックの必要はありません。

**この修正を含む予定のサービスパック** **:**
更新された TSAC ActiveX コントロールは Windows XP [Service Pack 1](http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/) に含まれています。

**再起動の必要性** **:**
なし

**更新プログラムのアンインストール** **:**
不可

**更新プログラムに含まれる過去の修正** **:**
なし

**更新プログラムが正しくインストールされたか確認する方法** **:**

-   更新プログラムのインストール中、管理者はファイルのインストール場所を指定するよう指示されます。インストールを確認するためには、マイクロソフト サポート技術情報 [327521](http://support.microsoft.com/kb/327521) で、ファイル欄に記載されているファイルの日付、時間情報を確認して下さい。

**警告** **:**

-   Web サーバーに更新プログラムをインストールした後、サポート技術情報 [240797](http://support.microsoft.com/kb/240797) で説明されているように、コントロールを使用する Web ページが新しいバージョンを使用するように、更新する必要があります。
-   Server Appliance Kit を使用した製品をご利用のお客様は、[436617](http://support.microsoft.com/kb/436617) をご参照ください。

本更新プログラムの適用前に [MS02-047](http://technet.microsoft.com/security/bulletin/ms02-047) で説明された Internet Explorer の更新プログラムを適用している場合、 Web ブラウザ経由でターミナルサービス (サーバー) に接続することが出来なくなります。 その場合は、本更新プログラムを適用することで、、引き続き TSAC をご利用いただけます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-046）

    [http://www.microsoft.com/technet/security/bulletin/ms02-046.mspx](http://technet.microsoft.com/security/bulletin/ms02-046)
-   サポート技術情報 （KB） 文書番号 ： 327521
    [\[MS02-0046\] TSAC ActiveX コントロールのバッファ オーバーランによりコードが実行される](http://support.microsoft.com/kb/327521)

**更新履歴** **:**

-   2002/8/23: このセキュリティ情報ページを公開しました。
-   2002/9/2: この問題に対する日本語版 KB を公開しました。
-   2002/10/11: 更新プログラムの適用後に、いくつかファイルを削除する必要があることを追記しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
