---
TOCTitle: 'MS02-009'
Title: 'マイクロソフト セキュリティ情報 MS02-009 - 緊急'
ms:assetid: 'ms02-009'
ms:contentKeyID: 61228434
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-009(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS02-009 - 緊急
===============================================

Internet Explorer の不正な VBScript 処理により Web ページがローカル ファイルを読み取る
--------------------------------------------------------------------------------------

公開日: 2002年2月22日 | 最終更新日: 2002年3月19日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Internet Explorer を使用しているお客様

**脆弱性の影響** **:**
情報の漏えい

**最大深刻度** **:**
高

**推奨する対応策** **:**
Internet Explorer を使用しているお客様は更新プログラムを適用してください。

**影響を受けるソフトウェア** **:**

-   Microsoft Internet Explorer 5.01
-   Microsoft Internet Explorer 5.5
-   Microsoft Internet Explorer 6
-   Microsoft Windows Script 5.1
-   Microsoft Windows Script 5.5
-   Microsoft Windows Script 5.6

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
Internet Explorer では、より豊かなブラウジング エクスペリエンスを提供するために、フレームの表示に対応しています。仕様上、フレーム内に表示されたあるサイトまたはドメイン内のスクリプトは、ほかのフレーム内に表示されたサイトまたはドメインのコンテンツへのアクセスは禁止される必要があります。しかし、ドメインを超えたアクセスの処理に関連して、Internet Explorer で VBScript が処理される方法に、ある問題が存在します。この問題により、1 つのドメインのスクリプトがフレームで区切られたほかのドメインのコンテンツにアクセスすることができます。
悪意のあるユーザーが、スクリプトを利用してほかのドメインのフレームのコンテンツを抽出し、そのコンテンツを自分の Web のサイトに送信し、この脆弱性を利用する可能性があります。これにより、攻撃者はユーザーのローカル マシン上のファイルを表示するか、またはユーザーが攻撃者のサイトを離れた後に訪問した第三者の Web サイトのコンテンツを盗み読みすることができる可能性があります。後者のシナリオでは、最悪の場合、攻撃者はユーザー名、パスワード、またはクレジット カード情報のような個人情報を取得できる可能性があります。
どちらの攻撃を行う際も、ユーザーは攻撃者の管理するサイトを訪問するか、または攻撃者が送信した HTML メールを表示させる必要があります。さらに、攻撃者は、ユーザーのシステムに存在する目的のファイルの正確な名前と場所を知っている必要があります。攻撃者は、テキスト ファイル、HTML ファイル、画像ファイルなどのブラウザ ウインドウで表示することができるファイルのみにアクセスすることができます。

**問題を緩和する要素** **:**

-   この脆弱性はファイルを表示するためのみに使用されます。この脆弱性を利用してファイルの作成、削除、変更、実行はできません。
-   この脆弱性によって攻撃者が実行できるのは、画像ファイル、HTML ファイル、テキスト ファイルなどのブラウザ ウインドウで開くことができるファイルを読み取ることのみです。バイナリ ファイルや実行可能ファイル、Word 文書などほかの種類のファイルは読み取ることができません。
-   攻撃者がファイルを読み取るためには、そのファイルの正確な名前および場所を指定する必要があります。
-   ユーザーが次のいずれかを使用している場合、電子メールを使用した攻撃のシナリオは阻止することができます。Outlook 電子メール セキュリティ アップデートをインストールした Outlook 98 またはOutlook 2000、Outlook 2002 または Outlook Express 6

**深刻度** **:**

|                            | インターネット サーバー | イントラネット サーバー | クライアント システム |
|----------------------------|-------------------------|-------------------------|-----------------------|
| **Internet Explorer 5.01** | 中                      | 中                      | 高                    |
| **Internet Explorer 5.5**  | 中                      | 中                      | 高                    |
| **Internet Explorer 6**    | 中                      | 中                      | 高                    |

上記の[評価](http://technet.microsoft.com/security/bulletin/rating)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形態およびこの脆弱性がシステムに及ぼす影響に基づいています。この脆弱性は、個人情報の漏えいに影響を及ぼし、クライアント システムに最も影響を及ぼす可能性があります。

**脆弱性識別番号** **:**
[CAN-2002-0052](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0052)

**テストしたバージョン** **:**
下の表は Internet Explorer の現在サポートされているバージョンでこの脆弱性の影響を受けるものを示しています。Internet Explorer 5.01 Service Pack 2 より前のバージョンに関しては、[通常のサポート](http://support.microsoft.com/lifecycle/)対象製品となっていません。Internet Explorer 5.01 Service Pack 2 は、Windows® 2000 Service Pack およびセキュリティ ロールアップ パッケージを介してのみサポートされます。

|                       | IE 5.01 SP2 | IE 5.5 SP1 | IE 5.5 SP2 | IE 6     |
|-----------------------|-------------|------------|------------|----------|
| **VBScript** **処理** | 影響あり    | 影響あり   | 影響あり   | 影響あり |

よく寄せられる質問
------------------

<span></span>
**どのようなことが起こる可能性がありますか?**

これは情報の漏えいの脆弱性です。この脆弱性により、悪意のある Web サイト運営者は Web サイトを訪問しているユーザーのローカル コンピュータにあるファイルを表示することができます。さらに、悪意のある Web サイト運営者は悪質な Web サイトをユーザーが訪問した後、そのユーザーのブラウジング セッションから情報を収集することもできます。その後、この情報は悪質な Web サイトへと渡され、その Web　サイトより攻撃者はユーザー名、パスワードまたはクレジット カード情報などの個人情報を盗み読みすることができる場合があります。
上記の両方のケースで、標的となるユーザーを悪意のあるユーザーが管理する Web サイトに誘導する必要があります。ユーザーのローカル マシンにある情報を読み取るためには、悪質な Web サイト運営者はユーザーのコンピュータにあるファイルの正確な名前および場所を知る必要があります。この脆弱性により、攻撃者はユーザーのコンピュータへのファイルの追加、またはユーザーのコンピュータに含まれるファイルの変更、削除を行うことはできません。

**何が原因で起こりますか?**

この脆弱性はフレーム内でドメインでのスクリプトの処理に問題があるために起こります。この問題により、スクリプトが Internet Explorer のドメインを越えたセキュリティ モデルを侵害し、Web サイトが別のドメインに属すフレーム内のデータを読み取ることができる可能性があります。

**スクリプトとは何ですか?**

[スクリプト](http://msdn2.microsoft.com/en-us/library/ms971094.aspx) (英語情報) は Web 開発者が Web ページのアイテムを操作することができるようにするために使用されます。Web ページのスクリプトの一般的な用途はユーザー入力の検証、ページのコントロールと動作、およびユーザーとの通信です。
既定で、このエンジンは [VBScript](http://msdn2.microsoft.com/en-us/library/t0aew7h6.aspx) (英語情報) と [Jscript](http://msdn2.microsoft.com/en-us/library/hbxc2t98(vs.71).aspx) (英語情報) の 2 つのスクリプト言語をサポートします。Web サイト開発者はこれらのプログラミング言語を Web サイトで使用することができます。
さらに、開発者および Web サイト運営者はそのほかの[サードパーティのスクリプト言語](http://msdn2.microsoft.com/en-us/library/s4axe076.aspx) (英語情報) のサポートを選択することもできます。しかし、これらはクライアント システムで正しくインストールされ、動作しなければなりません。

**フレームとは何ですか?**

フレームとはメイン ブラウザ ウィンドウのサブウィンドウです。例えば、フレームを使用してブラウザ ウィンドウを分割し、左側を目次、また右側をページ表示にすることができます。
しかし、ソフトウェアの観点から見ると、各フレームは個別のウィンドウでそのほかのウィンドウから独立しています。つまり、例えば、ブラウザ内のフレームで区切られた 3 つの領域で、異なる 3 つのWeb サイトからのコンテンツ、同じ Web サイトの異なる 3 つの部分、または同じ Web サイトと異なる Web サイトからのコンテンツの組み合わせを表示することができます。

**Internet Explorer** **のドメインを越えたセキュリティ モデルとは何ですか?**

各フレームは実際には独立したウィンドウであるため、「ドメイン」 の概念が開発され、フレームが同じ Web サイトの部分を論理的に全体として取り扱うことができるようになりました。例えば、ブラウザが www.microsoft.com からのページを 1 つのフレーム内で表示し、www.microsoft.com/security からのページを別のフレーム内で表示する場合、これらは同じドメインの部分とみなされます。 ブラウザが www.microsoft.com からのページをあるフレームで、また別の Web サイトからのページを別のフレームで表示する場合、これらの Web ページは別のドメインと見なされます。このドメインはセキュリティ境界として使用され、関連のない Web サイトからのコンテンツを分離し、同じ Web サイトからのコンテンツをグループにします。
このドメイン セキュリティ モデルはフレーム内のスクリプトにおけるセキュリティを強化するために使用されます。仕様上、スクリプトは同じドメイン内のフレームで実行することができなければなりません。これにより、例えば、目次のフレームのボタンをクリックすると別のフレーム内の同じ Web サイトからのテキストの表示を操作することができます。さらに、仕様上、スクリプトはほかのドメインからのフレーム内のコンテンツの操作が可能であってはいけません。

**スクリプトがドメインで処理される方法の何が問題になっていますか?**

ドメイン境界が計算される方法に問題が存在します。この問題のため、異なるドメイン内のフレームが間違って、同じドメインの部分であると見なされることがあります。これにより、スクリプトがそのドメイン外のフレームで操作を行う可能性があります。

**攻撃者はどのようにこの脆弱性を利用するのですか?**

攻撃者はこの脆弱性を利用する Web ページを作成することにより、この脆弱性を利用しようとします。次に、攻撃者はこの Web ページを自分が管理するサーバーの Web ページにポストするか、または電子メールを介して Web ページをユーザーに送信する可能性があります。

**なぜ攻撃者はこの脆弱性を** **HTML** **形式の電子メールを介して利用することができるのですか?**

HTML 形式の電子メールは本質的には電子メールにより送信された Web ページです。この脆弱性を利用する Web ページを作成し、それを HTML 形式の電子メールとして送信することにより、攻撃者は Web サイトによる攻撃と本質的に同じ攻撃を行うことができます。スクリプトが HTML 形式の電子メールに対して有効にされている場合、メッセージをダブルクリックまたはプレビュー ウィンドウで表示することにより電子メールが開かれると、スクリプトが実行されます。

**上記に挙げられた電子メール製品の** **1** **つを使用していますが、更新プログラムの適用は必要ないということですか?**

[Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)、Outlook 2002 および Outlook Express 6 は電子メールによる攻撃のシナリオを阻止します。しかし、マイクロソフトは Web ベースのシナリオに対する保護を確実にするため、この更新プログラムをインストールすることを推奨します。

**この脆弱性により、攻撃者は何ができますか?**

この脆弱性により、攻撃者はほかのドメイン内のほかのフレームのコンテンツを操作し、別の Web サイトのフレームからの情報を引き出し、攻撃者の Web サイトに含めることができる可能性があります。
分かりやすく言うと、攻撃者はこの脆弱性を含む HTML ページを Web サイトとして表示させたり、または電子メールでユーザーに送信することができます。これにより、ユーザーのローカル コンピュータで開かれた情報を含む、ほかのフレームからの情報の読み取り、およびその情報を攻撃者の Web サイトに送ることができます。これはユーザーがブラウザまたは HTML 形式の電子メールを閉じるまで発生します。

**この脆弱性は偶発的に発生しますか?**

いいえ。この脆弱性を利用するために Web サイトが行う必要があるステップは正当な目的に有益であることは非常にまれです。

**この脆弱性の影響を受ける可能性はどの程度ですか?**

Web サイト閲覧の習慣によって異なります。この脆弱性を利用するためには標的となるユーザーを攻撃者が管理する Web サイトへ誘導する必要があるため、よく知られている専門的に運営されている Web サイトを訪問するユーザーは、不明な Web サイトを頻繁に訪れるユーザーに比べ、この危険にさらされる可能性は低くなります。
セキュリティ ゾーンは Web サイト閲覧の習慣に基づく危険を管理する非常によい方法です。マイクロソフトはお客様にセキュリティ ゾーンを常に使用し、よく知られており、信頼されている Web サイトと不明な信頼されない Web サイトを区別することを推奨します。

**これはフレームのドメイン照合の脆弱性と類似しているようですが、同じものですか?**

類似していますが、わずかな相違点があります。これらの 2 つの問題の違いは問題を発生させる場所です。「フレームのドメイン照合」 の脆弱性は Internet Explorer における問題により発生します。これに対し、この脆弱性は Internet Explorer で VBScript が処理される方法が原因となっています。

**VBScript** **が処理される方法が原因とのことですが、JScript** **はこの脆弱性による影響を受けないのですか?**

その通りです。Jscript はこの脆弱性による影響を受けません。

**サードパーティのスクリプト言語もまたこの脆弱性の影響を受けますか?**

受ける可能性があります。Python、Perl およびそのほかのサードパーティのスクリプト言語がユーザーによりインストールされている場合、Internet Explorer はこのような言語の使用をサポートしません。これらの言語がどのように実装されているか、またこれらの言語がどのように特定のドメインのセキュリティ チェックを処理しているかにより、脆弱性による影響を受ける場合があります。

**サードパーティのスクリプト言語について、この更新プログラムは脆弱性を解決しますか?**

いいえ。しかし Internet Explorer の将来のサービス パックにおいてアーキテクチャ的な変更が行われ、この脆弱性がサードパーティのスクリプト言語について問題とならないようにする予定です。

**使用中の** **VBScript** **のバージョンはどのように分かるのですか?**

VBScript.dll ファイルは 2 つのソフトウェア製品 (Internet Explorer および Microsoft Windows Script) に同梱されています。

-   Internet Explorer 6.0 : Internet Explorer 6.0 を実行しているお客様については、使用しているプラットフォームに関係なく、Windows Script 5.6 が既定でインストールされています。Windows Script 5.6は Internet Explorer 6.0 に同梱されています。
-   Internet Explorer 5.5 : Internet Explorer 5.5 を実行しているお客様については、使用しているプラットフォームに関係なく、Windows Script 5.5 が既定でインストールされています。Windows Script 5.5 は Internet Explorer 5.5 に同梱されています。
-   Internet Explorer 5.01 : Internet Explorer 5.01 を実行しているお客様については、使用しているプラットフォームに関係なく、Windows Script 5.1 が既定でインストールされています。

Internet Explorer のバージョンを 6.0 または 5.5 にアップグレードしていないお客様は、次のバージョンの Windows Script を実行している高い可能性があります。

-   Windows 2000 : Windows Script 5.1
-   Win ME : Windows Script 5.5

**使用中のバージョンをどのように確認することができますか?**

実行している VBScript のバージョンを確認するためには、エクスプローラで Windows ディレクトリのディレクトリ System32 にある VBScript.dll を右クリックし、\[プロパティ\] を選択することにより、バージョンをチェックすることができます。

**VBScript** **の既定のバージョンからアップグレードしました。どの更新プログラムを適用する必要がありますか?**

VBScript の既定のバージョンからアップグレードした場合、インストールしたバージョンに対応する更新プログラムのバージョンを適用する必要があります。

-   VBScript 5.6 のユーザーは、Internet Explorer 6.0 用の更新プログラムをインストールしてください。
-   VBScript 5.5 のユーザーは、Internet Explorer 5.5 用の更新プログラムをインストールしてください。
-   VBScript 5.1 のユーザーは、Internet Explorer 5.01 用の更新プログラムをインストールしてください。

**記載されていることがよく分かりません。Internet Explorer** **のバージョンにしたがって更新プログラムをインストールするのではないのですか?**

ほとんどの場合、Internet Explorer のバージョンにしたがって更新プログラムをインストールする必要があります。VBScript は、Internet Explorer に同梱され、既定では VBScript のバージョンと Internet Explorer は関連しています。
しかし、VBScript のバージョンを手動でアップグレードした場合、VBScript と Internet Explorer は、一致しなくなります。
ほとんどのユーザーは、VBScript を手動でアップグレードしないため、マイクロソフトでは更新プログラムを既定の Internet Explorer のバージョンごとに紹介し、適用する必要がある更新プログラムの識別がほとんどのお客様にとって容易になるようにしました。

**更新プログラムは何を修正しますか?**

この更新プログラムは VBScript について、ドメイン照合処理を作成することにより、この脆弱性を排除します。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

Windows XP をお使いのお客様におかれましては、この問題に対する修正は Windows XP Service Pack 1 以降に含まれています。Windows XP 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

-   <http://www.microsoft.com/japan/windowsxp/pro/downloads/servicepacks/sp1/>

Windows 2000 をお使いのお客様におかれましては、この問題に対する修正は Windows 2000 Service Pack 3 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

-   <http://www.microsoft.com/japan/windows2000/downloads/>

Internet Explorer 6 をお使いのお客様におかれましては、この問題に対する修正は Internet Explorer 6 Service Pack 1 以降に含まれています。Internet Explorer 6 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

-   [http://www.microsoft.com/japan/ie/downloads/ie6SP1/](http://www.microsoft.com/japan/ie/downloads/ie6sp1/)

なお、個別の更新プログラムは以下の Web サイトから入手できます。

-   [http://download.microsoft.com/download/whistler/Patch/Q314147/WXP/JA/Q314147\_WXP\_SP1\_x86\_JPN.exe](http://download.microsoft.com/download/whistler/patch/q314147/wxp/ja/q314147_wxp_sp1_x86_jpn.exe)
-   Microsoft Update : <http://update.microsoft.com/microsoftupdate/>

**ご注意** **:**
VBScript を既定のバージョンからアップグレードした場合、インストールしたバージョンに対応する更新プログラムのバージョンを適用する必要があります。詳細は、よく寄せられる質問:マイクロソフトセキュリティ情報（MS02-009） の **VBScript** **の既定のバージョンからアップグレードしました。どの更新プログラムを適用する必要がありますか?** をご覧ください。

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**

-   Windows 2000 に Internet Explorer 5.01 用の更新プログラムを適用する際は、 Internet Explorer 5.01 を実行している Service Pack 2 をインストールした Windows 2000 システムに適用する必要があります。
-   Internet Explorer 5.5 用の更新プログラムは Internet Explorer 5.5 Service Pack 1 または Service Pack 2 を実行しているシステムにインストールすることができます。
-   Internet Explorer 6 用の更新プログラムは [Internet Explorer 6](http://www.microsoft.com/japan/windows/products/winfamily/ie/) を実行しているシステムにインストールすることができます。

**この修正を含む予定のサービス パック** **:**
この問題に対する更新プログラムは Internet Explorer 6 Service Pack 1 に含まれています。

**再起動の必要性** **:**
あり

**更新プログラムに含まれる過去の修正** **:**
なし

**更新プログラムが正しくインストールされたか確認する方法** **:**

-   各ファイルを確認するためには、サポート技術情報 [318089](http://support.microsoft.com/kb/318089) の更新プログラム欄を参照して下さい。

**警告** **:**
サード パーティのスクリプト言語は、この問題の影響を受ける可能性があります。今後リリースされる予定の Internet Explorer サービス パックで、この問題がサード パーティのスクリプト言語にとって問題にならないようにアーキテクチャの変更が行われる予定です。
この更新プログラムのリリース以来、マイクロソフトは、この更新プログラムによって無効にされる VBScript の動作に依存する少数のサードパーティのアプリケーションの存在を確認しています。このセキュリティ更新プログラムに少量の変更を加え、この問題を修正し、過去のバージョンとの互換性を確認しました。
この更新プログラムを適用後、サードパーティのアプリケーションの問題があるお客様は、変更された更新プログラムをダウンロードする必要があります。最初の更新プログラムのバージョンをダウンロードし、問題がないお客様は、対策を講じる必要はありません。
本モジュールは 3 月 5 日に再リリースされました。なお、本問題に関しては、下記の弊社サポート技術情報をご覧ください。
[319847: MS02-009 の適用後 VBScript とサードパーティ アプリケーションの間で互換性の問題が発生する](http://support.microsoft.com/kb/319847)

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/bulletins/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-009）
    [http://www.microsoft.com/technet/security/bulletin/ms02-009.mspx](http://technet.microsoft.com/security/bulletin/ms02-009)
-   サポート技術情報 （KB） 文書番号 ： 318089
    [\[MS02-009\] Internet Explorer の無効な VBScript 処理により Web ページからローカル ファイルを読み取られる](http://support.microsoft.com/kb/318089)

**更新履歴** **:**

-   2002/2/22: このセキュリティ情報ページを公開しました。
-   2002/2/28: この問題に対する日本語版 KB を公開しました。
-   2002/3/19: 「警告」 の欄を更新し、更新プログラムによってサードパーティのソフトウェア利用時に起きる障害と、その問題に対処する変更された更新プログラムが入手可能になったことをお知らせしました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
