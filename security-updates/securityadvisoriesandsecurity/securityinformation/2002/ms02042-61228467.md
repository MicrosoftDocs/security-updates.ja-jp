---
TOCTitle: 'MS02-042'
Title: 'マイクロソフト セキュリティ情報 MS02-042 - 緊急'
ms:assetid: 'ms02-042'
ms:contentKeyID: 61228467
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-042(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS02-042 - 緊急
===============================================

接続マネージャの問題により、権限が昇格する (326886)
---------------------------------------------------

公開日: 2002年8月16日 | 最終更新日: 2002年8月26日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Windows® 2000 を使用しているお客様

**脆弱性の影響** **:**
特権の昇格

**最大深刻度** **:**
高

**推奨する対応策** **:**
管理者は、特権を持たないユーザーが対話的にログオンすることができるマシン (ワークステーションや Terminal Server など) に直ちに更新プログラムを適用して下さい。

**影響を受けるソフトウェア** **:**

-   Microsoft Windows 2000

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
接続マネージャ (NCM: Network Connection Manager) はホスト システムにより管理されるすべてのネットワーク接続に制御メカニズムを提供します。NCM の機能の中に、ネットワーク接続が確立されている時、ハンドラ ルーチンを呼び出すものがあります。
仕様上、このハンドラ ルーチンはユーザーのセキュリティ コンテキストで実行される必要があります。しかし、ある問題により、非常に複雑なプロセスを要しますが、特権を持たないユーザーが LocalSystem のセキュリティ コンテキストでハンドラ ルーチンを実行できる可能性があります。攻撃者はこの問題を悪用し、自分が選択したコードをハンドラとして指定し、さらに、そのコードを NCM から呼び出させるために、ネットワーク接続を確立する可能性があります。コードはシステム権限で実行されます。

**問題を緩和する要素** **:**

-   この脆弱性は、攻撃者が影響を受けるシステムに対話的にログオンするための適切な資格情報を所有する場合のみ、悪用される可能性があります。セキュリティ上の最善策として、特権を持たないユーザーに、ビジネスクリティカルなサーバーに対話的にログオンすることを許可しないことを推奨します。この推奨策が講じられている場合、ドメイン コントローラ、ERP サーバー、プリント サーバー、ファイル サーバー、データベース サーバーなどのマシンは、この脆弱性による危険にさらされません。

**深刻度** **:**

|                  | インターネット サーバー | イントラネット サーバー | クライアント サーバー |
|------------------|-------------------------|-------------------------|-----------------------|
| **Windows 2000** | 低                      | 高                      | 高                    |

上記の[評価](http://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。

**脆弱性識別番号** **:**
[CAN-2002-0720](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-0720)

**テストしたバージョン** **:**
マイクロソフトは Windows XP、Windows 2000 および Windows NT 4.0 のテストを行い、これらの脆弱性による影響を評価しました。それより前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**どのようなことが起こる可能性がありますか?**

これは[特権の昇格](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者はこの脆弱性を悪用し、マシンを完全に制御できる可能性があります。これにより、システムのデータの追加、削除、変更、ユーザー アカウントの作成、削除、ローカル管理者グループへのアカウントの追加など、マシンで任意の操作を行う可能性があります。
この脆弱性は、攻撃者がコンピュータに[対話的にログオン](http://www.microsoft.com/japan/security/glossary.mspx)するための資格情報を持つ場合のみ、悪用されます。最善策として、特権を持たないユーザーには、ビジネスクリティカルなサーバーに対話的にログオンを許可しないことを推奨します。このガイダンスに従われている場合、このようなサーバーはこの脆弱性による危険にさらされません。

**何が原因で起こりますか?**

新しいネットワーク接続が確立される時、特権を持たないユーザーが接続マネージャ (NCM : Network Connection Manager) により使用されているハンドラ ルーチンを構成することができるため、この脆弱性が起こります。

**NCM** **とは何ですか?**

NCM とは Windows 2000 のオペレーティング システム コンポーネントで、\[ネットワークとダイヤルアップ接続\] フォルダで表示されているような、システムのネットワーク接続を制御する手段を提供します。たとえば、ユーザーがダイヤルアップ ネットワーク ウィザードを介し、新しいネットワーク接続を作成する時、NCM は接続を作成するためのリクエストを実際に処理します。

**NCM** **の何が問題になっていますか?**

NCM が提供する機能の中に、ネットワーク接続が確立される時にハンドラ ルーチンを呼び出すものがあります。既定のルーチンは Windows 2000 の一部として提供されますが、カスタム ハンドラもまた指定することができます。仕様上、これらのハンドラはユーザーと同じセキュリティ コンテキストで実行される必要があります。しかし、ユーザーは LocalSystem のセキュリティ コンテキストでハンドラを実行することができます。

**なぜこれがセキュリティ上の脆弱性となるのですか?**

NCM がハンドラ ルーチンを呼び出す時、NCM 自体の権限を与えます。この権限は System 権限です。つまり、特権を持たないユーザーがこの脆弱性を悪用した場合、ユーザーが選択したソフトウェアをシステム上で System 権限で実行することができる可能性があります。

**この脆弱性により、攻撃者は何ができますか?**

攻撃者はこの脆弱性を悪用して、システムを完全に制御し、システムで任意の操作を行うことができる可能性があります。

**攻撃者はどのようにしてこの脆弱性を悪用しますか?**

攻撃者はシステムに対話的にログオンできることが必要となります。この理由は、ハンドラ ルーチンはローカル システムに存在し、必要となる構成の変更もまたローカル アクセスを必要とするためです。攻撃者が新しいハンドラ ルーチンをインストールし、NCM がそのハンドラ ルーチンを呼び出すようにするため、ネットワーク接続を作成します。この結果、攻撃者のハンドラ ルーチンは System 権限で実行されます。

**主にどのような種類のシステムがこの脆弱性の危険にさらされますか?**

Windows 2000 を実行しているすべてのシステムがこの脆弱性の影響を受けると考えられますが、Windows 2000 ワークステーションと Terminal Server が最も危険にさらされる可能性があります。この理由は、このようなシステムは通常、特権を持たないユーザーが対話的にログオンできるように構成されているためです。一方、特権を持たないユーザーは通常サーバーへの対話的にログオンを許可されていません。このような場合、これらのシステムが危険にさらされる可能性は極めて低くなります。

**この脆弱性を悪用することは困難ですか?**

この脆弱性を悪用するには、技術的な専門知識や技術が必要になるため、非常に困難です。

**どのようにしてこの脆弱性は確認されたのですか?**

この脆弱性はマイクロソフト セキュリティ レビューの一部として確認されました。

**この更新プログラムはどのようにこの脆弱性を解決しますか?**

この更新プログラムは、NCM のカスタム ハンドラを指定する際、管理者権限を要求するようにします。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft Windows 2000:
    この問題に対する修正は Windows 2000 Service Pack 4 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。
    <http://www.microsoft.com/japan/windows2000/downloads/>
    なお、個別の更新プログラムは以下の Web サイトから入手できます。
    -   PC/AT 互換機用 :
        [http://download.microsoft.com/download/win2000platform/Patch/Q326886/NT5/JA/Q326886\_W2K\_SP4\_X86\_JA.exe](http://download.microsoft.com/download/win2000platform/patch/q326886/nt5/ja/q326886_w2k_sp4_x86_ja.exe)
    -   NEC PC-9800シリーズ用 :
        [http://download.microsoft.com/download/win2000platform/PatchNEC/Q326886/NT5/JA/Q326886\_W2K\_SP4\_nec98\_JA.exe](http://download.microsoft.com/download/win2000platform/patchnec/q326886/nt5/ja/q326886_w2k_sp4_nec98_ja.exe)
        ダウンロード先のリストから Japanese NEC を選択してください。

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**
この更新プログラムは Windows 2000 Service Pack 2 または Service Pack 3 を実行しているシステムにインストールすることができます。

**この修正を含む予定のサービス パック** **:**
この問題に対する更新プログラムは Windows 2000 [Service Pack 4](http://www.microsoft.com/downloads/details.aspx?familyid=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&displaylang=ja) に含まれています。

**再起動の必要性** **:**
あり

**更新プログラムのアンインストール** **:**
可

**更新プログラムに含まれる過去の修正** **:**
なし

**更新プログラムが正しくインストールされたか確認する方法** **:**

-   この更新プログラムがマシンにインストールされたことを確認するためには、マシンに次のレジストリ キーが作成されたことを確認して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP4\\Q326886
-   各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。
    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP4\\Q326886\\Filelist

**警告** **:**
なし

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-042）
    [http://www.microsoft.com/technet/security/bulletin/ms02-042.mspx](http://technet.microsoft.com/security/bulletin/ms02-042)
-   サポート技術情報 （KB） 文書番号 ： 326886
    [\[MS02-042\] 接続マネージャの問題により権限が昇格する](http://support.microsoft.com/kb/326886)

**更新履歴** **:**

-   2002/8/16: このセキュリティ情報ページを公開しました。
-   2002/8/26: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
