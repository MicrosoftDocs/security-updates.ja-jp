---
TOCTitle: 'MS02-059'
Title: 'マイクロソフト セキュリティ情報 MS02-059 - 警告'
ms:assetid: 'ms02-059'
ms:contentKeyID: 61228484
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-059(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS02-059 - 警告
===============================================

Word フィールドおよび Excel の外部データ更新の問題により、情報が漏えいされる (330008)
-------------------------------------------------------------------------------------

公開日: 2002年10月17日 | 最終更新日: 2003年1月7日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Word または Microsoft® Excel を使用しているお客様

**脆弱性の影響** **:**
情報の漏えい

**最大深刻度** **:**
中

**推奨する対応策** **:**
Word または Excel を使用しているお客様は更新プログラムを適用して下さい。

**影響を受けるソフトウェア** **:**

-   Microsoft Word 2002
-   Microsoft Word 2000
-   Microsoft Word 97
-   Microsoft Word 98 (日本語版のみ)
-   Microsoft Word X for Mac
-   Microsoft Word 2001 for Mac
-   Microsoft Word 98 for Macintosh Edition
-   Microsoft Excel 2002

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
Word および Excel は、あるドキュメントからのデータを別のドキュメントに挿入する、および、別のドキュメント内で更新するためのメカニズムを提供します。このメカニズムは Word ではフィールド コード、Excel では外部データの更新またはリンクの更新として知られています。これらは自動化することができ、ユーザーの手動による作業を削減します。Word のフィールド コードの使用例として、法律文書内の標準の免責条項の段落を自動挿入することができます。Excel の外部データの更新の使用例として、別のワークシートのデータを使用している、あるワークシート内のグラフを自動更新することができます。

フィールド コードや外部データの更新を悪用されることで、ユーザーが気がつかない間に、そのユーザーの情報が盗まれるという、脆弱性があります。文書が保存される、またはユーザーが手動でリンクを更新するなどの特定のイベントが行われることで、フィールド コードまたは外部データの情報を更新される可能性があります。通常、ユーザーはこれらの更新が行われることを認識しますが、不正なフィールド コードまたは外部データの更新が悪用され、更新がユーザーに示されずに実行される可能性があります。これにより攻撃者は、文書が開かれると、ユーザーのローカル コンピュータのファイルの内容を含ませる、その文書自体を更新する文書を作成できる可能性があります。

攻撃者がこの脆弱性を悪用するには、次のステップを行う必要があります。

-   この脆弱性を悪用する Word または Excel の文書を作成する。
-   その文書を電子メールまたはそのほかの方法によりユーザーに渡す。
-   ユーザーにその文書を開くよう誘導する。
-   ユーザーがその文書を攻撃者に返す。(マイクロソフトはユーザーがこれを行う必要がない唯一のケースを認識しています。攻撃者の文書が直接 Web サイトに情報を投稿する可能性のある方法が 1 つありますが、この方法が悪用されても、送られたファイルの最初の行の投稿が許可されるだけです。

**問題を緩和する要素** **:**

-   攻撃者は標的となるファイルの場所を知る必要があります。正しいファイル名が指定されない場合、攻撃は失敗し、無効なフィールド エラー メッセージが文書に表示されます。
-   ユーザーは常にフィールド コードまたは挿入された外部データの範囲および設定を表示することができます。攻撃で悪用されるフィールド コードまたは挿入された外部データの範囲および設定は、表示または編集される時に文書の邪魔にならないように単に隠されているのみであるため、これらは明らかに見えるようにすることができます。そのほかの不要な情報が文書に存在するかどうかをチェックする方法については、「よく寄せられる質問」 で説明されています
-   攻撃者は盗んだ情報を分かりにくくするためのステップを行う場合もありますが、攻撃者は明確な監査の痕跡を残します。フィールド コードまたは外部データの更新は、攻撃が成功しても表示することができるため、攻撃者が盗んだ情報の形式の文書と悪用したフィールド コードに明らかな証拠が残される可能性があります。この証拠は、必要であれば法の執行の際に使用することができます。
-   攻撃者によって、この脆弱性が悪用されユーザーのローカル システムでファイルの削除、変更、追加が行われることはありません。
-   実質的にすべての状況で、攻撃者はユーザーに文書を返すよう誘導する必要があります。ユーザーが文書を攻撃者に返さない限り、何の情報も洩れることはありません。

**深刻度** **:**

|                               | インターネット サーバー | イントラネット サーバー | クライアント システム |
|-------------------------------|-------------------------|-------------------------|-----------------------|
| **Word (すべてのバージョン)** | なし                    | なし                    | 中                    |
| **Excel 2002**                | なし                    | なし                    | 中                    |

上記の[評価](http://www.microsoft.com/japan/technet/security/policy/rating1.mspx)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。

**脆弱性識別番号** **:**
[CAN-2002-1143](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1143)

**テストしたバージョン** **:**
マイクロソフトは Word 2002、Word 2000、Word 98(日本語版のみ)、Word 97、Word X for Mac、Word 2001 for Mac、Word 98 for Macintosh Edition、Excel 2002、Excel 2000、Excel 97、Excel X for Mac、Excel 2001 for Mac および Excel 98 for Macintosh Edition のテストを行い、これらの脆弱性による影響を評価しました。それ以前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**どのようなことが起こる可能性がありますか?**

この脆弱性により、攻撃者は別のユーザーがアクセス権を持つ文書の内容を盗むことを目的とした文書を作成できる可能性があります。

実質上すべての状況で、ユーザーの操作なしでは、この脆弱性は悪用されません。攻撃者がこの脆弱性を悪用するには、不正な Word または Excel 文書を作成し、それをユーザーに (電子メールまたはそのほかの方法で) 提供し、ユーザーにその文書を攻撃者に返すよう誘導することが必要条件となります。攻撃が行われても、攻撃者を特定するに当たり、法の執行の手助けとなる証拠が残されます。

**どの製品がこの影響を受けますか?**

この問題は Word のすべてのバージョンに影響を及ぼします。Microsoft Outlook. や Excel 2002 により電子メール エディタとして使用される Word もこの影響を受けます。

**何が原因で起こりますか?**

仕様上、フィールド コードおよび外部データ (リンク) の更新はそのほかのソースから Word 文書および Excel ワークシートにデータを挿入するために使用することができます。通常、ユーザーはこれらの更新が行われていることを認識します。しかし、フィールド コードおよび外部データの更新が実装されている方法に存在する問題により、不正なフィールド コードまたは外部データの更新を作成し、その文書またはワークシートが開かれると、ユーザーが気がつかない間に自動的に更新が行われる可能性があります。

**フィールドコードおよび外部データの更新とは何ですか?**

フィールド コードおよび外部データの更新とは文書内へのデータの挿入を自動化する方法です。たとえば、フィールド コードは自動的に日付またはページ番号を挿入するために、Word 文書で頻繁に使用されます。Excel の外部データの更新は Word のフィールド コードに類似しており、たとえば、ある Excel ワークシートからのデータを別のワークシートに自動的に挿入するために使用されます。

フィールド コードおよび外部データの更新は通常、ユーザーに対する表示の邪魔にならないよう、文書が編集されている間は表示しないよう隠されています。しかし、必要であればこれらはいつでも表示、確認することができます。フィールド コードおよび外部リンクは後に表示できなくなるまで、文書内で恒久的に隠されることはありません。

**Word** **フィールドコードおよび** **Excel** **外部データの更新が実装されている方法の何が問題になっていますか?**

仕様上、フィールド コードおよび外部データの更新はユーザーのシステム上のデータ ファイルなど、外部のソースからの情報を自動的に挿入、更新することができます。これは通常、ユーザーに代わって行われる正当な自動化された操作です。しかし、ユーザーが気づかない間に、隠されたフィールド コードが更新を行うようにこの更新の動作を操作することができるため、この問題が存在します。これは、ユーザーに気づかれずに、ユーザーの文書から攻撃者の文書に情報を挿入するために悪用される可能性があります。

**この脆弱性により攻撃者は何ができますか?**

この脆弱性により、攻撃者はユーザーに気づかれない間にユーザーの文書の内容を盗む可能性があります。

**攻撃者はどのようにしてこの脆弱性を悪用する可能性がありますか?**

攻撃者が攻撃を行うために必要となる多くのステップがあります。

-   攻撃者は不正な Word フィールドまたは Excel 外部データの更新を含む Word または Excel 文書を作成する必要があります。これらのフィールド コードまたは外部データの更新は、攻撃者が標的としているファイルの正確な名前と場所を参照することが必要条件となります。
-   次に攻撃者はその文書を電子メールまたはそのほかの方法により、ユーザーに渡し、ユーザーにそれを開くよう誘導する必要があります。
-   その文書を閉じた後、ユーザーは攻撃者に文書を返すことが必要条件となります。(これが必要ではない場合が 1 つありますが、それは下記で説明します。)

**どのような場合、ユーザーが攻撃者の文書を返すことが攻撃の必要条件とならないのですか?**

攻撃者がフィールド コードを悪用し、攻撃者の管理する Web サイトにデータを直接送るという、1 つの限定されたシナリオがあります。このシナリオでは、ユーザーが攻撃者の文書を返すことが必要条件とはなりませんが、攻撃者にとって顕著な障害があります。それは、このシナリオではユーザーのファイルの最初の行のみが取得されるという点です。

**Microsoft Outlook** **はどのような影響を受けますか?**

Microsoft Outlook 自体はこの脆弱性の影響を受けません。しかし、Outlook 2002 は既定で Word をその電子メール エディタとして使用します。Outlook 2000 および Outlook 97 は Word を電子メール エディタとして使用するように構成することができます。Microsoft Outlook for Macintosh は Word を電子メール エディタとして使用しません。Word が Outlook 電子メール エディタとして使用されている場合、電子メール メッセージは文書として処理されます。このセキュリティ情報で説明されている Word 用の更新プログラムは Word が独立して使用されている場合、また Outlook と関連して使用されている場合の両方において、この問題を修正します。

**この脆弱性はデジタル署名された文書を偽造するために悪用される可能性がありますか?**

いいえ、ありません。悪質な文書が開かれるとすぐに署名は無効になります。これはデジタル署名を検査することにより、明らかになります。マイクロソフト サポート技術情報 [329228](http://support.microsoft.com/kb/329228) で、Office 文書のデジタル署名を確認する方法について説明しています。

**攻撃者により盗まれた可能性のあるものを確認する方法はありますか?**

はい、あります。重要な点として、盗まれた文書の内容は見えなくなることはありません。攻撃者は盗んだ文書の内容を分かりにくくする可能性がありますが、フィールド コードを表示し、文書を検査すれば、その内容を見ることができます。盗まれた内容は隠すことはできません。

次のメニュー オプションを選択することにより、フィールド コードおよび外部データの更新を表示することができます。

-   Word 2002、2000、97、98 (日本語版) : \[ツール\] – \[オプション\] – \[表示\] で、\[フィールド コード\] チェック ボックスをオンにします。
-   Word X, 2001 for Mac : \[編集\] – \[基本設定\] – \[表示\] で、\[フィールド コード\] ボックスを選択します。
-   Word 98 for Macintosh Edition : \[ツール\] – \[基本設定\] – \[表示\] で、\[フィールド コード\] ボックスを選択します。
-   Excel 2002 : \[ツール\] – \[オプション\] – \[表示\] で、ウィンドウ オプションの \[数式\] チェック ボックスをオンにします。

この証拠は常に表示できます。また、必要であれば攻撃者に対する懲戒処分や法的な措置を行うために使用できます。

**どのように** **Word** **または** **Excel** **文書で表示されるそのほかのデータを削除できますか?**

マイクロソフト サポート技術情報 [223396](http://support.microsoft.com/kb/223396) で Office 文書のそのほかのデータをチェック、削除する方法について説明しています。

**テキスト形式を使用して** **Outlook** **で電子メールを読み取ることはできますか?**

この機能は Office XP Service Pack 1 で導入されました。マイクロソフト サポート技術情報 [307594](http://support.microsoft.com/kb/307594) でこの方法について説明しています。

**更新プログラムは何を修正しますか?**

Word 用の更新プログラムは Word の既定の動作を変更し、ユーザーがこれらのフィールドへの更新を強制するために直接操作しない限り、外部のソースからのデータを現在の文書に挿入するこれらのフィールドが自動的に更新しないようにします。これにより、更新が続行されるかどうかをユーザーが管理できるようにします。Excel 2002 用の更新プログラムは、Excel 2002 が外部データの更新を最新の情報に更新するために、ユーザーの許可を求めない状況では、ユーザーに確認するようにします。

**ネットワーク管理者が管理している各ユーザーに** **Office Update** **サイトを訪問させるのではなく、この更新プログラムを適用することを望んでいる場合、これを行う方法はありますか?**

はい、あります。管理者用アップデートが利用可能であり、これを行います。管理者用アップデートをダウンロードするためには、Word および Excel の適切なバージョンのダウンロード サイトを訪問して下さい。管理者用アップデートへのリンクはダウンロードのページをご覧下さい。

更新プログラム
--------------

<span></span>
この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

-   Microsoft Word 2002:
    <http://office.microsoft.com/japan/downloads/2002/wrd1005.aspx>
    (管理者用アップデート)
    [http://download.microsoft.com/download/Word2002/Update/
    Wrd1005a/W98NT42KMeXP/JA/Wrd1005a.exe](http://download.microsoft.com/download/word2002/update/wrd1005a/w98nt42kmexp/ja/wrd1005a.exe)
-   Microsoft Word 2000:
    <http://office.microsoft.com/japan/downloads/2000/wrd0902.aspx>
    (管理者用アップデート)
    [http://download.microsoft.com/download/word2000/Update/
    Wrd0902a/WIN98MeXP/JA/Wrd0902a.exe](http://download.microsoft.com/download/word2000/update/wrd0902a/win98mexp/ja/wrd0902a.exe)
-   Word 97/Word 98 (日本語版) :
    この問題に対する日本語版更新プログラムの入手方法については、以下のサポート技術情報をご覧ください。

    <http://support.microsoft.com/kb/330080>
-   Word X for Mac:
    <http://www.microsoft.com/japan/mac/downloads.mspx>
-   Word 2001 for Mac:
    <http://www.microsoft.com/japan/mac/downloads.mspx>
-   Word 98 for Macintosh Edition:
    <http://www.microsoft.com/japan/mac/downloads.mspx>
-   Excel 2002:
    <http://office.microsoft.com/japan/downloads/2002/exc1003.aspx>
    (管理者用アップデート)
    [http://download.microsoft.com/download/Excel2002/
    Update/EXC1003a/W98NT42KMeXP/JA/EXC1003a.exe](http://download.microsoft.com/download/excel2002/update/exc1003a/w98nt42kmexp/ja/exc1003a.exe)

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**

-   Word 2002 用の更新プログラムは Office XP [Service Pack 2](http://office.microsoft.com/japan/downloads/2002/oxpsp2.aspx) を適用した Word 2002 を実行しているシステムにインストールすることができます。(管理者用アップデートは Office 2002 [Service Pack 1](http://office.microsoft.com/japan/downloads/2002/oxpsp1.aspx) を実行しているシステムにもインストールすることができます。)
-   Word 2000 用の更新プログラムは Office 2000 [Service Release 1](http://office.microsoft.com/japan/downloads/2000/o2ksr1ddl.aspx) または [Service Pack 2](http://office.microsoft.com/japan/downloads/2000/sp2upd.aspx) を適用した Word 2000 を実行しているシステムにインストールすることができます。
-   Word X for Mac 用の更新プログラムは Office v.X の最新バージョンを実行しているシステムにインストールすることができます。Office の最新バージョンを確認するためには、次の Web サイトをご覧下さい。<http://www.microsoft.com/japan/mac/downloads.mspx>
-   Word 2001 for Mac 用の更新プログラムは Office 2001 の最新バージョンを実行しているシステムにインストールすることができます。Office の最新バージョンを確認するためには、次の Web サイトをご覧下さい。<http://www.microsoft.com/japan/mac/downloads.mspx>
-   Word 98 for Macintosh Edition 用の更新プログラムは Office 98 の最新バージョンを実行しているシステムにインストールすることができます。Office の最新バージョンを確認するためには、次の Web サイトをご覧下さい。<http://www.microsoft.com/japan/mac/downloads.mspx>
-   Excel 2002 用の更新プログラムは Office XP [Service Pack 2](http://office.microsoft.com/japan/downloads/2002/oxpsp2.aspx) を適用した Excel 2002 を実行しているシステムにインストールすることができます。(管理者用アップデートは Office 2002 [Service Pack 1](http://office.microsoft.com/japan/downloads/2002/oxpsp1.aspx) を実行しているシステムにもインストールすることができます。)

**この修正を含む予定のサービスパック** **:**
この問題に対する更新プログラムは影響を受ける製品の将来のサービス パックに含まれる予定です。

**再起動の必要性** **:**
なし

**更新プログラムのアンインストール** **:**
不可

**更新プログラムに含まれる過去の修正** **:**

-   Word X for Mac、Word 2001 for Mac および Word 98 for Macintosh Edition の更新プログラムには、[MS02-050](http://technet.microsoft.com/security/bulletin/ms02-050) で説明されている問題に対する修正も含まれています。
-   その他の製品の更新プログラムに含まれる過去の修正はありません。

**更新プログラムが正しくインストールされたか確認する方法** **:**

-   Word 2002 : Winword.exe のバージョン番号が 10.0.4524.0 であることを確認して下さい。
-   Word 2000 : Winword.exe のバージョン番号が 9.00.00.6926 (または 9.0.0.6926) であることを確認して下さい。
-   Word X for Mac : Word X Mac のチェックに関する情報は次の Web サイトをご覧下さい。<http://www.microsoft.com/japan/mac/security/>
-   Word 2001 for Mac : Word 2001 for Mac のチェックに関する情報は次の Web サイトをご覧下さい。<http://www.microsoft.com/japan/mac/security/>
-   Word 98 for Macintosh Edition : Word 98 for Macintosh Edition のチェックに関する情報は次の Web サイトをご覧下さい。<http://www.microsoft.com/japan/mac/security/>
-   Excel 2002 : Excel.exe のバージョン番号が 10.0.4524.0 であることを確認して下さい。

**警告** **:**
なし

**他のセキュリティ更新プログラムの入手先** **:**
他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムはマイクロソフト [ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード検索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-059）
    [http://www.microsoft.com/technet/security/bulletin/ms02-059.mspx](http://technet.microsoft.com/security/bulletin/ms02-059)
-   サポート技術情報 （KB） 文書番号 ： 330008
    [\[MS02-059\] Word のフィールド コードおよび Excel の外部データ更新の問題により、情報が漏えいされる](http://support.microsoft.com/kb/330008)

**更新履歴** **:**

-   2002/10/17: このセキュリティ情報ページを公開しました。
-   2002/10/18: Word X for Mac の日本語版更新プログラムを公開しました。
-   2002/10/18: 管理者用アップデートを使用すると Word 2002 の更新プログラムをWord 2002 Service Pack 1 を実行しているシステムに適用できることをお知らせしました。
-   2002/10/25: この問題に対する日本語版 KB を公開しました。
-   2003/1/7: Word 97 および Word 98 (日本語版) の日本語版更新プログラムを公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
