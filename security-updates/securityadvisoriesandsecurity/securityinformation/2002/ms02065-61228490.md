---
TOCTitle: 'MS02-065'
Title: 'マイクロソフト セキュリティ情報 MS02-065 - 緊急'
ms:assetid: 'ms02-065'
ms:contentKeyID: 61228490
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-065(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS02-065 - 緊急
===============================================

Microsoft Data Access Components のバッファ オーバーランにより、コードが実行される (329414)
-------------------------------------------------------------------------------------------

公開日: 2002年11月21日 | 最終更新日: 2002年11月28日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Windows® を使用しているお客様。特に、Web サイトの運用またはインターネットの閲覧をしているお客様

**脆弱性の影響** **:**
攻撃者の選択したコードが実行される可能性があります。

**最大深刻度** **:**
緊急

**推奨する対応策** **:**
ユーザーは直ちにこの更新プログラムを適用して下さい。

**影響を受けるソフトウェア** **:**

-   Microsoft Data Access Components (MDAC) 2.1
-   Microsoft Data Access Components (MDAC) 2.5
-   Microsoft Data Access Components (MDAC) 2.6
-   Microsoft Internet Explorer 5.01
-   Microsoft Internet Explorer 5.5
-   Microsoft Internet Explorer 6.0

**注** **:**
MDAC 2.7 以降はこの脆弱性の影響を受けません。 MDAC のバージョンの確認方法については次のサポート技術情報をご覧ください。

[301202 \[HOW TO\] MDAC のバージョンを確認する方法](http://support.microsoft.com/kb/301202)

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
Microsoft Data Access Components (MDAC) とは、Windows プラットフォームでデータベース接続を提供するために使用されるコンポーネントの集まりです。MDAC は広く存在する技術で、ほとんどの Windows システム上に存在します。

-   Windows XP、Windows 2000、Windows Millennium の一部として既定でインストールされます。
-   スタンドアロン技術として、単体でダウンロードすることができます。
-   その他の多くの製品および技術に含まれるか、またはそれらの製品によってインストールされます。たとえば、MDAC は Windows NT® 4.0 Option Pack に含まれています。また、MDAC 自体がインストールされていなくても、Internet Explorer の一部として、いくつかの MDAC のコンポーネントがインストールされます。

MDAC は、リモート データベースへの接続やクライアントへのデータの返却など、多くのデータベース操作の基礎となる機能を提供します。Remote Data Services (RDS) として知られる MDAC のコンポーネントの 1 つは 3 層アーキテクチャをサポートする機能を提供します。そのアーキテクチャは、バックエンド データベースへのクライアントのサービス リクエストが、ビジネス ロジックを適用する Web サイトによって仲介されます。この RDS 実装 （具体的には、RDS データ スタブと呼ばれる機能） に脆弱性が存在します。RDS データ スタブの目的は、受信される HTTP リクエストを解析し、RDS コマンドを生成することです。

データ スタブの未チェックのバッファにより発生するセキュリティ上の脆弱性により、MDAC 2.7 （Windows XP に同梱されたバージョン） より前のバージョンに影響が及びます。攻撃者は不正な HTTP リクエストをデータ スタブに送信し、任意のデータでヒープのオーバーランを発生させる可能性があります。通常、ヒープのオーバーランは、より一般的に発生するスタックのオーバーランよりも悪用が困難ですが、マイクロソフトは、この脆弱性が悪用され、ユーザーのシステム上で攻撃者の任意のコードが実行される可能性があることを確認しました。

Web サーバーおよび Web クライアントの両方に、この脆弱性の危険が及ぶ可能性があります。

-   この脆弱性の影響を受けるバージョンの MDAC が Web サーバーにインストールされ、実行されている場合、そのサーバーは危険にさらされます。このような Web サーバーに対し、この脆弱性が悪用されるのは、攻撃者がサーバーとの接続を確立し、次に不正な HTTP リクエストをそのサーバーに送信することが必要となります。これにより、攻撃者の任意のデータによってバッファ オーバーランが発生する可能性があります。そのようなコードは、IIS サービスの セキュリティ コンテキストで実行される可能性があります。 （これは既定では、LocalSystem のコンテキストで実行されます。）
-   Web クライアントには、RDS データ スタブが Internet Explorer のすべての現行のバージョンに含まれており、無効にするオプションがないため、ほとんどの場合、Web クライアントは危険にさらされます。クライアントに対してこの脆弱性が悪用されるのは、攻撃者が、Web ページをホストし、それが開かれると、HTTP 応答をユーザーのシステムに送信し、攻撃者の任意のデータによりバッファ オーバーランが発生するようにすることが必要条件となります。Web ページは Web サイト上にホストされるかまたは直接ユーザーに HTML 形式の電子メールとして送信される可能性があります。そのコードは、ユーザーのセキュリティ コンテキストで実行されます。

明らかに、この脆弱性は非常に深刻であり、マイクロソフトはこれらの脆弱性の影響を受けるすべてのお客様に直ちに対策を講じることを推奨します。

-   Windows XP を使用しているか、またはシステムに MDAC 2.7 をインストールしたお客様には、危険は全く及ばないため、このための対策を講じる必要はありません。
-   この脆弱性の影響を受けるバージョンの MDAC を実行している Web サーバー管理者は、この更新プログラムをインストールするか、MDAC および RDS を無効にするか、またはこの脆弱性の影響を受けない [MDAC 2.7](http://www.microsoft.com/japan/msdn/data/download/mdac/27/27.aspx) にアップグレードしてください。
-   この脆弱性の影響を受けるバージョンの MDAC を実行している Web クライアント ユーザーは、Web ブラウジングに使用しているすべてのシステムにこの更新プログラムを直ちにインストールしてください。後述の案内は、いかなる保護対策を講じてあっても Web ブラウジングに使用しているすべてのシステムに適用されることにご注意ください。たとえば、RDS が無効に設定されている Web サーバーでも、それを Web クライアントとして使用することがある場合には、この更新プログラムが必要となります。

この更新プログラムを展開する前に、「よく寄せられる質問」 および下の 「警告」 の欄で説明されている注意点をよくお読みください。

**問題を緩和する要素** **:**

**Web** **サーバー** **:**

-   [MDAC バージョン 2.7](http://www.microsoft.com/japan/technet/archive/security/chklist/iis4cl.mspx) （Windows XP に同梱されているものと同等のバージョン） またはそれ以降のバージョンを使用している Web サーバーには、この脆弱性による危険はありません。
-   この脆弱性の影響を受けるバージョンの MDAC がインストールされた場合でも、RDS が有効に設定されている場合にのみ Web サーバーに危険が及びます。RDS は Windows XP および Windows 2000 のクリーン インストールで、既定で無効にされます。また、[IIS セキュリティ チェックリスト](http://www.microsoft.com/japan/technet/archive/security/chklist/iis4cl.mspx) の案内に従って他のシステム上で無効にすることができます。また、[IIS Lockdown Wizard ツール](http://technet.microsoft.com/ja-jp/library/dd362854.aspx)により、既定の構成で使用する際に RDS が自動的に無効にされます。
-   [URL Scan](http://technet.microsoft.com/ja-jp/security/cc242650.aspx) ツールを既定のルールセットで展開した場合 （この既定のルールセットでは、ASCII データを、HTTP リクエストに表示することができます） この脆弱性を悪用した場合の影響が、サービス拒否の攻撃のみに制限される可能性があります。
-   IIS をより低い管理者権限で実行するように構成することができます。このように設定した場合、攻撃者がこの脆弱性を悪用して取得する権限を同様に制限することができます。
-   IP アドレス制限を RDS 仮想ディレクトリに適用した場合、管理者はアクセスを信頼するユーザーのみに制限することができます。しかし、これはほとんどの Web サーバーのシナリオにとっては現実的ではありません。

**Web** **クライアント** **:**

-   [MDAC バージョン 2.7](http://www.microsoft.com/japan/msdn/data/download/mdac/27/27.aspx) (Windows XP に同梱されているものと同等のバージョン) またはそれ以降を使用している Web クライアントはこの脆弱性の危険にさらされません。
-   HTML 形式の電子メール ベースの攻撃方法は [Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)を適用した Outlook 98 または Outlook 2000 が使用されているシステム、または Outlook Express 6、Outlook 2002 が既定の構成で使用されているシステムでは自動的に悪用されることはありません。
-   この脆弱性により、攻撃者が取得する可能性のあるものは、ユーザーのシステムの権限のみです。システムでほとんど権限を持たないように構成されているアカウントを持つユーザーは、管理者権限で操作しているユーザーよりも危険にさらされる可能性は低くなります。

**深刻度** **:**

|                            |          |
|----------------------------|----------|
| **MDAC 2.1**               | 緊急     |
| **MDAC 2.5**               | 緊急     |
| **MDAC 2.6**               | 緊急     |
| **MDAC 2.7**               | 影響なし |
| **Internet Explorer 5.01** | 緊急     |
| **Internet Explorer 5.5**  | 緊急     |
| **Internet Explorer 6.0**  | 緊急     |

上記の[評価](http://technet.microsoft.com/security/bulletin/rating)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。この脆弱性の評価は 「緊急」 ですが、この理由は、攻撃者が IIS サーバーまたは Internet Explorer クライアントを制御し、コードを実行する可能性があるためです。MDAC がインストールされている IIS および Internet Explorer クライアントには直ちにこの更新プログラムを適用して下さい。

**脆弱性識別番号** **:**
[CAN-2002-1142](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1142)

**テストしたバージョン** **:**
マイクロソフトは [MDAC 2.1、2.5、2.6 および 2.7](http://www.microsoft.com/japan/msdn/data/download.aspx) のテストを行い、これらの脆弱性による影響を評価しました。さらに、Internet Explorer 5.01、5.5 および 6.0 のテストを行い、クライアント側の脆弱性の影響を評価しました。それ以前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**この更新プログラムによって排除される脆弱性は何ですか?**

この更新プログラムは、多くの Web サーバーおよびクライアントに影響を及ぼすセキュリティ上の脆弱性を排除します。しかし、この更新プログラムをインストールする前に、この更新プログラムに関する重要な注意点をご確認ください。

**この更新プログラムに関する注意点とは何ですか？**

この更新プログラムは、この脆弱性を解決しますが、更新プログラムを適用したシステムでも、特異な状況下において再び脆弱性の影響を受ける、ある特定のシナリオが存在します。このシナリオは、この脆弱性の影響を受けるコンポーネントの 1 つによって使用される “Kill Bit” が設定されないために起こります。

**"Kill Bit"とは何ですか？**

Kill Bit は、ActiveX コントロールがシステム上に存在している場合でも、Internet Explorer から呼び出されないようにする方法です。（Kill Bitに関する詳細はマイクロソフトサポート技術情報 [240797](http://support.microsoft.com/kb/240797) をご覧ください。）通常、ActiveX コントロールにセキュリティ上の脆弱性がある場合、更新プログラムにより、新しいコントロールがインストールされ、その脆弱性の影響を受けるコントロールに Kill Bit が設定されます。しかし、今回の場合、その方法は適していません。

**今回の場合** **Kill Bit** **を設定するのが適さないのはなぜですか？**

これらの脆弱性の影響に関連する ActiveX コントロールは、多くのアプリケーションおよび Web ページでデータにアクセスするために使用されます。サードパーティ製のアプリケーションを含む多くのアプリケーションには、ActiveX コントロールへの参照がハードコードされた形で含まれています。更新プログラムが Kill Bit を設定する場合、Web ページは、新しい、修正されたバージョンの AxtiveX コントロールを使用していても、まったく機能しなくなります。そのため、更新プログラムがその脆弱性を排除するためにコントロールをアップデートしますが、最新のコントロールは使用されず、旧バージョンのコントロール上に Kill Bit を設定していません。

**この方法に関する危険はどのようなものですか？**

ここで問題になっている ActiveX コントロールは、マイクロソフトによってデジタル署名されています。その署名は現在も有効であるため、ある特定の状況下において、攻撃者により、脆弱性の影響を受ける旧バージョンのコントロールが、更新プログラムが適用されているシステムに再度インストールされ、その結果そのシステムに再びこの脆弱性の影響が及ぶ恐れがあります。しかし、この攻撃を実行するには、ユーザーが悪意のある人物によって運用されている Web サイトを訪問するか、またはそのような人物からの HTML 形式のメールを開くことが必要条件となります。（HTML 形式のメールの場合には、Outlook 6 または Outlook 2002 を既定の構成で使用するか、または[Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)をインストールしたOutlook 98 または 2000を使用しているお客様には危険は及びません）

**攻撃者が旧バージョンのコントロールを再度自動的にインストールする可能性があるのはなぜですか?** **警告メッセージは表示されないのですか?**

デジタル署名に関してエラーが発生した場合、（例 : 不正な署名、期限切れの証明書） または署名者が信頼されない場合、常に警告メッセージが表示されます。しかし、今回のケースでは、旧バージョンのコントロール上のデジタル証明書は現在も有効で、署名者はマイクロソフトとなっており、状況によっては多くのユーザーがこの特定のマイクロソフトの証明書を信頼するように既に選択している可能性があります （証明書がいくつかの異なる Microsoft ActiveX コントロールに署名するために使用されているためです）。このため、多くのユーザーには、コントロールが再度インストールされる場合、警告メッセージが表示されません。

**コントロールに署名するために使用された証明書を無効にしないのはなぜですか?**

そのコントロールに署名するために使用された証明書は現在も有効です。この問題は、証明書にではなく、コントロールに存在します。また、同じ証明書を使用して多くのコントロールに署名されており、この証明書を無効にすると、それらのコントロールも無効になってしまいます。

**システムにコントロールが自動的に再度インストールされないようにするためには、どのような対策を取ればよいですか?**

マイクロソフトを含み、信頼されない発行元を削除することが、最も簡単な方法です。削除した場合、Web ページまたは HTML メールが ActiveX コントロールをダウンロードしようとすると、常に警告メッセージが表示されます。信頼される発行元の一覧を削除する方法は、以下の通りです。

1.  Internet Explorer で、\[ツール\]、次に \[インターネット オプション\] を選択します。
2.  \[コンテンツ\] タブをクリックします。このページの \[証明書\] の部分で、\[発行元\] をクリックします。
3.  \[証明書\] ダイアログにて、\[信頼された発行元\] タブをクリックします。
4.  一覧のそれぞれの証明書を選択し、\[削除\] ボタンをクリックします。一覧のすべてを削除してください。
5.  一覧中のすべての発行元を削除したら、\[閉じる\] ボタンをクリックして、\[証明書\] ダイアログを閉じ、次に \[OK\] ボタンをクリックし、\[インターネット オプション\] ダイアログを閉じます。

**信頼される発行元の一覧を削除した後、「Web** **サイトまたは** **HTML** **形式の電子メールがコントロールをダウンロードする必要があります」という内容のメッセージが表示された場合、ダウンロードするかどうかはどのように決定すればよいですか?**

それを決定する最も良い基準は、その Web サイトまたは HTML 形式の送信者が信頼できるかどうかということです。コントロールを提供している Web サイトが信頼できない場合、ダウンロードはキャンセルしてください。

**マイクロソフトは今後、このコントロールに** **Kill Bit** **を設定する予定ですか?**

はい。マイクロソフトは、これらのコントロールへの参照を含む Web ページをユーザーが強制的に再度作成せずに、この脆弱性の影響を受けるバージョンのコントロールに、Kill Bit を設定できる新たな技術を開発しています。その新たな技術が入手可能になる際には、この更新プログラムにその技術を含む予定です。

**どのようなことが起こる可能性がありますか?**

これは[バッファ オーバーラン](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者はこの脆弱性を悪用し、影響を受けるシステムの完全な制御を取得し、正規のユーザーが実行できるすべての操作を実行する可能性があります。この操作には、システム上のデータの作成、変更、削除、システムの再構成、ハード ドライブの再フォーマット、攻撃者の任意のプログラムの実行などが含まれます。この脆弱性は、Web サーバーおよび Web クライアントの両方の影響を及ぼすため、マイクロソフトはすべてのユーザーに、システムをこの脆弱性から保護する対策を講じることを推奨します。

Windows XP システムは、Web サーバー、Web クライアントとして使用されている場合にも、この脆弱性による影響はありません。その他のシステムは、様々な異なる影響があります。

-   Web サーバーは、システムを保護するためには、更新プログラムの適用から影響を受ける機能を無効にするまでの異なる対策があります。サーバーがこの脆弱性の影響を受ける場合でも、URLScan などのツールによって、この脆弱性が悪用された場合の攻撃をサービス拒否のみに制限することができる可能性があります。
-   Web クライアントは、Web の閲覧に使用することがある Web サーバーを含み、選択肢はより少なくなります。Windows XP 以外を実行している Web クライアントは更新プログラムの適用によってのみシステムをセキュリティで保護することができます。

**何が原因で起こりますか?**

Microsoft Data Access Components （具体的には Remote Access Service データ スタブ） の 1 つに、未チェックのバッファが含まれるためにこの脆弱性が起こります。

**Microsoft Data Access Components** **とは何ですか?**

Microsoft Data Access Components (MDAC) は、プログラムがデータベースにアクセスし、その中のデータの処理を容易にするコンポーネントの集合体です。現代のデータベースは、様々な形式を取っており、（例 : SQL データベース、Access データベース、XML ファイルなど） 様々な場所に置かれています。 （例 : ローカル システム上、またはリモート データベース サーバー） MDAC は、それらのデータベースすべてと、一貫した方法で連携する機能を統合し、提供します。

**MDAC** **はシステムにインストールされていますか?**

MDAC はほとんどの場合、確実にシステムにインストールされています。MDAC は広く使用されている技術です。

-   Windows XP、Windows 2000、Windows Millennium の一部としてインストールされます。（Windows XP によってインストールされるバージョンには、この脆弱性は存在しません。）
-   [マイクロソフト Web サイト](http://www.microsoft.com/japan/msdn/data/) からダウンロードできます。
-   その他の多くのマイクロソフトのアプリケーションによってインストールされます。たとえば、MDAC は Windows NT® 4.0 Option Pack の一部として、または Microsoft Access および SQL Server によってインストールされます。
-   MDAC の中のコンポーネントの中には、マイクロソフトのその他の多くの技術に含まれているものがあります。たとえば、Internet Explorer にはいくつかの MDAC の機能が含まれます。これは、後述のようにこのケースでは重要な要素となります。

**リモートデータサービスとは何ですか?**

リモート データ サービス (RDS) は MDAC のコンポーネントです。RDS は、インターネットベースのシナリオでよく必要となる機能、つまり、3 階層システムから間接的にデータ ソースにアクセスできる機能を提供します。検索機能を実装する Web サイトを訪問したことがある場合、そのユーザーは、[3 階層システム](http://msdn2.microsoft.com/en-us/library/ms966930) （英語情報） に参加したことになります。このようなシステムでは、ユーザー （「ユーザー インターフェイス層」 を占有するユーザー） は、データベースに問い合わせを行いますが、（それにより、「データベース層」 が占有されます） その問い合わせは直接的に行われません。その代わり、ユーザーは、ビジネス ロジック層として知られる、中間層へリクエストを行います。ほとんどのインターネットのシナリオでは、ビジネス ロジック層は、Web サーバーに配置されています。

ビジネス ロジック層の目的は、ユーザーが必要なデータを決定し、それらのリクエストをデータベース コマンドの集合に変換し、それらのコマンドをユーザーが実際に作成できるかを確認し、その後、それらをデータベース層に送信することです。データベースからの応答があると、ビジネス ロジック層は、その結果をユーザーが使用しやすい形式に変換する必要がある場合があります。RDS は、これらのシステムのビジネス ロジック層の実装に必要な機能の多くを提供し、具体的には、Web サーバー上では、クライアントからのデータベース リクエストを変換し、クライアント上では、これらのリクエストを Web サーバーから受信した際に、リクエストへの応答を変換する機能が提供されます。

**RDS** **の何が問題になっていますか?**

MDAC 2.4、2.5 および 2.6 で配布される RDS のコンポーネントの 1 つに未チェックのバッファが含まれます。サーバー側では、このコンポーネントは、RDS データ スタブと呼ばれ、クライアント側では、そのコンポーネントは、Data Space コントロールと呼ばれています。これらのコンポーネントは、ビジネス ロジック層の機能のいくつかを実装します。特に、データ スタブは、HTTP リクエストを処理し、それらを RDS リクエストに変換し、変換されたリクエストが RDS のコア機能へ渡され、処理されます。

**RDS** **データスタブに未チェックのバッファが含まれるというのはどのような意味ですか?**

バッファとは、ある種類のデータを持つために割り当てられるメモリの中の場所のことです。プログラムは、バッファ （この場合、RDS データ スタブ） を持ち、そのバッファが持つことができる以上のデータが保存されないようにチェックする必要があります。そうでなければ、データは周りのメモリにあふれ出し、そこにあるデータが上書きされ、その結果バッファのオーバーランが発生してしまいます。

バッファのオーバーランは危険です。比較的深刻度が低い例では、バッファがランダム データによってオーバーランする場合、オーバーランが発生したメモリが破損する可能性があります。ほとんどの場合、プログラム、またはシステム自体が異常終了する可能性があります。しかし、綿密に選択されたデータでバッファがオーバーランした場合、プログラムが変更され、新たな機能が実行される可能性があります。既に実行されているプログラムが攻撃者の狙ったように変更される恐れのある問題は、非常に深刻です。

**この脆弱性により、攻撃者は何ができますか?**

この脆弱性により、攻撃者は、影響を受けるシステムにHTTP リクエストを送信し、それが RDS データ スタブによって処理された際に、バッファ オーバーランを発生させる可能性があります。MDAC （特に RDS） がインストールされ、実行されているすべてのシステムは、この脆弱性による危険にさらされます。しかし、以下の 2 種類のシステムが特に危険にさらされる可能性があります。

-   **Web** **サーバー** : 多くの Web サーバー上では、この脆弱性の影響を受けるバージョンの RDS が実行されています。このようなサーバーに対し、攻撃者によってこの脆弱性が悪用された場合、攻撃者は、サーバーを不安定にさせるか、または最悪の場合、サーバーの完全な制御を取得する可能性があります。攻撃者は、次に Web ページを改ざんし、その後にそのサイトを訪問したユーザーを攻撃するか、または単純にハード ドライブの再フォーマットをする恐れがあります。
-   **Web** **クライアント**: Web クライアントとは、Web ページを処理するために使用されるすべてのシステムを意味します。一般的な例では、Web の閲覧、または電子メールの処理に使用される、家庭用のコンピュータ、ラップトップ、またはワークステーションがこれに含まれます。RDS データ スタブは、これらのシステムに Internet Explorer の一部としてインストールされています。このようなサーバーに対し、攻撃者によってこの脆弱性が悪用された場合、攻撃者は、Internet Explorer を異常終了させるか、（この影響は長く続かないと思われます） または最悪の場合、ユーザーの権限を取得する可能性があります。攻撃者は、次にそのシステム上でそのユーザーが実行できるすべての操作を実行する可能性があります。

**誰がこの脆弱性を悪用する可能性がありますか?**

攻撃者がこの脆弱性を悪用するのが、Web サーバーであるかまたは Web クラアントであるかによって異なります。

-   **Web** **サーバー**: 攻撃者がこの脆弱性の影響を受けるサーバーと Web セッションを確立することができる場合、サーバーに不正な HTTP リクエストを送信することにより、この脆弱性が悪用される可能性があります。
-   **Web** **クライアント**: 攻撃者が不正な HTTP コマンドを送信する Web ページを作成し、次にユーザーにそれを開くように誘導した場合、Web クライアントに対してこの脆弱性が悪用される可能性があります。通常、この攻撃は、攻撃者が運営する Web サイトにそのようなページをホストするか、または HTML 形式のメールとしてユーザーに直接送信することによって、実行される可能性があります。

**Web** **サーバーを実行しています。そのシステムに危険が及ぶかどうかはどのように確認することができますか?**

Web サーバーは、以下の両方に当てはまる場合に危険にさらされる恐れがあります。

-   この脆弱性の影響を受けるバージョンの MDAC がサーバーにインストールされている場合。Windows XP の一部として出荷されている、最新のバージョンの MDAC [バージョン 2.7](http://www.microsoft.com/japan/msdn/data/download/mdac/27/27.aspx) はこの脆弱性の影響は受けません。しかし、それ以前のほとんどのバージョンは、この脆弱性の影響を受けます。
-   Internet Information Services (IIS) で RDS が実行されている場合。IIS 5.0 および 5.1 では、RDS は既定で無効にされます。（システムが Windows の以前のバージョンからアップグレードされていない場合に無効になります） RDS が既定で実行される場合でも、[IIS セキュリティ チェックリスト](http://www.microsoft.com/japan/technet/archive/security/chklist/iis4cl.mspx) の案内に従って無効にすることができます。また、[IIS Lockdown Wizard ツール](http://technet.microsoft.com/ja-jp/library/dd362854.aspx)により、既定の構成で使用する際に RDS が自動的に無効にされます。

Web サーバーを Web クライアントとして使用することがある場合、（つまり、サーバーから Web を閲覧したり、電子メールを読んだりする場合） そのシステムには、依然として危険が及ぶ可能性があることにご注意ください。サーバーベースおよびクライアントベースの脆弱性はそれぞれ完全に独立しています。

**サーバーに** **URLScan** **ツールをインストールしました。システムは保護されますか?**

はい。[URL Scan](http://technet.microsoft.com/ja-jp/library/dd362854.aspx) ツールによってサーバーが処理する HTTP リクエストの種類が制限されます。この場合の利点は、URLScan の既定のルールセットでは HTTP リクエストが ASCII データのみで構成される場合、サーバーが処理できるのはその HTTP リクエストのみであるという点です。有効な ASCII データのみを使用して IIS サービスのオペレーションを変更するリクエストを作成するのは非常に困難ですが、この場合でも、攻撃者はサービスを異常終了させる可能性があります。

**システムを** **Web** **クライアントとして使用しています。危険が及ぶかどうかどのように確認できますか？**

最初に確認する点は、Windows XP を実行しているかチェックすることです。Windows XP を実行している場合、そのシステムは危険にさらされません。Windows XP に同梱されている MDAC のバージョンにはこの脆弱性はありません。

その他のすべての Windows のバージョンには危険にさらされます。Windows および Internet Explorer の多くのバージョンに、MDAC のこの脆弱性の影響を受けるバージョンが同梱されています。そのため、Windows XP 以外のバージョンを実行しているシステムは、ほとんど確実に危険にさらされており、更新プログラムが必要です。

**Windows XP** **には脆弱性の影響はなく、Internet Explorer 6.0** **のユーザーには影響があるとのことですが、Internet Explorer 6.0** **は** **Windows XP** **の一部として出荷されています。Windows XP** **にこの脆弱性の影響がないのはなぜですか?**

Internet Explorer 6.0 がシステムにインストールされる際、Internet Explorer 6.0 は MDAC が既にインストールされているかチェックし、インストールされていない場合、MDAC のバージョンをインストールします。Windows XP の場合、MDAC のバージョンは既にインストールされており、そのバージョンはこの脆弱性の影響を受けないバージョンです。そのため、Internet Explorer 6.0 はそのバージョンの MDAC を使用します。

**Web** **サイトベースの攻撃または** **HTML** **形式の電子メールベースの攻撃は、Web** **クライアントにとって、より深刻な脅威となるのですか？**

攻撃者が選択した方法に関わらず、これらの攻撃には、攻撃者にとってのメリットとデメリットがあります。Web サイト上に Web ページをホストする場合の、攻撃者にとっての主なメリットは、ほとんどのコンピュータが、更新プログラムがインストールされていない限り、これらの攻撃の影響を受けるという点です。攻撃者側の主なデメリットとしては、攻撃者は、そのようなサイトにユーザーを強制的に訪問させる方法がないという点です。その代わり、攻撃者は、通常攻撃者のサイトへのリンクをクリックさせることによって、ユーザーをそのようなサイトに誘導する必要があります。

一方、そのような Web ページを HTML 形式のメールとして送信することは、特定のユーザーを標的にでき、それらを直接送ることができるという点で、攻撃者側のメリットとなります。HTML 形式のメールを悪用した攻撃の攻撃者のデメリットとしては、多くのユーザーのシステム上で失敗に終わるという点です。具体的には、更新プログラムが適用されていない場合でも、この脆弱性は[Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)を適用した Outlook 98 または Outlook 2000 が使用されているシステム、または Outlook Express 6、Outlook 2002 が既定の構成で使用されているシステムではHTML 形式の電子メール ベースの攻撃方法は悪用されることはありません。

**システムを** **Web** **サーバーとして使用しており、この脆弱性の影響を受けないことを確認しました。しかし、このシステムから** **Web** **を閲覧することもあります。この更新プログラムをインストールする必要がありますか?**

はい、あります。Web クライアントとして実行しているシステムはすべて更新プログラムが必要です。これは、そのシステムが Web サーバーである場合にも当てはまります。また、Web サーバーがこの脆弱性から保護されるように構成されている場合にも当てはまります。

**MDAC** **および** **Internet Explorer** **用の個別の更新プログラムはありますか?**

いいえ、ありません。マイクロソフトは、MDAC および Internet Explorer を同時に修正するプログラムをインストールする 1 つの更新プログラムを開発しました。この更新プログラムは、MDAC のバージョンを確認します。システムに MDAC がインストールされている場合、更新プログラムがシステムにインストールされ、脆弱性の影響を受けるすべてのコンポーネントに修正を適用します。システム上にこの脆弱性の影響を受けるコンポーネントが存在しない場合、更新プログラムは何も修正しません。

**MDAC** **がインストールされているかわかりません。更新プログラムを適用する前に、確認する必要がありますか?**

いいえ、必要ありません。この更新プログラムは、MDAC のバージョンを確認します。システムに MDAC がインストールされている場合、更新プログラムがシステムにインストールされ、必要な修正を適用します。

更新プログラム
--------------

<span></span>
この問題に対する更新プログラムは、次のサイトからダウンロードできます。日本語環境でご利用いただくことができます。

-   [http://www.microsoft.com/downloads/details.aspx?FamilyID=cc37d12e-af4a-46dc-b0cc-8c789fde2f4b&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=cc37d12e-af4a-46dc-b0cc-8c789fde2f4b&displaylang=en)
-   なお、MDAC **2.5** をお使いのお客様におかれましては、この問題に対する MDAC **2.5** 用の修正は Windows 2000 Service Pack 4 以降に含まれています。Windows 2000 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

    <http://www.microsoft.com/japan/windows2000/downloads/>

#### 更新プログラムに関する追加情報

**対象プラットフォーム** **:**
この更新プログラムは以下の製品を実行しているシステムにインストールすることができます。

-   Windows 98
-   Windows 98SE
-   Windows Me
-   Windows NT 4.0 [Service Pack 6a](http://www.microsoft.com/japan/products/ntserver/sp6/)
-   Windows NT 4.0 Terminal Server Edition [Service Pack 6](http://www.microsoft.com/japan/ntserver/downloads/sp6a.mspx)
-   Windows 2000 Service Pack 2 または Service Pack 3

**この修正を含む予定のサービスパック** **:**

-   この問題に対する更新プログラムは MDAC 2.5 の次の Service Pack に含まれる予定です。MDAC 2.1 および MDAC 2.6 向けの Service Pack はリリースの予定は現在のところありません。
-   この問題に対する MDAC 2.5 用の更新プログラムは Windows 2000 [Service Pack 4](http://www.microsoft.com/downloads/details.aspx?familyid=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&displaylang=ja) に含まれています。
-   この問題に対する更新プログラムは Internet Explorer 6 Service Pack 2 に含まれる予定です。

**再起動の必要性** **:**

-   Web サーバー : 更新プログラムのインストール後に、サーバーを再起動することを推奨します。
-   Web クライアント : 更新プログラムのインストール後に再起動は必要ありません。

**更新プログラムのアンインストール** **:**
不可

**更新プログラムに含まれる過去の修正** **:**
なし

**更新プログラムが正しくインストールされたかどうか確認する方法** **:**

-   マイクロソフト サポート技術情報 [329414](http://support.microsoft.com/kb/329414) のファイル欄を参照して、更新プログラムが正しくインストールされたかどうかを確認してください。

**警告** **:**

-   「よく寄せられる質問」 で説明しているように、この更新プログラムは、影響を受ける ActiveX コントロール上に Kill Bit を設定しません。
-   この更新プログラムの適用後に、更新プログラムのインストール以前の MDAC Service Pack がインストールされる場合、更新プログラムが削除されます。また、更新プログラムのファイルは依然としてシステム上に存在するため、Windows Update は更新プログラムのファイルが使用されていないことを検出することができず、更新プログラムの再インストールに関しても表示されません。その代わり、ユーザーが MDAC の Service Pack のインストールの後に、更新プログラムを手動で再度インストールする必要があります。

    たとえば、MDAC 2.5 に更新プログラムを適用したユーザーがこの例に該当します。更新プログラムを適用した MDAC 2.5 マシンに MDAC 2.5 Service Pack 2 を適用した場合、後退が発生し、ユーザーはこの更新プログラムを再度インストールする必要があります。

本問題に対する完全な対策は、MDAC バージョン 2.7 以降を適用することです。MDAC バージョン 2.7 以降はこの脆弱性の影響を受けず、上述の Kill Bit 未設定によるコンポーネントの再登録の問題も発生しません。可能な限り MDAC 2.7 以降のバージョンへのアップグレードをお願いいたします。

**MDAC 2.7のインストールに伴う注意点** **:**

-   MDAC 2.7 のインストール実行時にプロセス一覧が表示されることがあります。このプロセス一覧に表示されたプロセスは必ず停止する必要があります。もし停止せずに MDAC のインストールを進めた場合、MDAC のコンポーネントが正常にインストールすることができない現象が発生することがあります。その結果、OS の再インストールを余儀なくされることがあります。詳細は次のサポート技術情報をご確認ください。

    [418820 \[MDAC\] インストールしても一部のファイルが DLLCACHE に登録されない](http://support.microsoft.com/kb/418820)
-   MDAC インストール中にプロセスを停止せずにインストール処理を行ってしまった場合、再起動が要求されます。再起動後の最初のログオンは管理者権限で行い、インストール処理を完了してください。
-   MDAC 2.7 は MSXML のコンポーネントを含んでいるため [MS02-008](http://technet.microsoft.com/security/bulletin/ms02-008) の適用をお願いいたします。
-   MDAC 2.7 を適用することにより、MDAC 2.7 上で動作確認されていないアプリケーションが正しく動作しなくなる可能性があります。現在お使いのアプリケーションに与える影響に関しては、製品の開発元様までご確認ください。

    現在 MDAC 2.7 に関して弊社で確認している問題は、ダウンロードページに記載されておりますので、ご確認のうえ適用ください。

    MDAC の最新バージョンは、以下の Microsoft Universal Data Access サイトからダウンロード可能です。

    <http://www.microsoft.com/japan/msdn/data/>

**他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。** **:**

-   セキュリティ更新プログラムは[マイクロソフト ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード探索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。

[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS02-065）
    [http://www.microsoft.com/technet/security/bulletin/ms02-065.mspx](http://technet.microsoft.com/security/bulletin/ms02-065)
-   サポート技術情報 （KB） 文書番号 ： 329414
    [\[MS02-065\] Microsoft Data Access Components のバッファ オーバーランにより、コードが実行される (MDAC 2.6)](http://support.microsoft.com/kb/329414)

**謝辞** **:**
この問題を連絡し、顧客の保護に協力して下さった Foundstone Research Labs に対し、マイクロソフトは深い[謝意](http://technet.microsoft.com/security/bulletin/policy) を表します。

**更新履歴** **:**

-   2002/11/21: このセキュリティ情報ページを公開しました。
-   2002/11/28: この問題に対する日本語版 KB を公開しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
