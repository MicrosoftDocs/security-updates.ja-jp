---
TOCTitle: 'MS02-069'
Title: 'マイクロソフト セキュリティ情報 MS02-069 - 緊急'
ms:assetid: 'ms02-069'
ms:contentKeyID: 61228494
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms02-069(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS02-069 - 緊急
===============================================

Microsoft VM の問題により、システムが侵害される (810030)
--------------------------------------------------------

公開日: 2002年12月12日 | 最終更新日: 2009年7月3日

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:**
Microsoft® Windows® を使用しているお客様

**脆弱性の影響** **:**
8 つの脆弱性。最も深刻な脆弱性については、攻撃者が別のユーザーのシステムの制御を取得する可能性があります。

**最大深刻度** **:**
緊急

**推奨する対応策** **:**
下記に説明されているように、お客様は Microsoft VM ビルド 3809 またはそれ以降のビルドをインストールして下さい。

**影響を受けるソフトウェア** **:**

-   Microsoft 仮想マシン (Microsoft VM) のバージョンはビルド番号により識別されます。ビルド番号は 「よく寄せられる質問」 で説明されているように JVIEW ツールを使用して確認することができます。5.0.3805 までの Microsoft VM の すべてのビルド (5.0.3805 を含む) はこれらの脆弱性の影響を受けます。

### 詳細

問題
----

<span></span>
**技術的な説明** **:**
Microsoft VM は Win32® 運用環境のための仮想マシンです。Microsoft VM は Internet Explorer のほとんどのバージョンに同梱されています。また、Windows のほとんどのバージョンにも同梱されています。(これらのバージョンの一覧は 「よく寄せられる質問」 をご覧下さい。)
Microsoft VM の新しいバージョンが利用可能となり、新たに報告された 8 つのセキュリティ問題に対する更新プログラムおよび以前リリースされたすべての VM 用の更新プログラムを含みます。すべての新しい問題に関する攻撃方法は同一である可能性があります。攻撃者は開かれると任意の脆弱性を悪用する Web ページを作成し、それを Web サイトにホストする、または HTML 形式の電子メールとしてユーザーに送る可能性があります。
新しく報告されたセキュリティ問題は次の通りです。

-   信頼されない Java アプレットが COM オブジェクトにアクセスする可能性があるセキュリティ上の脆弱性。仕様上、COM オブジェクトは、その機能が公開されるものであるため、信頼される Java プログラムにのみ利用可能となる必要があります。COM オブジェクトは攻撃者がシステムを制御する機能を提供している可能性があります。
-   原因は異なりますが、同じ影響を及ぼす 2 つの脆弱性。これらの脆弱性により、アプレットのコードベースの実際の場所が偽装される可能性があります。仕様上、ユーザーの記憶域またはネットワーク共有上の Java アプレットはそれが存在するフォルダおよびそのフォルダの下のすべてのフォルダへの読み取りアクセス権を持ちます。これらの脆弱性により、Web サイトのアプレットがそのコードベースの場所を誤って表示し、そのコードベースはユーザーのローカル システムまたはネットワーク共有に存在すると示されます。
-   攻撃者によって解析されると、ある Web サイトから Java アプレットを読み込み、そのアプレットが別の Web サイトに属すものであると間違って表示する URL を作成する可能性がある脆弱性。この結果、攻撃者のアプレットは別の Web サイトのドメインで実行される可能性があります。ユーザーによりアプレットに提供された情報は攻撃者に中継されます。
-   Microsoft VM がアプレットによる JDBC API の呼び出しを防止しないために起こる脆弱性。JDBC API とは、データベース アクセス メソッドを提供する API のセットです。仕様上、これらの API はデータベースのコンテンツの追加、変更、削除または書き換えを行う機能を提供します。これはユーザーのアクセス権のみを制御します。
-   攻撃者が指定された Java オブジェクトの読み込み、実行を一時的に妨げる可能性がある脆弱性。Standard Security Manager として知られているレガシー セキュリティ メカニズムは Java アプレットの実行を妨げるなど、これらのアプレットを制限する機能を提供します。しかし、VM は適切に SSM へのアクセスを規制せず、この結果、攻撃者のアプレットがそのほかの Java オブジェクトを 「禁止された」 一覧に追加する可能性があります。
-   攻撃者がローカル システム上のユーザーのユーザー名を知る可能性がある脆弱性。特定のシステム プロパティである user.dir は、本来、信頼されないアプレットに利用可能であるべきではありません。しかし、ある問題により、利用可能となるため、この脆弱性が起こります。ユーザー名が知られることは、それ自体ではセキュリティ上の危険性はありませんが、調査目的には役に立つ場合があります。
-   Java アプレットが別の Java オブジェクトの不完全なインスタンスの作成を行うことができるために起こるセキュリティ問題。この影響として、VM の包含アプリケーションである Internet Explorer が異常終了する可能性があります。

**問題を緩和する要素** **:**
これらのすべての脆弱性には 2 つの共通の問題を緩和する要素があります。

-   Web ベースの攻撃は、ユーザーが Internet Explorer のセキュリティ ゾーン (このゾーンで攻撃者の Web サイトが表示されます) で Java アプレットを無効にしている場合、阻止されます。
-   電子メールによる攻撃は、ユーザーが実行している電子メール クライアントの種類によって阻止されます。具体的には Outlook Express 6 および Outlook 2002 (Office XP に同梱されています) は既定で Java を無効にします。また、[Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)をインストールした Outlook 98 および Outlook 2000 は Java を無効にします。

COM オブジェクト アクセスの脆弱性 :

-   この脆弱性は攻撃の機会を示すのみです。攻撃者はシステム メモリ、Cookie、クリップボードまたはそのほかの場所に保存されている機密データを確認することはできません。

CODEBASE 偽装の脆弱性 :

-   ファイル (リモート共有のファイルも含む) への攻撃者のアクセス権はユーザーのアクセス権に限定されます。ユーザーが制限された権限のみを持つ場合、攻撃者の権限も制限されます。

ドメイン偽装の脆弱性 :

-   ユーザーが Web サイトを閲覧中に攻撃者の Web サイトを訪問した場合のみ、この脆弱性が悪用される可能性があります。
-   この脆弱性が悪用された場合、現在の Web セッションのみが影響を受けます。

JDBC API の脆弱性 :

-   攻撃者がアクセスしたい各データ ソースの名前を知っている場合、この脆弱性が悪用される可能性があります。ほとんどの場合、攻撃者はユーザーのネットワークの内部構成に関する知識が必要となります。
-   攻撃者が取得する可能性のあるものは、データ ソースへのユーザー自身のアクセス権のみです。たとえば、ユーザーが特定のデータベースへの読み取りアクセス権のみを所有する場合、攻撃者もそのアクセス権のみを取得します。

Standard Security Manager アクセスの脆弱性 :

-   この脆弱性が悪用された場合の影響は、現在のブラウザ セッションが実行されている間のみ継続します。
-   この脆弱性が悪用されても、アプレットの機能は変更されません。アプレットの実行が妨げられるのみです。

User.dir 公開の脆弱性 :

-   攻撃者がユーザー名を知ること自体では、そのユーザーに対し、攻撃者は何もできません。攻撃者にとってこの情報を取得する唯一の利点は、それを偵察目的で使用し、後の不特定の攻撃で悪用できる可能性がある点です。

不完全な Java オブジェクトのインスタンス作成の脆弱性 :

-   この脆弱性が悪用されても、攻撃者に可能な操作は Internet Explorer を異常終了させることのみです。攻撃者は Windows 自体、またはそのほかのアプリケーションを異常終了させることはできません。
-   ユーザーはブラウザを再起動することにより、通常の操作を行えるようになります。

**深刻度** **:**

|                                                                  | 深刻度 |
|------------------------------------------------------------------|--------|
| **COM** **オブジェクトアクセスの脆弱性**                         | 緊急   |
| **CODEBASE** **偽装の脆弱性**                                    | 重要   |
| **ドメイン偽装の脆弱性**                                         | 警告   |
| **JDBC API** **の脆弱性**                                        | 警告   |
| **Standard Security Manager** **アクセスの脆弱性**               | 注意   |
| **User.dir** **公開の脆弱性**                                    | 注意   |
| **不完全な** **Java** **オブジェクトのインスタンス作成の脆弱性** | 注意   |

上記の[評価](http://technet.microsoft.com/security/bulletin/rating)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。

**脆弱性識別番号** **:**

-   COM オブジェクト アクセスの脆弱性 : [CAN-2002-1257](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1257)
-   CODEBASE 偽装の脆弱性 : [CAN-2002-1258](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1258)
-   ドメイン偽装の脆弱性 : [CAN-2002-1259](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1259)
-   JDBC API の脆弱性 : [CAN-2002-1260](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1260)
-   Standard Security Manager アクセスの脆弱性 : [CAN-2002-1261](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1261)
-   User.dir 公開の脆弱性 : [CAN-2002-1325](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1325)
-   不完全な Java オブジェクトのインスタンス作成の脆弱性 : [CAN-2002-1263](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2002-1263)

**テストしたバージョン** **:**
マイクロソフトは VM ビルド 5.0.3167 のテストを行い、この脆弱性による影響を評価しました。それ以前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、この脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**新しい** **VM** **のビルドはどのようなセキュリティ上の脆弱性を排除しますか?**

この VM のビルドは過去にリリースされたセキュリティ更新プログラムおよび新しく報告された 8 つのセキュリティ上の脆弱性を排除します。

-   攻撃者が別のユーザーのシステムの制御する可能性がある脆弱性
-   攻撃者がユーザーのシステムまたはユーザーがアクセス権を持つネットワーク共有のファイルを読み取る可能性があ脆弱性
-   特殊な状況で、攻撃者の Web サイトのプログラムを第三者の Web サイトに配置する可能性がある脆弱性
-   特殊な状況で、攻撃者がユーザーを偽装し、データベースにアクセスする可能性がある脆弱性
-   攻撃者が Web サイトを特定のユーザーのシステムで正しく動作することを一時的に妨げる可能性がある脆弱性
-   攻撃者が後の攻撃の標的となるユーザーを見つけるために調査を行う可能性のある脆弱性
-   ユーザーが攻撃者の Web サイトを閲覧する場合、攻撃者が Internet Explorer を異常終了させる可能性のある脆弱性

**Microsoft VM** **とは何ですか?**

[Microsoft 仮想マシン](http://www.microsoft.com/japan/java) (Microsoft VM) は、Windows プラットフォームでの Java プログラムの実行を可能にします。Microsoft VM は Windows および Internet Explorerのほとんどのバージョンに含まれています。ここで説明する脆弱性は Microsoft VM をインストールしているすべてのお客様に影響を及ぼします。

**使用中のシステムに** **Microsoft VM** **がインストールされているかどうか分かりません。どのように確認できますか?**

Windows の次のバージョンのいずれかを使用している場合、Microsoft VM がインストールされています。

-   Microsoft Windows 95
-   Microsoft Windows 98 および 98SE
-   Microsoft Windows Millennium
-   Service Pack 1 以降の Microsoft Windows NT 4.0
-   Microsoft Windows 2000
-   Service Pack 1 以降の Microsoft Windows XP

Microsoft VM は Internet Explorer およびそのほかの製品のいくつかのバージョンにも同梱されています。また、オン デマンドでのインストールを介し Windows XP に含まれました。Microsoft VM がインストールされているかどうか定かでない場合、次の手順に従ってください。

1.  \[スタート\] を選択し、次に \[ファイル名を指定して実行\] を選択します。
2.  \[ファイル名を指定して実行\] ダイアログボックスが表示されたら、次の操作を行います。
    -   Windows 98 または Windows Millennium を実行している場合、“command” (二重引用符 “ ” は不要です) と入力し、エンター キーを押します。
    -   Windows NT 4.0、Windows 2000 または Windows XP を実行している場合、“cmd” (二重引用符 “ ” は不要です) と入力し、エンター キーを押します。
3.  起動したコマンド ボックスに “Jview” (二重引用符 “ ” は不要です) と入力します。プログラムが実行された場合、Microsoft VM がインストールされています。”該当する名前のプログラムはありません” といった内容のエラー メッセージが表示された場合、Microsoft VM はインストールされていません。

**これは** **Microsoft VM** **の新しいバージョンですか?**

はい。Microsoft VM ビルド 3809 は Microsoft VM の新しいリリースです。

**使用している** **Microsoft VM** **のバージョンはどのように確認するのですか?**

使用中のビルド番号の確認方法は次の通りです。

1.  \[スタート\] を選択し、次に \[ファイル名を指定して実行\] を選択します。
2.  Windows 95、98 または Me で、“command” (二重引用符 “ ” は不要です) と入力します。Windows NT 4.0、2000 または XP では、“cmd” (二重引用符 “ ” は不要です) と入力し、エンター キーを押します。
3.  起動したコマンド ボックスに “Jview” (二重引用符 “ ” は不要です) と入力し、エンター キーを押します。
4.  結果が表示された一番上の行の右端に、x.yy.zzzz という形式でバージョン番号が表示されます。下 4 桁がバージョン番号です。以下のように表示された場合、”3805” がバージョン番号です。
    Microsoft (R) Command-line Loader for Java Version 5.00.3805

**バージョン番号の確認後、何をする必要がありますか?**

次の表を使用し、正しい操作を確認して下さい。

 
<table style="border:1px solid black;">
<thead>
<tr class="header">
<th style="border:1px solid black;" ><br />
バージョン番号</th>
<th style="border:1px solid black;" >必要な操作<br />
</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">3805 またはそれ以前</td>
<td style="border:1px solid black;">Microsoft VM ビルド 3809 を適用します。(「更新プログラム」のセクションをご覧ください)</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">2002 年 9 月にリリースされた MS02-052 の更新プログラムを適用した 3805</td>
<td style="border:1px solid black;">Microsoft VM ビルド 3809 を適用します。(「更新プログラム」のセクションをご覧ください)</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">3809 またはそれ以降</td>
<td style="border:1px solid black;">必要な操作はありません。これらの脆弱性に対し、既に保護されているバージョンが使用されています。</td>
</tr>
</tbody>
</table>
  
**COM** **オブジェクトアクセスの脆弱性** **(CAN-2002-1257) :**  
**この問題でどのようなことが起こる可能性がありますか?**
  
この脆弱性により、攻撃者の Java アプレットが別のユーザーのシステムを制御する可能性があります。これにより、攻撃者はユーザーのシステムで任意の操作を行う可能性があります。たとえば、攻撃者はユーザーのシステム上のデータの削除、変更、Web サイトとの通信、プログラムの読み込み、実行、ハード ドライブのフォーマットなどを行うことができます。  
この脆弱性は Web サイトまたは HTML 形式の電子メールにより悪用される可能性がありますが、電子メールによる攻撃方法は、ユーザーが実行している電子メール クライアントの種類によって阻止されます。具体的には Outlook Express 6 および Outlook 2002 (Office XP に同梱されています) は既定で Java を無効にします。[Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)がインストールされている Outlook 98 および 2000 も既定で Java を無効にします。
  
**何が原因で起こりますか?**
  
信頼されない Java アプレットが COM オブジェクトにアクセスでき、これによりコンピュータ上で様々な操作が可能となるためにこの脆弱性が起こります。
  
**COM** **オブジェクトとは何ですか?**
  
Component Object Model ([COM](http://www.microsoft.com/japan/com/)) とは、開発者がコンポーネントと呼ばれる単一の用途を持つソフトウェア モジュール (これはそのほかのアプリケーションによる使用も可能です) を作成できるようにするマイクロソフトの技術です。たとえば、開発者は特定の種類のダイアログ ボックスを表示する COM オブジェクトを作成することができます。これを行う利点は、その種類のダイアログ ボックスを表示する必要のあるそのほかのアプリケーションが、そのダイアログ ボックス自体を実装せずに、単に COM オブジェクトを呼び出すことができます。
  
**COM** **オブジェクトは** **Java** **とどのような関わりがありますか?**
  
ほかの種類のアプリケーションのように、Java プログラムは COM オブジェクトを使用することができます。Microsoft VM は多くの 「COM ラッパー」 を提供し、これにより Java プログラムが COM オブジェクトを呼び出せるようにします。
  
**Microsoft VM** **の以前のバージョンはどのように** **COM** **機能を公開していたのですか?**
  
仕様上、信頼される Java プログラムのみが COM オブジェクトを使用できる必要があります。COM オブジェクトは強力な機能を公開できるため、信頼されない Java アプレットは COM オブジェクトの使用が許可されていません。Microsoft VM は Java アプレットが COM オブジェクトを呼び出さないようにするセキュリティ チェックを持っていますが、このチェックを無視して COM オブジェクトを呼び出すメソッドが存在します。
  
**この脆弱性により、攻撃者は何をする可能性がありますか?**
  
この脆弱性により Java アプレットが COM オブジェクトを呼び出せる可能性があります。これによる具体的な影響は攻撃者のアプレットが使用する特定の COM オブジェクトにより異なります。しかし、COM オブジェクトは様々な操作を実行するために利用可能です。この操作の中には、攻撃者により実行されると危険がもたらされるものもあります。たとえば、ActiveX コントロール (これらは COM オブジェクトです) は既定で、ユーザーのシステム上でのデータの操作、プログラムの実行などを可能にします。
  
**誰がこの脆弱性を悪用する可能性がありますか?**
  
攻撃者が選択した Java アプレットを他のユーザーに実行させることができる全ての攻撃者により、この脆弱性が悪用される可能性があります。攻撃者がこの脆弱性を悪用する方法は 2 つあります。
  
-   この問題を悪用するアプレットを攻撃者の管理する Web サイトにホストする  
-   この問題を悪用するアプレットを HTML 形式の電子メールに含め、それを直接標的となるユーザーに送信する
  
**Web** **ベースの攻撃により、どのような危険がもたらされますか?**
  
攻撃者にとってアプレットを Web サイトにホストする利点は、ほとんどのユーザーのブラウザが WebサイトのJava アプレットの実行を許可するように構成されている点です。攻撃者にとって不利な点は、攻撃者はユーザーに強制的に攻撃者の Web サイトを閲覧させることができない点です。ユーザーが自発的に攻撃者の Web サイトを閲覧するか、または攻撃者の Web サイトに接続するハイパーリンク (別の Web サイトにホストされているもの、電子メール内のものなど) をクリックしない限り、この脆弱性は悪用されません。
  
**電子メールベースの攻撃により、どのような危険がもたらされますか?**
  
攻撃者にとってアプレットを HTML 形式の電子メールで送る利点は、攻撃者が特定のユーザーを標的にすることができる点です。つまり、攻撃者はユーザーが攻撃者の Web サイトを閲覧することを待つ必要がなく、ユーザーに直接アプレットを送ることができる点です。攻撃者にとって不利な点は、最近のマイクロソフトのメール クライアントは電子メールで Java アプレットの実行を許可していない点です。たとえば、Outlook Express 6 および Outlook 2002 (Office XP に同梱されています) は既定の構成で Java アプレットが実行されません。同様に [Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)がインストールされている Outlook 98 および Outlook 2000 は Java アプレットが実行されません。
  
**新しい** **VM** **のビルドはどのようにしてこの脆弱性を解決しますか?**
  
この更新プログラムは上記で説明したシナリオを阻止し、COM オブジェクトを呼び出すすべての方法で適切なセキュリティ チェックに従うようにします。
  
**CODEBASE** **偽装の脆弱性** **(CAN-2002-1258) :**  
**これらの脆弱性でどのようなことが起こる可能性がありますか?**
  
これらの 2 つの脆弱性は異なる問題から起こりますが、まったく同じ影響を及ぼします。いずれの場合も、攻撃者がユーザーのシステムからファイルを読み取る可能性があります。(しかし、ファイルの変更、追加、削除はできません。) また、ユーザーが読み取りアクセス権を持つネットワーク共有からファイルを読み取る可能性もあります。  
これらの脆弱性は Web サイトまたは HTML 形式の電子メールにより悪用される可能性がありますが、電子メールによる攻撃方法は、ユーザーが実行している電子メール クライアントの種類によって阻止されます。具体的には Outlook Express 6 および Outlook 2002 (Office XP に同梱されています) は既定で Java を無効にします。[Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)がインストールされている Outlook 98 および Outlook 2000 も既定で Java を無効にします。
  
**何が原因で起こりますか?**
  
これらの脆弱性は 2 つの問題から起こりますが、これらの問題により、APPLET タグの CODEBASE パラメータで指定された場所を偽装することができます。
  
**APPLET** **タグとは何ですか?**
  
[APPLET](http://msdn2.microsoft.com/en-us/library/ms952632) (英語情報) (または HTML 用語でタグ) とは、Web ページに含まれる場合、ブラウザに特定の Java アプレットを読み込み、実行させるコマンドです。
  
**CODEBASE** **とは何ですか?** **またこれは何をしますか?**
  
CODEBASE はパラメータの 1 つで、APPLET タグで指定することができます。これはブラウザに Java アプレットが存在する場所を伝え、Web サイト、第三者のサーバー、ユーザーのローカル ファイル システムで保存されている Java アプレットを指定することができます。  
仕様上、アプレットは常にそれ自体のコード ベースに対する読み取りアクセス権を持ちます。つまり、それは、そのアプレットが存在するフォルダ、および、そのフォルダの下にあるすべてのフォルダに対する読み取りアクセス権です。たとえば、CODEBASE パラメータがユーザーのシステムの C:\\XYZ フォルダに存在する Java アプレットを実行するために使用されている場合、そのアプレットはそのフォルダとそのフォルダの下のすべての子フォルダへの読み取りアクセス権を持ちます。
  
**CODEBASE** **は** **Internet Explorer** **の一部ですか?** **それとも** **Microsoft VM** **の一部ですか?**
  
APPLET タグはブラウザにより処理されるため、CODEBASE パラメータの処理は Internet Explorer の一部であると判断することができます。しかし、実際は CODEBASE の処理は Microsoft VM により処理されます。
  
**VM** **が** **CODEBASE** **機能を実装する方法にどのような問題が存在しますか?**
  
同じ影響を及ぼす 2 つの問題があります。いずれの場合も VM が ある場所からアプレットを読み込む時、そのアプレットが実際の場所とは異なる場所から読み込まれているものであると VM がみなすようにする CODEBASE 情報を作成することが可能です。ほとんどの場合、攻撃者はこれらの脆弱性を悪用し、攻撃者の Web サイトから Java アプレットを実行しますが、VM に実際にはそのアプレットが別の場所 (ユーザーのハード ドライブ、ネットワーク ファイル共有、またはそのほかの場所) からのものであるとみなすようにします。
  
**これらの脆弱性により、攻撃者は何をする可能性がありますか?**
  
攻撃者はこの脆弱性を悪用し、仕様上、アクセス出来ないはずのファイルを読み取る可能性があります。たとえば、攻撃者がアプレットをユーザーのシステムの C:\\ フォルダからのものであるかのように見せかける場合、攻撃者はそのフォルダまたはそのフォルダの下のフォルダにあるファイルが読み取れる可能性があります。同様に、攻撃者がアプレットをネットワーク共有からのものであるように見せかける場合、攻撃者はその場所からファイルを読み取る可能性があります。
  
**攻撃者はどのようにしてこの脆弱性を悪用する可能性がありますか?**
  
この脆弱性は上記に説明されている方法と同じように悪用される可能性があります。この脆弱性を悪用する Java アプレットを作成し、そのアプレットを Web ページの一部として攻撃者の Web サイトにホストするか、または HTML 形式の電子メールを介し、直接ユーザーに送ることにより、この脆弱性を悪用する可能性があります。
  
**攻撃者によりファイルが変更される可能性はありますか?**
  
いいえ、ありません。攻撃者に可能な操作はファイルの読み取りのみです。ファイルの追加、変更、削除はできません。
  
**攻撃者により読み取られるファイルの種類に何か制限はありますか?**
  
はい、あります。攻撃者のアクセス権はユーザー自身の読み取りアクセス権により決定されます。ユーザーが特定のファイルへの読み取りアクセスを持たない場合、攻撃者もまた持ちません。この制限によって 2 つの重要な効果があります。
  
-   ネットワーク ファイル ファイル共有へのアクセスが著しく制限されます。攻撃者がこのような共有へアクセスする可能性はありますが、攻撃者はユーザー自身のアクセス許可により制限されます。ユーザーがアクセスできないファイルまたはフォルダがある場合、攻撃者もそれらにアクセスできません。  
-   攻撃者はユーザー自身のシステムのいくつかの重要なファイルにアクセスすることができません。たとえば、Security Access Manager ファイルには暗号化されたユーザーのパスワードが含まれますが、オペレーティング システムによりロックされ、操作中には管理者権限を持つユーザーであっても、読み取ることができません。
  
**新しい** **VM** **のビルドはどのようにしてこの脆弱性を解決しますか?**
  
この更新プログラムは APPLET タグの CODEBASE 情報が正しく解析されるようにします。ある場合には、これは無効なリクエストを拒否するにより実行されます。また別の場合には、Web ページが CODEBASE パラメータを使用する上での制限を課し、Web ページおよびそのアプレットの場所が同じ Internet Explorer のセキュリティ ゾーンに存在する場合にのみこれが行われるようにすることで実行されます。
  
**ドメイン偽装の脆弱性** **(CAN-2002-1259) :**  
**この脆弱性でどのようなことが起こる可能性がありますか?**
  
この脆弱性により、複雑なシナリオを介し、攻撃者の Java アプレットが別の Web サイトに属すように見せかける可能性があります。ユーザーがアプレットに開示した情報は攻撃者に中継される可能性があります。  
ユーザーが別の Web サイト (多くの場合、信頼される Web サイト) を閲覧中に、攻撃者の Web サイトを閲覧した場合、またはユーザーが攻撃者により管理されているハイパーリンクをクリックした場合、この脆弱性が悪用される可能性があります。これらの場合でも、攻撃者のアプレットはユーザーに強制的に機密情報を提供させることはできません。さらに、この脆弱性は Web サイトまたは HTML 形式の電子メールを介し悪用される可能性がありますが、電子メールによる攻撃は、ユーザーが実行している電子メール クライアントの種類によって阻止されます。具体的には Outlook Express 6 および Outlook 2002 (Office XP に同梱されています) は既定で Java を無効にします。また [Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)がインストールされている Outlook 98 および Outlook 2000 も既定で Java を無効にします。
  
**何が原因で起こりますか?**
  
Microsoft VM は Java アプレットがどのドメインから読み込まれるかを誤って判断させる URL を作成できるため、この脆弱性が起こります。しかし、そのアプレットは実際には別の Web サイトのものです。
  
**ドメインとはどのような意味ですか?**
  
ドメインは Web コンテンツの元のポイントに基づき、それを区別します。ほとんどの場合、ドメインは Web サイトと同等です。たとえば、すべての Web ページ、Java アプレット、そして Web サイト A のほかのコンテンツはそれら自身のドメイン内に存在します。また、Web サイト B からのコンテンツは別のドメインに存在します。これにより、各 Web サイトのコンテンツは適切なセキュリティ制限を受けます。Internet Explorer や Microsoft VM などの Web ベースのソフトウェアは URL がどのドメインから読み込まれたものであるかをチェックすることにより、ドメインを割り出します。
  
**以前のバージョンの** **Microsoft VM** **はどのようにドメインを割り出していたのですか?**
  
VM は特定の種類の URL を正しく解析しません。具体的には、URL が 2 つの異なる Web サイトへの参照を含む特定の、非常にまれな形式を使用して構成されている場合、VM はその URL を誤って処理し、Java アプレットがある Web サイトのドメインで実行されている間に、別の Web サイトからそのアプレットを読み込みます。
  
**これにより、攻撃者は何をする可能性がありますか?**
  
事実上、この脆弱性により、攻撃者は第三者の Web サイトの Java アプレットを攻撃者が選択した アプレットと一時的に置き換えることができます。その Java アプレットは別の Web サイトのドメインに存在するため、Java アプレットはその Web サイトが特定のユーザーのシステムに配置した Cookie にアクセスできる可能性があります。さらに、Java アプレットがユーザーに要求した情報は攻撃者に中継される可能性があります。
  
**攻撃者はどのようにしてこの脆弱性を悪用する可能性がありますか?**
  
この脆弱性は上記に説明されている方法と同じように悪用される可能性があります。この脆弱性を悪用する Java アプレットを作成し、そのアプレットを Web ページの一部として攻撃者の Web サイトにホストするか、または HTML 形式の電子メールを介し、直接ユーザーに送ることにより、この脆弱性を悪用する可能性があります。攻撃者のアプレットはそのほかの Web サイトの有効なアプレットの名前と正確に一致する名前を持つことが必要条件となります。
  
**ユーザーがそのほかの** **Web** **サイトを直接閲覧する場合、攻撃者がこの脆弱性を悪用する可能性はありますか?**
  
いいえ、ありません。ユーザーがそのほかの Web サイトを閲覧中に攻撃者の Web サイトを閲覧した (または攻撃者からの HTML 形式の電子メールのリンクをクリックした) 場合、この脆弱性が悪用される可能性があります。明らかに、これは信頼される Web サイトへの通常の閲覧方法ではありません。
  
**この脆弱性の影響は永続的ですか?**
  
いいえ。たとえば、ユーザーが攻撃者の Web サイトを介し Web サイト Aを閲覧する場合、攻撃者はこの脆弱性を悪用する可能性があります。しかし、ユーザーが次に Web サイト A を直接閲覧する場合、つまり、攻撃者の Web サイトを介さずに閲覧する場合、攻撃者のアプレットではなく、正しいアプレットが実行されます。
  
**この脆弱性により、そのほかの** **Web** **サイトのアプレットが実際に差し替えられる可能性はありますか?**
  
いいえ、ありません。そのほかのユーザーが Web サイト A を閲覧する場合、正しいアプレットが実行されます。ユーザーが Web サイト A を閲覧中に攻撃者の Web サイトを閲覧するという特定の場合にのみ、攻撃者のアプレットが実行される可能性があります。
  
**新しい** **VM** **のビルドはどのようにしてこの脆弱性を解決しますか?**
  
この更新プログラムは新しいチェックを実行し、URL が上記で説明した形式を使用して構成されている場合でも、正しいドメインが割り出せるようにします。
  
**JDBC API** **の脆弱性** **(CAN-2002-1260) :**  
**この脆弱性でどのようなことが起こる可能性がありますか?**
  
この脆弱性により、攻撃者は別のユーザーを偽装し、データベースにアクセスする可能性があります。攻撃者はこの脆弱性を悪用し、ユーザーがアクセス権を持つデータ ソースのデータの読み取り、追加、変更、削除を行う可能性があります。  
攻撃者がデータベースの名前を知っている (または推測できる) 場合にのみ、この脆弱性が悪用される可能性があります。ほとんどの場合、この脆弱性が悪用されるには、かなりの内部知識が必要となります。さらに、この脆弱性は Web サイトまたは HTML 形式の電子メールを介し悪用される可能性がありますが、電子メールによる攻撃方法は、ユーザーが実行している電子メール クライアントの種類によって阻止されます。具体的には Outlook Express 6 および Outlook 2002 (Office XP に同梱されています) は既定で Java を無効にします。[Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)がインストールされている Outlook 98 および Outlook 2000 も既定で Java を無効にします。
  
**何が原因で起こりますか?**
  
Java Database Connectivity API がそれを呼び出すことができるユーザーを適切に規制せず、信頼されない Java アプレットからのリクエストを処理するため、この脆弱性が起こります。
  
**Java Database Connectivity API** **とは何ですか?**
  
Java Database Connectivity (JDBC) API とは Java プログラムが様々な種類のデータベース (SQL データベース、Access データベース、フラット ファイルなど) への接続および使用ができるようにする機能セットのことです。
  
**以前のバージョンの** **Microsoft VM** **の** **JDBC API** **はどのように機能しましたか?**
  
仕様上、信頼されるプログラムのみが API にアクセスできる必要があります。どのようなプログラムにおいても、API はデータの読み取り、変更または削除のための機能を提供します。しかし、セキュリティ チェックが無視できるため、信頼されない Java アプレットが API を使用できる可能性があります。
  
**この脆弱性により、攻撃者は何をする可能性がありますか?**
  
攻撃者はこの脆弱性を悪用し、そのほかのユーザーのデータベース アクセス権限を 「奪う」 可能性があります。これにより、攻撃者はユーザーがアクセスできるデータ ソースへアクセスし、ユーザーに与えられたすべてのアクセス許可を悪用する可能性があります。ユーザーがデータの削除ができる場合、攻撃者もこれが可能となります。また、ユーザーがデータの追加ができる場合、攻撃者もこれが可能となります。
  
**攻撃者はどのようにしてこの問題を悪用する可能性がありますか?**
  
この脆弱性は上記に説明されている方法と同じように悪用される可能性があります。この脆弱性を悪用する Java アプレットを作成し、そのアプレットを Web ページの一部として攻撃者の Web サイトにホストするか、または HTML 形式の電子メールを介し、直接ユーザーに送ることにより、この脆弱性を悪用する可能性があります。
  
**攻撃者はユーザーがアクセス権を持つデータベースをどのように見分けるのですか?**
  
この脆弱性が悪用されても、ユーザーがアクセス権を持つデータ ソース、またはこれらのデータ ソースの名前や場所などの重要な情報を攻撃者に知られることはありません。攻撃者がこの情報を得るためには、相当の調査が必要となります。
  
**ユーザーが特定のデータソースの読み取りアクセス許可のみを持つ場合、攻撃者はそのほかのアクセス許可を取得できる可能性がありますか?**
  
いいえ、ありません。攻撃者が取得するアクセス許可はユーザーの持つアクセス許可に限定されます。この脆弱性が悪用されても、攻撃者にそのほかのアクセス許可を取得されることはありません。
  
**新しい** **VM** **のビルドはどのようにしてこの脆弱性を解決しますか?**
  
新しい VM のビルドは JDBC API で適切なチェックを行い、信頼されるコードのみが JDBC API にアクセスできるようにします。
  
**Standard Security Manager** **アクセスの脆弱性** **(CAN-2002-1261) :**  
**この脆弱性でどのようなことが起こる可能性がありますか?**
  
これは[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者はこの脆弱性を悪用し、そのほかの Web サイトの Java アプレットを一時的に実行できないようにする可能性があります。この影響は現在のブラウザ セッションが行われている間、継続します。新しいブラウザ セッションではこの脆弱性の影響を受けません。  
この脆弱性は Web サイトまたは HTML 形式の電子メールにより悪用される可能性がありますが、電子メールによる攻撃方法は、ユーザーが実行している電子メール クライアントの種類によって阻止されます。具体的には Outlook Express 6 および Outlook 2002 (Office XP に同梱されています) は既定で Java を無効にします。[Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)がインストールされている Outlook 98 および Outlook 2000 も既定で Java を無効にします。
  
**何が原因で起こりますか?**
  
Java アプレットが Standard Security Manager に書き込みができるため、この脆弱性が起こります。
  
**Standard Security Manager** **とは何ですか?** **また** **Standard Security Manager** **は何をしますか?**
  
Standard Security Manager とは VM のセキュリティ ポリシー メカニズムのコンポーネントで、Java アプレットが Internet Explorer で実行される時、強制する必要がある制限に関する情報を提供します。その情報には、Java アプレットおよび Java アプレットが呼び出してはいけないモジュールの一覧があります。
  
**Standard Security Manager** **でどのような問題が修正されたのですか?**
  
VM は VM に書き込みができるユーザーを適切に規制しません。仕様上、VM 自体のみが VM に情報を追加できる必要があります。実際には、どの Java アプレットも書き込みができます。結果として、Java アプレットはそのほかのアプレットを 「禁止された」 一覧に追加する可能性があります。
  
**この脆弱性により、攻撃者は何をする可能性がありますか?**
  
攻撃者はこの脆弱性を悪用し、そのほかの Java コードを Standard Security Manager の 「禁止された」 一覧に追加し、現在の Internet Explorer のセッションがそのコードを使用できないようにする可能性があります。この結果、現在禁止されている Java モジュールに依存する Web サイトが適切に動作しなくなる可能性があります。
  
**脆弱性が悪用された場合、その影響はどのくらい継続しますか?**
  
ユーザーがブラウザを閉じるまで、この影響が継続します。次のブラウザ セッション、または平行して行われているそのほかのセッションは影響を受けません。
  
**攻撃者はこの問題を悪用し、攻撃者の** **Java** **アプレットに対する制限を緩和することができますか?**
  
いいえ、できません。この脆弱性により、攻撃者はさらに厳しい制限を課すことはできますが、制限を緩和することはできません。
  
**新しい** **VM** **のビルドはどのようにしてこの脆弱性を解決しますか?**
  
新しい VM のビルドは Standard Security Manager のアクセス許可を修正し、VM 自体のみが VM に書き込みできるようにします。
  
**User.dir** **公開の脆弱性** **(CVE-CAN-2002-1325) :**  
**このセキュリティ問題でどのようなことが起こる可能性がありますか?**
  
これは情報漏えいの問題です。攻撃者はこの問題を悪用し、第三者のユーザー名を知る可能性があります。これ自体ではユーザーにセキュリティ上の危険はもたらされませんが、攻撃者がそのほかの攻撃のための調査を行うのに役立つ場合があります。  
この脆弱性は Web サイトまたは HTML 形式の電子メールにより悪用される可能性がありますが、電子メールによる攻撃方法は、ユーザーが実行している電子メール クライアントの種類によって阻止されます。具体的には Outlook Express 6 および Outlook 2002 (Office XP に同梱されています) は既定で Java を無効にします。[Outlook 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)がインストールされている Outlook 98 および Outlook 2000 も既定で Java を無効にします。
  
**何が原因で起こりますか?**
  
信頼されないアプレットが user.dir システム プロパティにアクセスすることを Microsoft VM が阻止しないため、この問題が起こります。
  
**システムプロパティとは何ですか?**
  
Java アプレットが実行される時、正しく実行されるように、ユーザーのシステムに関する特定の情報を知ることが必要となります。たとえば、アプレットがその処理を行うため、オペレーティング システムから手助けを必要とする場合、そのアプレットが実行されているシステムでどのバージョンの Windows がインストールされているかを正確に知る必要があります。システム プロパティはアプレットがオペレーティング システムにクエリを行い、このような情報を得る手段を提供します。  
異なるプロパティは異なるレベルの機密性を持ち、中には信頼されないアプレットに対し適切でないものもあります。仕様上、Microsoft VM はアプレットが信頼されているかどうかに基づき、特定のアプレットに利用可能なプロパティを規制する必要があります。しかし、user.dir と呼ばれる特定のシステム プロパティへのアクセスを規制しません。
  
**user.dir** **とは何ですか?** **また** **user.dir** **は何をしますか?**
  
user.dir プロパティはホストしているアプリケーションが作業中のディレクトリに関する情報を提供します。つまり、この場合、Internet Explorer です。
  
**信頼されないアプレットがユーザーの作業中のディレクトリを知ることはなぜ適切ではないのですか?**
  
主な理由は、ユーザーのアカウント名を漏らすためです。ほとんどの場合、Internet Explorer の作業中のディレクトリはユーザーのデスクトップです。これはパスの一部としてユーザー名を含みます。たとえば、ジョン (John) というユーザーのデスクトップは “c:\\documents and settings\\john\\desktop” である場合があります。ディレクトリが明らかにされることにより、VM もまたユーザー名 「ジョン (John)」 を明らかにします。
  
**この問題により、攻撃者はユーザーの身元を知ることができますか?**
  
いいえ、できません。ユーザーの身元とそのユーザー名の間には重要な区別があります。ユーザー名とは単に Windows がシステムを識別する名前です。しかし、これはユーザーの実名であるとは限りません。たとえば、ジョンというアカウントの所有者は本当にジョンという名前であるかもしれませんが、その保証はありません。ホーム ユーザーは自分の好きなユーザー名を選択することができます。企業ユーザーは実名の一部を使用したユーザー名を選択させられる場合もあります。
  
**攻撃者はどのようにしてこの脆弱性を悪用する可能性がありますか?**
  
この問題は上記に説明されている方法と同じように悪用される可能性があります。この問題を悪用する Java アプレットを作成し、そのアプレットを Web ページの一部として攻撃者の Web サイトにホストするか、または HTML 形式の電子メールを介し、直接ユーザーに送ることにより、この問題を悪用する可能性があります。
  
**新しい** **VM** **のビルドはどのようにしてこの問題を解決しますか?**
  
新しい VM のビルドは信頼されない Java アプレットが user.dir システム プロパティにアクセスすることを防ぐ制限を課します。
  
**不完全な** **Java** **オブジェクトのインスタンス作成の脆弱性** **(CVE-CAN-2002-1263) :**  
**この脆弱性でどのようなことが起こる可能性がありますか?**
  
攻撃者はこの問題を悪用し、ユーザーが攻撃者の Web サイトを閲覧した時、Internet Explorer を異常終了させる可能性があります。これ自体ではユーザーにセキュリティ上の危険はもたらされません。また、通常の操作は Internet Explorer を再起動することにより、復元されます。
  
**何が原因で起こりますか?**
  
Java アプレットが不適切に初期化された Java オブジェクトを作成することができるため、この問題が起こります。この影響として、Internet Explorer のメモリが破損し、Internet Explorer が異常終了する可能性があります。
  
**「不適切に初期化された** **Java** **オブジェクト」とはどのような意味ですか?**
  
Web ページにより Java コードが読み込まれ、実行されること (または、Java アプレットにより、追加の Java コードが読み込まれ、実行されること) を Java オブジェクトのインスタンス作成と呼びます。これが行われる時、コードが必要とするリソースを割り当てるため、いくつかの管理維持のアクティビティを発生させる必要があります。この問題はすべての適切なリソースなしで Java オブジェクトが開始される原因となる Java オブジェクトのインスタンスの作成に関連します。
  
**以前のバージョンの** **Microsoft VM** **はどのように** **Java** **オブジェクトのインスタンスを作成したのですか?**
  
仕様上許可されてはいけないメソッドを介し、Web ページが Java オブジェクトのインスタンスを作成することができます。Microsoft VM はシステムが提供する Java オブジェクトの特定の種類のインスタンスの作成をブロックしません。具体的には、いわゆる[プライベート コンストラクタ](http://msdn2.microsoft.com/ja-jp/library/kcfb85a6(vs.80).aspx) を含む Java オブジェクトです。このようなオブジェクトは VM 自体のみにより作成可能である必要があります。Web ページおよび Java アプレットにはそれらのためのリソースを割り当てる権限はありません。
  
**この問題により、攻撃者は何をする可能性がありますか?**
  
攻撃者はこの問題を悪用し、ユーザーのシステムの Internet Explorer を異常終了させる可能性があります。
  
**通常の操作を復元するためには何が必要ですか?**
  
通常の操作を再開するために必要なユーザーの操作は、Internet Explorer の再起動のみです。
  
**これはバッファオーバーランの脆弱性であると聞きましたが、本当ですか?**
  
これはバッファ オーバーランの脆弱性であり、これにより攻撃者はユーザーのシステム上での制御を取得する可能性があると示唆する推論が多くあります。しかし、この問題は実際にはバッファ オーバーランではありません。また、マイクロソフトの認識する限りでは、この問題が悪用された場合の影響は、Internet Explorer が異常終了させられる以外にはありません。
  
**新しい** **VM** **のビルドはどのようにこの問題を解決しますか?**
  
この更新プログラムは上記で説明されているインスタンスの作成のシナリオを阻止し、プライベート コンストラクタを持つ Java オブジェクトのインスタンスの作成を無効にすることにより、この問題を解決します。
  
更新プログラム  
--------------
  
<span></span>
Microsoft Java 仮想マシンは現在サポートされていません。 詳細情報は、[Microsoft Java Virtual Machine](http://support.microsoft.com/gp/lifean12) および [Microsoft Java Virtual Machine Support](http://www.microsoft.com/mscorp/java/default.mspx) (英語情報) をご覧ください。
  
#### サポート
  
-   マイクロソフト サポート技術情報 Q300845 には、この問題に関する説明が含まれ、このセキュリティ情報の公開後約 24 時間でご利用が可能になります。 サポート技術情報は [Microsoft オンライン サポート](http://support.microsoft.com/?scid=fh;en-us;kbhowto) の Web サイトで確認できます。  
-   テクニカル サポートは [Microsoft サポート オンライン](http://support.microsoft.com/directory/question.asp?sd=gn&fr=0) をご覧ください。 マイクロソフトでは、お問い合わせの内容が弊社製品の不具合が原因である場合、無償またはインシデントの未消費にてサポートをご提供いたします。
  
**その他のリソース:** [Microsoft セキュリティ TechCenter](http://technet.microsoft.com/security/default.aspx) では、製品に関するセキュリティ情報を提供しています。
  
**更新履歴** **:**
  
-   2002/12/12: このセキュリティ情報ページを公開しました。  
-   2002/12/19: この問題に対する日本語版 KB を公開しました。  
-   2009/07/03: このセキュリティ情報ページを更新し、「よく寄せられる質問」のリンク先を訂正しました。また、Microsoft Java 仮想マシンは現在マイクロソフトより利用可能ではないため、ダウンロードに関する情報を削除しました。 詳細情報は、「更新プログラム」のセクションをご覧ください。
  
本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。
  
*Built at 2014-04-18T01:50:00Z-07:00*
