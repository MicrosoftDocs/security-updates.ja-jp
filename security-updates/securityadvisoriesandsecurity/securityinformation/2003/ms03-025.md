---
TOCTitle: 'MS03-025'
Title: 'マイクロソフト セキュリティ情報 MS03-025 - 重要'
ms:assetid: 'ms03-025'
ms:contentKeyID: 61228522
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms03-025(v=Security.10)'
---


マイクロソフト セキュリティ情報 MS03-025 - 重要
===============================================

ユーティリティ マネージャによる Windows メッセージ処理の問題により、権限が昇格する (822679)
-------------------------------------------------------------------------------------------

公開日: 2003年7月10日 | 最終更新日: 2004年5月13日

[](http://www.microsoft.com/japan/security/bulletins/ms03-025e.mspx)

#### 概要 :

**このセキュリティ情報の対象となるユーザー :**  
Microsoft® Windows® 2000 を使用しているお客様

**脆弱性の影響 :**  
権限の昇格

**最大深刻度 :**  
重要

**推奨する対応策 :**  
お客様は早期に更新プログラムをインストールして下さい。

**影響を受けるソフトウェア :**  

-   Microsoft Windows 2000

**影響を受けないソフトウェア :**  

-   Microsoft Windows Me
-   Microsoft Windows NT Workstation 4.0
-   Microsoft Windows NT Server 4.0
-   Microsoft Windows NT Server 4.0, Terminal Services Edition
-   Microsoft Windows XP
-   Microsoft Windows Server 2003

### 詳細

問題
----

<span></span>
**技術的な説明 :**  
このセキュリティ情報のオリジナル版をリリースした後、マイクロソフトは Windows NT Workstation 4.0 および Windows 2000 Service Pack 2 のサポートを延長しました。セキュリティ更新プログラムは、これらのオペレーティング システムを実行しているお客様のために、現在マイクロソフトプロダクト サポート サービスから利用可能です。Windows 2000 Service Pack 2 の追加のセキュリティ更新プログラムを入手するには、[マイクロソフト製品サポートサービス](http://go.microsoft.com/fwlink/?linkid=21343&clcid=0x411) にご連絡下さい。

Microsoft Windows 2000 には[アクセシビリティ (ユーザー補助)](http://www.microsoft.com/japan/enable/) オプションのサポートがオペレーティング システムに含まれています。ユーザー補助のサポートは Windows の補助的な技術のシリーズで、これにより、障碍を持つユーザーがオペレーティング システムの機能にアクセスすることができます。ユーザー補助のサポートはオペレーティング システムに組み込まれているショートカット、またはアクセシビリティ ユーティリティ マネージャにより、有効または無効にされます。ユーティリティ マネージャはユーザーがユーザー補助プログラム (Microsoft 拡大鏡、ナレータ、オンスクリーン キーボード) の状態をチェックし、それらを起動、停止できるようにするユーザー補助ユーティリティです。

ユーティリティ マネージャが Windows メッセージを処理する方法に問題が存在します。Windows メッセージは対話的なプロセスがユーザー イベント (例 : キーボード操作、マウスの動き) に反応し、そのほかの対話的なプロセスと通信する方法を提供します。ユーザーにアクセシビリティ オプションの一覧を提供するコントロールがそれに送られた Windows メッセージを適切に検証しないため、セキュリティ上の脆弱性が起こります。対話的なデスクトップのプロセスが特定の Windows メッセージを使用して、ユーティリティ マネージャのプロセスを最初のプロセスよりも高い権限で実行するため、最初のプロセスはこれらの本来より高い権限で実行する方法を取得する可能性があります。

既定で、ユーティリティ マネージャには対話的なデスクトップで Local System 権限で実行されるコントロールが含まれています。このため、攻撃者がコンピュータに対話的にログオンすることができる場合、ユーティリティ マネージャのプロセスに不正な Windows メッセージを送るプログラムを実行し、そのプログラムに攻撃者の指定した操作を行わせる可能性があります。これにより、攻撃者はコンピュータでの完全な制御を取得する可能性があります。

攻撃はリモートからは行われません。また、攻撃が行われるには、コンピュータに対話的にログインできることが攻撃者にとっての必要条件となります。

**問題を緩和する要素 :**  

-   この脆弱性が悪用されるには、攻撃者にとって、有効なログオン資格情報を持っていることが必要条件となります。この脆弱性はリモートから悪用されることはありません。
-   適切にセキュリティで保護されているサーバーはこの脆弱性による危険にさらされることはほとんどありません。標準の最善策として、信頼される管理者にのみ、このようなコンピュータにログオンを許可することを推奨します。攻撃者にこのような特権がなければ、この脆弱性が悪用されることはありません。

**深刻度 :**  

|                  |      |
|------------------|------|
| **Windows 2000** | 重要 |

上記の[評価](http://technet.microsoft.com/security/bulletin/rating)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。


**脆弱性識別番号 :**  
[CAN-2003-0350](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0350)

**テストしたバージョン :**  
マイクロソフトは Windows Me、Windows NT Workstation 4.0、Windows NT Server 4.0、Windows NT 4.0、Terminal Server Edition、Windows 2000、Windows XP および Windows Server 2003 のテストを行い、これらの脆弱性による影響を評価しました。それ以前のバージョンに関しては[サポート](http://support.microsoft.com/lifecycle/)の対象となっていないため、これらの脆弱性による影響は不明です。

よく寄せられる質問
------------------

<span></span>
**マイクロソフトはなぜ** **Windows 2000 Service Pack 2** **用の新しいセキュリティ更新プログラムをリリースしたのですか?**  

このセキュリティ情報のオリジナル版をリリースした後、マイクロソフトは Windows NT Workstation 4.0 および Windows 2000 Service Pack 2 のサポートを延長しました。セキュリティ更新プログラムは、これらのオペレーティング システムを実行しているお客様のために、現在マイクロソフトプロダクト サポート サービスから利用可能です。これらの追加のセキュリティ更新プログラムを入手するには、[マイクロソフト製品サポートサービス](http://go.microsoft.com/fwlink/?linkid=21343&clcid=0x411) にご連絡下さい。

**どのようなことが起こる可能性がありますか?**  

これは[特権の昇格](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。攻撃者はこの脆弱性を悪用し、コンピュータで不当な特権を取得する可能性があります。この場合、攻撃者は完全な管理者特権を取得し、コンピュータ上のデータの追加、削除、変更、ユーザー アカウントの作成、削除、ローカル管理者グループへのアカウントの追加など、コンピュータで任意の操作を行うことができる可能性があります。攻撃者がコンピュータに対話的にログオンするための資格情報を持っていない限り、この脆弱性は悪用されません。最善策として、特権を持たないユーザーにビジネス クリティカルなサーバーへの対話的にログオンを許可しないことを推奨します。このガイダンスに従われている場合、このようなサーバーはこの脆弱性による危険にさらされることはありません。一方、この危険にさらされる主なコンピュータはワークステーションおよびターミナル サーバーです。

**何が原因で起こりますか?**  

特権を持たないユーザーが、ユーティリティ マネージャを特別に作成した Windows メッセージと組み合わせて使用し、対話的なデスクトップで特権を持つプロセスにコードを実行させることができるため、この脆弱性が起こります。

**ユーザー補助ユーティリティとは何ですか?**  

マイクロソフトは障碍をお持ちの方を含めすべての人々にアクセス可能で使用可能な技術を開発する責任を認識しています。このため、すべてのマイクロソフト製品は障碍をお持ちの方が製品の機能を活用できるよう支援するための機能とユーティリティとともにデザインされています。これらのユーティリティはユーザー補助ユーティリティとして知られています。Windows 2000 には製品にアクセシビリティを提供するいくつかのユーティリティおよび技術が含まれています。これらのユーティリティの一覧については次の Web サイトをご覧ください。

<http://www.microsoft.com/japan/enable/>

**マイクロソフトは製品で利用可能なユーザー補助オプションを文書化していますか?**  

マイクロソフト製品のユーザー補助オプションに関する情報は次のマイクロソフト アクセシビリティ Web サイトをご覧ください。

<http://www.microsoft.com/japan/enable/>

**ユーティリティマネージャとは何ですか?**  

ユーティリティ マネージャとは、ユーザーがユーザー補助プログラム (Microsoft 拡大鏡、ナレータ、オンスクリーン キーボード) の状態をチェックし、それらを起動、停止できるようにするユーザー補助ユーティリティです。

**「デスクトップ」とはどのような意味ですか?**  

通常、マイクロソフトで言う「デスクトップ」とは Windows セッション中、画面に見られるエクスプローラにより作成される Windows デスクトップを意味します。しかし、Windows のセキュリティ アーキテクチャでは、「デスクトップ」という用語は実際には異なる意味を持ちます。「デスクトップ」は、プロセスが承認されたアクティビティのみに適切に制限されるために、Windows のウィンドウおよび関連するオブジェクトをカプセル化するために使用されます。デスクトップではなく、まず windowstation から見ていく方が、デスクトップが何であるか、またそれがどのように機能するかを容易に説明することができるでしょう。

**Windowstation** **とは何ですか?**  

Windowstation とは、クリップボード、いくつかのグローバル情報、1 つまたは複数のデスクトップのセットを含むコンテナです。また、対話的なユーザーのログオン セッションに割り当てられた対話的な windowstation はキーボード、マウスおよびディスプレイ デバイスを含みます。対話的な windowstation はユーザーの目に見え、ユーザーからの入力を受け取ることができます。すべてのそのほかの windowstation は対話的ではありません。つまり、これらはユーザーの目に見えず、ユーザーの入力を受け取ることはできません。プロセスは 1 回につき 1 つのデスクトップのみと関連付けられます。

**対話的なデスクトップとは何ですか?**  

デスクトップとは windowstation に含まれているコンテナ オブジェクトです。windowstation には多くのデスクトップが含まれている場合があります。

デスクトップには論理的なディスプレイの表面があり、ウィンドウ、メニュー、フックが含まれています。対話的な windowstation のデスクトップのみが目に見え、ユーザーの入力を受け取ることができます。対話的な windowstation では、1 度に 1 つのデスクトップのみがアクティブです。このアクティブなデスクトップは対話的なデスクトップまたは入力デスクトップとも呼ばれ、ユーザーの目に見え、ユーザーの入力を受け取ります。

**Windows** **メッセージとは何ですか?**  

Windows で実行されているプロセスは、コンピュータおよび[メッセージ](http://msdn2.microsoft.com/en-us/library/ms644927) (英語情報) を使用するそのほかのプロセスと対話し、ユーザーがキーボードのキーを打つ、マウスを動かす、またスクロール バーなどのコントロールをクリックするごとに、Windows はメッセージを生成します。このメッセージの目的はプログラムにユーザー イベントが起きたことを伝え、そのイベントからのデータをプログラムに送ることです。同様に、プログラムは、制御している様々なウィンドウが互いに通信し、タスクを実行できるようにする方法として、メッセージを生成することができます。

**Windows 2000** **ユーティリティマネージャにより** **Windows** **メッセージが処理される方法の何が問題になっていますか?**  

問題は実際にはユーティリティ マネージャが、ユーザーに利用可能なユーザー補助機能の一覧を示す時に、メッセージを処理する方法に存在します。ユーティリティ マネージャはそれに送られる Windows メッセージを適切に検証しません。ユーティリティ マネージャがコンピュータで実行されている時、そのコンピュータで実行されている別のプロセスが対話的なデスクトップのユーティリティ マネージャに特別に作成されたメッセージを送ることができます。最初のプロセスはコールバック関数のアドレスを設定し、その結果、第 2 番目のプロセスが最初のプロセスにより指定されたコールバック関数を実行する可能性があります。

**なぜこれがセキュリティ上の脆弱性となるのですか?**  

本質的には、ユーティリティ マネージャに存在する問題により、対話的なデスクトップのプロセスがユーティリティ マネージャにその命令を実行させる方法を取得する可能性があります。第 2 番目のプロセスがより高い権限を持つ場合、これにより、最初のプロセスがその高い権限を使用する方法を取得する可能性があります。

**攻撃者はこの脆弱性を悪用して何をする可能性がありますか?**  

攻撃者はこの脆弱性を悪用し、まずユーティリティ マネージャを起動し、次にそれが実行されると、ユーティリティ マネージャにリクエストを行うプロセスを作成する可能性があります。Windows 2000 の既定の構成では、ユーティリティ マネージャはインストールされますが、実行されません。このような場合、この脆弱性が悪用されると、攻撃者はコンピュータで完全な制御を取得できる可能性があります。

**誰がこの脆弱性を悪用する可能性がありますか?**  

この脆弱性が悪用されるには、コンピュータにログオンし、ユーティリティ マネージャを起動し、攻撃者が選択したプログラム (ユーティリティ マネージャにメッセージを送り、任意のタスクを実行するコールバック関数を指定するプログラム) を読み込み、それを実行できることが攻撃者にとっての必要条件となります。

**ユーティリティマネージャのどのバージョンがこの攻撃の影響を受けますか?**  

ユーティリティ マネージャの Windows 2000 バージョンのみがこの脆弱性を含みます。Windows NT Workstation 4.0、Windows NT Server 4.0、Windows NT Server 4.0, Terminal Server Edition4.0、Windows XP および Windows Server 2003 は影響を受けません。

**主にどのコンピュータがこの脆弱性による危険にさらされますか?**  

一般的にワークステーションおよびターミナル サーバーが主に危険にさらされる可能性があります。サーバーについては、特権を持たないユーザーがサーバーにログオンし、プログラムを実行できる場合のみ、危険にさらされます。しかし、セキュリティ上の最善策として、これを許可しないことが強く推奨されています。

**この脆弱性はインターネットから悪用される可能性はありますか?**  

いいえ、ありません。攻撃の標的となる特定のコンピュータにログオンできることが攻撃者にとっての必要条件となります。リモートで対話的なデスクトップにプログラムを読み込み、それを実行することはできません。

**更新プログラムは何を修正しますか?**  

この更新プログラムは、ユーティリティ マネージャによる Windows メッセージの処理を変更し、メッセージが適切に検証され、登録されていないコールバック関数が呼び出されないようにすることにより、この脆弱性を解決します。

更新プログラム
--------------

<span></span>
この問題に対する更新プログラムは [MS04-011](http://technet.microsoft.com/security/bulletin/ms04-011) で提供されている更新プログラムに含まれています。[MS04-011](http://technet.microsoft.com/security/bulletin/ms04-011) の問題も解決することができる [MS04-011](http://technet.microsoft.com/security/bulletin/ms04-011) の更新プログラムをご利用ください。

この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。
-   Microsoft Windows 2000 Service Pack 3:  
    [http://www.microsoft.com/downloads/details.aspx?FamilyId=D415A4AC-E13A-4E8A-BE25-85E7DF686F61&displaylang=ja](http://www.microsoft.com/downloads/details.aspx?familyid=d415a4ac-e13a-4e8a-be25-85e7df686f61&displaylang=ja)![](../../images/Dn636345.mu_s(ja-JP,Security.10).gif)

![](../../images/Dn636345.mu_s(ja-JP,Security.10).gif)このマークの付いている更新プログラムは [Microsoft Update](http://update.microsoft.com/microsoftupdate/) からインストールすることもできます。

Microsoft Update の利用方法については以下のサイトを参照してください。
-   Microsoft Update 利用の手順  
    <http://www.microsoft.com/japan/athome/security/update/j_musteps.mspx>

**注 :**   Windows 2000 Service Pack 2 を実行しているお客様は、この追加のセキュリティ更新プログラムを入手するために、[マイクロソフト製品サポートサービス](http://go.microsoft.com/fwlink/?linkid=21343&clcid=0x411)にご連絡下さい。

#### 更新プログラムに関する追加情報

**対象プラットフォーム :**  
Windows 2000用の更新プログラムは Windows 2000 Service Pack 3 を実行しているコンピュータにインストールすることができます。さらに、この問題に対する修正は [Service Pack 4](http://www.microsoft.com/windows2000/downloads/servicepacks/sp4/) に含まれています。

**注 :**   Windows 2000 Service Pack 2 を実行しているお客様は、この追加のセキュリティ更新プログラムを入手するために、[マイクロソフト製品サポートサービス](http://go.microsoft.com/fwlink/?linkid=21343&clcid=0x411)にご連絡下さい。

**この修正を含む予定のサービスパック :**  
この問題に対する修正は Windows 2000 [Service Pack 4](http://www.microsoft.com/downloads/details.aspx?familyid=dc27b8c6-2a5a-4399-ad3d-4a97a25f41d9&displaylang=ja) に含まれています。

**再起動の必要性 :**  
あり

**更新プログラムのアンインストール :**  
可

**更新プログラムに含まれる過去の修正 :**  
なし

**更新プログラムが正しくインストールされたかどうか確認する方法 :**  

-   Windows 2000:
    この更新プログラムがコンピュータにインストールされたことを確認するためには、コンピュータに次のレジストリ キーが作成されたことを確認して下さい。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP4\\KB822679
    各ファイルを確認するためには、次のレジストリ キーで、日付、時間そしてバージョン情報を参照して下さい。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP4\\KB822679\\Filelist

**注 :**   Windows 2000 Service Pack 2 を実行しているお客様は、これらの追加のセキュリティ更新プログラムを入手するために、[マイクロソフト製品サポートサービス](http://go.microsoft.com/fwlink/?linkid=21343&clcid=0x411)にご連絡下さい。

**警告 :**  
なし

**他のセキュリティ更新プログラムの入手先 :**  

**他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。 :**  

-   セキュリティ更新プログラムは[マイクロソフト ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード探索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/) Web サイトからダウンロードできます。
-   本セキュリティ情報及び公開された更新プログラムは、[TechNet CD サブスクリプション](http://www.microsoft.com/japan/technet/subscriptions/)でも入手可能です。

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。  
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

### その他の情報

**詳細情報 :**  

-   US マイクロソフトセキュリティ情報（MS03-025）  
    [http://www.microsoft.com/technet/security/bulletin/ms03-025.mspx](http://technet.microsoft.com/security/bulletin/ms03-025)
-   サポート技術情報 （KB） 文書番号 ： 822679  
    [\[MS03-025\] ユーティリティ マネージャによる Windows メッセージ処理の問題により、権限が昇格する](http://support.microsoft.com/kb/822679)

**謝辞 :**  
この問題を連絡し、顧客の保護に協力して下さった [Next Generation Security Software Ltd](http://www.nextgenss.com/) の Chris Paget 氏に対し、マイクロソフトは深い[謝意](http://technet.microsoft.com/security/bulletin/policy)を表します。

**更新履歴 :**  

-   2003/7/10 : このセキュリティ情報ページを公開しました。
-   2003/7/10: この問題に対するマイクロソフト サポート技術情報 822679 日本語版を公開しました。
-   2003/7/11: レジストリ キーの情報を修正しました。
-   2004/05/13: このセキュリティ情報ページを更新し、お客様に Windows 2000 Service Pack 2 用のセキュリティ更新プログラムが利用可能になったことをお知らせしました。また、この情報を「よく寄せられる質問」に追加しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
