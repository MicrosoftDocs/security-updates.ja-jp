---
TOCTitle: 'MS04-037'
Title: 'マイクロソフト セキュリティ情報 MS04-037 - 緊急'
ms:assetid: 'ms04-037'
ms:contentKeyID: 61228685
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms04-037(v=Security.10)'
---



マイクロソフト セキュリティ情報 MS04-037 - 緊急
===============================================

Windows シェルの脆弱性により、リモートでコードが実行される (841356)
-------------------------------------------------------------------

公開日: 2004年10月13日 | 最終更新日: 2005年2月16日

[](http://www.microsoft.com/japan/security/bulletins/ms04-037e.mspx)

#### 概要 :

**このセキュリティ情報の対象となるユーザー** : Microsoft Windows をご使用のお客様

**脆弱性の影響** : リモートでコードが実行される

**最大深刻度** : 緊急

**推奨する対応策** : お客様はこの更新プログラムを直ちにインストールして下さい。

**含まれる過去の更新プログラム** : このセキュリティ情報で提供される更新プログラムは、以前提供されたいくつかの更新プログラムに置き換わるものです。 置き換わる更新プログラムの一覧については、このセキュリティ情報の「よく寄せられる質問」をご覧下さい。

**警告 :**[マイクロソフト サポート技術情報 841356](http://support.microsoft.com/kb/841356) では、このセキュリティ更新プログラムをインストールする際に起こる可能性のある既知の問題に関して説明されています。 また、このサポート技術情報にはこれらの問題に対する推奨される解決策に関する説明も記載されています。 詳細情報は、サポート技術情報 [841356](http://support.microsoft.com/kb/841356) をご覧ください。

**テストしたソフトウェアおよびセキュリティ更新プログラムのダウンロード先** :

**影響を受けるソフトウェア** :

|                                                                                                                                                                                                                                  | PC/AT                                                                                                                                                                                             | PC-9800                                                                                                                                                                                               |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Microsoft Windows NT Server 4.0 Service Pack 6a![](../../images/Dn609962.mu_s(ja-JP,Security.10).gif)                                                                                                     | [![](../../images/Dn609962.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=f8046e83-e151-4aaf-80cb-ad4f31c02eac&displaylang=ja) | [![](../../images/Dn609962.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=f8046e83-e151-4aaf-80cb-ad4f31c02eac&displaylang=ja-nec) |
| Microsoft Windows NT Server 4.0, Terminal Server Edition Service Pack 6                                                                                                                                                          | [![](../../images/Dn609962.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=2dcc6c99-509d-41a5-a3c7-cac017d633e1&displaylang=ja) | -                                                                                                                                                                                                     |
| Microsoft Windows 2000 Service Pack 3 および Microsoft Windows 2000 Service Pack 4![](../../images/Dn609962.mu_s(ja-JP,Security.10).gif)                                                                  | [![](../../images/Dn609962.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=846e7479-133b-45d7-aa69-d9257f1be178&displaylang=ja) | [![](../../images/Dn609962.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=846e7479-133b-45d7-aa69-d9257f1be178&displaylang=ja-nec) |
| Microsoft Windows XP および Microsoft Windows XP Service Pack 1![](../../images/Dn609962.mu_s(ja-JP,Security.10).gif)                                                                                     | [![](../../images/Dn609962.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=fb93cb07-3a7e-444c-b083-324fc9049b94&displaylang=ja) | -                                                                                                                                                                                                     |
| Microsoft Windows XP 64-Bit Edition Service Pack 1![](../../images/Dn609962.mu_s(ja-JP,Security.10).gif)                                                                                                  | [![](../../images/Dn609962.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=ff84bcbe-d1e5-4402-8ce4-f8d9966c79d0&displaylang=ja) | -                                                                                                                                                                                                     |
| Microsoft Windows XP 64-Bit Edition Version 2003![](../../images/Dn609962.mu_s(ja-JP,Security.10).gif)                                                                                                    | [![](../../images/Dn609962.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=ab91c7ff-2547-455e-9a6d-82b09373495f&displaylang=ja) | -                                                                                                                                                                                                     |
| Microsoft Windows Server 2003![](../../images/Dn609962.mu_s(ja-JP,Security.10).gif)                                                                                                                       | [![](../../images/Dn609962.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=5c60ca12-0045-42b7-9f2a-6d433dedc105&displaylang=ja) | -                                                                                                                                                                                                     |
| Microsoft Windows Server 2003 64-Bit Edition![](../../images/Dn609962.mu_s(ja-JP,Security.10).gif)                                                                                                        | [![](../../images/Dn609962.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=ab91c7ff-2547-455e-9a6d-82b09373495f&displaylang=ja) | -                                                                                                                                                                                                     |
| Microsoft Windows 98、Microsoft Windows 98 Second Edition (SE)、および Microsoft Windows Millennium Edition (ME) - これらのオペレーティング システムに関する詳細は、このセキュリティ情報の「よく寄せられる質問」をご覧ください。 | -                                                                                                                                                                                                 | -                                                                                                                                                                                                     |

**影響を受けないソフトウェア** :

-   Microsoft Windows XP Service Pack 2

![](../../images/Dn609962.dl_arrow(ja-JP,Security.10).jpg)このマークをクリックして、PC/AT 互換機用または NEC PC-9800 シリーズ用の更新プログラムをダウンロードしてください。
更新プログラムをダウンロードおよびインストールする方法は、[更新プログラムのダウンロード方法](http://www.microsoft.com/japan/security/bulletins/dcsteps_vista.mspx)および[更新プログラムのインストール方法](http://www.microsoft.com/japan/security/bulletins/instsecupdate_vista.mspx)をご覧ください。

![](../../images/Dn609962.mu_s(ja-JP,Security.10).gif)このマークの付いている更新プログラムは [Microsoft Update](http://update.microsoft.com/microsoftupdate/) からインストールすることもできます。
Microsoft Update の利用方法については以下のサイトを参照してください。

-   Microsoft Update 利用の手順
    
    <http://www.microsoft.com/japan/athome/security/update/j_musteps.mspx>

上記のソフトウェアのテストを行い、この脆弱性による影響を評価しました。それ以前のバージョンに関してはサポートの対象となっていないため、この脆弱性による影響は不明です。

ご使用中の製品およびバージョンのサポートライフ サイクルを確認するためには、[マイクロソフト サポート ライフサイクル](http://support.microsoft.com/lifecycle/)の Web サイトをご覧下さい。

### 詳細

要点
----


この更新プログラムは新たに確認され、一般に公開されているいくつかの脆弱性を解決します。各脆弱性はこのセキュリティ情報の「脆弱性の詳細」欄に説明されています。

ユーザーが管理者特権でログオンした場合、攻撃者がこれらの脆弱性のうち、最も深刻なものを悪用し、プログラムのインストール、データの表示、変更、削除、または完全な特権を持つ新規のアカウントの作成など、影響を受けるコンピュータの完全制御を取得する可能性があります。コンピュータ上でほとんど特権を持たないよう構成されているアカウントを持つユーザーは、管理者特権で実行しているユーザーよりも危険にさらされる可能性は低くなります。 攻撃者がこの脆弱性を悪用するには、ユーザーが操作することが必要条件となります。

マイクロソフトは、お客様にこの更新プログラムを直ちに適用することを推奨します。

**深刻度および脆弱性識別番号** :

| 脆弱性識別番号                                                                                                      | 脆弱性の影響                 | Windows 98, 98 SE, ME | Windows NT 4.0 | Windows 2000 | Windows XP および Windows XP Service Pack 1 | Windows Server 2003 |
|---------------------------------------------------------------------------------------------------------------------|------------------------------|-----------------------|----------------|--------------|---------------------------------------------|---------------------|
| シェルの脆弱性 - [CAN-2004-0214](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0214)                   | リモートでコードが実行される | 緊急でない            | 緊急           | 緊急         | 緊急                                        | なし                |
| Program Group Converter の脆弱性 - [CAN-2004-0572](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0572) | リモートでコードが実行される | 緊急でない            | 重要           | 重要         | 重要                                        | 重要                |
| **すべての脆弱性の総合的な深刻度**                                                                                  | **-**                        | **緊急でない**        | **緊急**       | **緊急**     | **緊急**                                    | **重要**            |

この[評価](http://technet.microsoft.com/security/bulletin/rating)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形態およびこの脆弱性がシステムに及ぼす影響に基づいています。

このセキュリティ更新プログラムに関するよく寄せられる質問
--------------------------------------------------------


**なぜこの更新プログラムはいくつかの報告されたセキュリティ上の脆弱性を解決するのですか?**

この更新プログラムは、これらの問題を解決するために必要となる変更が関連ファイルに配置されているため、いくつかの脆弱性のサポートを含みます。いくつかの更新プログラムをほとんど同時にインストールする必要はなく、お客様はこの更新プログラムのみをインストールすることができます。

**この更新プログラムにより何が置き換えられますか?**

これは、以前にリリースされた更新プログラムに置き換わる更新プログラムです。 影響を受けるセキュリティ情報の ID 番号およびオペレーティング システムのバージョンを次の表に記載します。

| セキュリティ情報番号                                                    | Windows NT 4.0 | Windows 2000 | Windows XP | Windows Server 2003 |
|-------------------------------------------------------------------------|----------------|--------------|------------|---------------------|
| [**MS02-014**](http://technet.microsoft.com/security/bulletin/ms02-014) | 置き換わる     | 置き換わる   | 対象外     | 対象外              |
| [**MS03-027**](http://technet.microsoft.com/security/bulletin/ms03-027) | 対象外         | 対象外       | 置き換わる | 対象外              |

**この更新プログラムはそのほかのセキュリティ上の変更を含みますか?**

はい。 この更新プログラムにより、このセキュリティ情報の「脆弱性の詳細」の欄に記載されている変更の他、以下の機能の変更が起こります。

-   Windows XP および Windows Server 2003 は、多層防御によりシェルの機能が制限されます。この機能変更により、"shell" プロトコルが使用できなくなるため、ある特定の種類の不正なリクエストが処理される際に、既知のファイル名の拡張子マッピングを使用するアプリケーションが自動的に開始されなくなります。この変更は、Windows XP Service Pack 2 の既定の設定と一致しています。
-   Windows XP および Windows Server 2003 には、多層防御に基づいた変更によりシェルが “shell:” プロトコルを使用してファイルを参照しなくなります。 このプロトコルは、システム オブジェクトおよびフォルダは参照できますが、ファイルを参照しないように設計が変更されました。 この変更は、Windows XP Service Pack 2 の既定の設定と一致しています。

**Windows XP** **を使用していますが、2004** **年** **9** **月** **30** **日に延長サポートが終了しました。しかし、このセキュリティ情報には、Windows XP** **の更新プログラムが含まれます。これはなぜですか?**

Windows XP 初期出荷版 （一般的に Windows XP Gold または Windows XP Release to Manufacturing (RTM) バージョンと呼ばれています） は、2004 年 9 月 30 日に、延長セキュリティ更新プログラムのサポートが終了しました。しかし、延長サポート期間の終了はごく最近のものです。 今回のケースでは、この脆弱性を解決するために必要なステップのほとんどが、 2004 年 9 月 30 日以前に完了しました。 このため、マイクロソフトは、このセキュリティ情報の一部としてこれらのオペレーティングシステム用のセキュリティ更新プログラムのリリースを決定しました。 マイクロソフトは、今後これらのオペレーティング システムに影響を及ぼす脆弱性に対し、このような対応を予定していませんが、必要であると判断した場合、更新プログラムの開発および利用可能とする権利を保留としています。 今後の脆弱性の影響を受ける可能性を防ぐため、これらのオペレーティングシステムを使用しているお客様は、サポート対象となっているバージョンに移行することを強く推奨します。

Windows Service Pack のサポート ライフサイクルに関する詳細情報は、[マイクロソフト サポート ライフサイクル](http://support.microsoft.com/gp/lifesupsps)をご覧下さい。 Windows 製品のサポート ライフサイクルに関する詳細情報は、[マイクロソフト サポート ライフサイクル](http://support.microsoft.com/gp/lifecycle)をご覧下さい。

詳細情報は、[Windows オペレーティング システム FAQ](http://support.microsoft.com/gp/lifewinfaq) をご覧下さい。

**Microsoft Windows NT 4.0 Workstation Service Pack 6a** **または** **Windows 2000 Service Pack 2** **を現在でも使用していますが、延長されたセキュリティ更新プログラムのサポートは** **2004** **年** **6** **月** **30** **日に終了しました。どうしたらよいですか?**

Windows NT 4.0 Workstation Service Pack 6a および Windows 2000 Service Pack 2 は以前よりご説明しておりますとおり、マイクロソフトはこのサポートを 2004 年 6 月 30 日まで延長しましたがライフサイクルは終了しました。

今後の脆弱性の影響を受ける可能性を防ぐため、これらのオペレーティングシステムを使用しているお客様は、サポート対象となっているバージョンに移行することが第一です。Windows 製品ライフサイクルに関する詳細情報は、[マイクロソフト サポート ライフサイクル](http://support.microsoft.com/gp/lifecycle)をご覧下さい。これらのオペレーティングシステムのバージョンについて、延長されたセキュリティ更新プログラムのサポート期間に関する詳細情報は、[Microsoft Product Support Services Web サイト](http://support.microsoft.com/gp/lifeanoct2003) をご覧下さい。

Windows NT Workstation 4.0 SP6a の追加サポート （カスタムサポート） が必要なお客様は、担当営業、または マイクロソフト アカウント チームの担当者、担当テクニカル アカウント マネージャ (TAM)、またはカスタム サポート オプションのマイクロソフト パートナー担当者までご連絡ください。プレミア契約をお持ちでないお客様は、マイクロソフトサポート契約センター （営業時間 9:30-12:00 13:00-19:00 土日祝祭日を除く TEL:0120-17-0196 FAX:03-5388-8253） までお問い合わせください。

詳細情報は、[Windows オペレーティング システム FAQ](http://support.microsoft.com/gp/lifewinfaq) をご覧下さい。

**Windows 98、Windows 98 Second Edition** **および** **Windows Millennium Edition** **のサポートの延長により、これらのオペレーティングシステム用のセキュリティ更新プログラムのリリースにどのような影響がありますか?**

マイクロソフトは、これらのオペレーティングシステム上で、深刻度が「緊急」のセキュリティ問題がある場合にのみ、セキュリティ更新プログラムをリリースする予定です。このサポート期間中は、「緊急」以外のセキュリティ問題のための更新プログラムは提供されません。これらのオペレーティングシステムについてのサポートライフサイクルのより詳細な情報は、次の [Web サイト](http://support.microsoft.com/gp/lifean1)をご覧下さい。

深刻度評価システムに関する詳細情報は、次の[Web サイト](http://technet.microsoft.com/security/bulletin/rating)をご覧下さい。

**Windows 98、Windows 98 Second Edition** **または** **Windows Millennium Edition** **はこの累積的な更新プログラムで解決される脆弱性による深刻な影響を受けますか?**

いいえ。これらの脆弱性の Windows 98、Windows 98 Second Edition または Windows Millennium Edition の深刻度はいずれも「緊急」ではありません。深刻度評価システムに関する詳細情報は、次の [Web サイト](http://technet.microsoft.com/security/bulletin/rating)をご覧下さい。

**Microsoft Baseline Security Analyzer (MBSA)** **を使用して、この更新プログラムが必要であるかどうかを確認することはできますか?**

はい。MBSA により、この更新プログラムが必要かどうかを確認することができます。MBSA に関する詳細は、[Microsoft Baseline Security Analyzer](http://technet.microsoft.com/ja-jp/security/cc184924.aspx) の Web サイトをご覧下さい。

注 : 2004 年 7 月 14 日をもって、以前のバージョンの SMS 2.0 Software Update Services Feature Pack、 SMS 2003 Software Update Scanning Tools、MBSA 1.1.1 および、それ以前のバージョンによって使用される Mssecure.xml ファイルの更新を終了するしたため、2004 年 7 月 15 日以降、新たなセキュリティ情報のデータでが更新されていません。そのため、2004 年 7 月 15 日以降、MBSA 1.1.1 またはそれ以前のバージョンのデータで行われるスキャンは、不完全となる場合がございます。 MBSA 1.2 でより正確なセキュリティ更新プログラムの検出が行われ、サポートされる製品もより多いため、すべてのユーザーは、MBSA 1.2 にアップグレードをすることを推奨いたします。MBSA 1.2 は、MBSA Web サイト からダウンロードすることができます。MBSA のサポートに関する詳細は、[Microsoft Baseline Security Analyzer (MBSA) Version 1.2 Q&A](http://technet.microsoft.com/ja-jp/security/cc184924.aspx) をご覧ください。

**Systems Management Server (SMS)** **を使用して、この更新プログラムが必要であるかどうかを確認することはできますか?**

はい。SMS は、このセキュリティ更新プログラムを検出し、展開する支援をします。SMS に関する情報は、SMS に関する情報は [SMS の Web サイト](http://www.microsoft.com/japan/smserver/default.mspx)をご覧下さい。 SMS により、このセキュリティ情報の「セキュリティ更新プログラムに関する情報」の欄に説明された影響を受けるファイルを検索することができます。 このセキュリティ情報に記載されているバージョンより前の影響を受けるファイルのすべてのバージョンを更新してください。SMS に関する情報は、SMS に関する情報は [SMS の Web サイト](http://www.microsoft.com/japan/smserver/default.mspx)をご覧下さい。

脆弱性の詳細
------------


#### シェルの脆弱性 - CAN-2004-0214:

Windows シェルがアプリケーションを起動する方法に、リモートで コードが実行される脆弱性が存在します。 ユーザーが悪質な Web サイトを訪問した場合、攻撃者により、この脆弱性が悪用される可能性があります。ユーザーが管理者権限でログオンした場合、攻撃者がこの脆弱性を悪用し、影響を受けるコンピュータの完全な制御を取得する可能性があります。 しかし、攻撃者がこの脆弱性を悪用するには、ユーザーが操作することが必要条件となります。

#### 「シェルの脆弱性」の問題を緩和する要素 - CAN-2004-0214:

-   Web ベースの攻撃シナリオでは、この脆弱性が悪用される Web ページが含まれる Web サイトをホストすることが攻撃者にとっての必要条件となります。攻撃者は、悪質な Web サイトにユーザーを強制的に訪問させることはできません。攻撃者のサイトへのリンクをユーザーにクリックさせるなどの方法により、ユーザーをそのような Web サイトに誘導することが攻撃者にとっての必要条件となります。 ユーザーがそのような操作を行った場合にのみ、攻撃が実行される可能性があります。
-   攻撃者はこの脆弱性を悪用し、ユーザーと同じ特権を取得する可能性があります。コンピュータ上でほとんど特権を持たないよう構成されているアカウントを持つユーザーは、管理者特権で実行しているユーザーよりも危険にさらされる可能性は低くなります。
-   既定で、Outlook Express 6、Outlook 2002、および Outlook 2003 は、HTML 形式の電子メールを制限付きサイト ゾーンで開きます。 また、Outlook 98 および Outlook 2000 は、[Outlook 電子メール セキュリティ更新プログラム](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx) がインストールされている場合、HTML 形式の電子メール メッセージが制限付きサイト ゾーンで開かれます。また、Outlook Express 5.5 Service Pack 2 は、[MS04-018](http://technet.microsoft.com/security/bulletin/ms04-018)がインストールされている場合、HTML 形式の電子メール メッセージが制限付きサイト ゾーンで開かれます。制限付きサイト ゾーンはこの脆弱性を悪用する攻撃を受ける可能性を低減する手助けとなります。

    次のすべての条件があてはまる場合、HTML 形式の電子メールによる攻撃の危険は著しく低減されます。

    -   マイクロソフト セキュリティ情報 [MS03-040](http://technet.microsoft.com/security/bulletin/ms03-040) またはそれ以降の Internet Explorer 用の累積的なセキュリティ更新プログラムに含まれる更新プログラムを適用している
    -   Microsoft Internet Explorer 6 以降 を使用している
    -   Microsoft Outlook 電子メール セキュリティ更新プログラムを使用、Microsoft Outlook Express 6 またはそれ以降、Microsoft Outlook 2000 Service Pack 2 またはそれ以降を既定の構成で使用している

#### 「シェルの脆弱性」の回避策 - CAN-2004-0214:

マイクロソフトは次の回避策のテストを行ないました。これらの回避策は根本的な脆弱性を修正しませんが、既知の攻撃の方法を阻止する手助けとなります。回避策は機能の低下の原因となる場合もあります。その場合、下記に記します。

-   **Outlook 2000 SP1** **またはそれ以前のバージョンを使用し、HTML** **形式の電子メールによる攻撃からコンピュータを保護している場合、**[**Outlook** **電子メールセキュリティ更新プログラム**](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)**をインストール**

    既定で、Outlook Express 6、Outlook 2002、および Outlook 2003 は、HTML 形式の電子メールを制限付きサイト ゾーンで開きます。 また、Outlook 98 および Outlook 2000 は、[Outlook 電子メール セキュリティ更新プログラム](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx) がインストールされている場合、HTML 形式の電子メール メッセージが制限付きサイト ゾーンで開かれます。また、Outlook Express 5.5 Service Pack 2 は、[MS04-018](http://technet.microsoft.com/security/bulletin/ms04-018)がインストールされている場合、HTML 形式の電子メール メッセージが制限付きサイト ゾーンで開かれます。制限付きサイト ゾーンはこの脆弱性を悪用する攻撃を受ける可能性を低減する手助けとなります。

    これらの製品のいずれかを使用しているお客様は、ユーザーが電子メール メッセージの悪質なリンクをクリックしない限り、この脆弱性の悪用を試みる電子メールによる攻撃の危険性が低減されます。

-   **Outlook 2002** **またはそれ以降、Outlook Express 6 Service Pack 1** **またはそれ以降を使用している場合、電子メールメッセージをテキスト形式で読み取り、HTML** **形式の電子メールによる攻撃に対する保護の手助けとする**

    Office XP Service Pack 1 またはそれ以降を適用している Microsoft Outlook 2002 ユーザー、および Internet Explorer 6 Service Pack 1 を適用している Outlook Express 6 ユーザーは、デジタル署名されていないすべての電子メール メッセージまたは暗号化されていない電子メール メッセージをテキスト形式のみで表示する機能を有効にすることができます。

    デジタル署名されている電子メール メッセージおよび暗号化されている電子メール メッセージは、設定による影響は受けず、その元の形式で読み取ることができる場合があります。Outlook 2002 のこの設定を有効にする方法に関する情報は、サポート技術情報 [307594](http://support.microsoft.com/kb/307594) で説明されています。

    Outlook Express 6 のこの設定に関する情報は、サポート 技術情報 [291387](http://support.microsoft.com/kb/291387) で説明されています。

    **回避策の影響** : テキスト形式で表示される電子メールは、写真、特別なフォント、アニメーションまたはそのほかのリッチコンテンツを含むことはできません。さらに、次の処理を実行します。

    -   変更はプレビュー ウィンドウおよび開いているメッセージに適用されます。
    -   写真はメッセージ コンテンツの紛失を避けるため、添付ファイルとなります。
    -   メッセージはストア内で依然としてリッチテキスト形式、または HTML 形式であるため、オブジェクト モデル (カスタムコード ソリューション) は予期されない動作をする場合があります。

#### 「シェルの脆弱性」のよく寄せられる質問 - CAN-2004-0214:

**どのようなことが起こる可能性がありますか?**

これはリモートでコードが実行される脆弱性です。ユーザーが管理者特権でログオンした場合、攻撃者がこの脆弱性を悪用し、プログラムのインストール、データの表示、変更、削除、または完全な特権を持つ新規のアカウントの作成など、影響を受けるコンピュータの完全制御を取得する可能性があります。 しかし、攻撃者がこの脆弱性を悪用するには、ユーザーが操作することが必要条件となります。コンピュータ上でほとんど特権を持たないよう構成されているアカウントを持つユーザーは、管理者特権で実行しているユーザーよりも危険にさらされる可能性は低くなります。

**何が原因で起こりますか?**

POSIX サブシステムに未チェックのバッファが含まれるため、この脆弱性が起こります。

**Windows** **シェルとは何ですか?**

Microsoft Windows のユーザー インターフェイス (UI) により、ユーザーは、アプリケーションを実行し、オペレーティング システムを管理するために必要な様々なオブジェクトにアクセスすることができます。 これらのオブジェクトのうちで、最も多く、よく知られているのは、コンピュータのディスク ドライブのフォルダとファイルがあります。 また、リモート プリンタにファイルを送信したり、ゴミ箱にアクセスするなどのタスクを行うことができる多くの仮想オブジェクトがあります。 シェルにより、これらのオブジェクトが階層的な名前空間に整理され、ユーザーおよびアプリケーションが、オブジェクトにアクセスし、管理するにあたり、一貫した効果的な方法が使用できるようになります。 詳細は、次の [User Interface （英語情報）](http://msdn2.microsoft.com/en-us/library/aa286531.aspx)をご覧下さい。

**この脆弱性により、攻撃者は何を行う可能性がありますか?**

攻撃者はこの脆弱性を悪用し、ユーザーと同じ特権を取得する可能性があります。コンピュータ上でほとんど特権を持たないよう構成されているアカウントを持つユーザーは、管理者特権で実行しているユーザーよりも危険にさらされる可能性は低くなります。

**どのように攻撃者はこの脆弱性を悪用する可能性がありますか?**

攻撃者がこの脆弱性を悪用するには、悪質な Web サイトをホストし、ユーザーがそのような Web サイトを表示するように誘導することが必要条件となります。 また、攻撃者は、綿密な細工をしたリンクを含んだ電子メール メッセージを作成し、ユーザーがそのような電子メール メッセージを表示し、悪質なリンクをクリックさせるように誘導する可能性があります。

**主にどのようなコンピュータがこの脆弱性による危険にさらされますか?**

ワークステーションおよびターミナル サーバーが、主にこの脆弱性による危険にさらされます。ユーザーがログオンし、プログラムを実行する権限を与えられている場合にのみ、サーバーがこの脆弱性による危険にさらされます。しかし、セキュリティ上の最善策により、これらの権限を無効にすることが強く推奨されます。

**Windows 98、Windows 98 Second Edition** **または** **Windows Millennium Edition** **はこの脆弱性による深刻な影響を受けますか?**

いいえ。 Windows Millennium Edition には、影響を受けるコンポーネントが含まれていますが、その脆弱性の深刻度は、「緊急」ではありません。深刻度評価システムに関する詳細情報は、次の [Web サイト](http://technet.microsoft.com/security/bulletin/rating)をご覧下さい。

**この脆弱性がインターネットで悪用される可能性はありますか?**

はい。攻撃者はこの脆弱性をインターネット上で悪用する可能性があります。

**更新プログラムは何を変更しますか?**

この更新プログラムは、Windows シェルが割り当てられたバッファにメッセージを渡す前に、メッセージの長さを検証する方法を変更することにより、この脆弱性を排除します。

**このセキュリティ情報のリリース時に、この脆弱性は一般に公開されていたのですか?**

はい。この脆弱性は一般に公開されていました。 これは Common Vulnerability and Exposure の CAN-2004-0214 にアサインされています。

**このセキュリティ情報のリリース時に、マイクロソフトはこの脆弱性が悪用されたという報告を受けていましたか?**

いいえ。マイクロソフトは、このセキュリティ情報が最初にリリースされた時に、公開された検証用コード例の存在を確認していましたが、この脆弱性が悪用され、お客様が攻撃されたということを示す情報は受けていませんでした。

#### Program Group Converter の脆弱性 - CAN-2004-0572:

Program Group Converter が綿密に細工をしたリクエストを処理する方法に、リモートでコードが実行される脆弱性が存在します。 攻撃者はユーザーが、添付ファイルを開いたり、HTML のリンクをクリックするなどの操作をした場合、リモートでコードが実行される悪質なリクエストを作成し、この脆弱性を悪用する可能性があります。ユーザーが管理者権限でログオンした場合、攻撃者がこの脆弱性を悪用し、影響を受けるコンピュータの完全な制御を取得する可能性があります。 しかし、攻撃者がこの脆弱性を悪用するには、ユーザーが操作することが必要条件となります。

#### 「Program Group Converter の脆弱性」の問題を緩和する要素 - CAN-2004-0572:

-   Web ベースの攻撃シナリオでは、この脆弱性が悪用される Web ページが含まれる Web サイトをホストすることが攻撃者にとっての必要条件となります。攻撃者は、悪質な Web サイトにユーザーを強制的に訪問させることはできません。攻撃者のサイトへのリンクをユーザーにクリックさせるなどの方法により、ユーザーをそのような Web サイトに誘導することが攻撃者にとっての必要条件となります。ユーザーがそのような操作を行った場合にのみ、攻撃が実行される可能性があります。
-   攻撃者はこの脆弱性を悪用し、ユーザーと同じ特権を取得する可能性があります。コンピュータ上でほとんど特権を持たないよう構成されているアカウントを持つユーザーは、管理者特権で実行しているユーザーよりも危険にさらされる可能性は低くなります。
-   既定で、Outlook Express 6、Outlook 2002、および Outlook 2003 は、HTML 形式の電子メールを制限付きサイト ゾーンで開きます。 また、Outlook 98 および Outlook 2000 は、[Outlook 電子メール セキュリティ更新プログラム](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx) がインストールされている場合、HTML 形式の電子メール メッセージが制限付きサイト ゾーンで開かれます。また、Outlook Express 5.5 Service Pack 2 は、[MS04-018](http://technet.microsoft.com/security/bulletin/ms04-018)がインストールされている場合、HTML 形式の電子メール メッセージが制限付きサイト ゾーンで開かれます。制限付きサイト ゾーンはこの脆弱性を悪用する攻撃を受ける可能性を低減する手助けとなります。

    次のすべての条件があてはまる場合、HTML 形式の電子メールによる攻撃の危険は著しく低減されます。

    -   マイクロソフト セキュリティ情報 [MS03-040](http://technet.microsoft.com/security/bulletin/ms03-040) またはそれ以降の Internet Explorer 用の累積的なセキュリティ更新プログラムに含まれる更新プログラムを適用している
    -   Microsoft Internet Explorer 6 以降 を使用している
    -   Microsoft Outlook 電子メール セキュリティ更新プログラムを使用、Microsoft Outlook Express 6 またはそれ以降、Microsoft Outlook 2000 Service Pack 2 またはそれ以降を既定の構成で使用している

#### 「Program Group Converter の脆弱性」の回避策 - CAN-2004-0572:

マイクロソフトは次の回避策のテストを行ないました。これらの回避策は根本的な脆弱性を修正しませんが、既知の攻撃の方法を阻止する手助けとなります。回避策は機能の低下の原因となる場合もあります。その場合、下記に記します。

-   **Outlook 2000 SP1** **またはそれ以前のバージョンを使用し、HTML** **形式の電子メールによる攻撃からコンピュータを保護している場合、**[**Outlook** **電子メールセキュリティ更新プログラム**](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)**をインストール**

    既定で、Outlook Express 6、Outlook 2002、および Outlook 2003 は、HTML 形式の電子メールを制限付きサイト ゾーンで開きます。 また、Outlook 98 および Outlook 2000 は、[Outlook 電子メール セキュリティ更新プログラム](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx) がインストールされている場合、HTML 形式の電子メール メッセージが制限付きサイト ゾーンで開かれます。また、Outlook Express 5.5 Service Pack 2 は、[MS04-018](http://technet.microsoft.com/security/bulletin/ms04-018)がインストールされている場合、HTML 形式の電子メール メッセージが制限付きサイト ゾーンで開かれます。制限付きサイト ゾーンはこの脆弱性を悪用する攻撃を受ける可能性を低減する手助けとなります。

    これらの製品のいずれかを使用しているお客様は、ユーザーが電子メール メッセージの悪質なリンクをクリックしない限り、この脆弱性の悪用を試みる電子メールによる攻撃の危険性が低減されます。

-   **Outlook 2002** **またはそれ以降、Outlook Express 6 Service Pack 1** **またはそれ以降を使用している場合、電子メールメッセージをテキスト形式で読み取り、HTML** **形式の電子メールによる攻撃に対する保護の手助けとする**

    Office XP Service Pack 1 またはそれ以降を適用している Microsoft Outlook 2002 ユーザー、および Internet Explorer 6 Service Pack 1 を適用している Outlook Express 6 ユーザーは、デジタル署名されていないすべての電子メール メッセージまたは暗号化されていない電子メール メッセージをテキスト形式のみで表示する機能を有効にすることができます。

    デジタル署名されている電子メール メッセージおよび暗号化されている電子メール メッセージは、設定による影響は受けず、その元の形式で読み取ることができる場合があります。Outlook 2002 のこの設定を有効にする方法に関する情報は、サポート技術情報 [307594](http://support.microsoft.com/kb/307594) で説明されています。

    Outlook Express 6 のこの設定に関する情報は、サポート 技術情報 [291387](http://support.microsoft.com/kb/291387) で説明されています。

    **回避策の影響** : テキスト形式で表示される電子メールは、写真、特別なフォント、アニメーションまたはそのほかのリッチコンテンツを含むことはできません。さらに、次の処理を実行します。

    -   変更はプレビュー ウィンドウおよび開いているメッセージに適用されます。
    -   写真はメッセージ コンテンツの紛失を避けるため、添付ファイルとなります。
    -   メッセージはストア内で依然としてリッチテキスト形式、または HTML 形式であるため、オブジェクト モデル (カスタムコード ソリューション) は予期されない動作をする場合があります。

-   **信頼されないソースから受け取った** **.grp** **ファイルを開いたり、保存したりしない**

    ユーザーが .grp ファイルを表示する際に、この脆弱性が悪用される可能性があります。 このファイル拡張子を使用するファイルを開かないでください。

-   **Windows XP、Windows XP Service Pack 1、および** **Windows Server 2003** **で、.grp** **ファイルと** **grpconv.exe** **アプリケーションの関連付けを削除する**

    **注:**  この回避策は、Windows XP、Windows XP Service Pack1 および Windows Server 2003 でのみ有効です｡

    この問題に対処するため、ローカル管理者として以下のステップを行ってください。

    1.  un-grpconv.inf と名前を付けたファイルに以下のコードを配置します。

        
    ```
    [Version]
    Signature="$CHICAGO$"
    [DefaultInstall]
    DelReg=DisableGrpAssociation.DelReg
    AddReg=DisableGrpAssociation.AddReg
    [DisableGrpAssociation.DelReg]
    HKCR,"MSProgramGroup"
    [DisableGrpAssociation.AddReg]
    HKCR,".grp",,,""
    HKCR,"MSProgramGroup",,,""
    [DisableGrpAssociation.AddReg.Security]
    "D:(D;CI;6;;;WD)(A;ID;KR;;;BU)(A;CIIOID;GR;;;BU)(A;ID;0x3001F;;;PU)(A;CIIOID;SDGWGR;;;PU)(A;ID;KA;;;BA)(A;CIIOID;GA;;;BA)(A;ID;KA;;;SY)(A;CIIOID;GA;;;SY)(A;CIIOID;GA;;;CO)"
    ```

    2.  un-grpconv.inf 上で右クリックし、\[インストール\] を選択します。

    この回避策を無効にし、既定の動作に戻すには、ローカル管理者として、以下のステップを行ってください。

    1.  grpconv.inf と名前を付けたファイルに以下のコードを配置します。

    ```
    [Version]
    Signature="$CHICAGO$"
    [DefaultInstall]
    DelReg=EnableGrpAssociation.DelReg
    [EnableGrpAssociation.DelReg]
    HKCR,"MSProgramGroup"
    HKCR,".grp
    ```

    2.  grpconv.inf 上で右クリックし、\[インストール\] を選択します。

    **注** : この回避策は Windows XP、Windows XP Service Pack 1、および Windows Server 2003 用にのみデザインされています。この回避策はその他の影響を受けるオペレーティング システムで正確に機能します。

#### 「Program Group Converter の脆弱性」のよく寄せられる質問 - CAN-2004-0572 :

**どのようなことが起こる可能性がありますか?**

これはリモートでコードが実行される脆弱性です。ユーザーが管理者特権でログオンした場合、攻撃者がこの脆弱性を悪用し、プログラムのインストール、データの表示、変更、削除、または完全な特権を持つ新規のアカウントの作成など、影響を受けるコンピュータの完全制御を取得する可能性があります。コンピュータ上でほとんど特権を持たないよう構成されているアカウントを持つユーザーは、管理者特権で実行しているユーザーよりも危険にさらされる可能性は低くなります。 しかし、攻撃者がこの脆弱性を悪用するには、ユーザーが操作することが必要条件となります。

**何が原因で起こりますか?**

Program Group Converter アプリケーションに未チェックのバッファが存在するためにこの脆弱性が起こります。

**Program Group Converter** **とは何ですか?**

Program Group Converter は、Windows 3.1、Windows 3.11、Windows for Workgroups 3.1、および Windows for Workgroups 3.11 からそれ以降のオペレーティング システム内で使用できるように、Program Manager Group ファイルを変換するために使用されます。 また、このアプリケーションは Windows Setup、またはサードパーティのアプリケーションまたはデバイスのインストール中に使用されます。 Program Group Converter に関する詳細情報は、次の[Web サイト](http://support.microsoft.com/kb/119941)をご覧下さい。

**この脆弱性により、攻撃者は何を行う可能性がありますか?**

攻撃者はこの脆弱性を悪用し、ユーザーと同じ特権を取得する可能性があります。コンピュータ上でほとんど特権を持たないよう構成されているアカウントを持つユーザーは、管理者特権で実行しているユーザーよりも危険にさらされる可能性は低くなります。

**どのように攻撃者はこの脆弱性を悪用する可能性がありますか?**

攻撃者がこの脆弱性を悪用するには、悪質な Web サイトをホストし、ユーザーがその Web サイトを表示するように誘導することが必要条件となります。 また、攻撃者は、綿密な細工をしたリンクを含んだ HTML 形式の電子メール メッセージを作成し、ユーザーがそのような電子メール メッセージを表示し、悪質なリンクをクリックさせるように誘導する可能性があります。 また、攻撃者は、綿密な細工をした .grp ファイルをユーザーに送信し、そのファイルをユーザーが開くように誘導する可能性があります。

また、攻撃者は、別な方法によって影響を受けるコンポーネントにアクセスする可能性があります。 例えば、攻撃者は、この脆弱性の影響を受けるコンポーネントにパラメータを渡す（ローカル、またはリモートで） 別のプログラムを悪用する可能性があります。

**主にどのようなコンピュータがこの脆弱性による危険にさらされますか?**

ワークステーションおよびターミナル サーバーが、主にこの脆弱性による危険にさらされます。ユーザーがログオンし、プログラムを実行する権限を与えられている場合にのみ、サーバーがこの脆弱性による危険にさらされます。しかし、セキュリティ上の最善策により、これらの権限を無効にすることが強く推奨されます。

**Windows 98、Windows 98 Second Edition** **または** **Windows Millennium Edition** **はこの脆弱性による深刻な影響を受けますか?**

いいえ。Windows 98、Windows 98 Second Edition、および Windows Millennium Edition には影響を受けるコンポーネントが含まれますが、この脆弱性の深刻度は「緊急」ではありません。深刻度評価システムに関する詳細情報は、次の [Web サイト](http://technet.microsoft.com/security/bulletin/rating)をご覧下さい。

**この脆弱性がインターネットで悪用される可能性はありますか?**

はい。攻撃者はこの脆弱性をインターネット上で悪用する可能性があります。

**この更新プログラムは何を修正しますか?**

この更新プログラムは、Program Group Converter のアプリケーションが、割り当てられたバッファにメッセージを渡す前に、メッセージの長さを検証する方法を変更することにより、この脆弱性を排除します。

**このセキュリティ情報のリリース時に、この脆弱性は一般に公開されていたのですか?**

はい。この脆弱性は一般に公開されていました。 これは Common Vulnerability and Exposure の CAN-2004-0572 にアサインされています。

**このセキュリティ情報のリリース時に、マイクロソフトはこの脆弱性が悪用されたという報告を受けていましたか?**

いいえ。マイクロソフトは、このセキュリティ情報が最初にリリースされた時に、公開された検証用コード例の存在を確認していましたが、この脆弱性が悪用され、お客様が攻撃されたということを示す情報は受けていませんでした。

セキュリティ更新プログラムに関する情報
--------------------------------------


**対象プラットフォームおよび必要条件** :

以下の情報の中から、ご使用のプラットフォーム向けのセキュリティ更新プログラムに関する情報をご覧ください。

#### Windows Server 2003 (すべてのバージョン)

**必要条件** :

このセキュリティ更新プログラムを適用するには、Windows Server 2003 の製品版を実行している必要があります。

**この修正を含む予定のサービスパック** :

この問題に対する更新プログラムは Windows Server 2003 Service Pack 1 に含まれる予定です。

**インストールに関する情報** :

このセキュリティ更新プログラムは次のセットアップ スイッチをサポートします。

**/help:** インストール スイッチの一覧を表示します
**セットアップモード**  
**/quiet:** 自動モード (ユーザー入力を必要としません。表示もしません)  
**/passive:** 無人モード (進行状況バーのみ)  
**/uninstall:** パッケージをアンインストールします  

**再起動オプション**  
**/norestart:** インストールの完了後、再起動しません  
**/forcerestart:** インストール後、再起動します  

**特別なオプション**  
**/l:** インストール済みの Windows ホットフィックスまたは更新パッケージを表示します  
**/o:** 確認メッセージを表示せずに OEM ファイルを上書きします  
**/n:** アンインストールに必要なファイルのバックアップを作成しません  
**/f:** シャットダウン時に他のプログラムを強制終了します  
**/extract:**  セットアップを起動せずにファイルを抽出します


**注** : これらのスイッチを 1 つのコマンド ラインに組み込むことができます。旧バージョンとの互換性のため、このセキュリティ更新プログラムは、セットアップ ユーティリティの以前のバージョンによって使用されるセットアップ スイッチもサポートしています。 サポートされるインストール スイッチについての追加情報は、マイクロソフト サポート技術情報 [262841](http://support.microsoft.com/kb/262841) をご覧ください。

**適用に関する情報** :

ユーザーの操作なしでセキュリティ更新プログラムをインストールするためには、Windows Server 2003 のコマンド プロンプトで次のコマンド ラインを使用してください。

**Windowsserver2003-kb841356-x86-jpn /passive /quiet**

コンピュータを強制的に再起動せずにセキュリティ更新プログラムをインストールするためには、Windows Server 2003 のコマンド プロンプトで次のコマンド ラインを使用してください。

**Windowsserver2003-kb841356-x86-jpn /norestart**

Software Update Services に関するより詳細な情報は以下をご覧ください ：
[Software Update Services の概要](http://www.microsoft.com/japan/windowsserversystem/sus/susoverview.mspx)

**再起動の必要性** :

セキュリティの更新を適用してから、コンピュータを再起動する必要があります。

**削除に関する情報** :

この更新プログラムを削除するためには、\[コントロール パネル\] の \[プログラムの追加と削除\] を使用してください。

システム管理者は Spuninst.exe ユーティリティを使用し、このセキュリティ更新プログラムを削除することができます。 Spuninst.exe ユーティリティは %Windir%\\$NTUninstallKB841356$\\Spuninst フォルダにあり、これは次のセットアップ スイッチをサポートします。

**/?:** インストール スイッチの一覧を表示します  
**/u :** 無人モードで実行します。
**/f:** コンピュータがシャット ダウンする時、そのほかのプログラムを強制的に閉じます  
**/z:** インストールが完了する時、再起動しません  
**/q:** 自動モードを使用します (ユーザーの操作なし)

**ファイルに関する情報** :

この更新プログラムの日本語版のファイル属性 (またはそれ以降) は次のとおりです。

**注** : 日付および時間の情報はインストール中に変わる場合があります。ファイルが正しいことを確認するには、バージョン、サイズおよびファイル名を参照して下さい。

Windows Server 2003 Enterprise Edition、Windows Server 2003 Standard Edition、Windows Server 2003 Web Edition、および Windows Server 2003 Datacenter Edition :

| 日付      | 時間 | バージョン    | サイズ    | ファイル名  | フォルダ |
|-----------|------|---------------|-----------|-------------|----------|
| 2004/8/24 | 2:15 | 5.2.3790.205  | 40,448    | grpconv.exe | RTMGDR   |
| 2004/8/24 | 2:18 | 6.00.3790.205 | 8,076,288 | shell32.dll | RTMGDR   |
| 2004/8/24 | 2:18 | 6.00.3790.205 | 286,720   | shlwapi.dll | RTMGDR   |
| 2004/8/24 | 2:10 | 5.2.3790.205  | 36,864    | grpconv.exe | RTMQFE   |
| 2004/8/24 | 2:17 | 6.00.3790.205 | 8,076,800 | shell32.dll | RTMQFE   |
| 2004/8/24 | 2:17 | 6.00.3790.205 | 286,720   | shlwapi.dll | RTMQFE   |

Windows Server 2003 64-Bit Enterprise Edition、および Windows Server 2003 64-Bit Datacenter Edition :

| 日付      | 時間  | バージョン    | サイズ     | ファイル名   | プラットフォーム | フォルダ    |
|-----------|-------|---------------|------------|--------------|------------------|-------------|
| 2004/8/23 | 10:07 | 5.2.3790.205  | 120,320    | grpconv.exe  | IA64             | RTMGDR      |
| 2004/8/23 | 10:15 | 6.00.3790.205 | 12,865,024 | shell32.dll  | IA64             | RTMGDR      |
| 2004/8/23 | 10:15 | 6.00.3790.205 | 738,304    | shlwapi.dll  | IA64             | RTMGDR      |
| 2004/8/23 | 10:15 | 5.2.3790.205  | 40,448     | wgrpconv.exe | X86              | RTMGDR\\WOW |
| 2004/8/23 | 10:18 | 6.00.3790.205 | 8,076,288  | wshell32.dll | X86              | RTMGDR\\WOW |
| 2004/8/23 | 10:18 | 6.00.3790.205 | 286,720    | wshlwapi.dll | X86              | RTMGDR\\WOW |
| 2004/8/23 | 10:08 | 5.2.3790.205  | 110,080    | grpconv.exe  | IA64             | RTMQFE      |
| 2004/8/23 | 10:15 | 6.00.3790.205 | 12,866,560 | shell32.dll  | IA64             | RTMQFE      |
| 2004/8/23 | 10:15 | 6.00.3790.205 | 738,304    | shlwapi.dll  | IA64             | RTMQFE      |
| 2004/8/23 | 10:10 | 5.2.3790.205  | 36,864     | wgrpconv.exe | X86              | RTMQFE\\WOW |
| 2004/8/23 | 10:17 | 6.00.3790.205 | 8,076,800  | wshell32.dll | X86              | RTMQFE\\WOW |
| 2004/8/23 | 10:17 | 6.00.3790.205 | 286,720    | wshlwapi.dll | X86              | RTMQFE\\WOW |

**注** :Windows Server 2003 または Windows XP 64-Bit Edition Version 2003 のコンピュータに、このセキュリティ更新プログラムをインストールするとき、コンピュータ上のアップデート対象ファイルのいずれかが、マイクロソフトの修正プログラムによって過去にアップデートされているかどうかがチェックされます。 過去に修正プログラムをインストールしてこれらのファイルのいずれかをアップデートしている場合は、RTMQFE ファイルがコンピュータにコピーされます。 それ以外の場合は、RTMGDR ファイルがコンピュータにコピーされます。 詳細は、関連情報を参照するには、サポート技術情報 [824994](http://support.microsoft.com/kb/824994) をご覧ください。

**更新プログラムが正しくインストールされたかどうか確認する方法** :

-   **Microsoft Baseline Security Analyzer**

    影響を受けるコンピュータにセキュリティ更新プログラムがインストールされていることを確認するためには、Microsoft Baseline Security Analyzer (MBSA) ツールを使用して下さい。管理者は、一般的なセキュリティ上誤った構成とともに、不足しているセキュリティ更新プログラムについて、ローカル コンピュータおよびリモート コンピュータをMicrosoft Baseline Security Analyzer (MBSA) を使ってスキャンすることができます。MBSA に関する追加情報は、[Microsoft Baseline Security Analyzer](http://technet.microsoft.com/ja-jp/security/cc184924.aspx) の Web サイトをご覧下さい。

-   **ファイルのバージョンの確認**

    **注** :Microsoft Windows にはいくつかのバージョンがあるため、次のステップは使用中のコンピュータにより異なる場合があります。その場合、製品の説明書をご覧ください。

    1.  **\[スタート\]** をクリックし、次に  **\[検索\]**  をクリックします。
    2.  **\[検索結果\]** のウィンドウの **\[検索コンパニオン\]** の下の **\[ファイルとフォルダすべて\]** をクリックします。
    3.  **\[ファイル名のすべてまたは一部\]** のボックスで、適切なファイル情報の表からファイル名を入力し、次に  **\[検索\]**  をクリックします。
    4.  ファイルの一覧で、適切なファイル情報の表からファイル名を右クリックし、次に **\[プロパティ\]** をクリックします。

        **注** :インストールされているオペレーティング システムまたはプログラムのバージョンにより、ファイル情報の表に記載されているファイルで、インストールされないものがある場合もあります。

    5.  **\[バージョン情報\]** タブで、適切なファイル情報の表に記載されているバージョンと比較し、コンピュータにインストールされているファイルのバージョンを確認します。

        **注** :ファイルのバージョン以外の属性はインストール中に変更される場合があります。そのほかのファイルの属性をファイル情報の表の情報と比較することは、更新プログラムが正しくインストールされたことを確認する方法としてサポートされていません。また、ファイル名がインストール中に変更される場合があります。ファイルまたはバージョンの情報が存在しない場合、その他の方法によって更新プログラムが正しくインストールされたことを確認して下さい。

-   **レジストリキーの確認**

    また、次のレジストリ キーを調べることにより、このセキュリティ更新プログラムがインストールしたファイルを確認することもできます。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB841356\\Filelist

    **注** :これらのレジストリ キーには、インストールされるファイルの完全な一覧が含まれない場合があります。また、管理者または OEM メーカーによって 841356 のセキュリティ更新プログラムを Windows インストール ソース ファイルに統合またはスリップストリーム化されている場合、このレジストリ キーが適切に作成されない場合があります。

#### Windows XP (すべてのバージョン)

**注** :セキュリティ更新プログラムの Windows XP 64-Bit Edition Version 2003 向けのバージョンは、Windows Server 2003 64-Bit Edition のセキュリティ更新プログラムと同じものです。

**必要条件**

このセキュリティ更新プログラムを適用するには、製品版の Windows XP または Windows XP Service Pack 1 (SP1) を実行している必要があります。 詳細は、サポート技術情報 [322389](http://support.microsoft.com/kb/322389) をご覧ください。

**この修正を含む予定のサービスパック** :

この問題に対する更新プログラムは Windows XP Service Pack 2 に含まれています。

**インストールに関する情報** :

このセキュリティ更新プログラムは次のセットアップ スイッチをサポートします。

**/help:** インストール スイッチの一覧を表示します
**セットアップモード**  
**/quiet:** 自動モード (ユーザー入力を必要としません。表示もしません)  
**/passive:** 無人モード (進行状況バーのみ)  
**/uninstall:** パッケージをアンインストールします  

**再起動オプション**  
**/norestart:** インストールの完了後、再起動しません  
**/forcerestart:** インストール後、再起動します  

**特別なオプション**  
**/l:** インストール済みの Windows ホットフィックスまたは更新パッケージを表示します  
**/o:** 確認メッセージを表示せずに OEM ファイルを上書きします  
**/n:** アンインストールに必要なファイルのバックアップを作成しません  
**/f:** シャットダウン時に他のプログラムを強制終了します  
**/extract:**  セットアップを起動せずにファイルを抽出します


**注** : これらのスイッチを 1 つのコマンド ラインに組み込むことができます。旧バージョンとの互換性のため、このセキュリティ更新プログラムは、セットアップ ユーティリティの以前のバージョンによって使用されるセットアップ スイッチもサポートしています。 サポートされるインストール スイッチについての追加情報は、マイクロソフト サポート技術情報 [262841](http://support.microsoft.com/kb/262841) をご覧ください。

**適用に関する情報** :

ユーザーの操作なしでセキュリティ更新プログラムをインストールするためには、Windows XP のコマンド プロンプトで次のコマンド ラインを使用してください。

**Windowsxp-kb841356-x86-jpn /passive /quiet**

コンピュータを強制的に再起動せずにセキュリティ更新プログラムをインストールするためには、Windows XP のコマンド プロンプトで次のコマンド ラインを使用してください。

**Windowsserverxp-kb841356-x86-jpn /norestart**

Software Update Services に関するより詳細な情報は以下をご覧ください。
[Software Update Services の概要](http://www.microsoft.com/japan/windowsserversystem/sus/susoverview.mspx)

**再起動の必要性** :

セキュリティの更新を適用してから、コンピュータを再起動する必要があります。

**削除に関する情報** :

この更新プログラムを削除するためには、\[コントロール パネル\] の \[プログラムの追加と削除\] を使用してください。

システム管理者は Spuninst.exe ユーティリティを使用し、このセキュリティ更新プログラムを削除することができます。 Spuninst.exe ユーティリティは %Windir%\\$NTUninstallKB841356$\\Spuninst フォルダにあり、これは次のセットアップ スイッチをサポートします。

**/?:** インストール スイッチの一覧を表示します  
**/u :** 無人モードで実行します。
**/f:** コンピュータがシャット ダウンする時、そのほかのプログラムを強制的に閉じます  
**/z:** インストールが完了する時、再起動しません  
**/q:** 自動モードを使用します (ユーザーの操作なし)

**ファイルに関する情報** :

この更新プログラムの日本語版のファイル属性 (またはそれ以降) は次のとおりです。

Windows XP Home Edition、Windows XP Professional、Windows XP Home Edition Service Pack 1、Windows XP Professional Service Pack 1、Windows XP Tablet PC Edition、Windows XP Media Center Edition :

| 日付      | 時間  | バージョン     | サイズ    | ファイル名   | フォルダ                                          |
|-----------|-------|----------------|-----------|--------------|---------------------------------------------------|
| 2004/8/21 | 6:50  | 6.00.2750.165  | 83,968    | Fldrclnr.dll | RTMQFE                                            |
| 2004/8/21 | 6:40  | 5.1.2600.166   | 37,888    | Grpconv.exe  | RTMQFE                                            |
| 2004/8/21 | 6:50  | 5.1.2600.165   | 15,872    | Linkinfo.dll | RTMQFE                                            |
| 2004/8/21 | 6:50  | 5.1.2600.165   | 37,376    | Ntlanman.dll | RTMQFE                                            |
| 2004/8/21 | 6:50  | 6.00.2750.166  | 8,133,632 | Shell32.dll  | RTMQFE                                            |
| 2004/8/21 | 6:50  | 6.00.2750.167  | 393,216   | Shlwapi.dll  | RTMQFE                                            |
| 2004/9/19 | 14:31 | 5.5.0031.0     | 30,720    | Xpsp1hfm.exe | RTMQFE                                            |
| 2004/8/21 | 6:53  | 6.00.2800.1579 | 81,408    | Fldrclnr.dll | SP1QFE                                            |
| 2004/8/21 | 6:45  | 5.1.2600.1580  | 37,888    | Grpconv.exe  | SP1QFE                                            |
| 2004/8/21 | 6:53  | 5.1.2600.1579  | 15,872    | Linkinfo.dll | SP1QFE                                            |
| 2004/8/21 | 6:53  | 6.00.2800.1580 | 8,348,160 | Shell32.dll  | SP1QFE                                            |
| 2004/8/21 | 6:53  | 6.00.2800.1584 | 422,400   | Shlwapi.dll  | SP1QFE                                            |
| 2004/7/30 | 14:32 | 5.1.2600.1580  | 564,736   | Sprt0411.dll | SP1QFE                                            |
| 2004/8/21 | 6:53  | 5.1.2600.1579  | 695,296   | Sxs.dll      | SP1QFE                                            |
| 2004/8/20 | 14:53 | 6.0.2800.1579  | 921,600   | Comctl32.dll | SP1QFE\\asms\\60\\msft\\windows\\common\\controls |
| 2004/8/21 | 7:02  |                | 1,812     | Controls.man | SP1QFE\\asms\\60\\msft\\windows\\common\\controls |

Windows XP 64-Bit Edition Service Pack 1:

| 日付      | 時間  | バージョン     | サイズ     | ファイル名    | プラットフォーム | フォルダ                                          |
|-----------|-------|----------------|------------|---------------|------------------|---------------------------------------------------|
| 2004/8/20 | 15:03 | 6.00.2800.1579 | 129,536    | fldrclnr.dll  | IA64             | SP1QFE                                            |
| 2004/8/20 | 15:01 | 5.1.2600.1580  | 129,536    | grpconv.exe   | IA64             | SP1QFE                                            |
| 2004/8/20 | 15:03 | 5.1.2600.1579  | 50,176     | Linkinfo.dll  | IA64             | SP1QFE                                            |
| 2004/8/20 | 15:03 | 6.00.2800.1580 | 14,298,112 | Shell32.dll   | IA64             | SP1QFE                                            |
| 2004/8/20 | 15:03 | 6.00.2800.1584 | 1,116,672  | Shlwapi.dll   | IA64             | SP1QFE                                            |
| 2004/7/30 | 12:22 | 5.1.2600.1580  | 564,224    | Sprt0411.dll  | IA64             | SP1QFE                                            |
| 2004/8/20 | 15:03 | 5.1.2600.1579  | 2,028,544  | Sxs.dll       | IA64             | SP1QFE                                            |
| 2004/8/20 | 15:03 | 6.00.2800.1579 | 2,639,360  | Comctl32.dll  | IA64             | SP1QFE\\asms\\60\\msft\\windows\\common\\controls |
| 2004/8/20 | 15:06 |                | 1,813      | Controls.man  |                  | SP1QFE\\asms\\60\\msft\\windows\\common\\controls |
| 2004/8/20 | 15:06 |                | 623        | Comctl.man    |                  | SP1QFE\\asms\\60\\policy\\60\\comctl              |
| 2004/8/20 | 14:53 | 6.00.2800.1579 | 81,408     | Wfldrclnr.dll | x86              | SP1QFE\\WOW                                       |
| 2004/8/20 | 14:45 | 5.1.2600.1580  | 37,888     | Wgrpconv.exe  | x86              | SP1QFE\\WOW                                       |
| 2004/8/20 | 14:53 | 5.1.2600.1579  | 15,872     | Wlinkinfo.dll | x86              | SP1QFE\\WOW                                       |
| 2004/8/20 | 14:53 | 6.00.2800.1580 | 8,348,160  | Wshell32.dll  | x86              | SP1QFE\\WOW                                       |
| 2004/8/20 | 14:53 | 6.00.2800.1584 | 422,400    | Wshlwapi.dll  | x86              | SP1QFE\\WOW                                       |
| 2004/7/30 | 14:32 | 5.1.2600.1580  | 564,736    | Wsprt0411.dll | x86              | SP1QFE\\WOW                                       |
| 2004/8/20 | 14:53 | 5.1.2600.1579  | 695,296    | Wsxs.dll      | x86              | SP1QFE\\WOW                                       |

Windows XP 64-Bit Edition Version 2003:

| 日付      | 時間  | バージョン    | サイズ     | ファイル名   | プラットフォーム | フォルダ    |
|-----------|-------|---------------|------------|--------------|------------------|-------------|
| 2004/8/23 | 10:07 | 5.2.3790.205  | 120,320    | Grpconv.exe  | IA64             | RTMGDR      |
| 2004/8/23 | 10:15 | 6.00.3790.205 | 12,865,024 | Shell32.dll  | IA64             | RTMGDR      |
| 2004/8/23 | 10:15 | 6.00.3790.205 | 738,304    | Shlwapi.dll  | IA64             | RTMGDR      |
| 2004/8/23 | 10:15 | 5.2.3790.205  | 40,448     | Wgrpconv.exe | x86              | RTMGDR\\WOW |
| 2004/8/23 | 10:18 | 6.00.3790.205 | 8,076,288  | Wshell32.dll | x86              | RTMGDR\\WOW |
| 2004/8/23 | 10:18 | 6.00.3790.205 | 286,720    | Wshlwapi.dll | x86              | RTMGDR\\WOW |
| 2004/8/23 | 10:08 | 5.2.3790.205  | 110,080    | Grpconv.exe  | IA64             | RTMQFE      |
| 2004/8/23 | 10:15 | 6.00.3790.205 | 12,866,560 | Shell32.dll  | IA64             | RTMQFE      |
| 2004/8/23 | 10:15 | 6.00.3790.205 | 738,304    | Shlwapi.dll  | IA64             | RTMQFE      |
| 2004/8/23 | 10:10 | 5.2.3790.205  | 36,864     | Wgrpconv.exe | x86              | RTMQFE\\WOW |
| 2004/8/23 | 10:17 | 6.00.3790.205 | 8,076,800  | Wshell32.dll | x86              | RTMQFE\\WOW |
| 2004/8/23 | 10:17 | 6.00.3790.205 | 286,720    | Wshlwapi.dll | x86              | RTMQFE\\WOW |

**注** :Windows XP、Windows XP Service Pack 1 および Windows XP 64-Bit Edition Version 2003 (英語版) 用のこのセキュリティ更新プログラムは、デュアルモード パッケージとして作成されています。デュアルモード パッケージには、Service Pack 未適用の Windows XP 製品版および Windows XP Service Pack 1 (SP1) 用のファイルが含まれています。 デュアルモード パッケージの関連情報を参照するには、サポート技術情報 [328848](http://support.microsoft.com/kb/328848) をご覧ください。

Windows XP 64-Bit Edition Version 2003 のセキュリティ更新プログラムをインストールする際、コンピュータ上のアップデート対象ファイルのいずれかが、マイクロソフトの修正プログラムによって過去にアップデートされているかどうかがチェックされます。 過去に修正プログラムをインストールしてこれらのファイルのいずれかをアップデートしている場合は、RTMQFE ファイルがコンピュータにコピーされます。 それ以外の場合は、RTMGDR ファイルがコンピュータにコピーされます。 詳細は、サポート技術情報 [824994](http://support.microsoft.com/kb/824994) をご覧ください。

**更新プログラムが正しくインストールされたかどうか確認する方法** :

-   **Microsoft Baseline Security Analyzer**

    影響を受けるコンピュータにセキュリティ更新プログラムがインストールされていることを確認するためには、Microsoft Baseline Security Analyzer (MBSA) ツールを使用して下さい。管理者は、一般的なセキュリティ上誤った構成とともに、不足しているセキュリティ更新プログラムについて、ローカル コンピュータおよびリモート コンピュータをMicrosoft Baseline Security Analyzer (MBSA) を使ってスキャンすることができます。MBSA に関する追加情報は、[Microsoft Baseline Security Analyzer](http://technet.microsoft.com/ja-jp/security/cc184924.aspx) の Web サイトをご覧下さい。

-   **ファイルのバージョンの確認**

    **注** :Microsoft Windows にはいくつかのバージョンがあるため、次のステップは使用中のコンピュータにより異なる場合があります。その場合、製品の説明書をご覧ください。

    1.  **\[スタート\]** をクリックし、次に  **\[検索\]**  をクリックします。
    2.  **\[検索結果\]** のウィンドウの **\[検索コンパニオン\]** の下の **\[ファイルとフォルダすべて\]** をクリックします。
    3.  **\[ファイル名のすべてまたは一部\]** のボックスで、適切なファイル情報の表からファイル名を入力し、次に  **\[検索\]**  をクリックします。
    4.  ファイルの一覧で、適切なファイル情報の表からファイル名を右クリックし、次に **\[プロパティ\]** をクリックします。

        **注** :インストールされているオペレーティング システムまたはプログラムのバージョンにより、ファイル情報の表に記載されているファイルで、インストールされないものがある場合もあります。

    5.  **\[バージョン情報\]** タブで、適切なファイル情報の表に記載されているバージョンと比較し、コンピュータにインストールされているファイルのバージョンを確認します。

        **注** :ファイルのバージョン以外の属性はインストール中に変更される場合があります。そのほかのファイルの属性をファイル情報の表の情報と比較することは、更新プログラムが正しくインストールされたことを確認する方法としてサポートされていません。また、ファイル名がインストール中に変更される場合があります。ファイルまたはバージョンの情報が存在しない場合、その他の方法によって更新プログラムが正しくインストールされたことを確認して下さい。

-   **レジストリキーの確認**

    また、次のレジストリ キーを調べることにより、このセキュリティ更新プログラムがインストールしたファイルを確認することもできます。

    Windows XP Home Edition、Windows XP Professional、Windows XP Home Edition Service Pack 1、Windows XP Professional Service Pack 1、Windows XP 64-Bit Edition Service Pack 1、Windows XP Tablet PC Edition、Windows XP Media Center Edition :

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP2\\KB841356\\Filelist

    Windows XP 64-Bit Edition Version 2003 :

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB841356\\Filelist

    **注** :これらのレジストリ キーには、インストールされるファイルの完全な一覧が含まれない場合があります。また、管理者または OEM メーカーによって 841356 のセキュリティ更新プログラムを Windows インストール ソース ファイルに統合またはスリップストリーム化されている場合、このレジストリ キーが適切に作成されない場合があります。

#### Windows 2000 (すべてのバージョン):

**必要条件** :

Windows 2000 にこのセキュリティ更新プログラムをインストールするには、Service Pack 3 (SP3) または Service Pack 4 (SP4) がインストールされている必要があります。

上記のソフトウェアのテストを行い、この脆弱性による影響を評価しました。それ以前のバージョンに関してはサポートの対象となっていないため、この脆弱性による影響は不明です。 ご使用中の製品およびバージョンのサポートライフサイクルを確認するためには、[マイクロソフト サポート ライフサイクル](http://support.microsoft.com/lifecycle/)の Web サイトをご覧下さい。

最新のサービス パックの入手方法に関する詳細情報は、マイクロソフト サポート技術情報 [260910](http://support.microsoft.com/kb/260910) をご覧下さい。

**この修正を含む予定のサービスパック:**

この問題に対する更新プログラムは Windows 2000 Service Pack 5 に含まれる予定です。

**インストールに関する情報** :

このセキュリティ更新プログラムは次のセットアップ スイッチをサポートします。

**/help:** インストール スイッチの一覧を表示します
**セットアップモード**  
**/quiet:** 自動モード (ユーザー入力を必要としません。表示もしません)  
**/passive:** 無人モード (進行状況バーのみ)  
**/uninstall:** パッケージをアンインストールします  

**再起動オプション**  
**/norestart:** インストールの完了後、再起動しません  
**/forcerestart:** インストール後、再起動します  

**特別なオプション**  
**/l:** インストール済みの Windows ホットフィックスまたは更新パッケージを表示します  
**/o:** 確認メッセージを表示せずに OEM ファイルを上書きします  
**/n:** アンインストールに必要なファイルのバックアップを作成しません  
**/f:** シャットダウン時に他のプログラムを強制終了します  
**/extract:**  セットアップを起動せずにファイルを抽出します


**注** : これらのスイッチを 1 つのコマンド ラインに組み込むことができます。旧バージョンとの互換性のため、このセキュリティ更新プログラムは、セットアップ ユーティリティの以前のバージョンによって使用されるセットアップスイッチもサポートしています。サポートされるインストール スイッチに関する詳細は、マイクロソフト サポート技術情報 [262841](http://support.microsoft.com/kb/262841) をご覧下さい。

**適用に関する情報** :

ユーザーの操作なしでセキュリティ更新プログラムをインストールするためには、Windows 2000 Service Pack 3 および Windows 2000 Service Pack 4 のコマンド プロンプトで、次のコマンド ラインを使用してください。

**Windows2000-kb841356-x86-jpn /passive /quiet**

コンピュータを強制的に再起動せずにセキュリティ更新プログラムをインストールするためには、Windows 2000 Service Pack 3 および Windows 2000 Service Pack 4 のコマンド プロンプトで、次のコマンド ラインを使用して下さい。

**Windows2000-kb841356-x86-jpn /norestart**

Software Update Services に関するより詳細な情報は以下をご覧ください ：
[Software Update Services の概要](http://www.microsoft.com/japan/windowsserversystem/sus/susoverview.mspx)

**再起動の必要性** :

セキュリティの更新を適用してから、コンピュータを再起動する必要があります。

**削除に関する情報** :

この更新プログラムを削除するためには、\[コントロール パネル\] の \[プログラムの追加と削除\] を使用してください。

システム管理者は Spuninst.exe ユーティリティを使用し、このセキュリティ更新プログラムを削除することができます。 Spuninst.exe ユーティリティは %Windir%\\$NTUninstallKB841356$\\Spuninst フォルダにあり、これは次のセットアップ スイッチをサポートします。

**/?:** インストール スイッチの一覧を表示します  
**/u :** 無人モードで実行します。
**/f:** コンピュータがシャット ダウンする時、そのほかのプログラムを強制的に閉じます  
**/z:** インストールが完了する時、再起動しません  
**/q:** 自動モードを使用します (ユーザーの操作なし)

**ファイルに関する情報** :

この更新プログラムの日本語版のファイル属性 (またはそれ以降) は次のとおりです。

Windows 2000 Service Pack 3 および Windows 2000 Service Pack 4:

| 日付      | 時間  | バージョン     | サイズ    | ファイル名   | フォルダ                |
|-----------|-------|----------------|-----------|--------------|-------------------------|
| 2004/9/3  | 4:59  | 5.00.2195.6966 | 41,744    | grpconv.exe  |                         |
| 2004/9/2  | 13:04 | 5.00.2195.6958 | 17,168    | linkinfo.dll |                         |
| 2004/9/3  | 5:04  | 5.00.2195.6824 | 35,088    | ntlanman.dll |                         |
| 2004/9/18 | 17:25 | 5.00.3900.6975 | 2,358,544 | shell32.dll  |                         |
| 2004/8/20 | 16:21 | 5.00.3900.6969 | 282,384   | shlwapi.dll  |                         |
| 2004/8/27 | 0:26  | 5.00.2195.6970 | 465,920   | sp3res.dll   |                         |
| 2004/9/18 | 1:25  | 5.00.3900.6975 | 1,122,064 | webvw.dll    |                         |
| 2004/8/20 | 15:39 | 6.00.2750.167  | 393,216   | shlwapi.dll  | xpclnt\_qfe\_binarydrop |
| 2004/8/20 | 15:39 | 6.00.2800.1584 | 422,400   | shlwapi.dll  | xpsp2\_binarydrop       |

**更新プログラムが正しくインストールされたかどうか確認する方法** :

-   **Microsoft Baseline Security Analyzer**

    影響を受けるコンピュータにセキュリティ更新プログラムがインストールされていることを確認するためには、Microsoft Baseline Security Analyzer (MBSA) ツールを使用して下さい。管理者は、一般的なセキュリティ上誤った構成とともに、不足しているセキュリティ更新プログラムについて、ローカル コンピュータおよびリモート コンピュータをMicrosoft Baseline Security Analyzer (MBSA) を使ってスキャンすることができます。MBSA に関する追加情報は、[Microsoft Baseline Security Analyzer](http://technet.microsoft.com/ja-jp/security/cc184924.aspx) の Web サイトをご覧下さい。

-   **ファイルのバージョンの確認**

    **注** : Microsoft Windows にはいくつかのバージョンがあるため、次のステップは使用中のコンピュータにより異なる場合があります。その場合、製品の説明書をご覧ください。

    1.  **\[スタート\]** をクリックし、 **\[検索\]**  にある **\[ファイルやフォルダ\]** をクリックします。
    2.  **\[ファイルまたはフォルダの名前\]** に、ファイル情報の表から適切なファイル名を入力し、**\[検索開始\]** をクリックします。
    3.  検索結果に出力されたファイルを右クリックし、次に **\[プロパティ\]** をクリックします。
    4.  **\[バージョン\]** タブで、ファイル情報の表に記載されているバージョンと、コンピュータにインストールされているファイルのバージョンを比較して確認して下さい。

        **注** : インストールされているオペレーティング システムまたはプログラムのバージョンにより、ファイル情報の表に記載されているファイルで、インストールされないものがある場合もあります。

    5.  **\[バージョン情報\]** タブで、適切なファイル情報の表に記載されているバージョンと比較し、コンピュータにインストールされているファイルのバージョンを確認します。

        **注** : ファイルのバージョン以外の属性はインストール中に変更される場合があります。そのほかのファイルの属性をファイル情報の表の情報と比較することは、更新プログラムが正しくインストールされたことを確認する方法としてサポートされていません。また、ファイル名がインストール中に変更される場合があります。ファイルまたはバージョンの情報が存在しない場合、その他の方法によって更新プログラムが正しくインストールされたことを確認して下さい。

-   **レジストリキーの確認**

    また、次のレジストリ キーを調べることにより、このセキュリティ更新プログラムがインストールしたファイルを確認することもできます。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP5\\KB841356\\Filelist

    **注：**  これらのレジストリ キーには、インストールされるファイルの完全な一覧が含まれない場合があります。 また、管理者または OEM メーカーによって 841356 のセキュリティ更新プログラムを Windows インストール ソース ファイルに統合またはスリップストリーム化されている場合、このレジストリ キーが適切に作成されない場合があります。

#### Windows NT Server 4.0 (すべてのバージョン)

**必要条件** :

このセキュリティ更新プログラムをインストールするには、Windows NT Server 4.0 Service Pack 6a (SP6a)、または Windows NT Server 4.0 Terminal Server Edition Service Pack 6 (SP6) がインストールされている必要があります。
上記のソフトウェアのテストを行い、この脆弱性による影響を評価しました。それ以前のバージョンに関してはサポートの対象となっていないため、この脆弱性による影響は不明です。
ご使用中の製品およびバージョンのサポートライフ サイクルを確認するためには、[マイクロソフト サポート ライフサイクル](http://support.microsoft.com/lifecycle/)の Web サイトをご覧下さい。
最新のサービス パックの入手方法に関する詳細情報は、マイクロソフト サポート技術情報 [152734](http://support.microsoft.com/kb/152734) をご覧下さい。

**インストール情報:**

このセキュリティ更新プログラムは次のセットアップ スイッチをサポートします。

**/Q** パッケージ処理の状況を一部表示しないモード    
**/Q:U** ユーザー Quiet モードを指定します。このモードでは、いくつかのダイアログ ボックスが表示されます。  
**/Q:A** 管理者 Quiet モードを指定します。このモードでは、ダイアログ ボックスは表示されません。  
**/T:&lt;完全なパス&gt;** ファイルの抽出のターゲットフォルダを指定します。  
**/C** ファイルをインストールせずに抽出します。/T: パスが指定されていない場合、ターゲット フォルダについて確認メッセージが表示されます。  
**/C:&lt;Cmd&gt;** 作成者により定義されたインストール コマンドを上書きします。Setup .inf ファイルまたは .exe ファイルのパスおよび名前を指定します。  
**/R:N** インストール後にコンピュータを再起動しません。    
**/R:I** 再起動が必要である場合、ユーザーにコンピュータを再起動するよう確認メッセージを表示します。(このスイッチが /Q:A スイッチと使用される場合を除く)  
**/R:A** インストール後、常にコンピュータを再起動します。    
**/r:s** ユーザーに確認メッセージを表示せずに、インストール後コンピュータを再起動します。    
**/N:V** バージョンをチェックしません。以前のすべてのバージョンにプログラムをインストールします。  

**注** : これらのスイッチはすべての更新プログラムと動作するわけではありません。スイッチが動作しない場合は、その更新プログラムに対応した機能が必要です。また、/N:V スイッチの使用はサポートされておらず、コンピュータが起動しなくなる原因となる場合があります。インストールが正常に完了しない場合、その理由をお客様のサポート プロフェッショナルにお問い合わせ下さい。

サポートされているセットアップ スイッチに関する追加情報は、マイクロソフト サポート技術情報 [197147](http://support.microsoft.com/kb/197147) をご覧下さい。

**適用に関する情報** :

たとえば、ユーザーの操作なしで、またコンピュータに再起動を強制せずにこの更新プログラムをインストールするためには、Windows NT Server 4.0 のコマンド プロンプトで次のコマンド ラインを使用してください。

**WindowsNT4Server-KB841356-x86-JPN.exe /q:a /r:n**

Windows NT Server 4.0 Terminal Server Edition :

**WindowsNT4TerminalServer-KB841356-x86-JPN.exe /q:a /r:n**

**再起動の必要性** :

セキュリティの更新を適用してから、コンピュータを再起動する必要があります。

**削除に関する情報** :

この更新プログラムを削除するためには、\[コントロール パネル\] の \[プログラムの追加と削除\] を使用してください。 Windows NT 4.0 Server Hotfix-KB841356 をクリックし、次に \[追加と削除\] をクリックします。

システム管理者は Ieuninst.exe ユーティリティを使用し、このセキュリティ更新プログラムを削除することができます。このセキュリティ更新プログラムは %Windir% フォルダに Ieuninst.exe ユーティリティをインストールします。このユーティリティは次のセットアップ スイッチをサポートします。

**/?** インストール スイッチの一覧を表示します
**/z** インストール終了時に再起動しません
**/q** Quiet モードを使用します (ユーザーの操作なし)

たとえば、この更新プログラムをメッセージを表示せず削除する場合、次のコマンドを使用して下さい。

**c:\\windows\\ieuninst /q c:\\windows\\inf\\KB841356.inf**

**注** : このコマンドは Windows が C:\\Windows フォルダにインストールされていることを前提とします。

**ファイルに関する情報** :

この更新プログラムの日本語版のファイル属性 (またはそれ以降) は次のとおりです。

Windows NT Server 4.0:

| 日付      | 時間  | バージョン     | サイズ    | ファイル名    | インストール前ファイル名 |
|-----------|-------|----------------|-----------|---------------|--------------------------|
| 2004/7/31 | 12:46 | 4.72.3843.3100 | 1,770,720 | ADSHELL32.DLL |                          |
| 2004/6/8  | 18:47 | 4.00           | 41,840    | NTLANMAN.DLL  |                          |
| 2004/7/21 | 11:21 | 5.00.2195.6960 | 41,744    | NWGRPCONV.EXE |                          |
| 2004/8/5  | 12:22 | 4.00           | 50,352    | OSGRPCONV.EXE |                          |
| 2004/8/16 | 16:22 | 4.00           | 1,340,176 | OSSHELL32.DLL |                          |
| 2004/8/20 | 14:53 | 6.00.2800.1584 | 422,400   | SHLWAPI.DLL   |                          |
| 2004/7/31 | 12:46 | 4.72.3843.3100 | 1,770,720 | SHELL32.DLL   | ADSHELL32.DLL            |
| 2004/7/21 | 11:21 | 5.00.2195.6960 | 41,744    | GRPCONV.EXE   | NWGRPCONV.EXE            |
| 2004/8/5  | 12:22 | 4.00           | 50,352    | GRPCONV.EXE   | OSGRPCONV.EXE            |
| 2004/8/16 | 16:22 | 4.00           | 1,340,176 | SHELL32.DLL   | OSSHELL32.DLL            |

Windows NT Server 4.0 Terminal Server Edition:

| 日付      | 時間  | バージョン     | サイズ    | ファイル名    | インストール前ファイル名 |
|-----------|-------|----------------|-----------|---------------|--------------------------|
| 2004/6/11 | 14:34 | 4.00           | 41,840    | NTLANMAN.DLL  |                          |
| 2004/7/21 | 11:21 | 5.00.2195.6960 | 41,744    | NWGRPCONV.EXE |                          |
| 2004/8/4  | 21:20 | 4.00           | 50,352    | OSGRPCONV.EXE |                          |
| 2004/8/16 | 17:17 | 4.00           | 1,360,768 | OSSHELL32.DLL |                          |
| 2004/8/20 | 14:53 | 6.00.2800.1584 | 422,400   | SHLWAPI.DLL   |                          |
| 2004/7/21 | 11:21 | 5.00.2195.6960 | 41,744    | GRPCONV.EXE   | NWGRPCONV.EXE            |
| 2004/8/4  | 21:20 | 4.00           | 50,352    | GRPCONV.EXE   | OSGRPCONV.EXE            |
| 2004/8/16 | 17:17 | 4.00           | 1,360,768 | SHELL32.DLL   | OSSHELL32.DLL            |

**更新プログラムが正しくインストールされたかどうか確認する方法** :

-   **ファイルのバージョンの確認**

    **注** : Microsoft Windows にはいくつかのバージョンがあるため、次のステップは使用中のコンピュータにより異なる場合があります。その場合、製品の説明書をご覧ください。

    1.  **\[スタート\]** をクリックし、次に  **\[検索\]**  をクリックします。
    2.  **\[名前\]** にファイル情報の表から適切なファイル名を入力し、Windows NT をインストールしたドライブを指定し、**\[検索開始\]** をクリックします。
    3.  検索結果に出力されたファイルを右クリックし、次に **\[プロパティ\]** をクリックします。

        **注** : インストールされているオペレーティング システムまたはプログラムのバージョンにより、ファイル情報の表に記載されているファイルで、インストールされないものがある場合もあります。

    4.  **\[バージョン情報\]** タブで、適切なファイル情報の表に記載されているバージョンと比較し、コンピュータにインストールされているファイルのバージョンを確認します。

        **注** : ファイルのバージョン以外の属性はインストール中に変更される場合があります。
        そのほかのファイルの属性をファイル情報の表の情報と比較することは、更新プログラムが正しくインストールされたことを確認する方法としてサポートされていません。また、ファイル名がインストール中に変更される場合があります。ファイルまたはバージョンの情報が存在しない場合、その他の方法によって更新プログラムが正しくインストールされたことを確認して下さい。

-   **レジストリキーの確認**

    また、次のレジストリ キーを調べることにより、このセキュリティ更新プログラムがインストールしたファイルを確認することもできます。

    **HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{dccb3000-9408-4772-b113-b600e1311cef}**

    **注** : 上記のレジストリ キーに、データ値 1 を持つ IsInstalled DWORD 値が存在することを確認して下さい。

-   **プログラムのバージョンの確認**

    また、次のレジストリ キーを調べることにより、このセキュリティ更新プログラムがインストールしたファイルを確認することもできます。

    Internet Explorer の **\[バージョン情報\]** ダイアログボックスの **\[更新バージョン\]** フィールドに **KB841356** が表示されていることを確認して下さい。

### その他の情報

**謝辞:**

この問題を連絡し、顧客の保護に協力して下さった下記の方に対し、マイクロソフトは深い[謝意](http://technet.microsoft.com/security/bulletin/policy)を表します。

-   シェルの脆弱性 (CAN-2004-0214) の報告に協力してくださった [ITsec Security Services](http://www.itsec-ss.nl/) の Yorick Koster 氏
-   シェルの脆弱性 (CAN-2004-0214) の報告に協力してくださった [Roozbeh Afrasiabi](http://www.persiax.com/) 氏

**他のセキュリティ更新プログラムの入手先** :

他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムは[マイクロソフト ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード探索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。
-   本セキュリティ情報及び公開された更新プログラムは、[TechNet CD サブスクリプション](http://www.microsoft.com/japan/technet/subscriptions/)でも入手可能です。

**他のセキュリティ情報** :

-   [Microsoft TechNet Security センター](http://technet.microsoft.com/ja-jp/security/default.aspx) では、製品に関するセキュリティ情報を提供しています。
-   Microsoft Software Update Services : <http://www.microsoft.com/japan/windowsserversystem/updateservices/>
-   Microsoft Baseline Security Analyzer (MBSA) : [http://www.microsoft.com/japan/technet/security/tools/Tools/mbsahome.asp](http://technet.microsoft.com/ja-jp/security/cc184924.aspx) MBSA ツールのセキュリティ更新プログラムの検出に関する制限は <http://support.microsoft.com/kb/306460> をご覧ください。
-   Windows Update カタログ : <http://support.microsoft.com/kb/323166>
-   Microsoft Update : <http://update.microsoft.com/microsoftupdate/>
-   Office のアップデート : <http://office.microsoft.com/officeupdate/>

**Software Update Services (SUS) :**

Microsoft Software Update Services (SUS) は、最新の重要な更新プログラムを適用し、Windows ベースのシステムを最新の状態に維持するプロセスを大幅に簡素化する目的で開発されました。SUS により、重要な更新プログラムを Windows® 2000 や Windows Server™ 2003 ベースのサーバー、ならびに Windows® 2000 Professional や Windows XP Professional を実行するデスクトップ コンピュータへ迅速かつ確実に配布することができます。

Software Update Services に関するより詳細な情報は以下をご覧ください:  
<http://www.microsoft.com/japan/windows2000/windowsupdate/sus/>

**Systems Management Server (SMS) :**

Microsoft Systems Management Server (SMS) は更新プログラムを管理するための、構成可能なエンタープライズ ソリューションを提供します。SMS により、管理者はセキュリティ更新プログラムを必要とする Windows ベースのコンピュータを識別し、エンタープライズ全体で、エンド ユーザーへの中断を最小限にして、これらの更新プログラムの制御された適用を実行することができます。セキュリティ更新プログラムを適用するための SMS 2003 の使用方法に関する詳細情報は [SMS 2003 セキュリティ パッチ管理 Web サイト](http://www.microsoft.com/japan/smserver/evaluation/tips.mspx)をご覧下さい。SMS 2.0 ユーザーもまた、[Software Updates Service Feature Pack](http://www.microsoft.com/japan/smserver/downloads/20/featurepacks/suspack/) を活用して、セキュリティ更新プログラムの適用を支援することができます。SMS に関する情報は [SMS の Web サイト](http://www.microsoft.com/japan/smserver/default.mspx)をご覧下さい。

**注** : SMS は Microsoft Baseline Security Analyzer および Microsoft Office 検出ツールを活用してセキュリティ情報で提供された更新プログラムの検出と適用について広範なサポートを提供します。これらのツールにより検出されないソフトウェアの更新プログラムもあります。管理者は、特定のコンピュータへの更新プログラムを対象とし、これらの場合に SMS のインベントリ機能を使用することができます。この手順に関する詳細情報は、[こちらの Web サイト](http://www.microsoft.com/technet/prodtechnol/sms/sms2003/patchupdate.mspx) (英語情報) をご覧下さい。コンピュータの再起動後、管理者権限を必要とするセキュリティ更新プログラムもあります。管理者は、SMS 2.0 Administration Feature Pack の上位権利での展開ツール ([SMS Administration Feature Pack](http://technet.microsoft.com/en-us/sms/bb676766.aspx) (英語情報) および [SMS 2.0 Administration Feature Pack](http://www.microsoft.com/japan/smserver/downloads/20/featurepacks/adminpack/) でご利用可能です) は、これらの更新プログラムのインストールに使用することができます。

**サポート** :

-   セキュリティ関連、およびセキュリティ更新プログラムに関するご質問や、ご不明な点などありましたら、マイクロソフト セキュリティ情報センターまでご連絡ください。
    [マイクロソフト セキュリティ情報センター](http://www.microsoft.com/japan/security/sicinfo.mspx)
-   その他、製品に関するご質問は、マイクロソフト プロダクト サポートまでご連絡ください。マイクロソフトでは、お問い合わせの内容が弊社製品の不具合が原因である場合、無償またはインシデントの未消費にてサポートをご提供いたします。
    [マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://support.microsoft.com/select/?target=assistance)
-   製品のサポート期間の詳細は、[マイクロソフト サポート ライフサイクル Web サイト](http://www.microsoft.com/lifecycle)をご参照ください。製品別情報の詳細は、同様にマイクロソフト サポート ライフサイクル Web サイトの [製品を探す](http://support.microsoft.com/default.aspx?scid=fh;ja;complifeport)からご確認ください。

**詳細情報** :

-   US マイクロソフトセキュリティ情報（MS04-037）  
    [http://www.microsoft.com/technet/security/bulletin/ms04-037.mspx](http://technet.microsoft.com/security/bulletin/ms04-037)
-   サポート技術情報 （KB） 文書番号 ： 841356  
    [\[MS04-037\] Windows シェルの脆弱性により、リモートでコードが実行される](http://support.microsoft.com/kb/841356)

**更新履歴** :

-   2004/10/13: このセキュリティ情報ページを公開しました。
-   2004/10/25: Program Group Converter の脆弱性に対する回避策である .grp ファイルと grpconv.exe アプリケーションの関連付けを削除する方法が、Windows XP および Windows 2003 でのみ有効なことを追記しました。
-   2005/02/16 : このセキュリティ情報ページを更新し、Windows NT Server 4.0 Terminal Server Edition Service Pack 6のセキュリティ更新プログラムについての既知の問題が[マイクロソフト サポート技術情報 841356](http://support.microsoft.com/kb/841356) で説明されていることを「警告」欄に追加しました。また、このセキュリティ更新プログラムは、マイクロソフト セキュリティ情報 [MS04-024](http://technet.microsoft.com/security/bulletin/ms04-024) で最初に説明された更新プログラムに置き換わるものではないことをお知らせしました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。-

*Built at 2014-04-18T01:50:00Z-07:00*
