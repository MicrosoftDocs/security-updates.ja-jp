---
TOCTitle: 'MS04-013'
Title: 'マイクロソフト セキュリティ情報 MS04-013 - 緊急'
ms:assetid: 'ms04-013'
ms:contentKeyID: 61228561
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms04-013(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS04-013 - 緊急
===============================================

Outlook Express 用の累積的な修正プログラム (837009)
---------------------------------------------------

公開日: 2004年4月14日 | 最終更新日: 2004年4月20日

[](http://www.microsoft.com/japan/security/bulletins/ms04-013e.mspx)

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:** Microsoft® Outlook Express® をインストールされているお客様

**脆弱性の影響** **:** リモートでコードが実行される

**最大深刻度**: 緊急

**推奨する対応策** **:** お客様は直ちにこの累積的な更新プログラムをインストールして下さい。

**含まれる過去の更新プログラム** **:** このセキュリティ更新プログラムは、[MS03-014](http://technet.microsoft.com/security/bulletin/ms03-014) でリリースされた Outlook Express 用の累積的なセキュリティ更新プログラムおよび以前にリリースされた Outlook Express のすべての累積的なセキュリティ更新プログラムを置き換えるものです。

**警告** **:** なし

**テストしたソフトウェアおよび更新プログラムのダウンロード先**

**影響を受けるソフトウェア** **:**

-   Microsoft Windows NT® Workstation 4.0 Service Pack 6a
-   Microsoft Windows NT Server 4.0 Service Pack 6a
-   Microsoft Windows NT Server 4.0 Terminal Server Edition, Service Pack 6
-   Microsoft Windows 2000 Service Pack 2, Service Pack 3, Service Pack 4
-   Microsoft Windows XP, Microsoft Windows XP Service Pack 1
-   Microsoft Windows XP 64-Bit Edition Service Pack 1
-   Microsoft Windows XP 64-Bit Edition Version 2003
-   Microsoft Windows Server® 2003
-   Microsoft Windows Server 2003, 64-Bit Edition
-   Microsoft Windows 98、Microsoft Windows 98 Second Edition (SE)、Microsoft Windows Millennium Edition - このプラット フォームに関する詳細は、「よく寄せられる質問」をご覧ください。

**テストした** **Microsoft Windows** **のコンポーネント** **:**

**影響を受けるコンポーネント** **:**

この問題に対する修正は、MS04-018 以降の累積的な更新プログラムに含まれました。最新の累積的な更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/) または、[こちら](http://technet.microsoft.com/security/bulletin/ms04-018)の Web サイトから入手できます。

この問題に対する日本語版更新プログラムは、次のサイトからダウンロードできます。

|                                                                                                                                                    | PC/AT およびPC-9800                                                                                                                                                                               |
|----------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Microsoft Outlook Express 5.5 SP2![](../../images/Dn636384.mu_s(ja-JP,Security.10).gif)                                     | [![](../../images/Dn636384.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=88d8f9dc-589a-4ce5-bb04-ccedcb8addba&displaylang=ja) |
| Microsoft Outlook Express 6![](../../images/Dn636384.mu_s(ja-JP,Security.10).gif)                                           | [![](../../images/Dn636384.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=dceb332e-cae4-4743-b6ab-edc1cd625ae0&displaylang=ja) |
| Microsoft Outlook Express 6 SP1![](../../images/Dn636384.mu_s(ja-JP,Security.10).gif)                                       | [![](../../images/Dn636384.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=925628bd-1b5f-4b21-8db6-ede1c73f97b5&displaylang=ja) |
| Microsoft Outlook Express 6 SP1 (64 Bit Edition)![](../../images/Dn636384.mu_s(ja-JP,Security.10).gif)                      | [![](../../images/Dn636384.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=dedba3ea-05ec-45af-8795-5f785d83ca77&displaylang=ja) |
| Windows Server 2003 上の Microsoft Outlook Express 6![](../../images/Dn636384.mu_s(ja-JP,Security.10).gif)                  | [![](../../images/Dn636384.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=1c44fb27-6a9d-42ae-8e06-3adbb7896bcd&displaylang=ja) |
| Windows Server 2003 (64 Bit Edition) 上の Microsoft Outlook Express 6![](../../images/Dn636384.mu_s(ja-JP,Security.10).gif) | [![](../../images/Dn636384.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=c765e4f3-19a4-45cf-be99-28c136b14e30&displaylang=ja) |

![](../../images/Dn636384.dl_arrow(ja-JP,Security.10).jpg)このマークをクリックして、更新プログラムをダウンロードしてください。
更新プログラムをダウンロードおよびインストールする方法は、[更新プログラムのダウンロード方法](http://www.microsoft.com/japan/security/bulletins/dcsteps_vista.mspx)および[更新プログラムのインストール方法](http://www.microsoft.com/japan/security/bulletins/instsecupdate_vista.mspx)をご覧ください。

![](../../images/Dn636384.mu_s(ja-JP,Security.10).gif)このマークの付いている更新プログラムは [Microsoft Update](http://update.microsoft.com/microsoftupdate/) からインストールすることもできます。
Microsoft Update の利用方法については以下のサイトを参照してください。

-   Microsoft Update 利用の手順
    <http://www.microsoft.com/japan/athome/security/update/j_musteps.mspx>

上記のソフトウェアのテストを行い、この脆弱性による影響を評価しました。それ以前のバージョンに関してはサポートの対象となっていないため、この脆弱性による影響は不明です。
ご使用中の製品およびバージョンのサポート ライフ サイクルを確認するためには、[マイクロソフト サポート ライフサイクル](http://support.microsoft.com/lifecycle/) の Web サイトをご覧下さい。

### 詳細

技術的な詳細
------------

<span></span>
**要点** **:**

これは Outlook Express 5.5 および Outlook Express 6 用に以前リリースされたすべての更新プログラムの機能を含む累積的な更新プログラムです。さらに、新たに確認された脆弱性を排除します。攻撃者がその脆弱性を悪用した場合、影響を受けるコンピュータ上のファイルにアクセスし、完全制御を取得する可能性があります。これは、コンピュータ上で Outlook Express が既定の電子メール プログラムとして使用されていない場合にも起こる可能性があります。

マイクロソフトは、この累積的な更新プログラムを直ちにインストールすることを推奨いたします。

**深刻度および脆弱性識別番号** **:**

| 脆弱性識別番号                                                                                                                  | 脆弱性の影響                 | Outlook Express 5.5 SP2 | Outlook Express 6 | Outlook Express 6 SP1 | Outlook Express 6 (64 Bit Edition) | Windows Server 2003 上の Outlook Express 6 | Windows Server 2003 上の Outlook Express 6 (64 Bit Edition) |
|---------------------------------------------------------------------------------------------------------------------------------|------------------------------|-------------------------|-------------------|-----------------------|------------------------------------|--------------------------------------------|-------------------------------------------------------------|
| **MHTML URL** **のプロセスの脆弱性** **-** [**CAN-2004-0380**](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0380) | リモートでコードが実行される | 緊急                    | 緊急              | 緊急                  | 緊急                               | 緊急                                       | 緊急                                                        |

上記の[評価](http://technet.microsoft.com/security/bulletin/rating)はこの脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。

このセキュリティ更新プログラムに関するよく寄せられる質問
--------------------------------------------------------

<span></span>
**この累積的な更新プログラムによって置き換えられる更新プログラムはどれですか?**

この累積的な更新プログラムは、以前にリリースされた Outlook Express 5.5 および Outlook Express 6 用のすべての更新プログラムを置き換えるものです。旧バージョンの Outlook Express の更新プログラムに該当するセキュリティ情報番号およびオペレーティング システムは、以下の表の通りです。

| セキュリティ情報番号                                                    | Outlook Express 5.5 SP2 | Outlook Express 6 | Outlook Express 6 SP1 | Outlook Express 6 (64 Bit Edition) | Windows Server 2003 上の Outlook Express 6 | Windows Server 2003 上の Outlook Express 6 (64 Bit Edition) |
|-------------------------------------------------------------------------|-------------------------|-------------------|-----------------------|------------------------------------|--------------------------------------------|-------------------------------------------------------------|
| [**MS03-014**](http://technet.microsoft.com/security/bulletin/ms03-014) | 置き換えられる          | 置き換えられる    | 置き換えられる        | 置き換えられる                     | 対象外                                     | 対象外                                                      |

**主にどのようなコンピュータがこの脆弱性による危険にさらされますか?**

Outlook Express は、既定で、サポートされるすべての Windows コンピュータにインストールされます。マイクロソフトは、この累積的な更新プログラムをすべてのコンピュータに直ちにインストールすることを推奨いたします。しかし、攻撃者がこの脆弱性を悪用し、悪意のある操作を行うには、ユーザーがコンピュータにログオンし、電子メールを読み取るか、または Web サイトを訪問することが必要条件となります。そのため、電子メールの読み取り、または Internet Explorer が頻繁に使用されているすべてのコンピュータ （ユーザーのワークステーションなど） は、この脆弱性による危険にさらされる可能性が最も高いと言えます。通常電子メールの読み取りや、Web サイトの閲覧を行っていないコンピュータ （ほとんどのサーバー コンピュータなど） がさらされる危険性は低減されます。

**Windows Server 2003** **上で** **Internet Explorer** **を実行しています。これによって、この脆弱性の問題が緩和されますか?**

いいえ。Windows Server 2003 上の Internet Explorer は既定でセキュリティ強化の構成と呼ばれる制限モードで実行されますが、それにより、この脆弱性の問題が緩和されることはありません。

**Outlook Express** **を使用して電子メールまたはニュースグループを読んではいません。この脆弱性による危険にさらされますか?**

はい。Outlook Express は既定でインストールされるため、この累積的な更新プログラムを適用するまで、危険にさらされることになります。攻撃者は、Outlook Express が既定で電子メール プログラムとして使用されていない場合でも、悪質な Web サイトまたは HTML 形式の電子メールによって、この脆弱性が悪用される可能性があります。

**Windows XP Service Pack 1 (SP1)、Windows 2000 Service Pack 3** **またはそれ以降のバージョンを使用しています。プログラムのアクセスと既定の設定ツールを使用して、Outlook Express** **を既定の電子メールプログラムから削除しました。その場合でもこの脆弱性からの危険にさらされますか?**

はい。Outlook Express は既定でインストールされるため、この累積的な更新プログラムを適用するまで、危険にさらされます。\[プログラムのアクセスと既定の設定\] を使用して、Outlook Express が既定で電子メール プログラムとして選択されていない場合でも、攻撃者は悪質な Web サイトまたは HTML 形式の電子メールによって、この脆弱性を悪用しようとする可能性があります。\[プログラムのアクセスと既定の設定\] に関する詳細は、次の [Web サイト](http://msdn2.microsoft.com/en-us/library/aa969379.aspx) （英語情報） をご覧ください。

**Microsoft Baseline Security Analyzer (MBSA)** **を使いコンピュータをスキャンして、この更新プログラムをインストールする必要がないという結果がでました。このような結果でも、この脆弱性による危険にさらされますか?**

現在 Microsoft Baseline Security Analyzer では、Outlook Express のセキュリティ関連の更新プログラムのスキャンが行われません。しかし、[Microsoft Update](http://update.microsoft.com/microsoftupdate/) では、必要な場合、この更新プログラムが正しく検出され、インストールされます。MBSA および MBSA が現在スキャンを行う製品に関する詳細は、次の [Web サイト](http://technet.microsoft.com/ja-jp/security/cc184924.aspx)をご覧ください。

**SMS** **を使用して、この更新プログラムを検出することができますか?**

SMS は、MBSA を使用して更新プログラムのチェックを行いますが、この更新プログラムは、MBSA によって検出されません。しかし、このセキュリティ情報のファイル情報およびレジストリ キー情報を使用し、SMS に特定のファイルおよびレジストリ キーの集合体のクエリを書き込み、この脆弱性の影響を受けるコンピュータを検出することができます。

**SMS** **を使用して、この更新プログラムを展開するにはどのようにしたらよいですか?**

SMS のソフトウェアの配布の機能を使用して、この更新プログラムを展開するための方法は、次の [Web サイト](http://www.microsoft.com/japan/technet/prodtechnol/sms/default.mspx)をご覧ください。

**Windows 98、Windows 98 Second Edition** **および** **Windows Millennium Edition** **のサポートの延長により、これらのプラットフォーム用のセキュリティ更新プログラムのリリースにどのような影響がありますか？**

マイクロソフトは、これらのオペレーティング システム上で、深刻度が「緊急」のセキュリティ問題がある場合にのみ、セキュリティ更新プログラムをリリースする予定です。このサポート期間中は、「緊急」以外のセキュリティ問題のための更新プログラムは提供されません。これらのオペレーティング システムのマイクロソフト サポート ライフサイクル ポリシーに関する詳細は、こちらの [Web サイト](http://support.microsoft.com/default.aspx?pr=lifean1)をご覧ください。深刻度に関する詳細は、こちらの [Web サイト](http://technet.microsoft.com/security/bulletin/rating)をご覧ください。

**Windows 98、Windows 98 Second Edition** **または** **Windows Millennium Edition** **はこのセキュリティ情報で対応する脆弱性によって深刻な影響を受けますか?**

はい。この脆弱性の、Windows 98、Windows 98 Second Edition または Windows Millennium Edition の深刻度はいずれも「緊急」と評価されています。

脆弱性の詳細
------------

<span></span>
#### MHTML URL のプロセスの脆弱性 - CAN-2004-0380:

特別な細工がされた MHTML URL が処理される方法に、リモートでコードが実行される脆弱性が存在します。それにより、Internet Explorer のマイ コンピュータのセキュリティ ゾーンで攻撃者の HTML コードが実行される可能性があります。これにより、攻撃者によって該当のコンピュータの完全な制御が取得される可能性があります。

#### 「MHTML URL のプロセスの脆弱性」の問題を緩和する要素 - CAN-2004-0380:

-   Web ベースの攻撃シナリオで、攻撃者がこの脆弱性を悪用するには、この脆弱性を悪用する Web ページを含む Web サイトをホストすることが攻撃者にとっての必要条件となります。攻撃者が、ユーザーをそのような悪質なサイトに強制的に訪問させるようにすることはできません。その代わり、攻撃者は通常、攻撃者のサイトに移動するリンクをユーザーにクリックさせることにより、そのような Web サイトにユーザーを訪問させるように誘導することが必要条件となります。
-   既定で、Outlook Express 6、Outlook 2002 および Outlook 2003 では、HTML 形式の電子メール メッセージは制限付きサイト ゾーンで開かれます。また、Outlook 98 および Outlook 2000 では、[Outlook 98 電子メール セキュリティ アップデート](http://www.microsoft.com/downloads/details.aspx?familyid=48b0bc6a-b123-4f48-b27d-119078b4819f&displaylang=ja)または、[Outlook 2000 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)がインストールされている場合、HTML 形式の電子メール メッセージが制限付きサイトゾーンで開かれます。制限付きサイト ゾーンは、この脆弱性を悪用した攻撃を低減させる手助けとなります。

    以下の条件のすべてが満たされる場合、HTML 形式の電子メールを悪用した方法による攻撃のリスクは、大幅に低減します。

    -   マイクロソフト セキュリティ情報 [MS03-040](http://technet.microsoft.com/security/bulletin/ms03-040) またはそれ以降の Internet Explorer 用の累積的な更新プログラムに含まれる更新を適用している場合
    -   Internet Explorer 6 またはそれ以降のバージョンを使用している場合
    -   Outlook 電子メール セキュリティ アップデートまたは Microsoft Outlook Express 6 またはそれ以降のバージョン、または Microsoft Outlook 2000 SP2 またはそれ以降のバージョンを既定の構成で使用している場合

-   攻撃者にこの脆弱性が悪用された場合、ユーザーと同じ特権が取得される可能性があります。ユーザーのアカウントが、そのコンピュータ上で低い特権しか設定されていない場合、管理者特権で実行しているユーザーよりも危険にさらされる可能性は低くなります。
    -   マイクロソフト セキュリティ情報に含まれている更新プログラム

#### 「MHTML URL のプロセスの脆弱性」の回避策 - CAN-2004-0380

マイクロソフトは次の回避策のテストを行ないました。これらの回避策は根本的な脆弱性を修正しませんが、既知の攻撃の方法を阻止する手助けとなります。回避策は機能の低下の原因となる場合もあります。その場合、下記に記します。

-   **Internet Explorer** **のマイコンピュータゾーンのセキュリティ設定の強化**

    攻撃者がこの脆弱性を悪用し、マイ コンピュータのセキュリティ ゾーンで HTML コードを実行する可能性があるため、マイ コンピュータのセキュリティ ゾーンの既定の設定を制限し、この脆弱性による影響を緩和することができます。これらの設定に関する詳細およびこれらの既定の設定の変更によって起こる可能性のある影響に関しては、マイクロソフト サポート技術情報 [833633](http://support.microsoft.com/kb/833633) をご覧ください。

    **注意** **:** マイクロソフトは、Internet Explorer のセキュリティ設定へのこれらの変更を、最終的手段としてのみ検討することを推奨いたします。これらの変更により、Windows のプログラムおよびコンポーネントのいくつかの機能が失われる可能性があります。運用環境にこれらの変更を追加する前に広範囲なテストを行い、ミッション クリティカルなプログラムがすべてのユーザーに引き続き適切に機能するように検証してください。

-   **Outlook 2000 SP1** **またはそれ以前のバージョンを使用している場合、Outlook** **電子メールセキュリティアップデートをインストールする**

    既定で、Outlook Express 6、Outlook 2002 および Outlook 2003 では、HTML 形式の電子メール メッセージは制限付きサイト ゾーンで開かれます。また、Outlook 98 および Outlook 2000 では、[Outlook 98 電子メール セキュリティ アップデート](http://www.microsoft.com/downloads/details.aspx?familyid=48b0bc6a-b123-4f48-b27d-119078b4819f&displaylang=ja)または、[Outlook 2000 電子メール セキュリティ アップデート](http://office.microsoft.com/japan/downloads/2000/out2ksec.aspx)がインストールされている場合、HTML 形式の電子メール メッセージが制限付きサイトゾーンで開かれます。

    これらの製品のいずれかをご使用のお客様は、電子メール中の不正なリンクをクリックしない限り、この脆弱性を悪用した電子メールによる攻撃の危険は低減されます。

-   **Outlook 2002** **およびそれ以降のバージョンまたは** **Outlook Express 6 SP1** **およびそれ以降のバージョンを使用している場合、電子メールをテキスト形式で読み取り、HTML** **形式の電子メールを悪用した攻撃からコンピュータを保護する**

    Office XP Service Pack 1 またはそれ以降のバージョンを適用した Microsoft Outlook 2002 ユーザー、または Internet Explorer 6 Service Pack 1 を適用した Outlook Express 6 ユーザーは、デジタル署名されていない電子メール メッセージまたは暗号化されていない電子メール メッセージをすべてプレーン テキストのみで表示させる機能を有効にできます。

    デジタル署名、または暗号化された電子メール メッセージは、この設定による影響を受けることはなく、元の形式でメールを読み取ることができます。Outlook 2002 のこの設定を有効にする方法の詳細は、マイクロソフト サポート技術情報 [307594](http://support.microsoft.com/kb/307594) をご覧ください。
    この設定を Outlook Express 6 で有効にするための情報は、マイクロソフト サポート技術情報 [291387](http://support.microsoft.com/kb/291387) をご覧ください。

**回避策の影響** **:**

テキスト形式で表示された電子メールには、画像、特殊フォント、アニメーション、または他のリッチ コンテンツは含まれません。さらに次の事項があります。

-   変更はプレビュー ウィンドウおよび開いているメッセージに適用されます。
-   写真は紛失を避けるため、添付ファイルとなります。
-   メッセージ ストア内のメッセージは依然としてリッチ テキストまたは HTML 形式であるため、オブジェクト モデル （カスタム コード ソリューション） は、予期しない動作をする場合があります。

#### 「MHTML URL のプロセスの脆弱性」のよく寄せられる質問 - CAN-2004-0380:

**どのようなことが起こる可能性がありますか?**

これは、リモートでコードが実行される脆弱性です。攻撃者にこの脆弱性が悪用され、Internet Explorer のマイ コンピュータのセキュリティ ゾーンで任意のコードが実行される可能性があります。攻撃者はマイ コンピュータ ゾーンで HTML コードを実行し、影響を受けるコンピュータの完全な制御を取得する可能性があります。攻撃者は、そのコンピュータ上でプログラムのインストール、データの表示、変更、削除、完全な資格情報を持つアカウントを新規で作成するなど、任意の操作を実行する可能性があります。

**何が原因で起こりますか?**

この脆弱性は、Outlook Express で、特別な細工がされた [MIME Encapsulation of Aggregate HTML](http://msdn2.microsoft.com/en-us/library/ms988648.aspx) (英語情報) (MHTML) URL が処理される方法が原因で起こります。

**MHTML URL** **とは何ですか?**

MHTML とは、 [MIME Encapsulation of Aggregate HTML](http://msdn2.microsoft.com/en-us/library/ms988648.aspx) (英語情報) の意味で、電子メール メッセージの本文内の HTML コンテンツを送るために使用される MIME (Multipurpose Internet Mail Extensions) 構造を定義するインターネット標準です。Windows の MHTML URL ハンドラ は、Outlook Express の一部で、アプリケーション内でレンダリングする MHTML 形式でエンコードされた文書を有効にする、URL の 1 つの種類 (MHTML://) を提供します。そのため、Internet Explorer などのアプリケーションは、Outlook Express を使用して、MHTML 形式でエンコードされた文書を処理します。

**Internet Explorer** **のセキュリティゾーンとは何ですか?**

[Internet Explorer のセキュリティ ゾーン](http://support.microsoft.com/kb/174360)とは、オンライン コンテンツをカテゴリ、またはその信頼度に基づいたゾーンに分類するシステムです。特定の Web ドメインは、各ドメインのコンテンツがどの程度信頼されているかにより、ゾーンに割り当てられます。そしてそのゾーンで、そのゾーンの設定に基づき Web コンテンツの権限が制限されます。既定で、ほとんどのインターネット ドメインはインターネット ゾーンの一部として取り扱われます。既定で、インターネット ゾーンのポリシーにより、スクリプトやそのほかのアクティブなコードがローカル コンピュータ上のリソースへのアクセスを取得することを防ぐよう設定がされます。

**この脆弱性により、攻撃者は何を行う可能性がありますか?**

攻撃者はこの脆弱性を悪用し、ユーザーのコンピュータ上にアクセスし、任意のコードを実行する可能性があります。このようなコードは、現在ログオンしているユーザーのセキュリティ コンテキストで実行される可能性があります。

**攻撃者はどのようにこの脆弱性を悪用する可能性がありますか?**

リモートでコードが実行される脆弱性が存在し、特別な細工がされた MHTML URL が処理される際に、Internet Explorer のマイ コンピュータのセキュリティ ゾーンで攻撃者の HTML コードが実行される可能性があります。これにより、攻撃者は該当のコンピュータの完全な制御が取得される可能性があります。
Web ベースの攻撃シナリオで、攻撃者がこの脆弱性を悪用するには、この脆弱性を悪用するための Web ページを含む Web サイトをホストすることが必要条件となります。攻撃者は、ユーザーをそのような悪質なサイトに強制的に訪問させるようにすることはできません。その代わり、攻撃者は通常、攻撃者のサイトに移動するリンクをユーザーにクリックさせることにより、そのような Web サイトにユーザーを訪問させるように誘導します。また攻撃者は、この脆弱性を悪用するように設計した HTML 形式の電子メール メッセージを作成し、ユーザーがそのメッセージを表示するように誘導する可能性があります。ユーザーが攻撃者の Web サイトを訪問するか、または攻撃者が作成した HTML 形式の電子メール メッセージを表示すると、ユーザーのコンピュータのマイ コンピュータ ゾーンで、攻撃者の任意の HTML コードが実行される恐れがあります。攻撃者はこの脆弱性を悪用し、ユーザーのコンピュータ上のファイルにアクセスし、任意のコードを実行する可能性があります。このようなコードは、その際にログオンしているユーザーのセキュリティ コンテキストで実行される可能性があります。

**更新プログラムは何を修正しますか?**

この更新プログラムは、Outlook Express が MHTML URL を処理する方法を変更することによってこの脆弱性を排除します。

セキュリティ更新プログラムに関する情報
--------------------------------------

<span></span>
**必要条件** **:**

マイクロソフトは、この脆弱性による影響を受けるかどうかを確認し、このセキュリティ情報で説明されている更新プログラムがこの脆弱性を解決することを確認するため、このセキュリティ情報に記載されている Windows および Outlook Express のテストを行いました。

Outlook Express 6 Service Pack 1 (SP1) 用の更新プログラムをインストールするには、以下の Windows のバージョンのいずれかで、Internet Explorer 6 SP1 (バージョン 6.00.2800.1106) を実行していることが必要となります。

-   Microsoft Windows 98
-   Microsoft Windows 98 Second Edition
-   Microsoft Windows Millennium Edition
-   Microsoft Windows NT® Workstation 4.0 Service Pack 6a
-   Microsoft Windows NT Server 4.0 Service Pack 6a
-   Microsoft Windows NT Server 4.0 Terminal Server Edition, Service Pack 6
-   Microsoft Windows 2000 Service Pack 2, Service Pack 3, Service Pack 4
-   Microsoft Windows XP
-   Microsoft Windows XP Service Pack 1
-   Microsoft Windows XP 64-Bit Edition, Service Pack 1

この更新プログラムの、Windows Server 2003 向けの Outlook Express 6 用バージョンをインストールするには、Windows Server 2003 (32-bit または 64-bit) 上で Internet Explorer 6 (バージョン 6.00.3790.0000) を実行するか、または Windows XP 64-Bit Edition, Version 2003 上で Internet Explorer 6 (バージョン 6.00.3790.0000) を実行している必要があります。

この更新プログラムの Outlook Express 6 用のバージョンをインストールするには、32-bit 版の Windows XP 上で Internet Explorer 6 (バージョン 6.00.2600.0000) を実行している必要があります。

この更新プログラムの Outlook Express 5.5 用のバージョンをインストールするには、以下のバージョンのいずれかを実行している必要があります。

-   Windows 2000 SP4 上で Internet Explorer 5.01 Service Pack 4 (バージョン 5.00.3700.1000) を実行
-   Windows 2000 SP3 上で Internet Explorer 5.01 Service Pack 3 (バージョン 5.00.3502.1000) を実行
-   Windows Millennium Edition 上で Internet Explorer 5.5 Service Pack 2 (バージョン 5.50.4807.2300) を実行

**注** **:** このページに記載されていない Windows、Outlook Express および Internet Explorer のバージョンはサポートの対象となっていません。このページで説明されているアップデート パッケージの中には、Windows および Outlook Express のそれらのサポート対象外のバージョンにインストールできるものがありますが、マイクロソフトはそれらのバージョンが、この脆弱性による影響を受けるかどうか、またはこの更新プログラムがこの脆弱性を解決するかどうかを確認するためのテストを行っていません。マイクロソフトは、Windows および Outlook Express のサポートされるバージョンにアップグレードし、適切な更新プログラムを適用することを推奨いたします。
実行している Internet Explorer のバージョンを確認する方法は、マイクロソフト サポート技術情報 [164539](http://support.microsoft.com/kb/164539) をご覧ください。
Windows コンポーネントのサポート ライフ サイクルを確認するためには、[マイクロソフト サポート ライフサイクル](http://support.microsoft.com/lifecycle/) の Web サイトをご覧下さい。
Internet Explorer 6 用の最新の Service Pack を入手する方法に関する詳細は、マイクロソフト サポート技術情報 [328548](http://support.microsoft.com/kb/328548) をご覧ください。
Internet Explorer 5.5 用の最新の Service Pack を入手する方法に関する詳細は、マイクロソフト サポート技術情報 [276369](http://support.microsoft.com/kb/276369) をご覧ください。
Internet Explorer 5.01 用の最新の Service Pack を入手する方法に関する詳細は、マイクロソフト サポート技術情報 [267954](http://support.microsoft.com/kb/267954) をご覧ください。

**再起動の必要性** **:**

この更新プログラムの適用後に、コンピュータの再起動を必要としない場合があります。しかし、必要なファイルが使用中の場合、この更新プログラムを適用後、再起動をする必要があります。この場合、コンピュータを再起動する必要があることを示すメッセージが表示されます。この更新プログラムでは、コンピュータを再起動した後、管理者ログオンを使用する必要はありません。

このセキュリティ更新プログラムの Windows Server 2003 のバージョン (Windows XP 64-Bit Edition, Version 2003 を含む) では、以下のセットアップ スイッチがサポートされます。

**/help:** インストール スイッチの一覧を表示します
**セットアップモード**
**/quiet:** QUIET モード (ユーザー入力を必要としません。表示もしません)
**/passive:** 無人モード (進行状況バーのみ)
**/uninstall:** パッケージをアンインストールします
**再起動オプション**
**/norestart:** インストールの完了後、再起動しません
**/forcerestart:** インストール後、再起動します
**特別なオプション**
**/l:** インストール済みの Windows 更新プログラムまたは更新パッケージを表示します
**/o:** 確認メッセージを表示せずに OEM ファイルを上書きします
**/n:** アンインストールに必要なファイルのバックアップを作成しません
**/f:** シャットダウン時に他のプログラムを強制終了します
**注** **:** これらのスイッチを 1 つのコマンド ラインに組み込むことができます。 旧バージョンとの互換性のため、このセキュリティ更新プログラムは、セットアップ ユーティリティの以前のバージョンによって使用されるセットアップ スイッチもサポートしています。サポートされるインストール スイッチについての追加情報はマイクロソフト サポート技術情報 [262841](http://support.microsoft.com/kb/262841) をご覧ください。

**適用に関する情報** **:**

ユーザーの操作なしでセキュリティ更新プログラムをインストールするためには、Windows Server 2003 のコマンド プロンプトで、次のコマンド ラインを使用してください。

Windows Server 2003 32 ビット用のこのセキュリティ更新プログラムをユーザーの操作なしでインストールするためには、次のコマンドラインを使用して下さい。

**windowsserver2003-kb837009-x86-jpn.exe /quiet /passive**

コンピュータを強制的に再起動させないでこのセキュリティ更新プログラムをインストールするためには、次のコマンドラインを使用して下さい。

**windowsserver2003-kb837009-x86-jpn.exe /norestart**

**注** **:** これらのスイッチを 1 つのコマンド ラインに組み込むことができます。過去のものとの互換性のため、このセキュリティ更新プログラムは、セットアップ ユーティリティの以前のバージョンにより使用されるセットアップ スイッチもサポートします。しかし、このサポートは今後のセキュリティ更新プログラムで削除される可能性があるため、これらの以前のスイッチの使用は停止して下さい。

この累積的なセキュリティ更新プログラムのためのほかのアップデート パッケージでは、以下のセットアップ スイッチがサポートされます。

**/q**: ファイルが抽出される時、自動モードを使用、またはメッセージを表示しません
**/q:u**: User-Quiet モードを使用します。User-Quiet モードはユーザーにいくつかのダイアログ ボックスを表示します
**/q:a**: Use Administrator-Quiet モードを使用します。Administrator-Quiet モードはユーザーにダイアログ ボックスを表示しません
**/t: path**: セットアップまたはファイルの抽出のターゲットフォルダにより使用される一時フォルダの場所を指定します (/c スイッチを使用する場合)
**/c**: ファイルをインストールせずに抽出します。/t: path スイッチを指定していない場合、ターゲットフォルダについて確認メッセージが表示されます
**/c: path**: Setup .inf ファイルまたは .exe ファイルのパスおよび名前を指定します
**/r:n**: インストール後、コンピュータを再起動しません
**/r:i**: 再起動が必要である場合、ユーザーにコンピュータを再起動するよう確認メッセージを表示します (このスイッチが /q:a スイッチと使用される場合を除く)
**/r:a**: インストール後、コンピュータを常に再起動します
**/r:s**: ユーザーに確認メッセージを表示せずに、インストール後コンピュータを再起動します
**/n:v**: バージョンをチェックしません

**注** **:** セットアップ スイッチに関する詳細は、マイクロソフト サポート技術情報 [197147](http://support.microsoft.com/kb/197147) をご覧ください。

たとえば、ユーザーの操作なしで、またコンピュータの再起動を強制せずにこの更新プログラムをインストールするためには、次のコマンドラインを使用して下さい。

**q837009.exe /q:a /r:n**

**更新プログラムが正しくインストールされたかどうか確認する方法** **:**

コンピュータにこの累積的な更新プログラムがコンピュータにインストールされたことを確認するためには、次のステップにしたがってください。

-   Internet Explorer を起動し、\[ヘルプ\] を選択し、Internet Explorer の \[バージョン情報\] をクリックします。\[更新バージョン\] のフィールドに Q837009 が表示されていることを確認して下さい。ただし、この方法は Windows Server 2003 または Windows XP 64-Bit Edition Version 2003 では使用できません。これらのオペレーティング システム用のパッケージをインストールしても \[更新バージョン\] フィールドは更新されないためです。
-   使用しているコンピュータ上の更新されたファイルのバージョンをこの資料の 「ファイル情報」 に記載されているファイルと比較します。
-   以下のレジストリ エントリが存在することを確認します。
    Windows Server 2003 および Windows XP 64-Bit Edition Version 2003 の場合:
    以下のレジストリ キーに Installed 値 (DWORD) があり、データ値が 1 に設定されていることを確認します。

**HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Hotfix\\KB837009**

上記以外のバージョンの Windows の場合:
以下のレジストリ キーに IsInstalled 値 (DWORD) があり、データ値が 1 に設定されていることを確認します。

**HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Active Setup\\Installed Components\\{ 2cc9d512-6db6-4f1c-8979-9a41fae88de0}**

**削除に関する情報** **:**

この更新プログラムを削除するには、コントロール パネルの \[プログラムの追加と削除\] または \[アプリケーションの追加と削除\] で \[Outlook Express Q837009\] をクリックし、\[変更と削除\] または \[追加と削除\] をクリックします。

Windows Server 2003 および Windows XP 64-Bit Edition Version 2003 の場合、システム管理者は Spunist.exe ユーティリティを使用してこの更新プログラムを削除することができます。Spuninst.exe プログラムは %Windir%\\$NTUninstallKB837009$\\Spuninst フォルダにあります。このユーティリティでは、以下のセットアップ スイッチがサポートされています。

**/?**: インストール スイッチの一覧を表示します
**/u**: 無人モードで実行します
**/f**: コンピュータがシャット ダウンする時、そのほかのプログラムを強制的に閉じます
**/z**: インストールの完了時に再起動しません
**/q**: Quiet モードで実行します (ユーザー入力を必要としません)

その他のバージョンの Windows の場合、システム管理者は ieuninst.exe ユーティリティを使用してこの更新プログラムを削除することができます。ieuninst.exe プログラムは %Windir% フォルダの中にあり、以下のコマンド ライン スイッチをサポートしています。

**/?**: サポートされているスイッチの一覧を表示します
**/z**: インストールの完了時に再起動しません
**/q**: Quiet モードで実行します (ユーザー入力を必要としません)

たとえば、この更新プログラムをメッセージなしで削除するためには、次のコマンドを使用して下さい。

**c:\\windows\\ieuninst /q c:\\windows\\inf\\q837009.inf**

**注** **:** 上記のコマンド ラインでは、Windows が C:\\Windows フォルダにインストールされていることを前提としています。

**ファイル情報** **:**

この更新プログラムの日本語版は次の表に挙げられているファイル属性 (またはそれ以降) を持ちます。
**注** **:** ファイルの依存関係のため、これらの更新プログラムには他のファイルも含まれていることがあります。

オペレーティング システムに特有のセキュリティ更新プログラムに関する詳細は、適切なリンクをクリックしてください。

#### Windows XP、Windows XP SP1、Windows 2000 SP2、Windows 2000 SP3、Windows 2000 SP4、Windows NT 4.0 SP6a、Windows 98、Windows 98 SE および Windows ME 上の Outlook Express 6 SP1

| 日付       | 時間  | バージョン     | サイズ    | ファイル名   | プラットフォーム |
|------------|-------|----------------|-----------|--------------|------------------|
| 2002/10/23 | 16:44 | 6.00.2800.1123 | 75,776    | DIRECTDB.DLL | x86              |
| 2004/03/02 | 13:18 | 6.00.2800.1409 | 593,408   | INETCOMM.DLL | x86              |
| 2004/03/11 | 12:57 | 6.00.2800.1123 | 47,616    | INETRES.DLL  | x86              |
| 2002/10/23 | 16:53 | 6.00.2800.1123 | 44,032    | MSIDENT.DLL  | x86              |
| 2002/10/23 | 16:53 | 6.00.2800.1123 | 56,832    | MSIMN.EXE    | x86              |
| 2004/03/02 | 13:18 | 6.00.2800.1409 | 1,175,040 | MSOE.DLL     | x86              |
| 2002/10/23 | 16:53 | 6.00.2800.1123 | 228,864   | MSOEACCT.DLL | x86              |
| 2004/03/11 | 12:57 | 6.00.2800.1123 | 2,479,616 | MSOERES.DLL  | x86              |
| 2002/10/23 | 16:44 | 6.00.2800.1123 | 91,136    | MSOERT2.DLL  | x86              |
| 2002/10/23 | 16:53 | 6.00.2800.1123 | 93,184    | OEIMPORT.DLL | x86              |
| 2002/10/23 | 16:53 | 6.00.2800.1123 | 55,808    | OEMIG50.EXE  | x86              |
| 2002/10/23 | 16:53 | 6.00.2800.1123 | 31,744    | OEMIGLIB.DLL | x86              |
| 2002/10/23 | 16:53 | 6.00.2800.1123 | 42,496    | WAB.EXE      | x86              |
| 2004/03/02 | 13:43 | 6.00.2800.1409 | 463,360   | WAB32.DLL    | x86              |
| 2002/10/23 | 16:53 | 6.00.2800.1123 | 30,208    | WABFIND.DLL  | x86              |
| 2002/10/23 | 16:53 | 6.00.2800.1123 | 77,824    | WABIMP.DLL   | x86              |
| 2002/10/23 | 16:44 | 6.00.2800.1123 | 27,648    | WABMIG.EXE   | x86              |

#### Windows XP 64-Bit Edition Service Pack 1 の Outlook Express 6 SP1 (64-Bit)

| 日付       | 時間  | バージョン     | サイズ    | ファイル名   | プラットフォーム |
|------------|-------|----------------|-----------|--------------|------------------|
| 2002/11/05 | 9:53  | 6.00.2800.1123 | 251,904   | DIRECTDB.DLL | IA64             |
| 2004/03/02 | 13:24 | 6.00.2800.1409 | 2,201,600 | INETCOMM.DLL | IA64             |
| 2004/03/11 | 13:00 | 6.00.2800.1123 | 47,104    | INETRES.DLL  | IA64             |
| 2002/11/05 | 12:37 | 6.00.2800.1123 | 63,488    | MSIMN.EXE    | IA64             |
| 2004/03/02 | 13:24 | 6.00.2800.1409 | 4,484,096 | MSOE.DLL     | IA64             |
| 2002/11/05 | 12:40 | 6.00.2800.1123 | 729,088   | MSOEACCT.DLL | IA64             |
| 2004/03/11 | 13:00 | 6.00.2800.1123 | 2,479,104 | MSOERES.DLL  | IA64             |
| 2002/11/05 | 9:53  | 6.00.2800.1123 | 300,032   | MSOERT2.DLL  | IA64             |
| 2002/11/05 | 12:42 | 6.00.2800.1123 | 302,080   | OEIMPORT.DLL | IA64             |
| 2002/11/05 | 12:38 | 6.00.2800.1123 | 142,336   | OEMIG50.EXE  | IA64             |
| 2002/11/05 | 12:35 | 6.00.2800.1123 | 73,728    | OEMIGLIB.DLL | IA64             |
| 2002/11/05 | 12:43 | 6.00.2800.1123 | 87,040    | WAB.EXE      | IA64             |
| 2004/03/02 | 13:45 | 6.00.2800.1409 | 1,774,592 | WAB32.DLL    | IA64             |
| 2002/11/05 | 12:37 | 6.00.2800.1123 | 38,912    | WABFIND.DLL  | IA64             |
| 2002/11/05 | 12:42 | 6.00.2800.1123 | 240,640   | WABIMP.DLL   | IA64             |
| 2002/11/05 | 9:53  | 6.00.2800.1123 | 71,680    | WABMIG.EXE   | IA64             |

#### Windows XP の Outlook Express 6

| 日付       | 時間  | バージョン     | サイズ    | ファイル名   | プラットフォーム |
|------------|-------|----------------|-----------|--------------|------------------|
| 2004/03/03 | 13:53 | 6.00.2739.300  | 595,968   | INETCOMM.DLL | x86              |
| 2003/03/13 | 15:03 | 6.00.2720.3000 | 1,175,040 | MSOE.DLL     | x86              |

#### Windows 2003 の Outlook Express 6

| 日付       | 時間  | バージョン    | サイズ  | ファイル名   | プラットフォーム | フォルダ |
|------------|-------|---------------|---------|--------------|------------------|----------|
| 2004/03/03 | 14:53 | 6.00.3790.137 | 605,184 | inetcomm.dll | x86              | rtmgdr   |
| 2004/03/03 | 14:40 | 6.00.3790.137 | 605,184 | inetcomm.dll | x86              | rtmqfe   |

#### Windows 2003 64-Bit Versions および Windows XP 64-Bit Edition, Version 2003 上の Outlook Express 6 (64-Bit)

| 日付       | 時間  | バージョン    | サイズ    | ファイル名    | プラットフォーム | フォルダ |
|------------|-------|---------------|-----------|---------------|------------------|----------|
| 2004/03/03 | 14:57 | 6.00.3790.137 | 2,019,840 | inetcomm.dll  | IA64             | rtmgdr   |
| 2004/03/03 | 14:53 | 6.00.3790.137 | 605,184   | winetcomm.dll | x86              | rtmgdr   |
| 2004/03/03 | 14:39 | 6.00.3790.137 | 2,019,840 | inetcomm.dll  | IA64             | rtmqfe   |
| 2004/03/03 | 14:40 | 6.00.3790.137 | 605,184   | winetcomm.dll | x86              | rtmqfe   |

#### Windows 2000 SP3、Windows 2000 SP4、Windows Millennium Edition 上の Outlook Express 5.5 SP2

| 日付       | 時間  | バージョン     | サイズ    | ファイル名   | プラットフォーム |
|------------|-------|----------------|-----------|--------------|------------------|
| 2004/03/03 | 17:04 | 5.50.4939.300  | 573,200   | INETCOMM.DLL | x86              |
| 2002/10/16 | 09:04 | 5.50.4922.1500 | 1,146,640 | MSOE.DLL     | x86              |

Windows XP 64-Bit Edition Version 2003 (英語版) 用のセキュリティ更新プログラムをインストールするとき、コンピュータ上のアップデート対象ファイルのいずれかが、マイクロソフトの更新プログラムによって過去にアップデートされているかどうかがチェックされます。過去に更新プログラムをインストールしてこれらのファイルのいずれかをアップデートしている場合は、RTMQFE ファイルがコンピュータにコピーされます。それ以外の場合は、RTMGDR ファイルがコンピュータにコピーされます。 関連情報を参照するには、以下の「サポート技術情報」 (Microsoft Knowledge Base) をクリックしてください。
[824994](http://support.microsoft.com/kb/824994) Windows Server 2003 製品アップデート パッケージの内容に関する説明

### その他の情報

**他のセキュリティ更新プログラムの入手先** **:**

他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムは[マイクロソフト ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード探索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。
-   本セキュリティ情報及び公開された更新プログラムは、[TechNet CD サブスクリプション](http://www.microsoft.com/japan/technet/subscriptions/)でも入手可能です。

**他のセキュリティ情報** **:**

-   [Microsoft TechNet Security センター](http://technet.microsoft.com/ja-jp/security/default.aspx) では、製品に関するセキュリティ情報を提供しています。
-   Microsoft Software Update Services : <http://www.microsoft.com/japan/windowsserversystem/updateservices/>
-   Microsoft Baseline Security Analyzer (MBSA) : <http://technet.microsoft.com/ja-jp/security/cc184924.aspx> MBSA ツールのセキュリティ更新プログラムの検出に関する制限は <http://support.microsoft.com/kb/306460> をご覧ください。
-   Windows Update カタログ : <http://support.microsoft.com/kb/323166>
-   Microsoft Update : <http://update.microsoft.com/microsoftupdate/>
-   Office のアップデート : <http://office.microsoft.com/officeupdate/>

**サポート** **:**

更新プログラムについてのご質問は、マイクロソフト プロダクト サポート までご連絡ください。マイクロソフトでは、ご質問の内容が弊社製品の不具合が原因の場合、サポート料金はいただきません。それ以外の場合には、サポート料金を請求させていただきますのでご注意ください。
[マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://www.microsoft.com/japan/security/support/patchqa.mspx)

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS04-013）
    [http://www.microsoft.com/technet/security/bulletin/ms04-013.mspx](http://technet.microsoft.com/security/bulletin/ms04-013)
-   サポート技術情報 （KB） 文書番号 ： 837009
    [\[MS04-013\] Outlook Express 用の累積的なセキュリティ更新プログラム](http://support.microsoft.com/kb/837009)

**更新履歴** **:**

-   2004/04/14 : このセキュリティ情報ページを公開しました。
-   2004/04/20: Outlook Express 5.5 SP2 の 「ファイル情報」 を修正しました。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。

*Built at 2014-04-18T01:50:00Z-07:00*
