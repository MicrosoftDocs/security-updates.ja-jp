---
TOCTitle: 'MS04-032'
Title: 'マイクロソフト セキュリティ情報 MS04-032 - 緊急'
ms:assetid: 'ms04-032'
ms:contentKeyID: 61228680
ms:mtpsurl: 'https://technet.microsoft.com/ja-JP/library/ms04-032(v=Security.10)'
---

Security Bulletin

マイクロソフト セキュリティ情報 MS04-032 - 緊急
===============================================

Microsoft Windows のセキュリティ更新プログラム (840987)
-------------------------------------------------------

公開日: 2004年10月13日 | 最終更新日: 2008年12月11日

[](http://www.microsoft.com/japan/security/bulletins/ms04-032e.mspx)

#### 概要 :

**このセキュリティ情報の対象となるユーザー** **:** Microsoft® Windows® をご使用のお客様

**脆弱性の影響** **:** リモートでコードが実行される

**最大深刻度** **:** 緊急

**推奨する対応策** **:** お客様は、このセキュリティ更新プログラムを直ちにインストールしてください。

**含まれる過去のセキュリティ更新プログラム** **:** このセキュリティ情報で提供される更新プログラムは、以前提供されたいくつかの更新プログラムに置き換わるものです。置き換わる更新プログラムの一覧については、このセキュリティ情報の「よく寄せられる質問」をご覧ください。

**警告** **:** マイクロソフト サポート技術情報 [840987](http://support.microsoft.com/kb/840987) には、このセキュリティ更新プログラムをインストールする際に起こる可能性のある既知の問題に関して説明されています。また、このサポート技術情報には、これらの問題に対する推奨されるソリューションに関する説明も記載されています。詳細は、サポート技術情報 [840987](http://support.microsoft.com/kb/840987) をご覧ください。

**テストしたソフトウェアおよび更新プログラムのダウンロード先** **:**

Windows XP をお使いのお客様におかれましては、この問題に対する修正は Windows XP Service Pack 2 以降に含まれています。Windows XP 日本語版の最新の Service Pack は、以下の Web サイトから入手できます。

<http://www.microsoft.com/japan/windowsxp/sp2/default.mspx>

**影響を受けるソフトウェア** **:**

|                                                                                                                                                                  | PC/AT                                                                                                                                                                                                | PC-9800                                                                                                                                                                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Microsoft Windows NT Server 4.0 Service Pack 6a![](../../images/Dn609957.mu_s(ja-JP,Security.10).gif)                                     | [![](../../images/Dn609957.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=533ae5cd-74ce-470a-8916-8e358084497c&displaylang=ja)    | [![](../../images/Dn609957.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=533ae5cd-74ce-470a-8916-8e358084497c&displaylang=ja-nec)    |
| Microsoft Windows NT Server 4.0 Terminal Server Edition Service Pack 6                                                                                           | [![](../../images/Dn609957.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=%203b871a96-5f64-4432-920f-fa5760df683a&displaylang=ja) | -                                                                                                                                                                                                        |
| Microsoft Windows 2000 Service Pack 3 および Microsoft Windows 2000 Service Pack 4 ![](../../images/Dn609957.mu_s(ja-JP,Security.10).gif) | [![](../../images/Dn609957.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=4a614222-ba0b-4927-856d-d443bbbe1a42&displaylang=ja)    | [![](../../images/Dn609957.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=%204a614222-ba0b-4927-856d-d443bbbe1a42&displaylang=ja-nec) |
| Microsoft Windows XP および Microsoft Windows XP Service Pack 1 ![](../../images/Dn609957.mu_s(ja-JP,Security.10).gif)                    | [![](../../images/Dn609957.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=715e985b-7929-4bd5-9564-5cfe7d528398&displaylang=ja)    | -                                                                                                                                                                                                        |
| Microsoft Windows XP 64-Bit Edition Service Pack 1 ![](../../images/Dn609957.mu_s(ja-JP,Security.10).gif)                                 | [![](../../images/Dn609957.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=99184841-70a8-47c7-9993-44a60e999a40&displaylang=ja)    | -                                                                                                                                                                                                        |
| Microsoft Windows XP 64-Bit Edition Version 2003 ![](../../images/Dn609957.mu_s(ja-JP,Security.10).gif)                                   | [![](../../images/Dn609957.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=%20b4e6bbcf-f5b9-4b2d-8bc4-30911ca4fd9c&displaylang=ja) | -                                                                                                                                                                                                        |
| Microsoft Windows Server 2003 64-Bit Edition ![](../../images/Dn609957.mu_s(ja-JP,Security.10).gif)                                       | [![](../../images/Dn609957.dl_arrow(ja-JP,Security.10).jpg)](http://www.microsoft.com/downloads/details.aspx?familyid=%20b4e6bbcf-f5b9-4b2d-8bc4-30911ca4fd9c&displaylang=ja) | -                                                                                                                                                                                                        |

**影響を受けないソフトウェア** **:**

-   Microsoft Windows XP Service Pack 2

![](../../images/Dn609957.dl_arrow(ja-JP,Security.10).jpg)このマークをクリックして、PC/AT 互換機用または NEC PC-9800 シリーズ用の更新プログラムをダウンロードしてください。
更新プログラムをダウンロードおよびインストールする方法は、[更新プログラムのダウンロード方法](http://www.microsoft.com/japan/security/bulletins/dcsteps_vista.mspx)および[更新プログラムのインストール方法](http://www.microsoft.com/japan/security/bulletins/instsecupdate_vista.mspx)をご覧ください。

![](../../images/Dn609957.mu_s(ja-JP,Security.10).gif)このマークの付いている更新プログラムは [Microsoft Update](http://update.microsoft.com/microsoftupdate/) からインストールすることもできます。
Microsoft Update の利用方法については以下のサイトを参照してください。

-   Microsoft Update 利用の手順
    <http://www.microsoft.com/japan/athome/security/update/j_musteps.mspx>

上記のソフトウェアのテストを行い、この脆弱性による影響を評価しました。それ以前のバージョンに関してはサポートの対象となっていないため、この脆弱性による影響は不明です。ご使用中の製品およびバージョンのサポートライフ サイクルを確認するためには、[マイクロソフト サポート ライフサイクル](http://support.microsoft.com/lifecycle/)の Web サイトをご覧下さい。

### 詳細

要点
----

<span></span>
この更新プログラムは新たに確認され、非公開で報告されたいくつかの脆弱性を解決します。各脆弱性はこのセキュリティ情報の「脆弱性の詳細」欄に説明されています。

攻撃者が、これらの脆弱性の最も深刻なものを悪用した場合、プログラムのインストール、データの表示、変更、削除または完全な特権を持つ新しいアカウントの作成など、影響を受けるコンピュータを完全に制御する可能性があります。

マイクロソフトは、お客様にこの更新プログラムを直ちに適用することを推奨します。

**深刻度および脆弱性識別番号** **:**

| 脆弱性識別番号                                                                                                        | 脆弱性の影響                 | Windows 98, 98 SE, Me | Windows NT 4.0 | Windows 2000 | Windows XP | Windows Server 2003 |
|-----------------------------------------------------------------------------------------------------------------------|------------------------------|-----------------------|----------------|--------------|------------|---------------------|
| Window Management の脆弱性 – [CAN-2004-0207](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0207)         | 特権の昇格                   | 緊急でない            | 重要           | 重要         | 重要       | 重要                |
| 仮想 DOS マシンの脆弱性 - [CAN-2004-0208](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0208)            | 特権の昇格                   | なし                  | 重要           | 重要         | 重要       | 重要                |
| Graphics Rendering Engine の脆弱性 - [CAN-2004-0209](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0209) | リモートでコードが実行される | なし                  | なし           | 緊急         | 緊急       | 緊急                |
| Windows カーネルの脆弱性 - [CAN-2004-0211](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0211)           | サービス拒否                 | なし                  | なし           | なし         | なし       | 重要                |
| **すべての脆弱性の総合的な深刻度**                                                                                    | **-**                        | **緊急でない**        | **重要**       | **緊急**     | **緊急**   | **緊急**            |

この[評価](http://technet.microsoft.com/security/bulletin/rating)は、この脆弱性の影響を受けるシステムの種類、システムの典型的な展開形式およびこの脆弱性がシステムに及ぼす影響に基づいています。

このセキュリティ更新プログラムに関するよく寄せられる質問
--------------------------------------------------------

<span></span>
**なぜこのセキュリティ情報は 2008 年 12 月 11 日に更新されたのですか?**

マイクロソフトは、更新プログラムの安定性または対象となるコンピューターのセキュリティとは関連のない問題のため、Windows Server 2003 パッケージを削除したことをお知らせするために、このセキュリティ情報を更新しました。この更新プログラムを既に適用しているお客様は何も行う必要はありません。Windows 2003 をご使用のお客様で、この更新プログラムを適用しておらず、この問題を懸念される場合、[最新のサービス パック](http://support.microsoft.com/kb/889100)を適用してください。このセキュリティ情報が該当するその他の Windows オペレーティング システムについては、変更はありません。

**なぜこの累積的な更新プログラムはいくつかの報告されたセキュリティ上の脆弱性を解決するのですか?**

この更新プログラムに関連するファイルに、いくつかの問題を解決するために必要な変更が存在したため、この更新プログラムにはこれらの脆弱性対策が含まれています。ユーザーは、ほぼ同一のファイルを含むいくつもの更新プログラムをインストールする代わりに、この更新プログラムのみをインストールすることができます。

**この更新プログラムにより何が置き換えられますか?**

このセキュリティ更新プログラムにより、以前にリリースされたいくつかの更新プログラムが置き換えられます。影響を受けるセキュリティ情報の ID 番号およびオペレーティング システムのバージョンを次の表に記載します。

| セキュリティ情報番号                                                | Windows NT 4.0   | Windows 2000 | Windows XP       | Windows Server 2003 |
|---------------------------------------------------------------------|------------------|--------------|------------------|---------------------|
| [MS02-071](http://technet.microsoft.com/security/bulletin/ms02-071) | 置き換えられない | 置き換わる   | 置き換えられない | 対象外              |
| [MS03-007](http://technet.microsoft.com/security/bulletin/ms03-007) | 置き換えられない | 置き換わる   | 置き換えられない | 対象外              |
| [MS03-013](http://technet.microsoft.com/security/bulletin/ms03-013) | 置き換えられない | 置き換わる   | 置き換わる       | 対象外              |
| [MS03-045](http://technet.microsoft.com/security/bulletin/ms03-045) | 置き換わる       | 置き換わる   | 置き換わる       | 置き換えられない    |

**Windows XP** **を使用していますが、2004** **年** **9** **月** **30** **日に延長サポートが終了しました。しかし、このセキュリティ情報には、Windows XP** **の更新プログラムが含まれます。これはなぜですか？**

Windows XP のオリジナルのバージョン （一般的に Windows XP Gold または Windows XP Release to Manufacturing (RTM) バージョンと呼ばれています） は、2004 年 9 月 30 日に、延長セキュリティ更新プログラムのサポートが終了しました。今回は、この脆弱性を解決するために必要なステップのほとんどが2004 年 9 月 30 日以前に完了しました。このため、マイクロソフトは、このセキュリティ情報の一部としてこれらのオペレーティングシステム用のセキュリティ更新プログラムのリリースを決定しました。マイクロソフトは、今後これらのオペレーティング システムに影響を及ぼす脆弱性に対し、このような対応を予定していませんが必要であると判断した場合、更新プログラムの開発および利用可能とする権利を保留としています。今後の脆弱性の影響を受ける可能性を防ぐため、これらのオペレーティングシステムを使用しているお客様は、バージョンをサポートの対象となっているバージョンに移行することを強く推奨します。Windows Service Pack のサポート ライフサイクルに関する詳細情報は、[マイクロソフト](http://support.microsoft.com/gp/lifesupsps) サポート ライフサイクルをご覧ください。Windows 製品のサポート ライフサイクルに関する詳細情報は、[マイクロソフト](http://support.microsoft.com/lifecycle) サポート ライフサイクルをご覧ください。

詳細情報は、[Windows](http://support.microsoft.com/kb/lifewinfaq)オペレーティング システム FAQ をご覧ください。

**Microsoft Windows NT 4.0 Workstation Service Pack 6a** **または** **Windows 2000 Service Pack 2** **を現在でも使用していますが、延長されたセキュリティ更新プログラムのサポートは** **2004** **年** **6** **月** **30** **日に終了しました。どうしたらよいですか?**

以前よりご案内しておりますとおり、マイクロソフトは Windows NT 4.0 Workstation Service Pack 6a および Windows 2000 Service Pack 2 のサポートを 2004 年 6 月 30 日まで延長しましたが、そのライフサイクルは終了しました。

今後の脆弱性の影響を受ける可能性を防ぐため、これらのオペレーティングシステムを使用しているお客様は、サポートの対象となっているバージョンに移行することを強く推奨します。Windows 製品ライフサイクルに関する詳細情報は、[マイクロソフトサポート](http://support.microsoft.com/gp/lifecycle) ライフサイクルをご覧ください。これらのオペレーティングシステムのバージョンについて、延長されたセキュリティ更新プログラムのサポート期間に関する詳細情報は、[Microsoft Product Support Services Web](http://support.microsoft.com/gp/lifeanoct2003)サイト をご覧ください。

Windows NT Workstation 4.0 SP6a の追加サポート （カスタムサポート） が必要なお客様は、担当営業、または マイクロソフト アカウント チームの担当者、担当テクニカルアカウント マネージャ (TAM)、またはカスタム サポート オプションのマイクロソフト パートナー担当者までご連絡ください。プレミア契約をお持ちでないお客様は、マイクロソフトサポート契約センター （営業時間 9:30-12:00 13:00-19:00 土日祝祭日を除く TEL:0120-17-0196 FAX:03-5388-8253） までお問い合わせください。

詳細情報は、[Windows](http://support.microsoft.com/gp/lifewinfaq)オペレーティング システム FAQ をご覧ください。

**Windows 98、Windows 98 Second Edition** **および** **Windows Millennium Edition** **のサポートの延長により、これらのオペレーティングシステム用のセキュリティ更新プログラムのリリースにどのような影響がありますか?**

マイクロソフトは、これらのオペレーティングシステム上で、深刻度が「緊急」のセキュリティ問題がある場合にのみ、セキュリティ更新プログラムをリリースする予定です。このサポート期間中は、「緊急」以外のセキュリティ問題のための更新プログラムは提供されません。 これらのオペレーティングシステムについてのサポートライフサイクルのより詳細な情報は、次の [Web](http://support.microsoft.com/gp/lifean1)サイトをご覧ください。

深刻度評価システムに関する詳細情報は、次の [Web](http://technet.microsoft.com/security/bulletin/rating)サイトをご覧ください。

**Windows 98、Windows 98 Second Edition** **または** **Windows Millennium Edition** **は、この累積的な更新プログラムで解決される脆弱性による深刻な影響を受けますか?**

いいえ。これらの脆弱性の Windows 98、Windows 98 Second Edition または Windows Millennium Edition の深刻度はいずれも「緊急」ではありません。

**Microsoft Baseline Security Analyzer (MBSA)** **を使用して、この更新プログラムが必要であるかどうかを確認することはできますか?**

はい。MBSA により、この更新プログラムが必要かどうかを確認することができます。MSBA に関する詳細情報は、[MBSA Web サイト](http://technet.microsoft.com/ja-jp/security/cc184924.aspx)をご覧下さい。なお、この更新プログラムには MSXML 3.0 Service Pack 5 が含まれているため、MSBA が IIS と MSXML 3.0 Service Pack 5 の両方を更新する必要があることを検出し、異なるノードでそれを報告します。

**注:** 2004 年 7 月 14 日をもって、以前のバージョンの SMS 2.0 Software Update Services Feature Pack、 SMS 2003 Software Update Scanning Tools、MBSA 1.1.1 および、それ以前のバージョンによって使用される Mssecure.xml ファイルの更新を終了するため、2004 年 7 月 15 日以降、新たなセキュリティ情報のデータで更新されていません。そのため、2004 年 7 月 15 日以降、MBSA 1.1.1 またはそれ以前のバージョンのデータで行われるスキャンは、不完全となる場合がございます。 MBSA 1.2 でより正確なセキュリティ更新プログラムの検出が行われ、サポートされる製品もより多いため、すべてのユーザーは、MBSA 1.2 にアップグレードをすることを推奨いたします。MBSA 1.2 は、[MBSA Web サイト](http://technet.microsoft.com/ja-jp/security/cc184924.aspx) からダウンロードすることができます。MBSA のサポートに関する詳細は、[Microsoft Baseline Security Analyzer (MBSA) Version 1.2 Q&A](http://technet.microsoft.com/ja-jp/security/cc184924.aspx) をご覧ください。

**Systems Management Server (SMS)** **を使用して、この累積的な更新プログラムが必要であるかどうかを確認することはできますか?**

はい。SMS は、このセキュリティ更新プログラムを検出し、展開する支援をします。 SMS に関する情報は、[SMS の Web サイト](http://www.microsoft.com/japan/smserver/default.mspx)をご覧下さい。

SMS の [Inventory and Software Distribution](http://www.microsoft.com/technet/prodtechnol/sms/sms2003/patchupdate.mspx)(英語情報）の機能を使用して、この更新プログラムを展開することができます。

脆弱性の詳細
------------

<span></span>
#### Window Management の脆弱性 - CAN-2004-0207:

Window Management アプリケーション プログラミング インターフェイス （API） に[特権の昇格](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性が存在します。 この脆弱性により、ログオン ユーザーがシステムを完全に制御できる場合があります。

#### 「Window Managementの脆弱性」の問題を緩和する要素 - CAN-2004-0207:

-   攻撃者がこの脆弱性を悪用するには、有効なログオン資格情報を所持し、ローカルでログオンできる必要があります。 リモートでログオンしている場合や匿名ユーザーがこの脆弱性を悪用することはできません。

#### 「Window Managementの脆弱性」の回避策 - CAN-2004-0207:

なし。

#### 「Window Managementの脆弱性」のよく寄せられる質問 - CAN-2004-0207:

**どのようなことが起こる可能性がありますか?**

これは、[ローカルで特権の昇格](http://www.microsoft.com/japan/security/glossary.mspx)される可能性のある脆弱性です。この脆弱性により、攻撃者はプログラムのインストール、データの表示、変更、削除または完全な特権を持つ新しいアカウントの作成など、影響を受けるコンピュータを完全に制御する可能性があります。

**何が原因で起こりますか?**

Window Management のいくつかの API の機能は、プログラムに、高いレベルの権限で実行されている他のプログラムのプロパティの変更を許可します。 プログラムから、同じレベルの権限で実行されている他のプログラムのプロパティを変更することができないよう制限をする必要があります。 高い特権で実行されているプログラムのプロパティを変更することによって、ローカルでログオンしているユーザーの特権を昇格させることができる場合があります。

**Window Management** **アプリケーションプログラミングインターフェイスの機能とは何ですか？**

Windows の GUI は、ウィンドウのサイズやプログラムの名前など、プログラムを定義するさまざまなプロパティの変更を許可します。 Window Management の API 機能は、プログラムがこれらのプロパティを変更するのに使用する、オペレーティングシステムのコンポーネントです。 Windows のプログラムの構築に使用するコンポーネントの詳細については、[MSDN](http://msdn2.microsoft.com/en-us/library/ms632587.aspx) の Web サイト (英語情報) をご覧ください。

**攻撃者はこの脆弱性により何を行う可能性がありますか?**

攻撃者はこの脆弱性を悪用し、そのコンピュータの完全制御を取得する可能性があります。

**攻撃者はどのようにこの脆弱性を悪用する可能性がありますか?**

攻撃者はこの脆弱性を悪用するには、まず、システムにログオンする可能性があります。 そして、この脆弱性の悪用のために特別に設計されたプログラムを実行し、システムを完全に制御します。

**主にどのようなコンピュータがこの脆弱性による危険にさらされますか?**

ワークステーションおよびターミナル サーバーが、主にこの脆弱性による危険にさらされます。十分な管理者資格情報を所有していないユーザーが、サーバーにログオンし、プログラムを実行する権限を与えられている場合にのみ、サーバーがこの脆弱性による危険にさらされます。しかし、セキュリティ上の最善策としては、このような設定を行わないことが強く推奨されます。

**Windows 98、Windows 98 Second Edition** **または** **Windows Millennium Edition** **はこの脆弱性による深刻な影響を受けますか?**

いいえ。Windows 98、Windows 98 Second Edition、および Windows Millennium Edition には影響を受けるコンポーネントが含まれますが、この脆弱性の深刻度は「緊急」ではありません。深刻度評価システムに関する詳細情報は、次の [Web](http://technet.microsoft.com/security/bulletin/rating)サイトをご覧ください。

**この脆弱性がインターネットで悪用される可能性はありますか?**

いいえ。攻撃者は、攻撃を対象にしたシステムにログオンする必要があります。 この脆弱性を悪用して、リモートからプログラムをロードおよび実行することはできません。

**この更新プログラムは何を修正しますか?**

この更新プログラムにより、異なる権限で実行されているプログラムのプロパティを、プログラムが変更できなくなり、この脆弱性が排除されます。

**このセキュリティ情報のリリース時に、この脆弱性は一般に公開されていたのですか?**

いいえ。マイクロソフトは信頼される情報元からこの脆弱性に関する情報を受けました。マイクロソフトは、このセキュリティ情報が最初にリリースされた際に、この脆弱性が一般に公開されていたことを示す情報を受けていませんでした。

**このセキュリティ情報のリリース時に、マイクロソフトはこの脆弱性が悪用されたという報告を受けていましたか?**

いいえ。このセキュリティ情報が最初にリリースされた段階で、マイクロソフトはこの脆弱性が悪用され、お客様が攻撃されたということを示す情報は受けておらず、また、公開された検証用コードのいかなる実例の存在も確認しておりません。

#### VDM （仮想 DOS マシン） の脆弱性 - CAN-2004-0208:

VDM サブシステムを処理するオペレーティング システムのコンポーネント内に、[ローカルで特権を昇格](http://www.microsoft.com/japan/security/glossary.mspx)できる脆弱性が存在します。 この脆弱性により、ログオンしているユーザーがシステムを完全に制御できる場合があります。

#### 「VDM の脆弱性」の問題を緩和する要素 - CAN-2004-0208:

-   攻撃者がこの脆弱性を悪用するには、有効な資格情報を所持し、ローカルでログオンできる必要があります。 リモートでログオンしている場合や匿名ユーザーがこの脆弱性を悪用することはできません。
-   Windows XP Service Pack 2 はこの脆弱性の影響を受けません。

#### 「VDM の脆弱性」の回避策 - CAN-2004-0208:

なし。

#### 「VDM の脆弱性」のよく寄せられる質問 - CAN-2004-0208:

**どのようなことが起こる可能性がありますか?**

これは、[特権の昇格](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。この脆弱性により、攻撃者はプログラムのインストール、データの表示、変更、削除または完全な特権を持つ新しいアカウントの作成など、影響を受けるコンピュータを完全に制御する可能性があります。 この脆弱性を悪用できるのは、ローカルにログオンし、プログラムを実行できる攻撃者です。

**何が原因で起こりますか?**

VDM サブシステムを処理するオペレーティング システム コンポーネントにセキュリティ上の脆弱性が存在し、これにより、保護されたカーネルメモリへのアクセスが取得される可能性があります。 特定の状況で、いくつかの特権を持つオペレーティング システムの機能がコンピュータの構造を検証せず、このため、攻撃者によりシステムの特権で特別に設計されたプログラムが実行される可能性があります。

**VDM** **サブシステムとは何ですか?**

VDM サブシステムとは、Windows NT ベースのオペレーティング システムで MS-DOS および DOS ベースの Windows をエミュレートする環境です。 VDM は、ユーザーが MS-DOS アプリケーションを Windows NT ベースのオペレーティング システムで起動すると、常に作成されます。

**この脆弱性により、攻撃者は何を行う可能性がありますか?**

この脆弱性により、攻撃者はプログラムのインストール、データの表示、変更、削除または完全な特権を持つ新しいアカウントの作成など、影響を受けるコンピュータを完全に制御する可能性があります。

**誰がこの脆弱性を悪用する可能性がありますか?**

攻撃者がこの脆弱性を悪用するには、ローカルにログオンし、プログラムを実行することが必要条件となります。

**攻撃者はどのようにこの脆弱性を悪用する可能性がありますか?**

攻撃者は、まず、システムにログオンします。 そして、この脆弱性の悪用のために特別に設計されたアプリケーションを実行し、システムを完全に制御します。

**主にどのようなコンピュータがこの脆弱性による危険にさらされますか?**

ワークステーションおよびターミナル サーバーが、主にこの脆弱性による危険にさらされます。十分な管理者資格情報を所有していないユーザーが、サーバーにログオンし、プログラムを実行する権限を与えられている場合にのみ、サーバーがこの脆弱性による危険にさらされます。しかし、セキュリティ上の最善策としては、このような設定を行わないことが強く推奨されています。

**この脆弱性がインターネットから悪用される可能性はありますか?**

いいえ。攻撃者は、対象の特定のシステムにログオンする必要があります。 この脆弱性を悪用して、リモートからプログラムを読み込みおよび実行することはできません。

**この更新プログラムは何を修正しますか?**

この更新プログラムは、VDM に割り当てられたメモリ ロケーションを参照するときに、Windows がデータを検証する方法を変更します。これによって、この脆弱性が排除されます。

**このセキュリティ情報のリリース時に、マイクロソフトはこの脆弱性が悪用されたという報告を受けていましたか?**

いいえ。このセキュリティ情報が最初にリリースされた段階で、マイクロソフトはこの脆弱性が悪用され、お客様が攻撃されたということを示す情報は受けておらず、また、公開された検証用コードのいかなる実例の存在も確認しておりません。

**この脆弱性とMS04-011で修正された** **VDM** **の脆弱性はどのように関係していますか？**

いずれの脆弱性も VDM に存在します。 しかし、このセキュリティ情報での更新は、MS04-011 では修正されなかった新しい脆弱性を解決します。MS04-011 では、MS04-011 の脆弱性からシステムを保護しますが、この新しい脆弱性は解決していません。 MS04-011 は、この更新には対応していません。両方の脆弱性からシステムを守るには、このセキュリティ情報の更新と MS04-011 のセキュリティ情報の一部として提供された更新をインストールする必要があります。

#### Graphics Rendering Engine の脆弱性 - CAN-2004-0209:

Windows メタファイル (WMF) および拡張メタファイル (EMF) の画像形式のレンダリング時に、影響を受ける可能性のあるシステムに対し、リモートからコードを実行できる脆弱性が存在します。 影響を受ける可能性のあるシステムで、WMF または EMF 画像をレンダリングするすべてのプログラムが、この攻撃の対象となる可能性があります。攻撃者はこの脆弱性を悪用し、そのコンピュータの完全制御を取得する可能性があります。

#### 「Graphics Rendering Engine の脆弱性」の問題を緩和する要素 - CAN-2004-0209:

-   この脆弱性は、攻撃者がユーザーに特別な細工をされた画像を含むファイルを開かせたり、特別な細工をされた画像を含むフォルダを表示するよう誘導することによって、悪用される可能性があります。 ユーザーが電子メールのメッセージをプレビューしてしまう以外に、攻撃者が悪質なファイルを開くようにユーザーを強制する方法はありません。
-   Web ベースの攻撃シナリオでは、この脆弱性が悪用される Web ページが含まれる Web サイトをホストすることが攻撃者にとっての必要条件となります。攻撃者は、悪質な Web サイトにユーザーを強制的に訪問させることはできません。その代わり、攻撃者は、通常攻撃者のサイトへのリンクをユーザーにクリックさせるなどの方法により、ユーザーをそのような Web サイトに誘導することが攻撃者にとっての必要条件となります。
-   Windows XP Service Pack 2 はこの脆弱性の影響を受けません。

#### 「Graphics Rendering Engine の脆弱性」の回避策 - CAN-2004-0209:

マイクロソフトは、次の回避策のテストを行ないました。これらの回避策は根本的な脆弱性を修正しませんが、既知の攻撃方法を阻止する手助けとなります。回避策は機能低下の原因となる場合もあります。その場合、下記に記します。

-   **Outlook 2002** **またはそれ以降、Outlook Express 6 Service Pack 1** **またはそれ以降を使用している場合、HTML** **形式の電子メールによる攻撃からコンピュータを保護するために電子メールをテキスト形式で読み取る**

    Office XP Service Pack 1 またはそれ以降を適用している Microsoft Outlook 2002 を使用しているお客様、および Internet Explorer 6 Service Pack 1 を適用している Microsoft Outlook Express 6 を使用しているお客様は、この設定を有効にし、デジタル署名されていない電子メール メッセージまたは暗号化されていない電子メール メッセージをテキスト形式のみで表示することができます。

    デジタル署名された電子メール メッセージまたは暗号化された電子メール メッセージはこの設定の影響を受けません。その元の形式で読み取られます。Outlook 2002 でこの設定を有効にすることに関する情報は、次のサポート技術情報をご覧ください。
    <http://support.microsoft.com/kb/307594>

    Outlook Express 6 でこの設定を有効にする方法に関する情報は、次のサポート技術情報をご覧ください。<http://support.microsoft.com/kb/291387>

    **回避策の影響:** テキスト形式で表示される電子メールは、写真、特殊なフォント、アニメーションまたはそのほかのリッチ コンテンツを含むことができません。さらに次の影響があります。

    -   プレビュー ウィンドウおよび開いているメッセージに変更が適用されます。
    -   写真は紛失を避けるため、添付ファイルとなります。
        **注:** 影響を受けるアプリケーションまたはオペレーティング システムを使用している場合、これらの画像を手動で表示すると、リモートでコードが実行される可能性があります。
    -   メッセージは保存場所では依然としてリッチテキスト形式、または HTML 形式であるため、オブジェクト モデル (カスタムコード ソリューション) が予期しない動作をする場合があります。

#### 「Graphics Rendering Engine の脆弱性」のよく寄せられる質問 - CAN-2004-0209:

**どのようなことが起こる可能性がありますか?**

これはリモートでコードが実行される脆弱性です。この脆弱性により、攻撃者はプログラムのインストール、データの表示、変更、削除または完全な特権を持つ新しいアカウントの作成など、影響を受けるコンピュータを完全に制御する可能性があります。 また、ローカルで権限を昇格したり、リモートからサービス拒否を引き起こすことができる場合があります。

**何が原因で起こりますか?**

Graphics Rendering Engine が Windows メタファイル (WMF) および拡張メタファイル (EMF) の画像形式をレンダリングするとき、未チェックのバッファがあるためこの問題が起こります。

**Windows** **メタファイル** **(WMF)** **および拡張メタファイル** **(EMF)** **の画像形式とは何ですか?**

WMF の画像は、16 ビットのメタファイル形式で、ベクトル情報およびビットマップ情報の両方を含むことができます。 WMF は、Windows オペレーティング システム用に最適化されています。 EMF の画像は、32 ビットで、ベクトル情報およびビットマップ情報の両方を含むことができます。 この形式は Windows メタファイル形式が改良されたもので、拡張機能が含まれます。

画像の種類および形式に関する詳細は、以下のサポート技術情報 （Microsoft Knowledge Base） をクリックしてください。[320314](http://support.microsoft.com/kb/320314) 適切な画像ファイル形式を選択するためのガイドライン これらのファイル形式に関する詳細については、[MSDN](http://msdn2.microsoft.com/en-us/library/ms531205.aspx)ライブラリの Web サイト (英語情報) をご覧ください。

**この脆弱性により、攻撃者は何を行う可能性がありますか?**

この脆弱性により、攻撃者はプログラムのインストール、データの表示、変更、削除または完全な特権を持つ新しいアカウントの作成など、影響を受けるコンピュータを完全に制御する可能性があります。

**どのように攻撃者はこの脆弱性を悪用する可能性がありますか?**

影響を受ける画像タイプをレンダリングするすべてのプログラムが影響を受ける可能性があります。次にいくつかの例を挙げます。

-   攻撃者は、この脆弱性の悪用を目的で設計された悪質な Web サイトをホストし、Internet Explorer を介して、ユーザーにその Web サイトを表示するよう誘導する可能性があります。
-   攻撃者は特別な細工をされた画像を添付した HTML 形式の電子メール メッセージを作成する可能性があります。 攻撃者は、この脆弱性を悪用する目的で、Microsoft Outlook または Outlook Express 6 を使用しているユーザーを対象に、特別な画像を作成する可能性があります。そして HTML 形式の電子メール メッセージを表示するよう誘導する可能性があります。
-   攻撃者は特別な細工をした画像を Office 文書に埋め込み、ユーザーにその文書を表示するよう誘導する可能性があります。
-   攻撃者は特別な細工をした画像をローカル ファイル システムまたはネットワーク共有に追加し、ユーザーにそのフォルダをプレビュー表示するよう誘導する可能性があります。
-   攻撃者が、ローカル システムにログオンする場合があります。 そして、この脆弱性の悪用のために特別に設計されたプログラムを実行し、システムを完全に制御します。

また、攻撃者は、別な方法によって影響を受けるコンポーネントにアクセスする可能性があります。たとえば、コンピュータに対話的にログオンするか、またはこの脆弱性の影響を受けるコンポーネントにパラメータを （ローカル、またはリモートで） 渡した別のプログラムを使用してログオンすることが考えられます。 ローカルからこの脆弱性を悪用するには、攻撃者は、まずシステムにログオンします。 そして、この脆弱性の悪用のために特別に設計されたアプリケーションを実行し、システムを完全に制御します。

**主にどのようなコンピュータがこの脆弱性による危険にさらされますか?**

この脆弱性は、攻撃者がユーザーに特別な細工をされた画像を含むファイルを開かせたり、特別な細工をされた画像を含むフォルダを表示するように誘導した場合、影響を受けるコンピュータで悪用される可能性があります。 ユーザーが電子メールのメッセージをプレビューしてしまう以外に、特別に作成されたファイルを開くよう、攻撃者がユーザーを強制する方法はありません。

Web ベースの攻撃シナリオでは、この脆弱性が悪用される Web ページが含まれる Web サイトをホストすることが攻撃者にとっての必要条件となります。攻撃者は、悪質な Web サイトにユーザーを強制的に訪問させることはできません。その代わり、攻撃者は、通常攻撃者のサイトへのリンクをユーザーにクリックさせるなどの方法により、ユーザーをそのような Web サイトに誘導することが攻撃者にとっての必要条件となります。

**この脆弱性がインターネットから悪用される可能性はありますか?**

はい。攻撃者はこの脆弱性をインターネット上で悪用する可能性があります。

**この更新プログラムは何を修正しますか?**

この更新プログラムは Graphics Rendering Engine が Windows メタファイル (WMF) および拡張メタファイル (EMF) の画像形式を処理する方法を変更することにより、この脆弱性を排除します。

**このセキュリティ情報のリリース時に、この脆弱性は一般に公開されていたのですか?**

いいえ。マイクロソフトは信頼される情報元からこの脆弱性に関する情報を受けました。マイクロソフトは、このセキュリティ情報が最初にリリースされた際に、この脆弱性が一般に公開されていたことを示す情報を受けていませんでした。

**このセキュリティ情報のリリース時に、マイクロソフトはこの脆弱性が悪用されたという報告を受けていましたか?**

いいえ。このセキュリティ情報が最初にリリースされた段階で、マイクロソフトはこの脆弱性が悪用され、お客様が攻撃されたということを示す情報は受けておらず、また、公開された検証用コードのいかなる実例の存在も確認しておりません。

**MS04-011で対処されているメタファイルの脆弱性とどのように関連しますか？**

2 つの脆弱性は、共に WMF と EMF の画像形式の処理と関係します。 しかし、このセキュリティ情報での更新は、MS04-011 では修正されなかった新しい脆弱性を解決します。MS04-011 では、MS04-011 の脆弱性からシステムを保護しますが、この新しい脆弱性は解決していません。 MS04-011 は、この更新には対応していません。両方の脆弱性からシステムを守るには、このセキュリティ情報の更新と MS04-011 のセキュリティ情報の一部として提供された更新をインストールする必要があります。

**MS04-028で対処されている** **JPEG** **処理（GDI+）の脆弱性とどのような関連がありますか？**

この脆弱性が影響を与えるコンポーネントは、オペレーティング システムに元から含まれているコンポーネントで、再配布されるものではありません。 しかし、MS04-028 の JPEG 処理 （GDI+）の脆弱性が影響するコンポーネントは、他のアプリケーションおよびサードパーティのプログラムで再配布することが可能でした。 オペレーティング システム用のこの更新プログラムをインストールすれば、この脆弱性を悪用する際の攻撃経路となるすべてのアプリケーションが保護されます。 MS04-028は、MS04-028のセキュリティ情報で説明した脆弱性に対応します。しかし、この新しい脆弱性には、対応していません。 MS04-028 は、この更新には対応していません。両方の脆弱性からシステムを守るには、この更新と MS04-028 のセキュリティ情報の一部として提供された更新をインストールする必要があります。

#### Windows カーネルの脆弱性 - CAN-2004-0211:

Windows のカーネルには、[ローカルでのサービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)を引き起こす脆弱性が存在します。 攻撃者が、攻撃対象のシステムの応答を停止させるようなプログラムを、ローカルで実行できる場合があります。

#### 「Windows カーネルの脆弱性」の問題を緩和する要素 - CAN-2004-0211:

-   攻撃者がこの脆弱性を悪用して、影響を受けるシステムで権限を取得することはできません。 この問題は、完全にサービス拒否の脆弱性です。
-   Windows NT 4.0、Windows 2000、Windows XP は、この脆弱性による影響を受けません。

#### 「Windows カーネルの脆弱性」の回避策 - CAN-2004-0211:

なし。

#### 「Windows カーネルの脆弱性」のよく寄せられる質問 - CAN-2004-0211:

**どのようなことが起こる可能性がありますか?**

これは、[サービス拒否](http://www.microsoft.com/japan/security/glossary.mspx)の脆弱性です。 この脆弱性を悪用する攻撃者は、影響を受けるシステムの応答を停止させて、自動的に再起動させます。その間、サーバーがリクエストに対して応答ができないように仕向けることができます。

**注:** 攻撃者は、サービス拒否の脆弱性を利用し、コードを実行したり、権限を昇格させることはできません。しかし、システムがリクエストを拒否するよう仕向けることができます。

**何が原因で起こりますか?**

Windows カーネルが、CPU データ構造内の一部の値を正確に再設定しないことが原因で起こります。

**Windows** **カーネルとは何ですか？**

Windows カーネルとは、オペレーティング システムの中核となる部分です。 デバイスやメモリの管理、処理時の処理時間の割り当て、エラー処理の管理など、システム レベルのサービスを提供します。 カーネルおよびオペレーティング システムの他の構造の詳細については、次の Web ページ [Windows NT System Overview](http://www.microsoft.com/technet/prodtechnol/winntas/training/ntarchitectoview/ntarc_2.mspx)(英語) を参照してください

**この脆弱性により、攻撃者は何を行う可能性がありますか?**

この脆弱性を悪用する攻撃者は、影響を受けるシステムの応答を停止させて、自動的に再起動させます。その間サーバーはリクエストに対して応答ができません。

**誰がこの脆弱性を悪用する可能性がありますか?**

ローカルにログオンし、プログラムを実行できる攻撃者です。

**攻撃者はどのようにこの脆弱性を悪用する可能性がありますか?**

攻撃者は、まず、システムにログオンします。 そして、特別に設計されたプログラムを実行し、脆弱性を悪用します。 これによってシステムが応答を停止し、サービスが拒否される事態を引き起こします。

**主にどのようなコンピュータがこの脆弱性による危険にさらされますか?**

主に、ターミナル サーバーが危険にさらされます。十分な管理者資格情報を所有していないユーザーが、サーバーにログオンし、プログラムを実行する権限を与えられている場合にのみ、サーバーがこの脆弱性による危険にさらされます。しかし、セキュリティ上の最善策としては、このような設定を行わないことが強く推奨されています。

**この脆弱性がインターネットで悪用される可能性はありますか?**

いいえ、ありません。対象の特定のシステムにログオンすることが攻撃者にとっての必要条件となります。 この脆弱性を悪用して、リモートからプログラムを読み込みおよび実行することはできません。

**この更新プログラムは何を修正しますか?**

この更新プログラムは、CPU のデータ構造の一部の値を、Windows カーネルが再設定する方法を変更します。

**このセキュリティ情報のリリース時に、この脆弱性は一般に公開されていたのですか?**

いいえ。マイクロソフトは信頼される情報元からこの脆弱性に関する情報を受けました。マイクロソフトは、このセキュリティ情報が最初にリリースされた際に、この脆弱性が一般に公開されていたことを示す情報を受けていませんでした。

**このセキュリティ情報のリリース時に、マイクロソフトはこの脆弱性が悪用されたという報告を受けていましたか?**

いいえ。このセキュリティ情報が最初にリリースされた段階で、マイクロソフトはこの脆弱性が悪用され、お客様が攻撃されたということを示す情報は受けておらず、また、公開された検証用コードのいかなる実例の存在も確認しておりません。

セキュリティ更新プログラムに関する情報
--------------------------------------

<span></span>
**対象プラットフォームおよび必要条件** **:**

以下の情報の中から、ご使用のプラットフォーム向けのセキュリティ更新プログラムに関する情報をご覧ください。

#### Windows Server 2003 (すべてのバージョン)

**必要条件** **:**

このセキュリティ更新プログラムを適用するには、Windows Server 2003 の製品版を実行している必要があります。

**この修正を含む予定のサービスパック** **:**

この問題に対する更新プログラムは Windows Server 2003 Service Pack 1 に含まれる予定です。

**インストールに関する情報** **:**

このセキュリティ更新プログラムは次のセットアップ スイッチをサポートします。

**/help:** インストール メッセージの一覧を表示します
**セットアップモード**
**/quiet:** QUIET モード (ユーザー入力を必要としません。表示もしません)
**/passive:** 無人モード (進行状況バーのみ)
**/uninstall:** パッケージをアンインストールします
**再起動オプション**
**/norestart:** インストールの完了後、再起動しません
**/forcerestart:** インストール後、再起動します
**特別なオプション**
**/l:** インストール済みの Windows ホットフィックスまたは更新パッケージを表示します
**/o:** 確認メッセージを表示せずに OEM ファイルを上書きします
**/n:** アンインストールに必要なファイルのバックアップを作成しません
**/f:** シャットダウン時に他のプログラムを強制終了します
**/extract:** セットアップを実行せずにファイルを抽出します

**注:** これらのスイッチを 1 つのコマンド ラインに組み込むことができます。旧バージョンとの互換性のため、このセキュリティ更新プログラムは、セットアップ ユーティリティの以前のバージョンによって使用されるセットアップ スイッチもサポートしています。 サポートされるインストール スイッチについての追加情報は、マイクロソフト サポート技術情報 [262841](http://support.microsoft.com/kb/262841) をご覧ください。

**適用に関する情報** **:**

ユーザーの操作なしでセキュリティ更新プログラムをインストールするためには、Windows Server 2003 のコマンド プロンプトで次のコマンド ラインを使用してください。

**Windowsserver2003-kb840987-x86-jpn /passive /quiet**

コンピュータを強制的に再起動せずにセキュリティ更新プログラムをインストールするためには、Windows Server 2003 のコマンド プロンプトで次のコマンド ラインを使用してください。

**Windowsserver2003-kb840987-x86-jpn /norestart**

Microsoft Software Update Services でこのセキュリティ更新プログラムを適用する方法に関する情報は、次のマイクロソフトの Web サイトをご覧ください。

[Software Update Services の概要](http://www.microsoft.com/japan/windowsserversystem/sus/susoverview.mspx)

**再起動の必要性** **:**

セキュリティの更新を適用してから、コンピュータを再起動する必要があります。

**削除に関する情報** **:**

この更新プログラムを削除するためには、\[コントロール パネル\] の \[プログラムの追加と削除\] を使用してください。

システム管理者は Spuninst.exe ユーティリティを使用し、このセキュリティ更新プログラムを削除することができます。 Spuninst.exe ユーティリティは %Windir%\\$NTUninstallKB840987$\\Spuninst フォルダにあります。このユーティリティは次のセットアップ スイッチをサポートします。

**/?**: インストール スイッチの一覧を表示します
**/u**: 無人モードを使用します
**/f**: シャットダウン時に他のプログラムを強制終了します
**/z**: インストール完了後、再起動しません
**/q**: Quiet モードを使用します (ユーザー入力を必要としません)

**ファイルに関する情報** **:**

この更新プログラムの日本語版のファイル属性 (またはそれ以降) は次のとおりです。

Windows Server 2003 Enterprise Edition、Windows Server 2003 Standard Edition、Windows Server 2003 Web Edition、および Windows Server 2003 Datacenter Edition :

| 日付       | 時間  | バージョン   | サイズ    | ファイル名   | フォルダ |
|------------|-------|--------------|-----------|--------------|----------|
| 2004/06/10 | 9:34  | 5.2.3790.175 | 2,407,424 | ntkrnlmp.exe | RTMGDR   |
| 2004/06/10 | 9:34  | 5.2.3790.175 | 2,064,896 | ntkrnlpa.exe | RTMGDR   |
| 2004/06/09 | 17:34 | 5.2.3790.175 | 2,107,392 | ntkrpamp.exe | RTMGDR   |
| 2004/06/10 | 9:34  | 5.2.3790.175 | 2,207,744 | ntoskrnl.exe | RTMGDR   |
| 2004/08/20 | 8:45  | 5.2.3790.198 | 1,812,480 | win32k.sys   | RTMGDR   |
| 2004/06/10 | 9:22  | 5.2.3790.177 | 2,408,960 | ntkrnlmp.exe | RTMQFE   |
| 2004/06/10 | 9:22  | 5.2.3790.177 | 2,065,920 | ntkrnlpa.exe | RTMQFE   |
| 2004/06/10 | 9:22  | 5.2.3790.177 | 2,110,464 | ntkrpamp.exe | RTMQFE   |
| 2004/07/20 | 16:22 | 5.2.3790.177 | 2,208,768 | ntoskrnl.exe | RTMQFE   |
| 2004/08/20 | 8:49  | 5.2.3790.202 | 1,814,016 | win32k.sys   | RTMQFE   |

Windows Server 2003 64-Bit Enterprise Edition、および Windows Server 2003 64-Bit Datacenter Edition :

| 日付       | 時間  | バージョン   | サイズ    | ファイル名 | プラットフォーム | フォルダ |
|------------|-------|--------------|-----------|------------|------------------|----------|
| 2004/08/20 | 11:23 | 5.2.3790.198 | 4,952,064 | win32k.sys | IA64             | RTMGDR   |
| 2004/08/20 | 11:24 | 5.2.3790.202 | 4,956,160 | win32k.sys | IA64             | RTMQFE   |

**注:**Windows Server 2003 または Windows XP 64-Bit Edition Version 2003 のコンピュータに、このセキュリティ更新プログラムをインストールするとき、コンピュータ上のアップデート対象ファイルのいずれかが、マイクロソフトの修正プログラムによって過去にアップデートされているかどうかがチェックされます。 過去に修正プログラムをインストールしてこれらのファイルのいずれかをアップデートしている場合は、RTMQFE ファイルがコンピュータにコピーされます。 それ以外の場合は、RTMGDR ファイルがコンピュータにコピーされます。詳細は、関連情報を参照するには、サポート技術情報 [824994](http://support.microsoft.com/kb/824994) をご覧ください。

**更新プログラムが正しくインストールされたかどうか確認する方法** **:**

-   **Microsoft Baseline Security Analyzer**

    影響を受けるコンピュータにセキュリティ更新プログラムがインストールされていることを確認するためには、Microsoft Baseline Security Analyzer (MBSA) ツールを使用して下さい。管理者は、一般的なセキュリティ上誤った構成とともに、不足しているセキュリティ更新プログラムについて、ローカル コンピュータおよびリモート コンピュータをMicrosoft Baseline Security Analyzer (MBSA) を使ってスキャンすることができます。MBSA に関する追加情報は、[Microsoft Baseline Security Analyzer](http://technet.microsoft.com/ja-jp/security/cc184924.aspx) の Web サイトをご覧下さい。

-   **ファイルバージョンの確認**

    **注:**Microsoft Windows にはいくつかのバージョンがあるため、次のステップは使用中のコンピュータにより異なる場合があります。その場合、製品の説明書をご覧ください。

    1.  **\[スタート\]** をクリックし、次に **\[検索\]** をクリックします。
    2.  **\[検索結果\]** のウィンドウの **\[検索コンパニオン\]** の下の **\[ファイルとフォルダすべて\]** をクリックします。
    3.  **\[ファイル名のすべてまたは一部\]** のボックスで、適切なファイル情報の表からファイル名を入力し、次に **\[検索\]** をクリックします。
    4.  ファイルの一覧で、ファイル情報の表の適切なファイルからファイル名を右クリックし、次に **\[プロパティ\]** をクリックします。

        **注:**インストールされているオペレーティング システムまたはプログラムのバージョンにより、ファイル情報の表に記載されているファイルで、インストールされないものがある場合もあります。

    5.  **\[バージョン情報\]** タブで、適切なファイル情報テーブルに記載されているバージョンと比較し、コンピュータにインストールされているファイルのバージョンを確認します。

        **注:**ファイルのバージョン以外の属性はインストール中に変更される場合があります。そのほかのファイルの属性をファイル情報の表の情報と比較することは、更新プログラムが正しくインストールされたことを確認する方法としてサポートされていません。また、ファイル名がインストール中に変更される場合があります。ファイルまたはバージョンの情報が存在しない場合、その他の方法によって更新プログラムが正しくインストールされたことを確認して下さい。

-   **レジストリキーの確認**

    また、次のレジストリ キーを調べることにより、このセキュリティ更新プログラムがインストールしたファイルを確認することもできます。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB840987\\Filelist

    **注:**これらのレジストリ キーには、インストールされるファイルの完全な一覧が含まれない場合があります。また、管理者または OEM メーカーによって 840987 のセキュリティ更新プログラムを Windows インストール ソース ファイルに統合またはスリップストリーム化されている場合、このレジストリ キーが適切に作成されない場合があります。

#### Windows XP (すべてのバージョン)

**注:**セキュリティ更新プログラムの Windows XP 64-Bit Edition Version 2003 向けのバージョンは、Windows Server 2003 64-Bit Edition のセキュリティ更新プログラムと同じものです。

**必要条件** **:**

このセキュリティ更新プログラムを適用するには、製品版の Windows XP または Windows XP Service Pack 1 (SP1) を実行している必要があります。詳細は、サポート技術情報 [322389](http://support.microsoft.com/kb/322389) をご覧ください。

**この修正を含む予定のサービスパック** **:**

この問題に対する更新プログラムは Windows XP Service Pack 2 に含まれています。

**インストールに関する情報** **:**

このセキュリティ更新プログラムは次のセットアップ スイッチをサポートします。

**/help:** インストール メッセージの一覧を表示します
**セットアップモード**
**/quiet:** QUIET モード (ユーザー入力を必要としません。表示もしません)
**/passive:** 無人モード (進行状況バーのみ)
**/uninstall:** パッケージをアンインストールします
**再起動オプション**
**/norestart:** インストールの完了後、再起動しません
**/forcerestart:** インストール後、再起動します
**特別なオプション**
**/l:** インストール済みの Windows ホットフィックスまたは更新パッケージを表示します
**/o:** 確認メッセージを表示せずに OEM ファイルを上書きします
**/n:** アンインストールに必要なファイルのバックアップを作成しません
**/f:** シャットダウン時に他のプログラムを強制終了します
**/extract:** セットアップを実行せずにファイルを抽出します

**注:** これらのスイッチを 1 つのコマンド ラインに組み込むことができます。旧バージョンとの互換性のため、このセキュリティ更新プログラムは、セットアップ ユーティリティの以前のバージョンによって使用されるセットアップ スイッチもサポートしています。 サポートされるインストール スイッチについての追加情報は、マイクロソフト サポート技術情報 [262841](http://support.microsoft.com/kb/262841) をご覧ください。

**適用に関する情報** **:**

ユーザーの操作なしでセキュリティ更新プログラムをインストールするためには、Windows XP のコマンド プロンプトで次のコマンド ラインを使用してください。

**Windowsxp-kb840987-x86-jpn /passive /quiet**

コンピュータを強制的に再起動せずにセキュリティ更新プログラムをインストールするためには、Windows XP のコマンド プロンプトで次のコマンド ラインを使用してください。

**Windowsxp-kb840987-x86-jpn /norestart**

Microsoft Software Update Services でこのセキュリティ更新プログラムを適用する方法に関する情報は、次のマイクロソフトの Web サイトをご覧ください。

[Software Update Services の概要](http://www.microsoft.com/japan/windowsserversystem/sus/susoverview.mspx)

**再起動の必要性** **:**

セキュリティの更新を適用してから、コンピュータを再起動する必要があります。

**削除に関する情報** **:**

この更新プログラムを削除するためには、\[コントロール パネル\] の \[プログラムの追加と削除\] を使用してください。

システム管理者は Spuninst.exe ユーティリティを使用し、このセキュリティ更新プログラムを削除することができます。 Spuninst.exe ユーティリティは %Windir%\\$NTUninstallKB840987$\\Spuninst フォルダにあります。このユーティリティは次のセットアップ スイッチをサポートします。

**/?**: インストール スイッチの一覧を表示します
**/u**: 無人モードを使用します
**/f**: シャットダウン時に他のプログラムを強制終了します
**/z**: インストール完了後、再起動しません
**/q**: Quiet モードを使用します (ユーザー入力を必要としません)

**ファイルに関する情報** **:**

この更新プログラムの日本語版のファイル属性 (またはそれ以降) は次のとおりです。

Windows XP Home Edition、Windows XP Professional、Windows XP Home Edition Service Pack 1、Windows XP Professional Service Pack 1、Windows XP Tablet PC Edition、Windows XP Media Center Edition :

| 日付       | 時間  | バージョン    | サイズ    | ファイル名   | フォルダ |
|------------|-------|---------------|-----------|--------------|----------|
| 2004/06/18 | 03:31 | 5.1.2600.159  | 48,128    | Basesrv.dll  | RTMQFE   |
| 2004/06/18 | 03:31 | 5.1.2600.151  | 241,664   | Gdi32.dll    | RTMQFE   |
| 2004/06/18 | 03:31 | 5.1.2600.153  | 1,144,320 | Kernel32.dll | RTMQFE   |
| 2004/03/30 | 10:26 | 5.1.2600.132  | 36,864    | Mf3216.dll   | RTMQFE   |
| 2004/06/18 | 03:28 | 5.1.2600.160  | 1,849,856 | Ntkrnlmp.exe | RTMQFE   |
| 2004/06/18 | 03:29 | 5.1.2600.160  | 1,903,872 | Ntkrnlpa.exe | RTMQFE   |
| 2004/06/18 | 03:29 | 5.1.2600.160  | 1,877,504 | Ntkrpamp.exe | RTMQFE   |
| 2004/06/18 | 03:29 | 5.1.2600.160  | 1,881,856 | Ntoskrnl.exe | RTMQFE   |
| 2004/06/18 | 03:27 | 5.1.2600.157  | 411,136   | Ntvdm.exe    | RTMQFE   |
| 2004/06/18 | 03:31 | 5.1.2600.153  | 13,312    | Ntvdmd.dll   | RTMQFE   |
| 2004/06/18 | 03:31 |               | 1,055,610 | Sysmain.sdb  | RTMQFE   |
| 2004/06/18 | 03:31 | 5.1.2600.152  | 526,336   | User32.dll   | RTMQFE   |
| 2004/06/18 | 03:31 | 5.1.2600.153  | 23,040    | Vdmdbg.dll   | RTMQFE   |
| 2004/08/07 | 05:06 | 5.1.2600.166  | 1,648,128 | Win32k.sys   | RTMQFE   |
| 2004/06/18 | 03:31 | 5.1.2600.153  | 310,272   | Winsrv.dll   | RTMQFE   |
| 2004/06/18 | 03:27 | 5.1.2600.156  | 244,224   | Wow32.dll    | RTMQFE   |
| 2004/06/18 | 3:29  | 5.1.2600.1566 | 47,616    | basesrv.dll  | SP1QFE   |
| 2004/06/18 | 3:29  | 5.1.2600.1561 | 257,536   | gdi32.dll    | SP1QFE   |
| 2004/06/18 | 3:29  | 5.1.2600.1560 | 1,177,088 | kernel32.dll | SP1QFE   |
| 2004/05/18 | 7:48  | 3.10          | 92,256    | krnl386.exe  | SP1QFE   |
| 2004/03/30 | 10:49 | 5.1.2600.1331 | 36,864    | mf3216.dll   | SP1QFE   |
| 2004/05/18 | 7:43  |               | 33,840    | ntio.sys     | SP1QFE   |
| 2004/05/18 | 7:43  |               | 34,560    | ntio404.sys  | SP1QFE   |
| 2004/05/18 | 7:43  |               | 35,648    | ntio411.sys  | SP1QFE   |
| 2004/05/18 | 7:43  |               | 35,424    | ntio412.sys  | SP1QFE   |
| 2004/05/18 | 7:43  |               | 34,560    | ntio804.sys  | SP1QFE   |
| 2004/06/18 | 3:25  | 5.1.2600.1568 | 1,899,008 | ntkrnlmp.exe | SP1QFE   |
| 2004/06/17 | 11:26 | 5.1.2600.1568 | 1,954,688 | ntkrnlpa.exe | SP1QFE   |
| 2004/06/18 | 3:26  | 5.1.2600.1568 | 1,926,656 | ntkrpamp.exe | SP1QFE   |
| 2004/06/18 | 3:26  | 5.1.2600.1568 | 2,051,584 | ntoskrnl.exe | SP1QFE   |
| 2004/06/18 | 3:26  | 5.1.2600.1564 | 411,648   | ntvdm.exe    | SP1QFE   |
| 2004/06/18 | 3:29  | 5.1.2600.1560 | 13,312    | ntvdmd.dll   | SP1QFE   |
| 2004/06/18 | 3:29  | 5.1.2600.1561 | 557,568   | user32.dll   | SP1QFE   |
| 2004/06/18 | 3:29  | 5.1.2600.1560 | 23,040    | vdmdbg.dll   | SP1QFE   |
| 2004/08/07 | 5:11  | 5.1.2600.1581 | 1,845,632 | win32k.sys   | SP1QFE   |
| 2004/06/18 | 3:25  | 5.1.2600.1557 | 473,600   | winlogon.exe | SP1QFE   |
| 2004/06/18 | 3:29  | 5.1.2600.1561 | 314,368   | winsrv.dll   | SP1QFE   |
| 2004/06/18 | 3:25  | 5.1.2600.1562 | 244,224   | wow32.dll    | SP1QFE   |

Windows XP 64-Bit Edition Service Pack 1:

| 日付       | 時間  | バージョン    | サイズ    | ファイル名  | プラットフォーム | フォルダ    |
|------------|-------|---------------|-----------|-------------|------------------|-------------|
| 2004/06/17 | 10:31 | 5.1.2600.1556 | 885,248   | Gdi32.dll   | IA64             | SP1QFE      |
| 2004/03/29 | 18:46 | 5.1.2600.1331 | 128,512   | Mf3216.dll  | IA64             | SP1QFE      |
| 2004/06/17 | 10:31 | 5.1.2600.1557 | 1,480,704 | User32.dll  | IA64             | SP1QFE      |
| 2004/08/06 | 12:57 | 5.1.2600.1581 | 5,629,696 | Win32k.sys  | IA64             | SP1QFE      |
| 2004/06/17 | 11:29 | 5.1.2600.1561 | 237,568   | Wgdi32.dll  | x86              | SP1QFE\\WOW |
| 2004/03/29 | 18:49 | 5.1.2600.1331 | 36,864    | Wmf3216.dll | x86              | SP1QFE\\WOW |
| 2004/06/17 | 11:29 | 5.1.2600.1561 | 553,984   | Wuser32.dll | x86              | SP1QFE\\WOW |

Windows XP 64-Bit Edition Version 2003 :

| 日付       | 時間  | バージョン   | サイズ    | ファイル名 | プラットフォーム | フォルダ |
|------------|-------|--------------|-----------|------------|------------------|----------|
| 2004/08/20 | 11:23 | 5.2.3790.198 | 4,952,064 | Win32k.sys | IA64             | RTMGDR   |
| 2004/08/20 | 11:24 | 5.2.3790.202 | 4,956,160 | Win32k.sys | IA64             | RTMQFE   |

Windows XP、Windows XP Service Pack 1 および Windows XP 64-Bit Edition Version 2003 (英語版) 用のこのセキュリティ更新プログラムは、デュアルモード パッケージとして作成されています。デュアルモード パッケージには、Service Pack 未適用の Windows XP 製品版および Windows XP Service Pack 1 (SP1) 用のファイルが含まれています。デュアルモード パッケージの関連情報を参照するには、サポート技術情報 [328848](http://support.microsoft.com/kb/328848) をご覧ください。

Windows XP 64-Bit Edition Version 2003 のセキュリティ更新プログラムをインストールする際、コンピュータ上のアップデート対象ファイルのいずれかが、マイクロソフトの修正プログラムによって過去にアップデートされているかどうかがチェックされます。過去に修正プログラムをインストールしてこれらのファイルのいずれかをアップデートしている場合は、RTMQFE ファイルがコンピュータにコピーされます。それ以外の場合は、RTMGDR ファイルがコンピュータにコピーされます。詳細は、関連情報を参照するには、サポート技術情報 [824994](http://support.microsoft.com/kb/824994) をご覧ください。

**更新プログラムが正しくインストールされたかどうか確認する方法** **:**

-   **Microsoft Baseline Security Analyzer**

    影響を受けるコンピュータにセキュリティ更新プログラムがインストールされていることを確認するためには、Microsoft Baseline Security Analyzer (MBSA) ツールを使用してください。管理者は、一般的なセキュリティ上誤った構成とともに、不足しているセキュリティ更新プログラムについて、ローカル コンピュータおよびリモート コンピュータをMicrosoft Baseline Security Analyzer (MBSA) を使ってスキャンすることができます。MBSA に関する追加情報は、[Microsoft Baseline Security Analyzer](http://technet.microsoft.com/ja-jp/security/cc184924.aspx) の Web サイトをご覧ください。

-   **ファイルバージョンの確認**

    **注:**Microsoft Windows にはいくつかのバージョンがあるため、次のステップは使用中のコンピュータにより異なる場合があります。その場合、製品の説明書をご覧ください。

    1.  **\[スタート\]** をクリックし、次に **\[検索\]** をクリックします。
    2.  **\[検索結果\]** のウィンドウの **\[検索コンパニオン\]** の下の **\[ファイルとフォルダすべて\]** をクリックします。
    3.  **\[ファイル名のすべてまたは一部\]** のボックスで、適切なファイル情報の表からファイル名を入力し、次に **\[検索\]** をクリックします。
    4.  ファイルの一覧で、ファイル情報の表の適切なファイルからファイル名を右クリックし、次に **\[プロパティ\]** をクリックします。

        **注:**インストールされているオペレーティング システムまたはプログラムのバージョンにより、ファイル情報の表に記載されているファイルで、インストールされないものがある場合もあります。

    5.  **\[バージョン情報\]** タブで、適切なファイル情報テーブルに記載されているバージョンと比較し、コンピュータにインストールされているファイルのバージョンを確認します。

        **注:**ファイルのバージョン以外の属性はインストール中に変更される場合があります。そのほかのファイルの属性をファイル情報の表の情報と比較することは、更新プログラムが正しくインストールされたことを確認する方法としてサポートされていません。また、ファイル名がインストール中に変更される場合があります。ファイルまたはバージョンの情報が存在しない場合、その他の方法によって更新プログラムが正しくインストールされたことを確認してください。

-   **レジストリキーの確認**

    また、次のレジストリ キーを調べることにより、このセキュリティ更新プログラムがインストールしたファイルを確認することもできます

    Windows XP Home Edition、Windows XP Professional、Windows XP Home Edition Service Pack 1、Windows XP Professional Service Pack 1、Windows XP 64-Bit Edition Service Pack 1、Windows XP Tablet PC Edition、Windows XP Media Center Edition :

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP2\\KB840987\\Filelist

    Windows XP 64-Bit Edition Version 2003 :

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB840987\\Filelist

    **注:**これらのレジストリ キーには、インストールされるファイルの完全な一覧が含まれない場合があります。また、管理者または OEM メーカーによって 840987 のセキュリティ更新プログラムを Windows インストール ソース ファイルに統合またはスリップストリーム化されている場合、このレジストリ キーが適切に作成されない場合があります。

#### Windows 2000 (すべてのバージョン)

**必要条件** **:**

Windows 2000 にこのセキュリティ更新プログラムをインストールするには、Service Pack 3 (SP3) または Service Pack 4 (SP4) がインストールされている必要があります。

上記のソフトウェアのテストを行い、この脆弱性による影響を評価しました。それ以前のバージョンに関してはサポートの対象となっていないため、この脆弱性による影響は不明です。 ご使用中の製品およびバージョンのサポートライフサイクルを確認するためには、[マイクロソフト](http://www.microsoft.comhttp://support.microsoft.com/lifecycle/) サポート ライフサイクルの Web サイトをご覧下さい。

最新のサービス パックの入手方法に関する詳細情報は、マイクロソフト サポート技術情報 [260910](http://support.microsoft.com/kb/260910) をご覧下さい。

**この修正を含む予定のサービスパック:**

この問題に対する更新プログラムは Windows 2000 Service Pack 5 に含まれる予定です。

**インストールに関する情報** **:**

このセキュリティ更新プログラムは次のセットアップ スイッチをサポートします。

**/help:** インストール メッセージの一覧を表示します
**セットアップモード**
**/quiet:** QUIET モード (ユーザー入力を必要としません。表示もしません)
**/passive:** 無人モード (進行状況バーのみ)
**/uninstall:** パッケージをアンインストールします
**再起動オプション**
**/norestart:** インストールの完了後、再起動しません
**/forcerestart:** インストール後、再起動します
**特別なオプション**
**/l:** インストール済みの Windows ホットフィックスまたは更新パッケージを表示します
**/o:** 確認メッセージを表示せずに OEM ファイルを上書きします
**/n:** アンインストールに必要なファイルのバックアップを作成しません
**/f:** シャットダウン時に他のプログラムを強制終了します
**/extract:** セットアップを実行せずにファイルを抽出します

**注:** これらのスイッチを 1 つのコマンド ラインに組み込むことができます。旧バージョンとの互換性のため、このセキュリティ更新プログラムは、セットアップ ユーティリティの以前のバージョンによって使用されるセットアップ スイッチもサポートしています。サポートされるインストール スイッチに関する詳細は、マイクロソフト サポート技術情報 [262841](http://support.microsoft.com/kb/262841) をご覧下さい。

**適用に関する情報** **:**

ユーザーの操作なしでセキュリティ更新プログラムをインストールするためには、Windows 2000 Service Pack 3 および Windows 2000 Service Pack 4 のコマンド プロンプトで、次のコマンド ラインを使用してください。

**Windows2000-kb840987-x86-jpn /passive /quiet**

コンピュータを強制的に再起動せずにセキュリティ更新プログラムをインストールするためには、Windows 2000 Service Pack 3 および Windows 2000 Service Pack 4 のコマンド プロンプトで、次のコマンド ラインを使用して下さい。

**Windows2000-kb840987-x86-jpn /norestart**

Software Update Services に関するより詳細な情報は以下をご覧ください ：

[Software Update Services](http://www.microsoft.com/japan/windowsserversystem/sus/susoverview.mspx)の概要

**再起動の必要性** **:**

セキュリティの更新を適用してから、コンピュータを再起動する必要があります。

**削除に関する情報** **:**

この更新プログラムを削除するためには、\[コントロール パネル\] の \[プログラムの追加と削除\] を使用してください。

システム管理者は Spuninst.exe ユーティリティを使用し、このセキュリティ更新プログラムを削除することができます。Spuninst.exe ユーティリティは %Windir%\\$NTUninstallKB840987$\\Spuninst フォルダにあり、これは次のセットアップ スイッチをサポートします。

**/?**: インストール スイッチの一覧を表示します
**/u**: 無人モードを使用します
**/f**: シャットダウン時に他のプログラムを強制終了します
**/z**: インストールの完了後、再起動しません
**/q**: Quiet モードを使用します (ユーザー入力を必要としません)

**ファイルに関する情報** **:**

この更新プログラムの日本語版のファイル属性 (またはそれ以降) は次のとおりです。

Windows 2000 Service Pack 3 および Windows 2000 Service Pack 4:

| 日付       | 時間  | バージョン     | サイズ    | ファイル名   | フォルダ |
|------------|-------|----------------|-----------|--------------|----------|
| 2004/06/18 | 8:06  | 5.00.2195.6951 | 46,352    | basesrv.dll  |          |
| 2004/03/24 | 10:49 | 5.00.2195.6824 | 312,592   | cmd.exe      |          |
| 2004/06/18 | 08:06 | 5.00.2195.6945 | 231,184   | gdi32.dll    |          |
| 2004/06/18 | 08:06 | 5.00.2195.6946 | 906,512   | kernel32.dll |          |
| 2003/06/20 | 05:05 | 3.10.0.103     | 92,128    | krnl386.exe  |          |
| 2004/06/18 | 08:06 | 5.00.2195.6898 | 37,136    | mf3216.dll   |          |
| 2004/02/11 | 04:47 | 5.00.2195.6897 | 30,160    | mountmgr.sys |          |
| 2004/06/18 | 08:06 | 5.00.2195.6824 | 54,544    | mpr.dll      |          |
| 2004/06/18 | 08:06 | 5.00.2195.6928 | 335,120   | msgina.dll   |          |
| 2003/06/20 | 05:05 |                | 33,824    | ntio.sys     |          |
| 2003/06/20 | 05:05 |                | 34,544    | ntio404.sys  |          |
| 2003/06/20 | 05:05 |                | 35,648    | ntio411.sys  |          |
| 2003/06/20 | 05:05 |                | 35,408    | ntio412.sys  |          |
| 2003/06/20 | 05:05 |                | 34,544    | ntio804.sys  |          |
| 2004/06/18 | 03:15 | 5.00.2195.6952 | 1,704,128 | ntkrnlmp.exe |          |
| 2004/06/18 | 03:15 | 5.00.2195.6952 | 1,703,744 | ntkrnlpa.exe |          |
| 2004/06/18 | 03:15 | 5.00.2195.6952 | 1,725,440 | ntkrpamp.exe |          |
| 2004/06/18 | 03:15 | 5.00.2195.6952 | 1,680,960 | ntoskrnl.exe |          |
| 2004/06/18 | 03:15 | 5.00.2195.6946 | 415,504   | ntvdm.exe    |          |
| 2004/06/18 | 08:06 | 5.00.2195.6946 | 14,096    | ntvdmd.dll   |          |
| 2004/03/24 | 11:19 | 5.00.2195.6892 | 90,264    | rdpwd.sys    |          |
| 2004/05/17 | 04:42 | 5.00.2195.6928 | 464,896   | sp3res.dll   |          |
| 2004/03/24 | 11:19 | 5.00.2195.6897 | 403,216   | user32.dll   |          |
| 2003/08/06 | 07:19 | 5.00.2195.6794 | 385,808   | userenv.dll  |          |
| 2004/06/18 | 08:06 | 5.00.2195.6946 | 29,456    | vdmdbg.dll   |          |
| 2004/08/25 | 00:18 | 5.00.2195.6966 | 1,632,624 | win32k.sys   |          |
| 2004/08/25 | 16:18 | 5.00.2195.6970 | 182,544   | winlogon.exe |          |
| 2004/06/18 | 08:06 | 5.00.2195.6946 | 259,856   | winsrv.dll   |          |
| 2004/06/18 | 08:06 | 5.00.2195.6946 | 239,888   | wow32.dll    |          |
| 2004/06/18 | 08:06 | 5.00.2195.6946 | 906,512   | kernel32.dll | Uniproc  |
| 2004/08/25 | 00:18 | 5.00.2195.6966 | 1,632,624 | win32k.sys   | Uniproc  |
| 2004/06/18 | 08:06 | 5.00.2195.6946 | 259,856   | winsrv.dll   | Uniproc  |

**更新プログラムが正しくインストールされたかどうか確認する方法** **:**

-   **Microsoft Baseline Security Analyzer**

    影響を受けるコンピュータにセキュリティ更新プログラムがインストールされていることを確認するためには、Microsoft Baseline Security Analyzer (MBSA) ツールを使用して下さい。管理者は、一般的なセキュリティ上誤った構成とともに、不足しているセキュリティ更新プログラムについて、ローカル コンピュータおよびリモート コンピュータをMicrosoft Baseline Security Analyzer (MBSA) を使ってスキャンすることができます。MBSA に関する追加情報は、[Microsoft Baseline Security Analyzer](http://technet.microsoft.com/ja-jp/security/cc184924.aspx) の Web サイトをご覧下さい。

-   **ファイルバージョンの確認**

    **注:** Microsoft Windows にはいくつかのバージョンがあるため、次のステップは使用中のコンピュータにより異なる場合があります。その場合、製品の説明書をご覧ください。

    1.  **\[スタート\]** をクリックし、次に **\[検索\]** をクリックします。
    2.  **\[検索結果\]** のウィンドウの **\[検索コンパニオン\]** の下の **\[ファイルとフォルダすべて\]** をクリックします。
    3.  **\[ファイル名のすべてまたは一部\]** のボックスで、適切なファイル情報の表からファイル名を入力し、次に **\[検索\]** をクリックします。
    4.  ファイルの一覧で、適切なファイル情報の表からファイル名を右クリックし、次に **\[プロパティ\]** をクリックします。

        **注:** インストールされているオペレーティング システムまたはプログラムのバージョンにより、ファイル情報の表に記載されているファイルで、インストールされないものがある場合もあります。

    5.  **\[バージョン情報\]** タブで、適切なファイル情報の表に記載されているバージョンと比較し、コンピュータにインストールされているファイルのバージョンを確認します。

        **注:** ファイルのバージョン以外の属性はインストール中に変更される場合があります。そのほかのファイルの属性をファイル情報の表の情報と比較することは、更新プログラムが正しくインストールされたことを確認する方法としてサポートされていません。また、ファイル名がインストール中に変更される場合があります。ファイルまたはバージョンの情報が存在しない場合、その他の方法によって更新プログラムが正しくインストールされたことを確認して下さい。

-   **レジストリキーの確認**

    また、次のレジストリ キーを調べることにより、このセキュリティ更新プログラムがインストールしたファイルを確認することもできます。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP5\\KB840987\\Filelist

    **注：** これらのレジストリ キーには、インストールされるファイルの完全な一覧が含まれない場合があります。 また、管理者または OEM メーカーによって 840987 のセキュリティ更新プログラムを Windows インストール ソース ファイルに統合またはスリップストリーム化されている場合、このレジストリ キーが適切に作成されない場合があります。

#### Windows NT Server 4.0 (すべてのバージョン)

**必要条件** **:**

このセキュリティ更新プログラムをインストールするには、Windows NT Server 4.0 Service Pack 6a (SP6a)、または Windows NT Server 4.0 Terminal Server Edition Service Pack 6 (SP6) がインストールされている必要があります。

上記のソフトウェアのテストを行い、この脆弱性による影響を評価しました。それ以前のバージョンに関してはサポートの対象となっていないため、この脆弱性による影響は不明です。ご使用中の製品およびバージョンのサポートライフ サイクルを確認するためには、[マイクロソフト](http://www.microsoft.comhttp://support.microsoft.com/lifecycle/) サポート ライフサイクルの Web サイトをご覧下さい。

最新のサービス パックの入手方法に関する詳細情報は、マイクロソフト サポート技術情報 [152734](http://support.microsoft.com/kb/152734) をご覧下さい。

**インストール情報** **:**

このセキュリティ更新プログラムは次のセットアップ スイッチをサポートします。

**/u:** アンインストールを実行します (/m または /q と共に指定)
**/f:** シャットダウン時にアプリケーションを強制終了します
**/n:** アンインストール ディレクトリを作成しません
**/z:** アップデート終了時に再起動しません
**/q:** メッセージなし - ユーザー インターフェイスがありません (このスイッチは /m の機能を含みます)
**/m:** 無人モードでアップグレードします
**/l:** インストールされている Hotfix の一覧を表示します
**/x:** セットアップを実行せずにファイルを抽出します

**注:** これらのスイッチを 1 つのコマンド ラインに組み込むことができます。 サポートされるインストール スイッチに関する詳細は、マイクロソフト サポート技術情報 [262841](http://support.microsoft.com/kb/262841) をご覧ください。

**適用に関する情報** **:**

ユーザーの操作なしでセキュリティ更新プログラムをインストールするためには、Windows NT Server 4.0 のコマンド プロンプトで次のコマンド ラインを使用してください。

**WindowsNT4Server-KB840987-x86-JPN /q**

Windows NT Server 4.0 Terminal Server Edition :

**WindowsNT4TerminalServer-KB840987-x86-JPN /q**

コンピュータを強制的に再起動せずにセキュリティ更新プログラムをインストールするためには、Windows NT Server 4.0 のコマンド プロンプトで次のコマンド ラインを使用してください。

**WindowsNT4Server-KB840987-x86-JPN /z**

Windows NT Server 4.0 Terminal Server Edition :

**WindowsNT4TerminalServer-KB840987-x86-JPN /z**

**再起動の必要性** **:**

セキュリティの更新を適用してから、コンピュータを再起動する必要があります。

**削除に関する情報** **:**

この更新プログラムを削除するためには、\[コントロール パネル\] の \[プログラムの追加と削除\] を使用してください。

システム管理者は Hotfix.exe ユーティリティを使用し、このセキュリティ更新プログラムを削除することができます。 Hotfix.exe ユーティリティは %Windir%\\$NTUninstallKB873350$\\ フォルダにあります。 このユーティリティは次のセットアップ スイッチをサポートします。

**/u:** アンインストールを実行します (/m または /q と共に指定)
**/f:** シャットダウン時にアプリケーションを強制終了します
**/n:** アンインストール ディレクトリを作成しません
**/z:** アップデート終了時に再起動しません
**/q:** メッセージなし - ユーザー インターフェイスがありません (このスイッチは /m の機能を含みます)
**/m:** 無人モードでアップグレードします
**/l:** インストールされている Hotfix の一覧を表示します

**ファイルに関する情報** **:**

この更新プログラムの日本語版のファイル属性 (またはそれ以降) は次のとおりです。

**Windows NT Server 4.0:**

| 日付       | 時間  | バージョン    | サイズ    | ファイル名   |
|------------|-------|---------------|-----------|--------------|
| 2004/06/07 | 15:02 | 4.0.1381.7275 | 232,032   | gdi32.dll    |
| 2004/06/03 | 18:59 | 4.0.1381.7255 | 108,224   | imm32.dll    |
| 2004/02/25 | 18:10 | 4.0.1381.7263 | 44,448    | mf3216.dll   |
| 2004/05/21 | 17:15 | 4.0.1381.7267 | 1,022,096 | ntkrnlmp.exe |
| 2004/05/21 | 17:18 | 4.0.1381.7267 | 1,001,456 | ntoskrnl.exe |
| 2004/06/03 | 19:00 | 4.0.1381.7270 | 382,736   | user32.dll   |
| 2004/08/05 | 12:34 | 4.0.1381.7301 | 1,411,520 | win32k.sys   |
| 2004/06/03 | 19:00 | 4.0.1381.7255 | 270,688   | winsrv.dll   |

**Windows NT Server 4.0 Terminal Server Edition:**

| 日付       | 時間  | バージョン     | サイズ    | ファイル名   |
|------------|-------|----------------|-----------|--------------|
| 2004/06/04 | 14:08 | 4.0.1381.39784 | 232,864   | gdi32.dll    |
| 2003/08/20 | 8:14  | 4.0.1381.39775 | 109,056   | imm32.dll    |
| 2004/02/24 | 19:38 | 4.0.1381.39778 | 44,448    | mf3216.dll   |
| 2004/05/21 | 18:45 | 4.0.1381.39782 | 1,071,696 | ntkrnlmp.exe |
| 2004/03/18 | 16:42 | 4.0.1381.39780 | 1,049,904 | ntoskrnl.exe |
| 2003/08/20 | 8:14  | 4.0.1381.39775 | 388,304   | user32.dll   |
| 2004/08/05 | 10:20 | 4.0.1381.39798 | 1,439,136 | win32k.sys   |
| 2003/08/20 | 8:13  | 4.0.1381.39775 | 294,176   | winsrv.dll   |

**更新プログラムが正しくインストールされたかどうか確認する方法** **:**

-   **Microsoft Baseline Security Analyzer**

    影響を受けるコンピュータにセキュリティ更新プログラムがインストールされていることを確認するためには、Microsoft Baseline Security Analyzer (MBSA) ツールを使用して下さい。管理者は、一般的なセキュリティ上誤った構成とともに、不足しているセキュリティ更新プログラムについて、ローカル コンピュータおよびリモート コンピュータを Microsoft Baseline Security Analyzer (MBSA) を使ってスキャンすることができます。MBSA に関する追加情報は、[Microsoft Baseline Security Analyzer](http://technet.microsoft.com/ja-jp/security/cc184924.aspx) の Web サイトをご覧下さい。

-   **ファイルバージョンの確認**

    **注:** Microsoft Windows にはいくつかのバージョンがあるため、次のステップは使用中のコンピュータにより異なる場合があります。その場合、製品の説明書をご覧ください。

    1.  **\[スタート\]** をクリックし、次に **\[検索\]** をクリックします。
    2.  検索結果ウィンドウの検索コンパニオンで **\[すべてのファイルとフォルダ\]** をクリックします。
    3.  **\[検索結果\]** のウィンドウの **\[検索コンパニオン\]** の下の **\[ファイルとフォルダすべて\]** をクリックします。
    4.  ファイルの一覧で、適切なファイル情報の表からファイル名を右クリックし、次に **\[プロパティ\]** をクリックします。

        **注:** インストールされているオペレーティング システムまたはプログラムのバージョンにより、ファイル情報の表に記載されているファイルで、インストールされないものがある場合もあります。

    5.  **\[バージョン情報\]** タブで、適切なファイル情報の表に記載されているバージョンと比較し、コンピュータにインストールされているファイルのバージョンを確認します。

        **注:** そのほかのファイルの属性をファイル情報の表の情報と比較することは、更新プログラムが正しくインストールされたことを確認する方法としてサポートされていません。また、ファイル名がインストール中に変更される場合があります。ファイルまたはバージョンの情報が存在しない場合、その他の方法によって更新プログラムが正しくインストールされたことを確認して下さい。

-   **レジストリキーの確認**

    また、次のレジストリ キーを調べることにより、このセキュリティ更新プログラムがインストールしたファイルを確認することもできます。

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Hotfix\\KB840987\\File 1

    **注：** これらのレジストリ キーには、インストールされるファイルの完全な一覧が含まれない場合があります。 また、管理者または OEM メーカーによって 840987 のセキュリティ更新プログラムを Windows インストール ソース ファイルに統合またはスリップストリーム化されている場合、このレジストリ キーが適切に作成されない場合があります。

### その他の情報

**謝辞** **:**

この問題を連絡し、顧客の保護に協力して下さった下記の方に対し、マイクロソフトは深い[謝意](http://technet.microsoft.com/security/bulletin/policy)を表します。

-   「Window Management の脆弱性」 (CAN-2004-0207) を報告してくださった [Security-Assessment.com](http://security-assessment.com/) の Brett Moore 氏
-   「VDMの脆弱性」 (CAN-2004-0208) を報告してくださった [eEye Digital Security](http://www.eeye.com/html/)
-   [Winternals Software](http://www.winternals.com/)の Mark Russinovich 氏に協力し、「Graphics Rendering Engineの脆弱性」 (CAN-2004-0209) を報告してくださった [Patrick Porlan](https://technet.microsoft.com/ja-JP/mailto:porlan@club-internet.fr)氏
-   「Windows のカーネルの脆弱性」 (CAN-2004-0211) を報告してくださった [hlt](https://technet.microsoft.com/ja-JP/mailto:hlt@dgap.mipt.ru) 氏

**他のセキュリティ更新プログラムの入手先** **:**

他のセキュリティ問題を解決する更新プログラムは以下のサイトから入手できます。

-   セキュリティ更新プログラムは[マイクロソフト ダウンロード センター](http://www.microsoft.com/downloads/results.aspx?displaylang=ja&freetext=security_patch)からダウンロードすることができます。「security\_patch」 のキーワード探索によって容易に見つけることができます。
-   コンシューマ プラットフォーム用の更新プログラムは、[Microsoft Update](http://update.microsoft.com/microsoftupdate/)Web サイトからダウンロードできます。
-   本セキュリティ情報及び公開された更新プログラムは、[TechNet CD サブスクリプション](http://www.microsoft.com/japan/technet/subscriptions/)でも入手可能です。

**他のセキュリティ情報** **:**

-   [Microsoft TechNet Security センター](http://technet.microsoft.com/ja-jp/security/default.aspx) では、製品に関するセキュリティ情報を提供しています。
-   Microsoft Software Update Services : <http://www.microsoft.com/japan/windowsserversystem/updateservices/>
-   Microsoft Baseline Security Analyzer (MBSA) : <http://technet.microsoft.com/ja-jp/security/cc184924.aspx> MBSA ツールのセキュリティ更新プログラムの検出に関する制限は <http://support.microsoft.com/kb/306460> をご覧ください。
-   Microsoft Update : <http://update.microsoft.com/microsoftupdate/>
-   Windows Update カタログ : <http://support.microsoft.com/kb/323166>
-   Office のアップデート : <http://office.microsoft.com/officeupdate/>

**Software Update Services (SUS) :**

Microsoft Software Update Services (SUS) は、最新の重要な更新プログラムを適用し、Windows ベースのシステムを最新の状態に維持するプロセスを大幅に簡素化する目的で開発されました。SUS により、重要な更新プログラムを Windows® 2000 や Windows Server™ 2003 ベースのサーバー、ならびに Windows® 2000 Professional や Windows XP Professional を実行するデスクトップ コンピュータへ迅速かつ確実に配布することができます。

Software Update Services に関するより詳細な情報は以下をご覧ください:
<http://www.microsoft.com/japan/windows2000/windowsupdate/sus/>

**Systems Management Server (SMS) :**

Microsoft Systems Management Server (SMS) は更新プログラムを管理するための、構成可能なエンタープライズ ソリューションを提供します。SMS により、管理者はセキュリティ更新プログラムを必要とする Windows ベースのコンピュータを識別し、エンタープライズ全体で、エンド ユーザーへの中断を最小限にして、これらの更新プログラムの制御された適用を実行することができます。セキュリティ更新プログラムを適用するための SMS 2003 の使用方法に関する詳細情報は [SMS 2003 セキュリティ パッチ管理 Web サイト](http://www.microsoft.com/japan/smserver/evaluation/tips.mspx)をご覧下さい。SMS 2.0 ユーザーもまた、[Software Updates Service Feature Pack](http://www.microsoft.com/japan/smserver/downloads/20/featurepacks/suspack/) を活用して、セキュリティ更新プログラムの適用を支援することができます。SMS に関する情報は [SMS の Web サイト](http://www.microsoft.com/japan/smserver/default.mspx)をご覧下さい。

**注:** SMS は Microsoft Baseline Security Analyzer および Microsoft Office 検出ツールを活用してセキュリティ情報で提供された更新プログラムの検出と適用について広範なサポートを提供します。これらのツールにより検出されないソフトウェアの更新プログラムもあります。管理者は、特定のコンピュータへの更新プログラムを対象とし、これらの場合に SMS のインベントリ機能を使用することができます。この手順に関する詳細情報は、[こちらの Web サイト](http://www.microsoft.com/technet/prodtechnol/sms/sms2003/patchupdate.mspx) (英語情報) をご覧下さい。コンピュータの再起動後、管理者権限を必要とするセキュリティ更新プログラムもあります。管理者は、SMS 2.0 Administration Feature Pack の上位権利での展開ツール ([SMS Administration Feature Pack](http://www.microsoft.com/technet/sms/2003/downloads/featurepacks/adminpack.mspx) (英語情報) および [SMS 2.0 Administration Feature Pack](http://www.microsoft.com/japan/smserver/downloads/20/featurepacks/adminpack/) でご利用可能です) は、これらの更新プログラムのインストールに使用することができます。

**サポート** **:**

-   セキュリティ関連、およびセキュリティ更新プログラムに関するご質問や、ご不明な点などありましたら、マイクロソフト セキュリティ情報センターまでご連絡ください。
    [マイクロソフト セキュリティ情報センター](http://www.microsoft.com/japan/security/sicinfo.mspx)
-   その他、製品に関するご質問は、マイクロソフト プロダクト サポートまでご連絡ください。マイクロソフトでは、お問い合わせの内容が弊社製品の不具合が原因である場合、無償またはインシデントの未消費にてサポートをご提供いたします。
    [マイクロソフト プロダクト サポートへの連絡方法はこちらをご覧ください。](http://support.microsoft.com/select/?target=assistance)
-   製品のサポート期間の詳細は、[マイクロソフト サポート ライフサイクル Web サイト](http://www.microsoft.com/lifecycle)をご参照ください。製品別情報の詳細は、同様にマイクロソフト サポート ライフサイクル Web サイトの [製品を探す](http://support.microsoft.com/default.aspx?scid=fh;ja;complifeport)からご確認ください。
    **注:** Windows NT 4.0 Workstation は、ライフサイクルを終了しております。詳細につきましては、「よく寄せられる質問」をご確認ください。

**詳細情報** **:**

-   US マイクロソフトセキュリティ情報（MS04-032）
    [http://www.microsoft.com/technet/security/bulletin/ms04-032.mspx](http://technet.microsoft.com/security/bulletin/ms04-032)
-   サポート技術情報 （KB） 文書番号 ：840987
    [\[MS04-032\] Microsoft Windows のセキュリティ更新プログラム](http://support.microsoft.com/kb/840987)

**更新履歴** **:**

-   2004/10/13: このセキュリティ情報ページを公開しました。
-   2008/12/11: このセキュリティ情報ページを更新し、「このセキュリティ更新プログラムに関するよく寄せられる質問」の欄に Windows Server 2003 の更新プログラム パッケージの削除に関する質問および回答を追加しました。この更新プログラムを既に適用しているお客様は何も行う必要はありません。

本セキュリティ情報に含まれている情報は、いかなる保証もない現状ベースで提供されるものです。Microsoft Corporation 及びその関連会社は、市場性および特定の目的への適合性を含めて、明示的にも黙示的にも、一切の保証をいたしません。さらに、Microsoft Corporation 及びその関連会社は、本文書に含まれている情報の使用及び使用結果につき、正確性、真実性等、いかなる表明・保証も行ないません。Microsoft Corporation、その関連会社及びこれらの権限ある代理人による口頭または書面による一切の情報提供またはアドバイスは、保証を意味するものではなく、かつ上記免責条項の範囲を狭めるものではありません。Microsoft Corporation、その関連会社 及びこれらの者の供給者は、直接的、間接的、偶発的、結果的損害、逸失利益、懲罰的損害、または特別損害を含む全ての損害に対して、状況のいかんを問わず一切責任を負いません。（Microsoft Corporation、その関連会社 またはこれらの者の供給者がかかる損害の発生可能性を了知している場合を含みます。) 結果的損害または偶発的損害に対する責任の免除または制限を認めていない地域においては、上記制限が適用されない場合があります。-

*Built at 2014-04-18T01:50:00Z-07:00*
