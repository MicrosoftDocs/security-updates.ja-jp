---
TOCTitle: RPC および DCOM の脆弱性の影響を緩和するための最善策
Title: RPC および DCOM の脆弱性の影響を緩和するための最善策
ms:assetid: 'fc8a2694-e254-43a4-b94c-3c986bb4bfe5'
ms:contentKeyID: 19871740
ms:mtpsurl: 'https://technet.microsoft.com/ja-jp/library/Dd362794(v=TechNet.10)'
---

RPC および DCOM の脆弱性の影響を緩和するための最善策
====================================================

##### トピック

[](#ehaa)[修正プログラムはどこから入手できますか？](#ehaa)
[](#egaa)[背景](#egaa)
[](#efaa)[問題の説明](#efaa)
[](#eeaa)[管理者は何をする必要がありますか？](#eeaa)
[](#edaa)[脆弱性の影響を受けるコンピュータの検出](#edaa)
[](#ecaa)[緩和策](#ecaa)
[](#ebaa)[感染したコンピュータでワームを駆除する方法](#ebaa)
[](#eaaa)[技術サポート](#eaaa)

このホワイト ペーパーはシステム管理者および技術者がマイクロソフトのオペレーティング システムの RPC および DCOM のサブシステムの脆弱性の悪用によって発生する被害を防ぐために利用することができるものです。これらの脆弱性は、マイクロソフト セキュリティ情報 MS03-026 および MS03-039 で説明されています。この脆弱性は現在サポートされているマイクロソフトのほとんどのオペレーティング システムに影響を及ぼしますが、このホワイト ペーパーは、主に技術者を対象としています。コンシューマは <http://www.microsoft.com/japan/athome/security/protect/> を参照し、記載されているステップに従い、この攻撃およびそのほかの脅威から自ら保護することを推奨します。

### 修正プログラムはどこから入手できますか？

マイクロソフトはこの問題の重要性を考慮し、お客様に必要な修正プログラムをできるだけ早期にインストールすることを強く推奨します。影響を受けるシステムが攻撃されるのを防ぐために実行できる緩和策がいくつかありますが、マイクロソフトは可能な限りすべてのシステムに修正プログラムを適用することを強く推奨いたします。修正プログラムは Windows Update (<http://windowsupdate.microsoft.com>) および以下のサイトからインストールすることができます。

-   [Windows NT Server 4.0](http://www.microsoft.com/downloads/details.aspx?familyid=71b6135c-f957-4702-b376-2dacce773dc0&displaylang=ja)

-   [Windows NT Server 4.0(NEC PC98 シリーズ)](http://www.microsoft.com/downloads/details.aspx?displaylang=ja-nec&familyid=71b6135c-f957-4702-b376-2dacce773dc0)

-   [Windows NT Workstation 4.0](http://www.microsoft.com/downloads/details.aspx?familyid=7eabad74-9ca9-48f4-8db5-cf8c188879da&displaylang=ja)

-   [Windows NT Workstation 4.0 (NEC PC98 シリーズ)](http://www.microsoft.com/downloads/details.aspx?familyid=7eabad74-9ca9-48f4-8db5-cf8c188879da&displaylang=ja)

-   [Windows NT Server 4.0, Terminal Server Edition](http://www.microsoft.com/downloads/details.aspx?familyid=6c0f0160-64fa-424c-a3c1-c9fad2dc65ca&displaylang=ja)

-   [Windows 2000](http://www.microsoft.com/downloads/details.aspx?familyid=f4f66d56-e7ce-44c3-8b94-817ea8485dd1&displaylang=ja)

-   [Windows 2000 (NEC PC98 シリーズ)](http://www.microsoft.com/downloads/details.aspx?displaylang=ja-nec&familyid=f4f66d56-e7ce-44c3-8b94-817ea8485dd1)

-   [Windows XP 32 bit Edition](http://www.microsoft.com/downloads/details.aspx?familyid=5fa055ae-a1ba-4d4a-b424-95d32cfc8cba&displaylang=ja)

-   [Windows XP 64 bit Edition](http://www.microsoft.com/downloads/details.aspx?familyid=50e4fb51-4e15-4a34-9dc3-7053ec206d65&displaylang=ja)

-   [Windows Server 2003 32 bit Edition](http://www.microsoft.com/downloads/details.aspx?familyid=51184d09-4f7e-4f7b-87a4-c208e9ba4787&displaylang=ja)

-   [Windows Server 2003 64 bit Edition](http://www.microsoft.com/downloads/details.aspx?familyid=80ab25b3-e387-441f-9b6d-84106f66059b&displaylang=ja)

ほとんどのお客様は 32-bit Editionのオペレーティング システムを使用しています。使用しているバージョンが不明の場合は、まず 32-bit Edition をお試しください。

[](#mainsection)[ページのトップへ](#mainsection)

### 背景

2003 年 7 月 16 日 （米国日付）、マイクロソフトは、マイクロソフト セキュリティ情報 [MS03-026](http://www.microsoft.com/japan/technet/security/bulletin/ms03-026.mspx) にて、マイクロソフトのオペレーティング システムのいくつかで利用可能な Distributed Component Object Model (DCOM) サービスのコンポーネントに存在するバッファ オーバーフローに対する修正プログラムをリリースしました。2003 年 9 月 10 日、マイクロソフトは [MS03-039](http://www.microsoft.com/japan/technet/security/bulletin/ms03-039.mspx) をリリースし、DCOM アクティブ化ルーチンの別のセキュリティ上の脆弱性に対する修正プログラムが入手可能になったことをお知らせしました。MS03-039 でリリースされた修正プログラムには MS03-026 でリリースされた修正プログラムが含まれ、それらのプログラムの代わりに使用する必要があります。MS03-026 でリリースされた修正プログラムが適用されたコンピュータは、MS03-039 で説明された脆弱性の影響を受ける可能性が依然として存在することにご注意ください。

この修正プログラムは、DCOM に存在する既知の脆弱性を全て排除する効果があります。マイクロソフトは、現在も多数のコンピューターにこの脆弱性の影響を回避する修正プログラムが適用されていない事に対し、非常に強い懸念を抱いております。2003 年 7 月 25 日、いくつかのハッカー組織が MS03-026 で説明された脆弱性を悪用するコードをインターネット上に公開しました。MS03-039 の修正プログラムのリリース直後、その脆弱性を悪用するサンプルの悪用コードが公開されると予想されていました。公に使用できる悪用コードにより、攻撃者が攻撃を実行するワームおよびほかの悪用コードを作成するのが非常に容易にできるようになります。そのため、この修正プログラムのインストールをさらに緊急に行う必要があります。この脆弱性を悪用するサンプル プログラムの多くは、実際には攻撃が行われないものか、またはローカル コンピュータを侵害するためのトロイの木馬で、任意のリモートの標的の代わりに実効される可能性があるものですが、中には広範囲な攻撃が行うツールがあります。このような攻撃が実行されるコードは、標的のコンピュータまたはネットワークを完全に侵害するために悪用されます。したがって、コンピュータをできるだけ早期に保護することが絶対的に必要です。

[](#mainsection)[ページのトップへ](#mainsection)

### 問題の説明

Microsoft Windows システムのリモート プロシージャ コール (RPC) サービスは、ローカルおよびリモートの両方のプロセスの間でシームレスな通信を提供するために使用されます。RPC は、プログラマからネットワークの実装の詳細を抽出するために使用され、これにより、プログラマはネットワークの詳細ではなく、プログラムの実装に焦点を当てることができます。RPC により、DCOM など、多くの異なるサービスに通信プラットフォームが提供されます。Windows のほとんどのバージョンの DCOM の実装に、バッファ オーバーフローの脆弱性が確認されました。具体的には、DCOM コンポーネントの RPCSS アクティブ化インターフェイスに脆弱性が存在します。これらのバッファ オーバーフローが悪用された場合、任意のコードが実行される恐れがあります。これらの悪用プログラムの記述は、一般的には、簡単ではありません。しかし現在、これらの脆弱性のうちの最低でも 1 つを悪用するコードのいくつかが公開されています。たとえば、Blaster ワームは、これらの脆弱性の 1 つが悪用されたものです。

#### バッファ オーバーフローとは何ですか？

バッファ オーバーフローは、さまざまな問題から発生する可能性がある非常に一般的なプログラマのミスです。その名前が示すように、問題の中心は、プログラムがバッファに設計された以上の量のデータを格納しようとするということです。この共通のエラーは、様々な形式でおこる可能性があります。この種の問題を引き起こす構造の中には明らかなものがありますが、発見が非常に困難である場合もあります。

攻撃者がバッファ オーバーフローを悪用するには、標的となるコンピュータに、バッファに含むことができる量より多くのデータを送信する可能性があります。その結果、超過したデータにより、メモリのほかの部分が上書きされます。メモリ中のその部分に実行される命令が含まれている場合、コンピュータで、攻撃者が命令として送信したデータが翻訳され、実行される可能性があります。いくつかのケースで、実際に実行可能なプログラム コードであるデータが含まれるバッファに上書きし、コンピュータに任意のコードを実行させることは可能です。これは「悪用可能な」バッファ オーバーフローとして知られています。[MS03-026](http://www.microsoft.com/japan/technet/security/bulletin/ms03-026.mspx) および [MS03-039](http://www.microsoft.com/japan/technet/security/bulletin/ms03-039.mspx) の修正プログラムを適用したバッファ オーバーフローは悪用が可能なバッファ オーバーフローです。

#### テストされたシステムはどれですか？

マイクロソフトは、現在サポートされているすべてのオペレーティング システムで報告されているすべてのセキュリティ上の脆弱性のためのテストを行っています。以下のシステムがテスト済みです。

-   Windows Server 2003 Gold

-   Windows Server 2003 64-bit Edition

-   Windows 2000 Service Pack 4

-   Windows 2000 Service Pack 3

-   Windows 2000 Service Pack 2

-   Windows XP Service Pack 1

-   Windows XP 64-bit Edition, Version 2003

-   Windows XP 64-bit Edition, Version 2002

-   Windows XP Gold

-   Windows NT Server 4.0 Service Pack 6a

-   Windows NT Workstation 4.0 Service Pack 6a

-   Windows NT Server 4.0, Terminal Services Edition SP6

この場合、"Gold" は、Service Pack が適用されていない、製品の最初のリリース版を意味します。

Windows 2000 Service Pack 2 および Windows NT Workstation 4.0 Service Pack 6a はサポートが終了していることにご注意ください。しかし、この脆弱性の特性およびこの製品のサポートが終了したのがつい最近であり、また現在これらのシステムが使用されている数が多いという事実により、マイクロソフトはこの脆弱性に関し、Windows 2000 Service Pack 2 および Windows NT Workstation 4.0 Service Pack 6a のプラットフォーム向けに例外の措置をとることを決定しました。未知の脆弱性に関しては、今回のような措置は行う予定はありませんが、必要に応じ、修正プログラムを作成し、提供する権限を残しています。サポート対象外の製品に対する修正プログラムが必要なお客様は、サポート窓口からこれらの修正プログラムを入手できる場合があります。詳細は、マイクロソフト製品サポートにご連絡ください。未知の脆弱性からコンピュータを保護するためには、既存の Windows 2000 Service Pack 2 および Windows NT Workstation 4.0 Service Pack 6a をご使用のお客様は、できるだけ早期にサポート対象のプラットフォームにアップグレードすることを強く推奨します。

上記の製品のほかに、Windows Me のテストも行われ、この問題の影響を受けないことが確認されました。これにより、マイクロソフトのオペレーティング システムのサポートされているバージョンはすべてテストされたことになります。現在サポートされていないオペレーティング システムのバージョンのテストは行われていないため、それらのバージョンもこの脆弱性の影響を受ける可能性があります。マイクロソフトのサポート ポリシーに関する詳細は、Windows ライフ サイクルのページを参照してください。
<http://www.microsoft.com/japan/windows/lifecycle/default.mspx>

[](#mainsection)[ページのトップへ](#mainsection)

### 管理者は何をする必要がありますか？

*使用しているコンピュータに修正プログラムを適用してください！*

この問題に対応するため最も重要なのは、できるだけ早期にご使用の環境の影響を受けるすべてのコンピュータに修正プログラムを適用することです。多くの緩和策が利用可能ですが、修正プログラムのインストールの代わりになる方法はありません。コンピュータがインターネットに直接接続されていない場合でも、信頼さ れたコンピュータによる攻撃から、この脆弱性の影響を受ける可能性は依然としてあります。それらのコンピュータには、企業イントラネット上のほかのホスト、VPN またはダイヤルインによって組織的なネットワークにダイヤルされたホスト、およびインターネットからネットワークを保護するファイアウォールの背後に配置することができる他のホストが含まれます。また、RPC および (または) イントラネット上の DCOM を無効に設定することなどの対応策により、ほかの多くの機能に影響が及び、コンピュータのある部分で正常の動作が行われなくなる場合があります。そのため、この問題に取り組むためのよりよいアプローチは、できるだけ早期にすべてのコンピュータに修正プログラムを適用することになります。利用可能な修正プログラムに関する詳細は、「修正プログラムはどこから入手することができますか？」のセクションを参照してください。しかし、修正プログラムがインストールできない場合、または修正プログラムが適用される前に攻撃を受けたコンピュータの場合、「緩和策」の部分をご覧ください。

[](#mainsection)[ページのトップへ](#mainsection)

### 脆弱性の影響を受けるコンピュータの検出

コンピュータに修正プログラムが適用されたかどうかを検知するいくつかの方法があります。単一のコンピュータでチェックする最も単純な方法はWindows Update (<http://windowsupdate.microsoft.com>) を使用することです。しかし、複数のシステムでインストールを行うお客様は、そのほかの方法が便利です。ネットワーク管理インフラストラクチュアが存在する大きなネットワーク上では、管理者は以下のレジストリ キーを確認することにより、修正プログラムを検知することができます。

-   Windows Server 2003

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB824146

-   Windows XP Gold

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP1\\KB824146

-   Windows XP SP1

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP2\\KB824146

-   Windows 2000 SP3 and SP4

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP5\\KB824146

-   Windows NT Server 4.0 SP6a

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\Current Version\\Hotfix\\Q824146

-   Windows NT Server 4.0, Terminal Services Edition, SP6

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\Current Version\\Hotfix\\Q824146

**脆弱性の影響を受けるコンピュータのスキャン**

ネットワーク管理者は、KB824146scan.exe のスキャン ツールを使用して、ネットワーク上で 823980 (MS03-026) または 824146 (MS03-039) のセキュリティ修正プログラムがインストールされていないホストコンピュータを識別することができます。このツールについての詳細および、ツールのダウンロードに関しては、マイクロソフト サポート技術情報 827363 を参照ください。
[http://support.microsoft.com/kb/827363/ja](http://support.microsoft.com/kb/827363)

マイクロソフトは KB823980scan.exe ツールをリリースしています。このツールは MS03-026 の修正プログラムが適用されていないコンピュータのみをスキャンするツールで、MS03-039 がインストールされたコンピュータに MS03-026 がインストールされていないという誤ったリポートが行なわれます。更新された KB824146scan.exe ツールを使用し、これらの脆弱性の影響を受けるシステムをスキャンしてください。

KB824146scan.exe ツールでは、認証なしリモート ホスト コンピュータのスキャンを行うことができます。（つまり、リモート ホストコンピュータに有効な資格情報を入力する必要がありません。）Windows Server 2003 ベース、Windows XP ベース、またはWindows 2000 ベースのコンピュータから KB824146scan.exe のツールを使用することができます。このツールは、修正プログラムのためのレジストリまたはファイル情報を確認するのではなく、対象のコンピュータと RPC セッションを確立し、そのコンピュータの状態 (修正プログラム適用済み、未適用、または非確認) を推測します。しかし、このツールにより、MS03-026 または MS03-039 で説明されている DCOM の脆弱は悪用されません。したがって、このツールにより、対象となるコンピュータが不安定になることはありません。

このツールは、以下のサイトからインストールすることができます。
[http://www.microsoft.com/downloads/details.aspx?FamilyId=13AE421B-7BAB-41A2-843B-FAD838FE472E&displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=13ae421b-7bab-41a2-843b-fad838fe472e&displaylang=en)

また、ウイルス対策ソフトウェアベンダーのインターネット セキュリティ システムズ株式会社からツールが提供されています。このツールを使用するとネットワーク上で 824146 (MS03-039) のセキュリティ修正プログラムがインストールされていないホストコンピュータを識別することができます。詳細については以下のサイトをご覧ください。

インターネット セキュリティ システムズ株式会社
セキュリティ管理者向けツール MS03-039　RPCSS サービスの脆弱性を検査する「Xfrpcss」
http://www.isskk.co.jp/security\_center/152/ms03-039rpc.html![](images/Dd362794.leave-ms(ja-jp,TechNet.10).gif)

また、Microsoft Baseline Security Analyzer (MBSA) を使用して、MS03-039 やほかの修正プログラムが適用されていないコンピュータのためにスキャンを行うことができます。MBSA は、対象のコンピュータ上での管理者権限が必要ですが、KB824146scan.exe ツールでは管理者権限が必要ではありません。マイクロソフトは MBSA を使用して、ネットワークの全体的な修正プログラムの状態を評価することを強く推奨しますが、MS03-039 の修正プログラムがインストールされているかを確認するには、以下のテーブルを使用し、どのツールが適切かを決定してください。

 
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >MBSA</th>
<th style="border:1px solid black;" >KB824146scan.exe</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">824146 (MS03-039) のスキャン</td>
<td style="border:1px solid black;">可</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">823980 (MS03-026) のスキャン</td>
<td style="border:1px solid black;">可</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">対象のコンピュータの管理者権限なしでのスキャンの実行</td>
<td style="border:1px solid black;">不可</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">824146 および 823980 以外の問題のスキャン</td>
<td style="border:1px solid black;">可</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">セキュリティ構成上の問題のスキャン</td>
<td style="border:1px solid black;">可</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">強度の低いパスワードのスキャン</td>
<td style="border:1px solid black;">可</td>
</tr>
</tbody>
</table>
  
MBSA に関する詳細または MBSA のダウンロードは、以下のサイトをご覧ください。  
<http://www.microsoft.com/japan/technet/security/tools/mbsahome.mspx>
  
[](#mainsection)[ページのトップへ](#mainsection)
  
### 緩和策
  
前述のように、この脆弱性のための唯一の最善策は影響を受けるコンピュータにすべて修正プログラムを適用することです。しかし、修正プログラムがインストールされるまでの間、この脆弱性の影響を受けるポートをブロックすることにより、この脆弱性の影響を緩和することができます。ブロックする必要のあるポートは以下の通りです。
  
-   UDP
  
    -   135
  
    -   137
  
    -   138
  
    -   445
  
-   TCP
  
    -   135
  
    -   139
  
    -   445
  
    -   593
  
また、COM インターネット サービスまたは RPC over HTTP がインストールされている場合、ポート 80 および443 を通じて脆弱性を悪用される可能性があります。ポート 80 以外のポートはファイアウォールを展開することによりブロックする必要があります。しかし、それらのポートがファイアウォールによって確かにブロックされているか確認するのがこの場合、賢明と言えます。マイクロソフトの [PortQry](http://support.microsoft.com/kb/310099) または Foundstone からリリースされている [SuperScan](http://www.foundstone.com/) あるいは [ScanLine](http://www.foundstone.com/) などのような標準のポート スキャナを使用して、これを確認することができます。
  
ポート 80 または 443 に対する攻撃を防ぐためには、CIS および RPC over HTTP を必要としないすべてのコンピュータで、それらを無効に設定する必要があります。これらのサービスは、既定でコンピュータにインストールされません。CIS を無効に設定する方法に関する詳細は、マイクロソフト サポート技術情報 [825819](http://support.microsoft.com/kb/825819) をご覧ください。RPC over HTTP が必要で、DCOM は必要としないコンピュータを保護する方法に関する詳細は、「RPC Over HTTP を必要とし、DCOM を必要としないコンピュータを保護する」のセクションをご覧ください。
  
#### ネットワーク ファイアウォールが有効でない可能性がある理由
  
インターネットからネットワークを保護するネットワーク ファイアウォールにより、これらの脆弱性に対する攻撃を完全には防ぐことができない場合があります。その理由は、保護されたネットワークと保護されていないネットワークの間でコンピュータが頻繁に移動されるためです。例えば、現在多くの従業員がラップトップ コンピュータを家庭に持ち出し、そしてケーブル モデムまたは DSL の回線にそれらを接続します。そのようなネットワークに接続されると、それらのコンピュータは組織的なファイアウォールの保護外となり、攻撃を受ける可能性があります。侵害されたシステムが保護されたネットワークに再度接続される時、そのコンピュータによって外部からの攻撃をブロックするファイアウォールが設置されていても、保護されたネットワークの上にワームを蔓延させる可能性があります。また、ウィルスがファイアウォール内にあるコンピュータを感染し、電子メールを悪用する方法により、この脆弱性が悪用される可能性があります。この理由により、すべてのホストを保護し、攻撃を阻むためにファイアウォールのみに単純に頼らないようにすることが絶対的に重要となります。
  
#### ホストベースのファイアウォール
  
Windows XP および Windows Server 2003 は、既定の構成でこれらのポートをすべてブロックするする、ビルトインのファイアウォールが含まれています。ビルトインのファイアウォールが有効で、これらのポートがブロックされていることを確認するためには、ネットワーク接続コントロール パネルにて、順番に各ネットワーク接続上で右クリックして、\[プロパティ\] を選択して、次に、\[詳細設定\] タブをクリックしてください。
  
![](images/Dd362794.bp03001(ja-jp,TechNet.10).jpg)
  
\[インターネット接続ファイアウォール\] の下のチェックボックスが選択されていることを確認してください。コンピュータが保護されたネットワーク上にある場合でも、\[インターネット接続ファイアウォール\] を有効に設定することは賢明な手段であると言えます。その理由は、そのネットワークは部外者から保護されない可能性がありますが、既にこの脆弱性を悪用した内部者から保護されないということです。しかし、多くの企業では、ファイアウォールの内部で、ICF の許可していないポリシーを設定していることにご注意ください。その理由は、ICF により、コンピュータのリモート管理が利用できなくなるためです。ICF に関する詳細は、マイクロソフト サポート技術情報 [317530](http://support.microsoft.com/kb/317530) をご覧ください。
  
Windows NT 4.0 および Windows 2000 にはビルトインのファイアウォールは含まれていません。ホーム ユーザー向けのほとんどのファイアウォール ソフトウェアは無料のバージョンまたは試用版にて利用可能です。パーソナル ファイアウォールに関する詳細は、以下のリソースをご覧ください。
  
-   [McAfee](http://www.mcafee.com/japan/products/mcafee/mdf.asp)
  
-   [Symantec](http://www.symantec.com/sabu/nis/npf/) (英語情報)
  
-   [ZoneAlarm Pro](http://www.zonealarm.com/store/content/catalog/products/zonealarm_pro_firewall_and_antispyware.jsp) (Zone Labs) (英語情報)
  
-   [Tiny Personal Firewall](http://www.tinysoftware.com/home/tiny2?la=en) (Tiny Software) (英語情報)
  
-   [Outpost Firewall](http://www.agnitum.com/products/outpostfree/download.php) (Agnitum) (英語情報)
  
-   [Kerio Personal Firewall](http://www.kerio.com/us/kpf_download.html) (Kerio Technologies) (英語情報)
  
-   BlackICE PC Protection (Internet Security Systems) (英語情報)
  
または、ハードウェア ファイアウォールを使用し、小規模のネットワークを攻撃から保護することができます。そのようなファイアウォールは、比較的安価で、通常非常に簡単にセット アップすることができます。そのようなデバイスには、たとえば Microsoft Wireless Base Station MN-500 があります。それはほとんどの電気店およびマイクロソフトのオンライン ショップで購入が可能です。すべてのホストペースのファイアウォールを展開した後に、それらのポートが確実にブロックされていることを常に確認してください。上記のポート スキャナを使用して、この確認を行うことができます。
  
#### IPSec を使用し、攻撃を阻止
  
また、Windows 2000、Windows XP、Windows Server 2003 では、IPSec を使用し、これらのポートをブロックすることが可能です。しかし、IPSec を有効にするためには、ポリシーを設定し、脆弱性の影響を受けるすべてのポートを完全にブロックする必要があるか、または、完全に信頼される、既知のホストを持つこれらのポートに修正を適用し、セキュリティで保護する必要があります。ドメイン内のすべてのコンピュータを信頼するか、またはセキュリティのみを要求するが、それを要求しないポリシーは完全に有効ではありません。その理由は、そのようなポリシーにより、感染しているにも関わらず、セキュリティで保護されているという誤った認識がされているコンピュータで、通信が妨げられずに行われ、そのため、保護されていうると認識されているホストが攻撃される可能性があるためです。
  
単純な [IPSec ポリシー](http://www.microsoft.com/downloads/details.aspx?familyid=d5d9b402-ed79-4ab4-8db2-2d25e0b8d2ea&displaylang=en) (英語情報) を利用することができます。このポリシーにより、脆弱性の影響を受けるポート上のすべてのトラフィックがブロックされます。このポリシーを使用するには、まず IPSecTools.exe ファイルをコンピュータの既知の場所にダウンロードし、抽出してください。\[ローカル セキュリティ設定\] を開き、は \[IP セキュリティ ポリシー\] で右クリックし、\[すべてのタスク\] をポイントし、\[ポリシーのインポート\] を選択します。次に、DCOM.IPSEC のポリシーを開きます。 (IPSecTools.exe のアーカイブから抽出されたファイルのうちの 1 つです)
  
![](images/Dd362794.bp03002(ja-jp,TechNet.10).gif)
  
ポリシーがインポートされたら、それを割り当る必要があります。ポリシーは割り当てるまで、無効です。ポリシーを割り当てるには、右クリックして、\[割り当て\] を選択してください。DCOM.IPSEC フィルタには、2 つのポリシーが含まれています。1 つのポリシーにより、CIS トラフィック以外のすべての DCOM トラフィックがブロックされます。もう 1 つのポリシーにより、CIS トラフィックを含むすべての DCOM トラフィックがブロックされます。HTTP トラフィックのサービスを行う必要があるコンピュータ上で CIS トラフィックもブロックするポリシーを使用しないでください。その理由は、そのポリシーにより、HTTP および HTTPS のトラフィックもブロックされるためです。
  
![](images/Dd362794.bp03003(ja-jp,TechNet.10).gif)
  
他のポリシーが割り当てられる場合、それらのポリシーがこの操作によって割り当てられなくなることにご注意ください。グループ ポリシーが IP セキュリティ ポリシーを指定した場合、グループ ポリシーによりローカルに割り当てられたポリシーが無効になります。グループ ポリシーが使用され IP セキュリティ ポリシーが配布されている環境では、グループ ポリシーによって、この脆弱性の影響を受けるすべての Windows 2000 およびそれ以降のバージョンのコンピュータに DCOM のポリシーを配布することができます。
  
IPSec のポリシーに対するよりさらに詳細の管理については、このドキュメントに含まれている IPSec\_RPC\_Blocker ツールを使用することができます。このツールにより、受信または送信のリクエストのブロックに加え、いくつかの例外を確立することができるポリシーをセット アップすることができます。また、IPSec\_RPC\_Blocker ツールは IPSecTools.exe アーカイブから利用可能です。このツールに関する詳細は、IPSec\_RPC\_Blocker ディレクトリーの readme.txt を参照してください。IPSec ポリシーが適用された後、リモート管理もブロックされることにご注意ください。コンピュータに修正プロ後ラムを適用した後に、IPSec ポリシーを削除する方法に関する詳細は、readme.txt をご覧ください。
  
IPSec を使用するプロトコルおよびポートをブロックする方法に関する詳細は、マイクロソフト サポート技術情報 813878 「IPSec を使用して特定のネットワーク プロトコルとポートをブロックする方法」 を参照してください。  
<http://support.microsoft.com/kb/813878>
  
#### DCOM を無効に設定する
  
いくつかのシステムでは、DCOM を無効にし、これらの脆弱性を防ぐことができます。しかし、DCOM を無効にすると、DCOM をリモートで再度有効にする機能など、いくつかの機能が使用できなくなります。再度 DCOM を有効にするには、コンピュータに物理的にアクセスする必要があります。
  
DCOM を無効にすると、以下のアイテムが無効になります。
  
-   リモートでアクティブ化されている COM オブジェクトが正しく機能しなくなる。
  
-   ローカルの COM+ スナップインからリモート サーバーに接続して COM+ カタログを列挙できなくなる。
  
-   証明書の自動登録が正しく動作しなくなる。
  
-   リモート サーバーに対する Windows Management Instrumentation (WMI) クエリが正しく実行されなくなる。
  
それでも DCOM を無効にしたい場合、レジストリ エディタまたは dcomcnfg.exe ツールを使用して無効に設定することができます。
  
**レジストリを編集する**
  
1.  レジストリ エディタを起動します。
  
2.  次のパスを見つけます。
  
    HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\OLE
  
3.  文字列値 EnableDCOM のデータを「N」に変更します。
  
4.  オペレーティング システムを再起動して、変更を適用します。
  
以下のコマンドを使用することもできます。
  
<codesnippet language displaylanguage containsmarkup="false"> reg add \\\\&lt;hostname&gt;\\HKLM\\Software\\Microsoft\\OLE /v EnableDCOM /t REG\_SZ /d N /f   
```  
DCOM を無効にしたいコンピュータ名を&lt;ホスト名&gt;に変更します。ローカル コンピュータで DCOM を無効に設定したい場合、“localhost” を使用してください。（ダブル クオーテーションは必要ありません）
  
**Dcomcnfg.exe を使用する**
  
1.  Dcomcnfg.exe を実行します。
  
2.  Windows XP または Windows Server 2003 を実行している場合は、次の手順を追加で実行します。
  
    1.  \[コンソール ルート\] の下の \[コンポーネント サービス\] ノードをクリックします。
  
    2.  \[コンピュータ\] フォルダを開きます。
  
    3.  ローカル コンピュータの場合は、\[マイ コンピュータ\] を右クリックし、\[プロパティ\] をクリックします。
  
    4.  リモート コンピュータの場合は、\[コンピュータ\] フォルダを右クリックし、\[新規作成\] をポイントし、\[コンピュータ\] をクリックします。
  
    5.  コンピュータ名を入力します。
  
    6.  コンピュータ名を右クリックし、\[プロパティ\] をクリックします。
  
3.  \[既定のプロパティ\] タブをクリックします。
  
4.  \[このコンピュータ上で分散 COM を有効にする\] (または \[このコンピュータ上で分散 COM を使う\]) チェック ボックスをオン (またはオフ) にします。
  
5.  コンピュータに対して他にもプロパティの設定を行う場合は、\[適用\] をクリックして DCOM を有効 (または無効) にします。設定を終了する場合は、\[OK\] をクリックして変更を適用し、Dcomcnfg.exe を終了します。
  
6.  オペレーティング システムを再起動して、変更を適用します。
  
Windows 2000 上で、DCOM を無効にするためには、Windows 2000 Service Pack 3 以降のバージョンを実行する必要があることにご注意ください。DCOM を無効にする方法に関する詳細は、マイクロソフト サポート技術情報 825750 をご覧ください。  
<http://support.microsoft.com/kb/825750>
  
RPC Over HTTP を必要とし、DCOM を必要としないコンピュータを保護する
  
いくつかの環境では、RPC over HTTP を使用し、ファイアウォールの外のクライアントに Exchange 2003 サーバーを発行する場合など、DCOM が必要な場合があります。そのような場合でも、TCPポート 593 へのアクセスをブロックし、DCOM を介する攻撃からこのようなコンピュータを保護することができます。詳細は、マイクロソフト サポート技術情報 836382 に記載されているステップにしたがってください。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
### 感染したコンピュータでワームを駆除する方法
  
ワームまたは他の攻撃のすべての場合に、既知の正常な状態のバックアップからコンピュータを再構築することが常に望ましいといえます。MSBlast ワームおよびその亜種の場合、ワーム自体によりコンピュータに別のバックドアは作成されないため、ワームを削除することができます。しかし、コンピュータが MSBlast に感染している場合、同じ脆弱性を介して、復旧できない方法でそのコンピュータを侵害したツールで、攻撃が行われていた可能性があります。しかし、このような攻撃が行われていないと確信できる場合、いくつかのウイルス対策ソフトウェア ベンダからリリースされている駆除ツールを使用し、ワームを削除することができます。
  
-   [Network Associates](http://vil.nai.com/vil/stinger/)
  
-   [Trend Micro](http://housecall.trendmicro.com/)
  
-   [Symantec](http://securityresponse.symantec.com/avcenter/venc/data/w32.blaster.worm.removal.tool.html)
  
-   [Computer Associates](http://www3.ca.com/virusinfo/virus.aspx?id=36265)
  
他の攻撃が行われたかどうかに関して、懸念がある場合、コンピュータを既知の正常な状態の媒体によって再構築する必要があります。
  
#### ワームの攻撃が行われている際のシステムの修正
  
MSBlast ワームなど、広がる速度が速いワームの動きがまだ遅い期間に、コンピュータに修正プログラムを適用する前に攻撃されてしまうということがよく起こる可能性があります。このような攻撃では、実際にコンピュータが侵害されることはないこともありますが、それにより、コンピュータが不安定になったり、クラッシュする可能性があります。たとえば、MSBlast ワームにより、Windows 2000 および Windows XP の 2 種類のコンピュータの攻撃が行われます。MSBlast ワームがコンピュータを感染し始めると、2 つの攻撃の 1 つが無作為に選択されます。たとえば、Windows 2000 の攻撃は、Windows 2000 システムを感染させますが、脆弱性の影響を受けるほかのコンピュータに対して悪用された場合、それらのコンピュータはすべてクラッシュします。ワームの活動が最も盛んな時に、非常に短時間でこのクラッシュが起こり、その前に修正プログラムを適用するのが不可能になる可能性があります。この状態が起こるほかのケースは、ウィルス スキャナがインストールされている場合に起こります。ウィルス スキャナにより、ワームがコンピュータを実際に感染するのが阻止されます。しかし、ウィルス スキャナによりワームの感染が阻止されても、その攻撃自体により、RPC サブシステムがクラッシュし、システムが再起動します。ウィルス スキャナにより、攻撃を阻止することはできません。できるのは感染を食い止めることのみです。したがって、コンピュータが攻撃される前に修正プログラムを適用するのは非常に困難となります。
  
このようなコンピュータに、修正プログラムを適用する 3 つの方法があります。それらはすべて、コンピュータに修正プログラムを適用するまでの期間、一時的にコンピュータを保護するための方法です。以下のステップに従ってください。
  
1.  ネットワーク ケーブルを外します。ワイアレス ネットワークを使用している場合、ネットワーク インターフェイス カードを外すか、またはワイアレス ネットワークを無効にします。この操作は、ネットワーク コントロール パネルから行うことができます。
  
2.  コンピュータを再起動します。
  
3.  管理者としてログオンします。コンピュータがワーク グループのメンバか、またはキャッシュされた資格情報カウントが既定値の 10 から変更されている場合、ログオンするコンピュータのローカルの資格情報が必要となります。
  
4.  以下の 4 つの方法の中の 1 つに従ってください。
  
    1.  **Windows 2000、Windows XP、Windows Server 2003 システムの場合**
  
        Windows 2000 またはそれ以降のバージョンでは、修正プログラムのダウンロードの際に、一時的に IPSec ポリシーを使用して、攻撃を阻止することができます。IPSec ツールのダウンロードのポリシーは、この目的で使用することができます。詳細は、「IPSec を使用し、攻撃を阻止」のセクションをご覧ください。IPSec ポリシーが適用されると、ネットワーク ケーブルを再度接続し、修正プログラムをダウンロードおよびインストールすることができます。その前にコンピュータを再起動する必要はありません。
  
    2.  **Windows XP および Windows Server 2003 システムの場合**
  
        Windows XP および Windows Server 2003 には、ICF が含まれており、それにより既定の構成で、これらの脆弱性が悪用される可能性があるすべてのトラフィックがブロックされます。このアプローチを使用するためには、「ホストベースのファイアウォール」のセクションの操作手順に従ってください。ファイアウォールが有効にされると、ネットワーク ケーブルに再び接続し、修正プログラムをダウンロードおよびインストールすることができます。その前にコンピュータを再起動する必要はありません。
  
    3.  **影響を受けるすべてのコンピュータ**
  
        Windows NT 4.0 には IPSec およびファイアウォールが含まれていません。したがって、Windows NT 4.0 システムでは、保護されたコンピュータに修正プログラムをダウンロードし、それをリムーバブル メディアに保存し、次にそれを使用して、この脆弱性の影響を受けるホストにインストールする必要があります。この方法は、もちろん影響を受けるほかのコンピュータのすべてに使用することができますが、Windows NT 4.0 では、必須となります。
  
    4.  **影響を受けるすべてのコンピュータ**
  
        「DCOM を無効に設定する」のセクションの操作手順に従って、DCOM を無効に設定します。DCOM を無効にする場合、変更を有効にする前にはシステムを再起動する必要があることにご注意ください、この修正プログラムのインストール後、DCOM サービスを再び使用する前に、そのコンピュータ上で DCOM をローカルに再度有効にする必要があります。
  
これらの操作手順は、攻撃者によって、これらの脆弱性が悪用されておらず、コンピュータが侵害されていないと確信できる場合にのみこの方法を行ってください。コンピュータが侵害されている場合、修正プログラムを適用しても、コンピュータを回復することはできません。その場合、コンピュータのハード ドライブの再フォーマットを行い、既知の正常なバックアップにより復元するのが唯一の方法です。
  
[](#mainsection)[ページのトップへ](#mainsection)
  
### 技術サポート
  
ウィルスの識別または駆除に関するサポートは、ウイルス対策ソフトウェア ベンダに連絡をお取りください。ウィルスに関連する問題に関するサポートを必要とする場合は、マイクロソフト プロダクト サポート (PSS) に連絡をお取りください。マイクロソフトは現在非常に多くのお問い合わせをいただいており、お答えできるまでに時間をいただいていることに関し、大変申し訳なく思っております。
  
-   合衆国およびカナダからマイクロソフト ＰＳＳ に連絡される場合は、フリーダイアル (866) PCSafety (727-2338) におかけください。
  
-   日本からマイクロソフトに連絡される場合は、[マイクロソフトセキュリティ情報センター](http://www.microsoft.com/japan/security/sicinfo.mspx) をご確認のうえ、ご連絡をください。
  
-   ワールドワイドのサポートに関しては、[お近くのマイクロソフトのオフィスまでご連絡ください](http://www.microsoft.com/japan/worldwide/)。
  
MSBlast ワームの影響を受けるかどうかについて、あるいは他のワームおよびウィルスに関してのご質問は、[マイクロソフトセキュリティ情報センター](http://www.microsoft.com/japan/security/sicinfo.mspx) あるいはお近くのマイクロソフトまでご連絡ください。セキュリティに関連するサポートは常に無料です。
  
[](#mainsection)[ページのトップへ](#mainsection)
